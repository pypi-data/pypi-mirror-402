# -*- coding: utf-8 -*-
"""Predictive Analytics Assignment 1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mg4UXf9ZijfqVSMQ2niM-rmhy1qDiExK
"""

# Imports
import pandas as pd
import numpy as np
from pandas.core.frame import DataFrame
from sklearn.preprocessing import LabelEncoder

# Data Read
data = pd.read_csv("data.csv")
data = data.drop(data.columns[0], axis = 1)
print(data)

# Calculate root of sum of square
data_new = data.copy()
data_new.columns = range(len(data_new.columns))
squared_sum = data_new ** 2
root_squared_sum = np.sqrt(squared_sum.sum())
print(root_squared_sum)

# Normalizing Value
data_new = data_new / root_squared_sum
print(data_new)

# Assigning Weights
weights = [0.25, 0.25, 0.25, 0.25]
data_new = data_new * weights
print(data_new)

# Calculating ideal value using impacts
impacts = ["-", "+", "+", "+"]
vj_max = pd.Series()
vj_min = pd.Series()

for i in range(len(impacts)):
  if impacts[i] == "+":
    vj_max[i] = data_new[i].max()
    vj_min[i] = data_new[i].min()
  else:
    vj_max[i] = data_new[i].min()
    vj_min[i] = data_new[i].max()

print(vj_max)
print("\n", vj_min)

# Calculating euclidean distance
st_max = np.sqrt(((data_new - vj_max) ** 2).sum(axis = 1))
st_min = np.sqrt(((data_new - vj_min) ** 2).sum(axis = 1))
print(st_max)
print("\n", st_min)

# Calculating Performance Score
p = st_min / (st_min + st_max)
print(p)

# Ranking based on Performance Score
rank = p.rank(ascending = False).astype(int)
print(rank)

# Joining performance score and rank in original dataset
data["Performance Score"] = p
data["Rank"] = rank
print(data)