"""Core module for claude-ctx - refactored into domain-specific submodules.

This __init__.py provides backward compatibility by re-exporting all functions
from the submodules, allowing existing code to continue using:
    from claude_ctx_py.core import function_name

The module is now organized as:
- base.py: Utility functions and constants
- agents.py: Agent management
- skills.py: Skill management
- modes.py: Mode management
- rules.py: Rule management
- workflows.py: Workflow management
- scenarios.py: Scenario management
- profiles.py: Profile and initialization functions
"""

# Re-export optional dependency handle for compatibility
try:  # pragma: no cover - optional dependency
    import yaml
except ImportError:  # pragma: no cover
    yaml = None  # type: ignore[assignment]

# Export all constants
from .base import (
    BLUE,
    GREEN,
    YELLOW,
    RED,
    NC,
    FrontMatterToken,
)

# Export all functions from base
from .base import (
    _color,
    _resolve_cortex_root,
    _resolve_plugin_assets_root,
    _resolve_claude_dir,
    _resolve_init_dirs,
    _ensure_claude_structure,
    _init_slug_for_path,
    _strip_ansi_codes,
    _run_detection_command,
    _run_detect_project_type,
    _run_analyze_project,
    _is_disabled,
    _iter_md_files,
    _iter_all_files,
    _parse_active_entries,
    _write_active_entries,
    _update_with_backup,
    _uncomment_rule_line,
    _comment_rule_line,
    _remove_exact_entries,
    _parse_claude_md_refs,
    _extract_front_matter,
    _tokenize_front_matter,
    _strip_inline_comment,
    _clean_scalar,
    _inactive_category_dir,
    _ensure_inactive_category_dir,
    _inactive_dir_candidates,
    _parse_inline_list,
    _find_key,
    _locate_path,
    _collect_list_items,
    _extract_values_for_path,
    _extract_values_from_paths,
    _extract_scalar_from_paths,
    _backup_config,
    _render_section,
    _refresh_claude_md,
    _load_yaml,
    _load_yaml_dict,
    _flatten_mixed,
    _ensure_list,
    _now_iso,
    _load_detection_file,
    _resolve_init_target,
    _prompt_user,
    _confirm,
    _format_detection_summary,
    _format_header,
    _parse_selection,
    _append_session_log,
    _list_available_agents,
    _list_available_modes,
)

# Export all functions from agents
from .agents import (
    AgentGraphNode,
    _agent_basename,
    _normalize_agent_filename,
    _find_disabled_agent_file,
    _find_agent_file_any_state,
    _normalize_dependency_name,
    _parse_agent_dependencies,
    _read_agent_front_matter_lines,
    _parse_agent_metadata_name,
    _parse_dependencies_from_front,
    _display_agent_name,
    _extract_agent_name,
    _generate_dependency_map,
    _active_agent_files,
    _find_agent_dependents,
    build_agent_graph,
    _format_dependency_entries,
    render_agent_graph,
    export_agent_graph,
    agent_graph,
    _iter_agent_paths,
    _resolve_agent_validation_target,
    _load_agent_schema,
    agent_validate,
    _agent_activate_recursive,
    agent_activate,
    agent_deactivate,
    list_agents,
    agent_status,
    agent_deps,
)

# Export all functions from skills
from .skills import (
    list_skills,
    skill_info,
    skill_versions,
    skill_validate,
    skill_analyze,
    skill_deps,
    skill_agents,
    skill_suggest,
    skill_metrics,
    skill_metrics_reset,
    skill_analytics,
    skill_report,
    skill_trending,
    skill_compose,
    skill_recommend,
    skill_feedback,
    skill_rate,
    skill_ratings,
    skill_top_rated,
    skill_ratings_export,
    skill_community_list,
    skill_community_install,
    skill_community_validate,
    skill_community_rate,
    skill_community_search,
)

# Export all functions from modes
from .modes import (
    _mode_active_file,
    _mode_inactive_dir,
    _parse_claude_md_modes,
    _get_active_modes,
    mode_activate,
    mode_deactivate,
    list_modes,
    mode_status,
    mode_add_to_claude_md,
)

# Export all functions from rules
from .rules import (
    rules_status,
    rules_activate,
    rules_deactivate,
    list_rules,
)

# Export all functions from principles
from .principles import (
    list_principles,
    principles_status,
    principles_activate,
    principles_deactivate,
    principles_build,
)

# Export all functions from prompts
from .prompts import (
    PromptInfo,
    discover_prompts,
    prompt_activate,
    prompt_deactivate,
    list_prompts,
    prompt_status,
    get_prompt_by_slug,
)

# Export all functions from workflows
from .workflows import (
    workflow_run,
    workflow_list,
    workflow_status,
    workflow_resume,
    workflow_stop,
)

# Export all functions from worktrees
from .worktrees import (
    WorktreeInfo,
    worktree_discover,
    worktree_list,
    worktree_default_path,
    worktree_get_base_dir,
    worktree_set_base_dir,
    worktree_clear_base_dir,
    worktree_add,
    worktree_remove,
    worktree_prune,
)

# Export all functions from scenarios
from .scenarios import (
    ScenarioPhase,
    ScenarioMetadata,
    _scenario_dirs,
    _ensure_scenarios_dir,
    _scenario_schema_path,
    _scenario_lock_basename,
    _scenario_init_state,
    _scenario_update_phase_state,
    _scenario_finalize_state,
    _collect_scenario_targets,
    _parse_scenario_metadata,
    scenario_list,
    scenario_validate,
    scenario_status,
    scenario_stop,
    scenario_run,
    scenario_preview,
)

# Export all functions from profiles
from .profiles import (
    _profile_reset,
    profile_list,
    profile_save,
    profile_minimal,
    profile_frontend,
    profile_web_dev,
    profile_backend,
    profile_devops,
    profile_documentation,
    profile_data_ai,
    profile_quality,
    profile_meta,
    profile_developer_experience,
    profile_product,
    profile_full,
    init_detect,
    init_minimal,
    init_profile,
    init_status,
    init_reset,
    init_resume,
    init_wizard,
    show_status,
)

# Export all functions from context_export
from .context_export import (
    collect_context_components,
    export_context,
    list_context_components,
)

# Export all functions from mcp
from .mcp import (
    MCPServerInfo,
    MCPServerCapabilities,
    MCPConfigError,
    MCPServerNotFoundError,
    discover_servers,
    list_doc_only_servers,
    get_server_info,
    list_server_tools,
    get_server_docs_path,
    validate_server_config,
    generate_config_snippet,
    list_available_servers,
    get_server_command_line,
    export_servers_list,
    mcp_list,
    mcp_show,
    mcp_docs,
    mcp_test,
    mcp_diagnose,
    mcp_snippet,
    list_doc_only_servers,
    # MCP docs activation
    mcp_activate,
    mcp_deactivate,
    mcp_list_docs,
    mcp_docs_status,
)

# Export doctor function
from .doctor import doctor_run

# Export hooks functions
from .hooks import (
    HookDefinition,
    InstalledHook,
    HOOK_EVENTS,
    get_settings_path,
    load_settings,
    save_settings,
    get_installed_hooks,
    get_available_hooks,
    parse_hook_file,
    install_hook,
    uninstall_hook,
    get_hook_events,
    create_hook_template,
    validate_hooks_config,
    validate_hooks_config_file,
)

# Export backup functions
from .backup import (
    BackupInfo,
    get_backup_dir,
    create_backup,
    list_backups,
    restore_backup,
    delete_backup,
    get_backup_summary,
    auto_cleanup_backups,
)

__all__ = [
    # Constants
    "BLUE",
    "GREEN",
    "YELLOW",
    "RED",
    "NC",
    "yaml",
    "FrontMatterToken",
    # Dataclasses
    "AgentGraphNode",
    "ScenarioMetadata",
    # Base functions
    "_color",
    "_resolve_cortex_root",
    "_resolve_claude_dir",
    "_resolve_plugin_assets_root",
    "_resolve_init_dirs",
    "_ensure_claude_structure",
    "_init_slug_for_path",
    "_strip_ansi_codes",
    "_run_detection_command",
    "_run_detect_project_type",
    "_run_analyze_project",
    "_is_disabled",
    "_iter_md_files",
    "_iter_all_files",
    "_parse_active_entries",
    "_write_active_entries",
    "_update_with_backup",
    "_uncomment_rule_line",
    "_comment_rule_line",
    "_remove_exact_entries",
    "_parse_claude_md_refs",
    "_extract_front_matter",
    "_tokenize_front_matter",
    "_strip_inline_comment",
    "_clean_scalar",
    "_inactive_category_dir",
    "_ensure_inactive_category_dir",
    "_inactive_dir_candidates",
    "_parse_inline_list",
    "_find_key",
    "_locate_path",
    "_collect_list_items",
    "_extract_values_for_path",
    "_extract_values_from_paths",
    "_extract_scalar_from_paths",
    "_backup_config",
    "_render_section",
    "_refresh_claude_md",
    "_load_yaml",
    "_load_yaml_dict",
    "_flatten_mixed",
    "_ensure_list",
    "_now_iso",
    "_load_detection_file",
    "_resolve_init_target",
    "_prompt_user",
    "_confirm",
    "_format_detection_summary",
    "_format_header",
    "_parse_selection",
    "_append_session_log",
    "_list_available_agents",
    "_list_available_modes",
    # Agent functions
    "_agent_basename",
    "_normalize_agent_filename",
    "_find_disabled_agent_file",
    "_find_agent_file_any_state",
    "_normalize_dependency_name",
    "_parse_agent_dependencies",
    "_read_agent_front_matter_lines",
    "_parse_agent_metadata_name",
    "_parse_dependencies_from_front",
    "_display_agent_name",
    "_extract_agent_name",
    "_generate_dependency_map",
    "_active_agent_files",
    "_find_agent_dependents",
    "build_agent_graph",
    "_format_dependency_entries",
    "render_agent_graph",
    "export_agent_graph",
    "agent_graph",
    "_iter_agent_paths",
    "_resolve_agent_validation_target",
    "_load_agent_schema",
    "agent_validate",
    "_agent_activate_recursive",
    "agent_activate",
    "agent_deactivate",
    "list_agents",
    "agent_status",
    "agent_deps",
    # Skill functions
    "list_skills",
    "skill_info",
    "skill_versions",
    "skill_validate",
    "skill_analyze",
    "skill_deps",
    "skill_agents",
    "skill_suggest",
    "skill_metrics",
    "skill_metrics_reset",
    "skill_analytics",
    "skill_report",
    "skill_trending",
    "skill_compose",
    "skill_recommend",
    "skill_feedback",
    "skill_rate",
    "skill_ratings",
    "skill_top_rated",
    "skill_ratings_export",
    "skill_community_list",
    "skill_community_install",
    "skill_community_validate",
    "skill_community_rate",
    "skill_community_search",
    # Mode functions
    "_mode_active_file",
    "_mode_inactive_dir",
    "mode_activate",
    "mode_deactivate",
    "list_modes",
    "mode_status",
    # Rule functions
    "rules_status",
    "rules_activate",
    "rules_deactivate",
    "list_rules",
    # Principles functions
    "list_principles",
    "principles_status",
    "principles_activate",
    "principles_deactivate",
    "principles_build",
    # Prompts functions
    "PromptInfo",
    "discover_prompts",
    "prompt_activate",
    "prompt_deactivate",
    "list_prompts",
    "prompt_status",
    "get_prompt_by_slug",
    # Workflow functions
    "workflow_run",
    "workflow_list",
    "workflow_status",
    "workflow_resume",
    "workflow_stop",
    # Worktree functions
    "WorktreeInfo",
    "worktree_discover",
    "worktree_list",
    "worktree_default_path",
    "worktree_get_base_dir",
    "worktree_set_base_dir",
    "worktree_clear_base_dir",
    "worktree_add",
    "worktree_remove",
    "worktree_prune",
    # Scenario functions
    "_scenario_dirs",
    "_ensure_scenarios_dir",
    "_scenario_schema_path",
    "_scenario_lock_basename",
    "_scenario_init_state",
    "_scenario_update_phase_state",
    "_scenario_finalize_state",
    "_collect_scenario_targets",
    "_parse_scenario_metadata",
    "scenario_list",
    "scenario_validate",
    "scenario_status",
    "scenario_stop",
    "scenario_run",
    "scenario_preview",
    # Profile and init functions
    "_profile_reset",
    "profile_list",
    "profile_save",
    "profile_minimal",
    "profile_frontend",
    "profile_web_dev",
    "profile_backend",
    "profile_devops",
    "profile_documentation",
    "profile_data_ai",
    "profile_quality",
    "profile_meta",
    "profile_developer_experience",
    "profile_product",
    "profile_full",
    "init_detect",
    "init_minimal",
    "init_profile",
    "init_status",
    "init_reset",
    "init_resume",
    "init_wizard",
    "show_status",
    # Context export functions
    "collect_context_components",
    "export_context",
    "list_context_components",
    # MCP functions
    "MCPServerInfo",
    "MCPServerCapabilities",
    "MCPConfigError",
    "MCPServerNotFoundError",
    "discover_servers",
    "get_server_info",
    "list_server_tools",
    "get_server_docs_path",
    "validate_server_config",
    "generate_config_snippet",
    "list_available_servers",
    "get_server_command_line",
    "export_servers_list",
    "mcp_list",
    "mcp_show",
    "mcp_docs",
    "mcp_test",
    "mcp_diagnose",
    "mcp_snippet",
    "list_doc_only_servers",
    # MCP docs activation
    "mcp_activate",
    "mcp_deactivate",
    "mcp_list_docs",
    "mcp_docs_status",
    # Doctor functions
    "doctor_run",
    # Hooks functions
    "HookDefinition",
    "InstalledHook",
    "HOOK_EVENTS",
    "get_settings_path",
    "load_settings",
    "save_settings",
    "get_installed_hooks",
    "get_available_hooks",
    "parse_hook_file",
    "install_hook",
    "uninstall_hook",
    "get_hook_events",
    "create_hook_template",
    "validate_hooks_config",
    "validate_hooks_config_file",
    # Backup functions
    "BackupInfo",
    "get_backup_dir",
    "create_backup",
    "list_backups",
    "restore_backup",
    "delete_backup",
    "get_backup_summary",
    "auto_cleanup_backups",
]
