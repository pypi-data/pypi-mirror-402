"""Malware Detector Framework.

A base framework for building malware detectors with:
- Pydantic v2 configuration system
- Typer-based extensible CLI
- Structured logging with structlog
- ABC-based detector with train/evaluate/predict interface

Source code: https://github.com/bolin8017/malware-detector.git
Documentation: https://github.com/bolin8017/malware-detector/wiki
PyPI: https://pypi.org/project/malware-detector/
"""

from importlib.metadata import version

from .cli import create_cli
from .config import (
    BaseDetectorConfig,
    DataConfig,
    LogConfig,
    OutputConfig,
)
from .constants import (
    CONFIG_VERSION,
    DEFAULT_DATA_PATH_PREDICT,
    DEFAULT_DATA_PATH_TEST,
    DEFAULT_DATA_PATH_TRAIN,
    DEFAULT_LOG_FORMAT,
    DEFAULT_LOG_LEVEL,
    DEFAULT_OUTPUT_PATH_FEATURE,
    DEFAULT_OUTPUT_PATH_LOG,
    DEFAULT_OUTPUT_PATH_MODEL,
    DEFAULT_OUTPUT_PATH_PREDICTION,
    ENV_NESTED_DELIMITER,
    ENV_PREFIX,
)
from .detector import BaseDetector
from .exceptions import DetectorError
from .logging import configure_logging, get_logger

__version__ = version(__package__ or __name__)

__all__ = [
    # Version
    "__version__",
    # Detector
    "BaseDetector",
    # Config
    "BaseDetectorConfig",
    "DataConfig",
    "OutputConfig",
    "LogConfig",
    # CLI
    "create_cli",
    # Logging
    "configure_logging",
    "get_logger",
    # Exceptions
    "DetectorError",
    # Constants
    "CONFIG_VERSION",
    "DEFAULT_LOG_LEVEL",
    "DEFAULT_LOG_FORMAT",
    "DEFAULT_DATA_PATH_TRAIN",
    "DEFAULT_DATA_PATH_TEST",
    "DEFAULT_DATA_PATH_PREDICT",
    "DEFAULT_OUTPUT_PATH_MODEL",
    "DEFAULT_OUTPUT_PATH_FEATURE",
    "DEFAULT_OUTPUT_PATH_PREDICTION",
    "DEFAULT_OUTPUT_PATH_LOG",
    "ENV_PREFIX",
    "ENV_NESTED_DELIMITER",
]
