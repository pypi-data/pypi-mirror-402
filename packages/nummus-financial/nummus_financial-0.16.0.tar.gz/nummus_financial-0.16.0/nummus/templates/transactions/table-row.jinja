<div
  class="txn"
  hx-get="{{ url_for('transactions.transaction', uri=txn.parent_uri) }}"
  hx-target="#dialog"
  hx-swap="innerHTML show:#dialog:top"
  hx-push-url="#dialog"
>
  {% set cf = txn.currency_format %}
  <label class="checkbox">
    {# TODO (WattsUp): #365 Add bulk editor #}
    <input type="checkbox" autocomplete="off" disabled />
    <icon>check_box_outline_blank</icon>
    <icon>check_box</icon>
  </label>
  <div>
    {# TODO (WattsUp): #366 Add emphasis to matching terms when searching #}
    <div>
      <div>
        {% if txn.asset_name %}
          {% if txn.asset_quantity > 0 %}
            Buy
          {% elif txn.asset_quantity == 0 %}
            {% if txn.amount > 0 %}
              Dividend from
            {% else %}
              Fee from
            {% endif %}
          {% else %}
            Sell
          {% endif %}
          {% if txn.asset_ticker %}{{ txn.asset_ticker }}:{% endif %}
          {{ txn.asset_name }}
        {% else %}
          {{ txn.payee or "Payee needed" }}
        {% endif %}
      </div>
      {% set class_amount = "text-primary" if txn.amount > 0 %}
      <div class="{{ class_amount }}">{{ cf(txn.amount) }}</div>
      {% set class_cleared = "text-primary filled" if txn.cleared > 0 %}
      <icon class="{{ class_cleared }}">check_circle</icon>
    </div>
    <div>
      <div>
        {% if txn.asset_quantity %}
          {{ txn.asset_quantity | abs | qty }}
          shares @ {{ cf(txn.asset_price) }}
        {% else %}
          {{ txn.category }}
        {% endif %}
        <span class="max-md:hidden">
          {% for label in txn.labels %}
            <a
              class="btn-tonal btn-tight inline-block"
              href="{{ url_for('income.page' if txn.amount > 0 else 'spending.page', label=label.key) }}"
              hx-get="{{ url_for('income.page' if txn.amount > 0 else 'spending.page', label=label.key) }}"
              hx-trigger="click consume"
              hx-disabled-elt="this"
              hx-target="#main"
              hx-swap="innerHTML show:window:top"
              hx-push-url="true"
            >
              {{ label.name }}
            </a>
          {% endfor %}
        </span>
      </div>
      <div>{{ txn.account }}</div>
      <icon>{% if txn.is_split %}arrow_split{% endif %}</icon>
    </div>
  </div>
</div>
