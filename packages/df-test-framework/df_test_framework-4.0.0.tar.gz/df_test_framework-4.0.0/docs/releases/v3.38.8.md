# v3.38.8 - 可观测性架构文档更新

**发布日期**: 2025-12-29

## 概述

v3.38.8 更新可观测性架构文档，说明日志技术栈升级（Loguru → structlog）和控制台日志架构设计。

## 主要变更

### 1. 日志技术栈说明更新

更新架构文档中的日志技术栈描述：

- **v3.38.2 之前**: Loguru 作为日志库
- **v3.38.2 之后**: structlog 结构化日志库

### 2. 控制台日志架构章节

新增控制台日志架构设计说明，解释两种日志记录方式：

| 组件 | 适用场景 | 原因 |
|------|----------|------|
| `LoggingMiddleware` | HTTP 客户端 | 中间件位置敏感，需要在中间件链内部记录 |
| `ObservabilityLogger` | Database/Redis/UI | 领域语义封装，直接在能力层调用 |

### 3. 双写设计说明

说明控制台日志和 EventBus 事件的双写设计：

```
能力层操作
    │
    ├──► 控制台日志（实时调试）
    │    - LoggingMiddleware（HTTP）
    │    - ObservabilityLogger（DB/Redis/UI）
    │
    └──► EventBus 事件（解耦架构）
         - AllureObserver 订阅
         - MetricsObserver 订阅
         - ConsoleDebugObserver 订阅
```

### 4. 版本演进表更新

更新可观测性功能的版本演进记录：

| 版本 | 功能 |
|------|------|
| v3.35.7 | UI 自动化可观测性集成 |
| v3.38.2 | Loguru → structlog 迁移 |
| v3.38.4 | ProcessorFormatter + ISO 8601 |
| v3.38.5 | pytest 日志集成完善 |
| v3.38.7 | 日志系统简化 |
| v3.38.8 | 架构文档更新 |

## 影响的文件

- `docs/architecture/observability-architecture.md`

## 升级指南

无需修改任何代码，仅为文档更新。