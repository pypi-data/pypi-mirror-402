# DF Test Framework v3.7.0 Release Notes

å‘å¸ƒæ—¥æœŸ: 2025-11-24

---

## ğŸ‰ é‡å¤§æ›´æ–°

### ğŸ—ï¸ Unit of Work æ¨¡å¼ - ç°ä»£åŒ–æ•°æ®è®¿é—®æ¶æ„ï¼ˆæ ¸å¿ƒç‰¹æ€§ï¼‰

**æ¶æ„å‡çº§ï¼šDDD æ ‡å‡†å®ç°ï¼Œè§£å†³ v3.6.2 äº‹åŠ¡éš”ç¦»é—®é¢˜ï¼**

v3.7.0 å¼•å…¥ Unit of Work æ¨¡å¼ï¼Œæä¾›ç°ä»£åŒ–çš„æ•°æ®è®¿é—®æ¶æ„ï¼Œè§£å†³ v3.6.2 ä¸­ `db_transaction` å’Œ Repository ä½¿ç”¨ä¸åŒ Session å¯¼è‡´çš„äº‹åŠ¡éš”ç¦»é—®é¢˜ã€‚

#### æ ¸å¿ƒç‰¹æ€§

- âœ… **UnitOfWork ç±»**: ç»Ÿä¸€ç®¡ç†äº‹åŠ¡è¾¹ç•Œå’Œ Repository ç”Ÿå‘½å‘¨æœŸ
- âœ… **BaseUnitOfWork**: æ¡†æ¶æä¾›åŸºç±»ï¼Œæ”¯æŒ Repository æ‡’åŠ è½½å’Œç¼“å­˜
- âœ… **uow fixture**: æ›¿ä»£ `db_transaction`ï¼Œç¡®ä¿æ‰€æœ‰æ“ä½œåœ¨åŒä¸€äº‹åŠ¡ä¸­
- âœ… **Session å…±äº«**: æ‰€æœ‰ Repository å…±äº«åŒä¸€ä¸ª Sessionï¼Œäº‹åŠ¡éš”ç¦»æ­£ç¡®
- âœ… **DDD æ ‡å‡†å®ç°**: Unit of Work + Repository æ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡çš„æ ‡å‡†æ¨¡å¼
- âœ… **æ˜¾å¼æäº¤**: é»˜è®¤å›æ»šï¼Œ`uow.commit()` æ‰æäº¤

---

## âœ¨ åŠŸèƒ½è¯¦è§£

### 1. Unit of Work æ¨¡å¼

#### èƒŒæ™¯é—®é¢˜

v3.6.2 çš„ `db_transaction` å’Œ Repository ä½¿ç”¨ä¸åŒçš„ Sessionï¼Œå¯¼è‡´äº‹åŠ¡éš”ç¦»å¤±æ•ˆï¼š

```python
# âŒ v3.6.2 é—®é¢˜
def test_example(db_transaction, card_repository):
    # db_transaction ä½¿ç”¨ Session A
    db_transaction.execute(text("UPDATE card_inventory SET status = 'LOCKED'"))

    # card_repository ä½¿ç”¨ Session Bï¼ˆä¸åŒçš„ Sessionï¼‰
    card = card_repository.find_by_card_no("CARD001")
    # card.status å¯èƒ½çœ‹ä¸åˆ° Session A çš„ä¿®æ”¹
```

#### è§£å†³æ–¹æ¡ˆ

v3.7.0 å¼•å…¥ Unit of Work æ¨¡å¼ï¼Œç»Ÿä¸€ç®¡ç† Sessionï¼š

```python
# âœ… v3.7.0 è§£å†³æ–¹æ¡ˆ
def test_example(uow):
    # æ‰€æœ‰æ“ä½œåœ¨åŒä¸€ä¸ª Session ä¸­
    uow.session.execute(text("UPDATE card_inventory SET status = 'LOCKED'"))

    # Repository ä½¿ç”¨ç›¸åŒçš„ Session
    card = uow.cards.find_by_card_no("CARD001")
    # card.status èƒ½æ­£ç¡®çœ‹åˆ°ä¿®æ”¹
```

#### ä½¿ç”¨æ–¹å¼

**æ­¥éª¤ 1: åˆ›å»ºé¡¹ç›®ä¸“ç”¨ UoW**

```python
# gift_card_test/uow.py
from df_test_framework import BaseUnitOfWork
from gift_card_test.repositories import CardRepository, OrderRepository

class GiftCardUoW(BaseUnitOfWork):
    """ç¤¼å“å¡æµ‹è¯•é¡¹ç›®çš„ Unit of Work"""

    @property
    def cards(self) -> CardRepository:
        """ç¤¼å“å¡ Repository"""
        return self.repository(CardRepository, "card_inventory")

    @property
    def orders(self) -> OrderRepository:
        """è®¢å• Repository"""
        return self.repository(OrderRepository, "card_order")
```

**æ­¥éª¤ 2: åœ¨ conftest.py ä¸­åˆ›å»º uow fixture**

```python
# conftest.py
import pytest
from gift_card_test.uow import GiftCardUoW

@pytest.fixture
def uow(database, request):
    """Unit of Work fixture"""
    # æ£€æŸ¥æ˜¯å¦éœ€è¦ä¿ç•™æ•°æ®
    auto_commit = request.node.get_closest_marker("keep_data") is not None

    unit_of_work = GiftCardUoW(database.session_factory)
    with unit_of_work:
        yield unit_of_work
        # æ ¹æ®æ ‡è®°å†³å®šæ˜¯å¦æäº¤
        if auto_commit and not unit_of_work._committed:
            unit_of_work.commit()
```

**æ­¥éª¤ 3: åœ¨æµ‹è¯•ä¸­ä½¿ç”¨**

```python
def test_example(uow):
    """æ‰€æœ‰æ“ä½œåœ¨åŒä¸€äº‹åŠ¡ä¸­"""

    # ä½¿ç”¨ Repository
    card = uow.cards.find_by_card_no("CARD001")
    assert card is not None

    order = uow.orders.find_by_order_no("ORD001")
    assert order is not None

    # ç›´æ¥æ‰§è¡Œ SQL
    uow.session.execute(
        text("UPDATE card_inventory SET status = :status WHERE card_no = :card_no"),
        {"status": "ACTIVE", "card_no": "CARD001"}
    )

    # é»˜è®¤å›æ»šï¼Œä¸æäº¤
    # é™¤éæ˜¾å¼è°ƒç”¨ uow.commit()
```

**æ­¥éª¤ 4: éœ€è¦ä¿ç•™æ•°æ®æ—¶ä½¿ç”¨æ ‡è®°**

```python
@pytest.mark.keep_data
def test_create_demo_data(uow):
    """åˆ›å»ºæ¼”ç¤ºæ•°æ®ï¼Œéœ€è¦ä¿ç•™"""
    card = Card(card_no="DEMO001", balance=Decimal("100.00"))
    uow.cards.add(card)

    # æ•°æ®ä¼šè¢«æäº¤ï¼ˆå› ä¸º @pytest.mark.keep_dataï¼‰
```

#### æ¶æ„ä¼˜åŠ¿

- âœ… **DDD æ ‡å‡†å®ç°**: Unit of Work + Repository æ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡çš„æ ‡å‡†æ¨¡å¼
- âœ… **äº‹åŠ¡è¾¹ç•Œæ¸…æ™°**: æ‰€æœ‰ Repository æ“ä½œåœ¨åŒä¸€äº‹åŠ¡ä¸­
- âœ… **æ˜¾å¼æäº¤**: é»˜è®¤å›æ»šï¼Œ`uow.commit()` æ‰æäº¤
- âœ… **Repository å¤ç”¨**: Repository ä»ç„¶ç‹¬ç«‹ï¼Œå¯å•ç‹¬ä½¿ç”¨
- âœ… **æ‡’åŠ è½½**: Repository æŒ‰éœ€åˆ›å»ºï¼Œæå‡æ€§èƒ½
- âœ… **ç¼“å­˜æœºåˆ¶**: åŒä¸€ä¸ª Repository å¤šæ¬¡è®¿é—®è¿”å›åŒä¸€å®ä¾‹

#### å½±å“æ–‡ä»¶

- `src/df_test_framework/databases/uow.py` - æ–°å¢ UnitOfWork å’Œ BaseUnitOfWork
- `src/df_test_framework/databases/repositories/base.py` - BaseRepository æ¥æ”¶ Session
- `src/df_test_framework/__init__.py` - å¯¼å‡º BaseUnitOfWork

#### æµ‹è¯•è¦†ç›–

- âœ… **19ä¸ªå•å…ƒæµ‹è¯•**, å…¨éƒ¨é€šè¿‡
- âœ… **è¦†ç›–ç‡ 94.52%** (ç›®æ ‡80%, è¶…å‡º14.52%)
- âœ… **æµ‹è¯•åˆ†ç±»**: åŸºç¡€åŠŸèƒ½/äº‹åŠ¡ç®¡ç†/Repositoryé›†æˆ/é”™è¯¯å¤„ç†

**æµ‹è¯•æ–‡ä»¶**: `tests/unit/databases/test_uow.py`

---

### 2. ç†”æ–­å™¨ (Circuit Breaker) - é˜²æ­¢çº§è”å¤±è´¥

**æ–°å¢æ¨¡å—**: `src/df_test_framework/utils/resilience.py`

æä¾›å®Œæ•´çš„ç†”æ–­å™¨å®ç°ï¼Œé˜²æ­¢çº§è”å¤±è´¥ã€‚

#### æ ¸å¿ƒåŠŸèƒ½

- âœ… **çŠ¶æ€æœº**: CLOSED â†’ OPEN â†’ HALF_OPEN â†’ CLOSED å®Œæ•´å®ç°
- âœ… **å¤±è´¥ä¿æŠ¤**: è¿ç»­å¤±è´¥Næ¬¡è‡ªåŠ¨ç†”æ–­
- âœ… **è‡ªåŠ¨æ¢å¤**: è¶…æ—¶åå°è¯•åŠå¼€çŠ¶æ€
- âœ… **å¼‚å¸¸ç™½åå•**: å¯é…ç½®ä¸è®¡å…¥å¤±è´¥çš„å¼‚å¸¸
- âœ… **çº¿ç¨‹å®‰å…¨**: threading.Lock ä¿æŠ¤å¹¶å‘è®¿é—®
- âœ… **è£…é¥°å™¨æ”¯æŒ**: @circuit_breaker ç®€åŒ–ä½¿ç”¨

#### ä½¿ç”¨æ–¹å¼

**æ–¹å¼ 1: ç¼–ç¨‹å¼**

```python
from df_test_framework.utils import CircuitBreaker, CircuitOpenError

# åˆ›å»ºç†”æ–­å™¨
breaker = CircuitBreaker(
    failure_threshold=3,  # è¿ç»­å¤±è´¥3æ¬¡è§¦å‘ç†”æ–­
    timeout=60,           # 60ç§’åå°è¯•æ¢å¤
    name="payment-api"    # ç†”æ–­å™¨åç§°
)

try:
    # è°ƒç”¨å¯èƒ½å¤±è´¥çš„å‡½æ•°
    result = breaker.call(risky_api_call)
except CircuitOpenError:
    # ç†”æ–­å™¨å·²æ‰“å¼€ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ
    result = get_cached_data()
```

**æ–¹å¼ 2: è£…é¥°å™¨**

```python
from df_test_framework.utils import circuit_breaker

@circuit_breaker(failure_threshold=5, timeout=30)
def call_payment_api():
    """è°ƒç”¨æ”¯ä»˜ API"""
    return requests.post("/payment", json=data)

# ä½¿ç”¨
try:
    result = call_payment_api()
except CircuitOpenError:
    # ä½¿ç”¨é™çº§æ–¹æ¡ˆ
    result = fallback_payment()
```

**æ–¹å¼ 3: å¼‚å¸¸ç™½åå•**

```python
from df_test_framework.utils import CircuitBreaker

# åˆ›å»ºç†”æ–­å™¨ï¼Œå¿½ç•¥ç‰¹å®šå¼‚å¸¸
breaker = CircuitBreaker(
    failure_threshold=3,
    timeout=60,
    excluded_exceptions=[ValidationError, InvalidInputError]
)

# ValidationError ä¸ä¼šè®¡å…¥å¤±è´¥æ¬¡æ•°
result = breaker.call(validate_and_process)
```

#### çŠ¶æ€è½¬æ¢

```
CLOSED (æ­£å¸¸)
  â†“ å¤±è´¥æ¬¡æ•°è¾¾åˆ°é˜ˆå€¼
OPEN (ç†”æ–­)
  â†“ è¶…æ—¶æ—¶é—´åˆ°è¾¾
HALF_OPEN (å°è¯•æ¢å¤)
  â†“ æˆåŠŸè°ƒç”¨
CLOSED (æ¢å¤æ­£å¸¸)
  æˆ–
  â†“ å¤±è´¥è°ƒç”¨
OPEN (é‡æ–°ç†”æ–­)
```

#### ä½¿ç”¨åœºæ™¯

```python
# åœºæ™¯ 1: å¤–éƒ¨ API è°ƒç”¨
@circuit_breaker(failure_threshold=5, timeout=60)
def call_third_party_api():
    return requests.get("https://api.example.com/data")

# åœºæ™¯ 2: æ•°æ®åº“è¿æ¥
breaker = CircuitBreaker(failure_threshold=3, timeout=30)
try:
    result = breaker.call(lambda: db.execute(query))
except CircuitOpenError:
    logger.warning("æ•°æ®åº“ç†”æ–­ï¼Œä½¿ç”¨ç¼“å­˜")
    result = cache.get(key)

# åœºæ™¯ 3: å¾®æœåŠ¡è°ƒç”¨
@circuit_breaker(failure_threshold=10, timeout=120, name="user-service")
def get_user_info(user_id):
    return user_service_client.get(f"/users/{user_id}")
```

#### æµ‹è¯•è¦†ç›–

- âœ… **26ä¸ªå•å…ƒæµ‹è¯•**, å…¨éƒ¨é€šè¿‡
- âœ… **è¦†ç›–ç‡ 98.40%** (ç›®æ ‡80%, è¶…å‡º18.40%)
- âœ… **æµ‹è¯•ç±»åˆ«**: åŸºç¡€/çŠ¶æ€è½¬æ¢/ç™½åå•/è£…é¥°å™¨/çº¿ç¨‹å®‰å…¨/è¾¹ç•Œ/é›†æˆ

**æµ‹è¯•æ–‡ä»¶**: `tests/unit/utils/test_resilience.py`

---

## ğŸ”’ å®‰å…¨å¢å¼º

### 1. å®‰å…¨æœ€ä½³å®è·µæŒ‡å—

**æ–°å¢æ–‡æ¡£**: `docs/user-guide/security-best-practices.md`

**æ–‡æ¡£è§„æ¨¡**: 8000+å­—, 11ä¸ªä¸»é¢˜, 50+ç¤ºä¾‹

**è¦†ç›–ä¸»é¢˜**:

1. âœ… **æ•æ„Ÿä¿¡æ¯ç®¡ç†**
   - ç¦æ­¢ç¡¬ç¼–ç å¯†é’¥
   - .env æ–‡ä»¶ç®¡ç†
   - å¯†é’¥ç®¡ç†æœåŠ¡ (KMS)

2. âœ… **SQLæ³¨å…¥é˜²æŠ¤**
   - å‚æ•°åŒ–æŸ¥è¯¢
   - è¡¨åç™½åå•
   - ORM æœ€ä½³å®è·µ

3. âœ… **APIç­¾åéªŒè¯**
   - HMAC ç­¾åå®ç°
   - é˜²é‡æ”¾æ”»å‡»
   - æ—¶é—´æˆ³éªŒè¯

4. âœ… **HTTPSæœ€ä½³å®è·µ**
   - SSL è¯ä¹¦éªŒè¯
   - ç¦ç”¨ HTTP
   - è¯ä¹¦å›ºå®š

5. âœ… **è®¤è¯æˆæƒ**
   - Bearer Token è‡ªåŠ¨åˆ·æ–°
   - OAuth 2.0 é›†æˆ
   - RBAC æƒé™æ§åˆ¶

6. âœ… **æ—¥å¿—å®‰å…¨**
   - æ•æ„Ÿä¿¡æ¯è‡ªåŠ¨è„±æ•
   - æ—¥å¿—çº§åˆ«æ§åˆ¶
   - å®¡è®¡æ—¥å¿—

7. âœ… **ä¾èµ–ç®¡ç†**
   - æ¼æ´æ‰«æ
   - å®šæœŸæ›´æ–°
   - ç‰ˆæœ¬é”å®š

8. âœ… **æ•°æ®åŠ å¯†**
   - åŠ å¯†æ•æ„Ÿå­—æ®µ
   - å¯†é’¥ç®¡ç†
   - ä¼ è¾“åŠ å¯†

9. âœ… **å®‰å…¨æ£€æŸ¥æ¸…å•**
10. âœ… **å®‰å…¨äº‹ä»¶å“åº”æµç¨‹**
11. âœ… **å‚è€ƒèµ„æº** (OWASP Top 10, CWE Top 25)

**æ–‡æ¡£è·¯å¾„**: `docs/user-guide/security-best-practices.md`

---

### 2. ä¾èµ–æ¼æ´æ‰«æ (CI/CDé›†æˆ)

**è‡ªåŠ¨åŒ–æ‰«æå·¥å…·**:

- âœ… **Safety**: Pythonä¾èµ–æ¼æ´æ‰«æ
- âœ… **Bandit**: ä»£ç å®‰å…¨å®¡è®¡
- âœ… **pip-audit**: é¢å¤–ä¾èµ–æ£€æŸ¥
- âœ… **TruffleHog**: å¯†é’¥æ³„éœ²æ‰«æ
- âœ… **Gitleaks**: å¤‡ç”¨å¯†é’¥æ‰«æ

**è§¦å‘æ¡ä»¶**:

- âœ… æ¯å‘¨æ—¥è‡ªåŠ¨æ‰«æ
- âœ… æ‰€æœ‰ Push å’Œ PR
- âœ… æ‰‹åŠ¨è§¦å‘æ”¯æŒ

**æœ¬åœ°æ‰«æ**:

```bash
# Linux/Mac
bash scripts/security-scan.sh

# Windows
scripts\security-scan.bat
```

**å½±å“æ–‡ä»¶**:

- `.github/workflows/security.yml` - CI/CDå®‰å…¨æ‰«æå·¥ä½œæµ
- `scripts/security-scan.sh` - Linux/Macæœ¬åœ°æ‰«æè„šæœ¬
- `scripts/security-scan.bat` - Windowsæœ¬åœ°æ‰«æè„šæœ¬
- `CONTRIBUTING.md` - æ·»åŠ å®‰å…¨æ‰«ææŒ‡å—

---

## ğŸ“¦ å®Œæ•´ç‰¹æ€§æ¸…å•

### v3.7.0 æ–°å¢

1. **Unit of Work æ¨¡å¼**
   - UnitOfWork ç±»
   - BaseUnitOfWork åŸºç±»
   - Repository é›†æˆ
   - 94.52% æµ‹è¯•è¦†ç›–

2. **ç†”æ–­å™¨ (Circuit Breaker)**
   - çŠ¶æ€æœºå®ç°
   - è‡ªåŠ¨æ•…éšœä¿æŠ¤
   - è£…é¥°å™¨æ”¯æŒ
   - 98.40% æµ‹è¯•è¦†ç›–

3. **å®‰å…¨å¢å¼º**
   - å®‰å…¨æœ€ä½³å®è·µæ–‡æ¡£ (8000+å­—)
   - ä¾èµ–æ¼æ´æ‰«æ (CI/CDé›†æˆ)
   - æœ¬åœ°æ‰«æè„šæœ¬

### v3.6.2 ç‰¹æ€§ï¼ˆå·²åŒ…å«ï¼‰

1. **æµ‹è¯•æ•°æ®æ¸…ç†æ§åˆ¶**
   - é»˜è®¤å¼ºåˆ¶å›æ»š
   - ä¸‰ç§æ§åˆ¶æ–¹å¼

### v3.6.1 ç‰¹æ€§ï¼ˆå·²åŒ…å«ï¼‰

1. **æ—¥å¿—ç³»ç»Ÿä¿®å¤**
   - Database.execute() è¿ç§»åˆ° ObservabilityLogger
   - Loguru + Pytest ç°ä»£åŒ–é›†æˆ

### v3.6.0 ç‰¹æ€§ï¼ˆå·²åŒ…å«ï¼‰

1. **Decimal é›¶é…ç½®åºåˆ—åŒ–**
   - HttpClient Pydantic æ”¯æŒ
   - ç±»å‹å·¥å…·æ¨¡å—

---

## ğŸ”§ ä¾èµ–æ›´æ–°

æ— æ–°å¢ä¾èµ–ã€‚

### ç°æœ‰ä¾èµ–

- `sqlalchemy>=2.0.0` - æ•°æ®åº“ ORM
- `pytest>=8.0.0` - æµ‹è¯•æ¡†æ¶
- `loguru>=0.7.0` - æ—¥å¿—åº“
- `httpx>=0.27.0` - HTTP å®¢æˆ·ç«¯

---

## ğŸ“ˆ å‡çº§æŒ‡å—

### ä» v3.6.2 å‡çº§

v3.7.0 å¼•å…¥æ–°çš„æ¶æ„æ¨¡å¼ï¼Œéœ€è¦è¿ç§»ï¼š

```bash
uv pip install --upgrade df-test-framework
```

### è¿ç§»æŒ‡å—

#### è¿ç§»è·¯å¾„

```
v3.6.2: db_transaction + card_repository
  â†“
v3.7.0: uow
```

#### è¯¦ç»†æ­¥éª¤

**æ­¥éª¤ 1: åˆ›å»ºé¡¹ç›®ä¸“ç”¨ UoW**

```python
# æ–°å»º project_name/uow.py
from df_test_framework import BaseUnitOfWork

class ProjectUoW(BaseUnitOfWork):
    @property
    def cards(self):
        return self.repository(CardRepository, "card_inventory")
```

**æ­¥éª¤ 2: æ›´æ–° conftest.py**

```python
# conftest.py
@pytest.fixture
def uow(database, request):
    auto_commit = request.node.get_closest_marker("keep_data") is not None
    unit_of_work = ProjectUoW(database.session_factory)
    with unit_of_work:
        yield unit_of_work
        if auto_commit and not unit_of_work._committed:
            unit_of_work.commit()
```

**æ­¥éª¤ 3: æ›´æ–°æµ‹è¯•ä»£ç **

```python
# âŒ v3.6.2 æ—§æ–¹å¼
def test_example(db_transaction, card_repository):
    card = card_repository.find_by_card_no("CARD001")
    db_transaction.execute(text("UPDATE ..."))

# âœ… v3.7.0 æ–°æ–¹å¼
def test_example(uow):
    card = uow.cards.find_by_card_no("CARD001")
    uow.session.execute(text("UPDATE ..."))
```

**æ­¥éª¤ 4: è¿è¡Œæµ‹è¯•éªŒè¯**

```bash
pytest tests/ -v
```

#### å¯¹æ¯”è¡¨

| æ“ä½œ | v3.6.2 | v3.7.0 |
|------|--------|--------|
| **ä½¿ç”¨ Repository** | `card_repository.find_xxx()` | `uow.cards.find_xxx()` |
| **æ‰§è¡Œ SQL** | `db_transaction.execute()` | `uow.session.execute()` |
| **æäº¤äº‹åŠ¡** | è‡ªåŠ¨ï¼ˆæ ¹æ®æ ‡è®°ï¼‰ | `uow.commit()` æˆ–æ ‡è®° |
| **äº‹åŠ¡éš”ç¦»** | âŒ å¯èƒ½ä¸ä¸€è‡´ | âœ… å®Œå…¨ä¸€è‡´ |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. UoW ç»„ç»‡ç»“æ„

```python
# âœ… æ¨èï¼šæŒ‰é¢†åŸŸç»„ç»‡ Repository
class OrderUoW(BaseUnitOfWork):
    @property
    def orders(self):
        return self.repository(OrderRepository, "orders")

    @property
    def order_items(self):
        return self.repository(OrderItemRepository, "order_items")

    @property
    def payments(self):
        return self.repository(PaymentRepository, "payments")
```

### 2. æ˜¾å¼æäº¤

```python
# âœ… æ¨èï¼šéœ€è¦ä¿ç•™æ•°æ®æ—¶æ˜¾å¼æäº¤
def test_create_order(uow):
    order = Order(order_no="ORD001", total=Decimal("100.00"))
    uow.orders.add(order)

    # åªæœ‰æ˜¾å¼è°ƒç”¨æ‰æäº¤
    uow.commit()
```

### 3. ç†”æ–­å™¨ä½¿ç”¨

```python
# âœ… æ¨èï¼šä¸ºæ¯ä¸ªå¤–éƒ¨æœåŠ¡åˆ›å»ºç‹¬ç«‹ç†”æ–­å™¨
payment_breaker = CircuitBreaker(
    failure_threshold=5,
    timeout=60,
    name="payment-service"
)

shipping_breaker = CircuitBreaker(
    failure_threshold=3,
    timeout=30,
    name="shipping-service"
)
```

### 4. å®‰å…¨æ‰«æ

```bash
# âœ… æ¨èï¼šæäº¤å‰è¿è¡Œå®‰å…¨æ‰«æ
bash scripts/security-scan.sh

# âœ… æ¨èï¼šCI/CD è‡ªåŠ¨æ‰«æ
# å·²åœ¨ .github/workflows/security.yml é…ç½®
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### UoW é€‚ç”¨åœºæ™¯

- âœ… **å¤æ‚äº‹åŠ¡**: æ¶‰åŠå¤šä¸ª Repository çš„æ“ä½œ
- âœ… **æ•°æ®ä¸€è‡´æ€§**: éœ€è¦ä¸¥æ ¼çš„äº‹åŠ¡éš”ç¦»
- âœ… **DDD é¡¹ç›®**: é¢†åŸŸé©±åŠ¨è®¾è®¡é¡¹ç›®
- âœ… **ä¼ä¸šåº”ç”¨**: éœ€è¦è§„èŒƒæ•°æ®è®¿é—®å±‚çš„é¡¹ç›®

### ç†”æ–­å™¨é€‚ç”¨åœºæ™¯

- âœ… **å¤–éƒ¨ API è°ƒç”¨**: ç¬¬ä¸‰æ–¹æœåŠ¡è°ƒç”¨
- âœ… **å¾®æœåŠ¡é€šä¿¡**: æœåŠ¡é—´è°ƒç”¨
- âœ… **æ•°æ®åº“è¿æ¥**: é˜²æ­¢è¿æ¥æ± è€—å°½
- âœ… **æ‰¹é‡æ“ä½œ**: å¤§é‡è¯·æ±‚åœºæ™¯

---

## ğŸ› å·²çŸ¥é—®é¢˜

æ— ã€‚

---

## ğŸ“ æ”¯æŒ

- **æ–‡æ¡£**:
  - [UoW ä½¿ç”¨æŒ‡å—](../user-guide/unit-of-work.md)
  - [ç†”æ–­å™¨ä½¿ç”¨æŒ‡å—](../user-guide/circuit-breaker.md)
  - [å®‰å…¨æœ€ä½³å®è·µ](../user-guide/security-best-practices.md)
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/yourorg/df-test-framework/issues)

---

**å®Œæ•´æ›´æ–°æ—¥å¿—**: [v3.6.2...v3.7.0](https://github.com/yourorg/df-test-framework/compare/v3.6.2...v3.7.0)

---

## ğŸŠ æ€»ç»“

v3.7.0 æ˜¯ä¸€ä¸ª**é‡å¤§æ¶æ„å‡çº§ç‰ˆæœ¬**ï¼Œæ ¸å¿ƒäº®ç‚¹ï¼š

âœ¨ **UoW æ¨¡å¼**: DDD æ ‡å‡†å®ç°ï¼Œè§£å†³äº‹åŠ¡éš”ç¦»é—®é¢˜
âœ¨ **ç†”æ–­å™¨**: é˜²æ­¢çº§è”å¤±è´¥ï¼Œæå‡ç³»ç»Ÿç¨³å®šæ€§
âœ¨ **å®‰å…¨å¢å¼º**: å®Œæ•´çš„å®‰å…¨æŒ‡å—å’Œè‡ªåŠ¨åŒ–æ‰«æ
âœ¨ **é«˜è´¨é‡**: 94-98% æµ‹è¯•è¦†ç›–ç‡

ç«‹å³å‡çº§ï¼Œä½“éªŒç°ä»£åŒ–çš„æ•°æ®è®¿é—®æ¶æ„å’Œå®‰å…¨ä¿éšœï¼
