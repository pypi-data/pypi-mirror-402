# DF Test Framework v3 - æ¶æ„é‡æ„æ–¹æ¡ˆ

> åŸºäº"èƒ½åŠ›å±‚ä¸æµ‹è¯•ç±»å‹å±‚è§£è€¦"çš„å¯æ— é™æ‰©å±•æ¶æ„
>
> ğŸ“… æ—¥æœŸ: 2025-11-03
> ğŸ“Œ ç‰ˆæœ¬: v3.0.0ï¼ˆæœ€ç»ˆæ•´åˆç‰ˆï¼‰
> ğŸš€ çŠ¶æ€: æ¶æ„è®¾è®¡å®Œæˆï¼Œå‡†å¤‡å®æ–½
>
> **é‡è¦è¯´æ˜**: é¡¹ç›®ä»åœ¨æ­å»ºé˜¶æ®µï¼Œæœªå¤§è§„æ¨¡ä½¿ç”¨ï¼Œæœ¬æ¬¡é‡æ„**ä¸éœ€è¦ä¿ç•™å‘åå…¼å®¹æ€§**ï¼Œå¯ä»¥å¤§èƒ†è°ƒæ•´ä½¿ç”¨æ–¹å¼ã€‚

---

## ğŸ“– ç›®å½•

- [ç¬¬ä¸€éƒ¨åˆ†ï¼šè®¾è®¡å†³ç­–è¿‡ç¨‹](#ç¬¬ä¸€éƒ¨åˆ†è®¾è®¡å†³ç­–è¿‡ç¨‹)
  - [1.1 åˆå§‹é—®é¢˜è¯†åˆ«](#11-åˆå§‹é—®é¢˜è¯†åˆ«)
  - [1.2 é—æ¼ç‚¹è¡¥å……](#12-é—æ¼ç‚¹è¡¥å……)
  - [1.3 æ¶æ„æ¼”è¿›å†ç¨‹](#13-æ¶æ„æ¼”è¿›å†ç¨‹)
- [ç¬¬äºŒéƒ¨åˆ†ï¼šæœ€ç»ˆæ¶æ„æ–¹æ¡ˆ](#ç¬¬äºŒéƒ¨åˆ†æœ€ç»ˆæ¶æ„æ–¹æ¡ˆ)
  - [2.1 æ¶æ„æ ¸å¿ƒçªç ´](#21-æ¶æ„æ ¸å¿ƒçªç ´)
  - [2.2 å®Œæ•´åˆ†å±‚æ¶æ„](#22-å®Œæ•´åˆ†å±‚æ¶æ„)
  - [2.3 æ ¸å¿ƒè®¾è®¡åŸåˆ™](#23-æ ¸å¿ƒè®¾è®¡åŸåˆ™)
  - [2.4 æ‰©å±•æ€§éªŒè¯](#24-æ‰©å±•æ€§éªŒè¯)
- [ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æ–½æŒ‡å—](#ç¬¬ä¸‰éƒ¨åˆ†å®æ–½æŒ‡å—)
  - [3.1 å®æ–½è®¡åˆ’](#31-å®æ–½è®¡åˆ’)
  - [3.2 ç›®å½•ç»“æ„å¯¹ç…§](#32-ç›®å½•ç»“æ„å¯¹ç…§)
  - [3.3 é‡è¦æé†’](#33-é‡è¦æé†’)

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šè®¾è®¡å†³ç­–è¿‡ç¨‹

### 1.1 åˆå§‹é—®é¢˜è¯†åˆ«

#### é—®é¢˜1: exceptions.py æ”¾ç½®ä¸å½“

**ç°çŠ¶**:
```
src/df_test_framework/
â”œâ”€â”€ exceptions.py          # âš ï¸ å•æ–‡ä»¶åœ¨é¡¶çº§ç›®å½•
â”œâ”€â”€ infrastructure/
â”œâ”€â”€ core/
â”œâ”€â”€ patterns/
â”œâ”€â”€ testing/
â”œâ”€â”€ extensions/
â”œâ”€â”€ models/
â”œâ”€â”€ utils/
â”œâ”€â”€ ui/
â””â”€â”€ cli/
```

**é—®é¢˜åˆ†æ**:
- é¡¶çº§ç›®å½•å·²ç»æœ‰10ä¸ªå­ç›®å½•ï¼Œå†åŠ ä¸Šå•æ–‡ä»¶æ˜¾å¾—ä¸å¤Ÿæ¸…æ™°
- exceptions æ˜¯åŸºç¡€è®¾æ–½éƒ¨åˆ†ï¼Œåº”è¯¥å±äºæ›´åº•å±‚çš„ä½ç½®
- å¯èƒ½å¼•å‘å¾ªç¯ä¾èµ–ï¼ˆå¦‚æœæ”¾åœ¨ infrastructure/ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
```
åˆ›å»º common/ ä½œä¸º Layer 0ï¼ˆæœ€åº•å±‚ï¼‰ï¼š
common/
â”œâ”€â”€ exceptions.py     # å¼‚å¸¸å®šä¹‰
â”œâ”€â”€ types.py          # ç±»å‹å®šä¹‰
â””â”€â”€ protocols.py      # é€šç”¨Protocol
```

**ç†ç”±**:
- âœ… ç¬¦åˆåˆ†å±‚æ¶æ„åŸåˆ™ï¼ˆæœ€åŸºç¡€çš„å±‚ï¼‰
- âœ… é¿å…å¾ªç¯ä¾èµ–ï¼ˆæ‰€æœ‰å±‚éƒ½å¯ä»¥ä¾èµ–å®ƒï¼‰
- âœ… ä¿æŒé¡¶çº§ç›®å½•ç®€æ´

---

#### é—®é¢˜2: patterns/ ç›®å½•æ¦‚å¿µæ··æ·†

**ç°çŠ¶**:
```
patterns/
â”œâ”€â”€ repositories/     # Repositoryæ¨¡å¼
â”‚   â”œâ”€â”€ base.py
â”‚   â””â”€â”€ query_spec.py
â””â”€â”€ builders/         # Builderæ¨¡å¼
    â”œâ”€â”€ base.py
    â””â”€â”€ dict_builder.py
```

**é—®é¢˜åˆ†æ**:
1. **Repository** ä¸æ•°æ®åº“æ“ä½œå¼ºç›¸å…³ï¼Œåº”è¯¥å½’å±åˆ°æ•°æ®å¤„ç†èƒ½åŠ›å±‚
2. **Builder** æ˜¯æµ‹è¯•æ•°æ®æ„å»ºå·¥å…·ï¼Œåº”è¯¥å½’å±åˆ°æµ‹è¯•æ”¯æŒå±‚
3. ä¸¤è€…èŒè´£å®Œå…¨ä¸åŒï¼Œæ”¾åœ¨ä¸€èµ·ä¸åˆç†

**è§£å†³æ–¹æ¡ˆ**:
```
# Repository â†’ engines/sql/repositories/
engines/
â””â”€â”€ sql/
    â”œâ”€â”€ database.py           # åŸ core/database/
    â””â”€â”€ repositories/         # åŸ patterns/repositories/
        â”œâ”€â”€ base.py
        â””â”€â”€ query_spec.py

# Builder â†’ testing/data/builders/
testing/
â””â”€â”€ data/
    â””â”€â”€ builders/             # åŸ patterns/builders/
        â”œâ”€â”€ base.py
        â””â”€â”€ dict_builder.py
```

**ç†ç”±**:
- âœ… Repository æ˜¯æ•°æ®è®¿é—®å±‚ï¼Œå±äº engines/sql/
- âœ… Builder æ˜¯æµ‹è¯•æ•°æ®æ„å»ºå·¥å…·ï¼Œå±äº testing/data/
- âœ… èŒè´£æ¸…æ™°ï¼Œå½’å±æ˜ç¡®

---

#### é—®é¢˜3: UI/API æ¶æ„ä¸å¯¹ç§°

**ç°çŠ¶**:
```
core/
â””â”€â”€ http/              # APIå®¢æˆ·ç«¯
    â”œâ”€â”€ client.py
    â””â”€â”€ base_api.py

ui/                    # UIæ¨¡å—
â”œâ”€â”€ page.py
â”œâ”€â”€ browser.py
â””â”€â”€ locator.py
```

**é—®é¢˜åˆ†æ**:
- API åœ¨ `core/http/`ï¼ŒUI åœ¨ `ui/`ï¼Œå±‚çº§ä¸å¯¹ç§°
- `core/http/` æš—ç¤º HTTP æ˜¯æ ¸å¿ƒä¸šåŠ¡ï¼Œä½†å®é™…ä¸Šå®ƒæ˜¯ä¸€ç§"èƒ½åŠ›"
- éš¾ä»¥æ‰©å±•å…¶ä»–åè®®ï¼ˆGraphQLã€gRPCï¼‰æˆ–å…¶ä»–é©±åŠ¨ï¼ˆSeleniumã€Appiumï¼‰

**è§£å†³æ–¹æ¡ˆ - å¯¹ç§°æ¶æ„**:
```
clients/              # APIé€šä¿¡èƒ½åŠ›ï¼ˆä¸ drivers/ å¯¹ç§°ï¼‰
â”œâ”€â”€ rest/
â”‚   â”œâ”€â”€ httpx/       # é»˜è®¤å®ç°
â”‚   â””â”€â”€ requests/    # å¤‡é€‰å®ç°
â”œâ”€â”€ graphql/         # æ‰©å±•
â””â”€â”€ grpc/            # æ‰©å±•

drivers/              # UIäº¤äº’èƒ½åŠ›ï¼ˆä¸ clients/ å¯¹ç§°ï¼‰
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ playwright/  # é»˜è®¤å®ç°
â”‚   â””â”€â”€ selenium/    # å¤‡é€‰å®ç°
â””â”€â”€ mobile/          # æ‰©å±•
    â””â”€â”€ appium/
```

**ç†ç”±**:
- âœ… å¯¹ç§°è®¾è®¡ï¼Œæ¦‚å¿µæ¸…æ™°
- âœ… æ˜“äºæ‰©å±•æ–°åè®®å’Œæ–°é©±åŠ¨
- âœ… Protocol+Adapter+Factory æ¨¡å¼ç»Ÿä¸€

---

### 1.2 é—æ¼ç‚¹è¡¥å……

åœ¨åˆå§‹è®¨è®ºåï¼Œæˆ‘ä»¬å‘ç°æ¶æ„è¿˜ç¼ºå°‘ä»¥ä¸‹å…³é”®å†…å®¹ï¼š

#### é—æ¼ç‚¹1: æ•°æ®æµ‹è¯•èƒ½åŠ›

**é—®é¢˜**: åªæœ‰ API å’Œ UI èƒ½åŠ›ï¼Œç¼ºå°‘æ•°æ®æµ‹è¯•èƒ½åŠ›

**è§£å†³æ–¹æ¡ˆ**: æ–°å¢ `engines/` å±‚
```
engines/              # æ•°æ®å¤„ç†èƒ½åŠ›
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ mysql/
â”‚   â”œâ”€â”€ postgresql/
â”‚   â””â”€â”€ sqlite/
â”œâ”€â”€ nosql/
â”‚   â”œâ”€â”€ redis/
â”‚   â””â”€â”€ mongodb/
â”œâ”€â”€ bigdata/
â”‚   â”œâ”€â”€ spark/
â”‚   â”œâ”€â”€ hive/
â”‚   â””â”€â”€ kafka/
â”œâ”€â”€ etl/
â””â”€â”€ stream/
```

**å½±å“**: æ•°æ®æµ‹è¯•æˆä¸ºä¸€ç­‰å…¬æ°‘ï¼Œä¸ APIã€UI åŒçº§

---

#### é—æ¼ç‚¹2: æµ‹è¯•ç±»å‹ç»´åº¦æ··æ·†

**é—®é¢˜**: æ€§èƒ½æµ‹è¯•ã€å®‰å…¨æµ‹è¯•åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Ÿ

**åˆ†æ**:
```
âŒ é”™è¯¯ç†è§£ï¼š
testing/
â”œâ”€â”€ performance/      # æ€§èƒ½æµ‹è¯•æ”¾åœ¨ testing/ï¼Ÿ
â””â”€â”€ security/         # å®‰å…¨æµ‹è¯•æ”¾åœ¨ testing/ï¼Ÿ

é—®é¢˜ï¼šåŠŸèƒ½æµ‹è¯•å»å“ªäº†ï¼Ÿ
```

**è§£å†³æ–¹æ¡ˆ**: æµ‹è¯•ç±»å‹ä½œä¸ºç‹¬ç«‹ç»´åº¦
```
âœ… æ­£ç¡®æ¶æ„ï¼š
testing/
â”œâ”€â”€ functional/       # åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ performance/      # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ security/         # å®‰å…¨æµ‹è¯•
â”œâ”€â”€ compatibility/    # å…¼å®¹æ€§æµ‹è¯•
â”œâ”€â”€ integration/      # é›†æˆæµ‹è¯•
â”œâ”€â”€ e2e/              # ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ data/             # æµ‹è¯•æ•°æ®ç®¡ç†ï¼ˆé€šç”¨å·¥å…·ï¼‰
â”œâ”€â”€ validation/       # éªŒè¯å™¨ï¼ˆé€šç”¨å·¥å…·ï¼‰
â”œâ”€â”€ mocks/            # Mockï¼ˆé€šç”¨å·¥å…·ï¼‰
â””â”€â”€ reporting/        # æŠ¥å‘Šï¼ˆé€šç”¨å·¥å…·ï¼‰
```

**å…³é”®**: ä»»ä½•æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ä»»ä½•èƒ½åŠ›ï¼ˆçŸ©é˜µç»„åˆï¼‰

---

#### é—æ¼ç‚¹3: æµ‹è¯•æ•°æ®ç®¡ç†ä¸å®Œå–„

**é—®é¢˜**: åªæœ‰ Builderï¼Œç¼ºå°‘å…¶ä»–æ•°æ®ç®¡ç†å·¥å…·

**è§£å†³æ–¹æ¡ˆ**:
```
testing/data/
â”œâ”€â”€ builders/         # æ•°æ®æ„å»ºå™¨ï¼ˆå·²æœ‰ï¼‰
â”œâ”€â”€ factories/        # æ•°æ®å·¥å‚ï¼ˆæ–°å¢ - åŸºäºFakerç”Ÿæˆéšæœºæ•°æ®ï¼‰
â”œâ”€â”€ loaders/          # æ•°æ®åŠ è½½å™¨ï¼ˆæ–°å¢ - ä»JSON/CSV/ExcelåŠ è½½ï¼‰
â”œâ”€â”€ cleaners/         # æ•°æ®æ¸…ç†å™¨ï¼ˆæ–°å¢ - æµ‹è¯•åæ¸…ç†ï¼‰
â””â”€â”€ snapshots/        # æ•°æ®å¿«ç…§ï¼ˆæ–°å¢ - æ•°æ®åº“å¿«ç…§å’Œæ¢å¤ï¼‰
```

---

#### é—æ¼ç‚¹4: API éªŒè¯æœºåˆ¶ç¼ºå¤±

**é—®é¢˜**: æ²¡æœ‰ä¸“é—¨çš„ API å“åº”éªŒè¯å·¥å…·

**è§£å†³æ–¹æ¡ˆ**:
```
testing/validation/
â”œâ”€â”€ response/
â”‚   â”œâ”€â”€ validator.py         # å“åº”éªŒè¯å™¨ï¼ˆFluent APIï¼‰
â”‚   â”œâ”€â”€ json_schema.py       # JSON SchemaéªŒè¯
â”‚   â””â”€â”€ matchers.py          # æ–­è¨€åŒ¹é…å™¨
â””â”€â”€ fixtures.py
```

---

#### é—æ¼ç‚¹5: Mock æ”¯æŒç¼ºå¤±

**é—®é¢˜**: æ²¡æœ‰ Mock å¤–éƒ¨ä¾èµ–çš„å·¥å…·

**è§£å†³æ–¹æ¡ˆ**:
```
testing/mocks/
â”œâ”€â”€ http/             # HTTP Mockï¼ˆMockå¤–éƒ¨APIï¼‰
â”œâ”€â”€ database/         # æ•°æ®åº“Mockï¼ˆå†…å­˜æ•°æ®åº“ï¼‰
â”œâ”€â”€ time/             # æ—¶é—´Mockï¼ˆfreezegunï¼‰
â””â”€â”€ fixtures.py
```

---

#### é—æ¼ç‚¹6: æŠ¥å‘Šç³»ç»Ÿå•ä¸€

**é—®é¢˜**: åªæ”¯æŒ Allure

**è§£å†³æ–¹æ¡ˆ**:
```
testing/reporting/
â”œâ”€â”€ allure/           # AllureæŠ¥å‘Š
â”œâ”€â”€ html/             # HTMLæŠ¥å‘Š
â”œâ”€â”€ screenshots/      # æˆªå›¾ç®¡ç†ï¼ˆå¤±è´¥è‡ªåŠ¨æˆªå›¾ï¼‰
â””â”€â”€ videos/           # è§†é¢‘å½•åˆ¶ï¼ˆå¤±è´¥å½•åˆ¶è§†é¢‘ï¼‰
```

---

### 1.3 æ¶æ„æ¼”è¿›å†ç¨‹

æˆ‘ä»¬çš„æ¶æ„è®¨è®ºç»å†äº†ä»¥ä¸‹æ¼”è¿›è¿‡ç¨‹ï¼š

#### é˜¶æ®µ1: å‘ç°é—®é¢˜
- exceptions.py æ”¾ç½®ä¸å½“
- patterns/ æ¦‚å¿µæ··æ·†
- UI/API ä¸å¯¹ç§°

#### é˜¶æ®µ2: åˆæ­¥æ–¹æ¡ˆ
- åˆ›å»º `common/` å±‚
- åˆ›å»ºå¯¹ç§°çš„ `clients/` å’Œ `drivers/`
- æ‹†åˆ† `patterns/`

#### é˜¶æ®µ3: è¡¥å……é—æ¼
- æ–°å¢ `engines/` å±‚ï¼ˆæ•°æ®å¤„ç†èƒ½åŠ›ï¼‰
- å®Œå–„ `testing/` å±‚ï¼ˆæµ‹è¯•ç±»å‹ç»´åº¦ï¼‰
- è¡¥å……æ•°æ®ç®¡ç†ã€éªŒè¯ã€Mockã€æŠ¥å‘Šç­‰

#### é˜¶æ®µ4: æœ€ç»ˆå…±è¯†
- **èƒ½åŠ›å±‚ä¸æµ‹è¯•ç±»å‹å±‚å®Œå…¨è§£è€¦**
- **èƒ½åŠ›å±‚å¼€æ”¾æ‰©å±•**ï¼ˆä¸é™äºclients/drivers/enginesï¼‰
- **æµ‹è¯•ç±»å‹å±‚å¼€æ”¾æ‰©å±•**ï¼ˆä¸é™äºfunctional/performance/securityï¼‰
- **ä»»ä½•æµ‹è¯•ç±»å‹ Ã— ä»»ä½•èƒ½åŠ› = æ— é™å¯èƒ½**

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæœ€ç»ˆæ¶æ„æ–¹æ¡ˆ

### 2.1 æ¶æ„æ ¸å¿ƒçªç ´

ç»è¿‡æ·±åº¦è®¨è®ºï¼Œæˆ‘ä»¬å‘ç°äº†æµ‹è¯•æ¡†æ¶æ¶æ„çš„æœ¬è´¨é—®é¢˜ï¼Œå¹¶ç»™å‡ºäº†ç»ˆæè§£å†³æ–¹æ¡ˆï¼š

#### é—®é¢˜ï¼šèƒ½åŠ›ä¸æµ‹è¯•ç±»å‹æ··æ·†

```
âŒ é”™è¯¯çš„æ¶æ„ï¼ˆv2åŠä¹‹å‰ï¼‰ï¼š

clients/         # APIèƒ½åŠ›
drivers/         # UIèƒ½åŠ›
core/
â”œâ”€â”€ database/    # â“ æ•°æ®åº“æ˜¯èƒ½åŠ›ï¼Ÿè¿˜æ˜¯å·¥å…·ï¼Ÿ
â””â”€â”€ redis/       # â“ Redisæ˜¯èƒ½åŠ›ï¼Ÿè¿˜æ˜¯å·¥å…·ï¼Ÿ
testing/
â”œâ”€â”€ performance/ # â“ æ€§èƒ½æµ‹è¯•ä¸ºä»€ä¹ˆåœ¨testingï¼Ÿ
â””â”€â”€ security/    # â“ å®‰å…¨æµ‹è¯•ä¸ºä»€ä¹ˆåœ¨testingï¼Ÿ

é—®é¢˜ï¼š
1. èƒ½åŠ›å±‚ä¸å®Œæ•´ï¼ˆç¼ºå°‘æ•°æ®æµ‹è¯•èƒ½åŠ›ï¼‰
2. æ¦‚å¿µæ··æ·†ï¼ˆæ•°æ®åº“æ—¢æ˜¯èƒ½åŠ›åˆæ˜¯å·¥å…·ï¼‰
3. æµ‹è¯•ç±»å‹ä¸å®Œæ•´ï¼ˆåŠŸèƒ½æµ‹è¯•å»å“ªäº†ï¼Ÿï¼‰
```

#### è§£å†³æ–¹æ¡ˆï¼šä¸¤ä¸ªç»´åº¦å®Œå…¨åˆ†ç¦»

```
âœ… æ­£ç¡®çš„æ¶æ„ï¼ˆv3ï¼‰ï¼š

ç»´åº¦1: èƒ½åŠ›å±‚ï¼ˆLayer 1ï¼‰- å®šä¹‰"æµ‹è¯•ä»€ä¹ˆ"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
clients/      - APIé€šä¿¡èƒ½åŠ›
drivers/      - UIäº¤äº’èƒ½åŠ›
engines/      - æ•°æ®å¤„ç†èƒ½åŠ›
messengers/   - æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
chains/       - åŒºå—é“¾èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
devices/      - IoTè®¾å¤‡èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
storages/     - æ–‡ä»¶å­˜å‚¨èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
...           - ä»»æ„æ–°èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰

ç»´åº¦2: æµ‹è¯•ç±»å‹å±‚ï¼ˆLayer 3ï¼‰- å®šä¹‰"æ€ä¹ˆæµ‹"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
testing/
â”œâ”€â”€ functional/     - åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ performance/    - æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ security/       - å®‰å…¨æµ‹è¯•
â”œâ”€â”€ compatibility/  - å…¼å®¹æ€§æµ‹è¯•
â”œâ”€â”€ integration/    - é›†æˆæµ‹è¯•
â”œâ”€â”€ e2e/            - ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ accessibility/  - å¯è®¿é—®æ€§æµ‹è¯•ï¼ˆå¯æ‰©å±•ï¼‰
â”œâ”€â”€ chaos/          - æ··æ²Œæµ‹è¯•ï¼ˆå¯æ‰©å±•ï¼‰
â””â”€â”€ ...             - ä»»æ„æ–°æµ‹è¯•ç±»å‹ï¼ˆå¯æ‰©å±•ï¼‰

å…³é”®ï¼šä¸¤ä¸ªç»´åº¦å®Œå…¨è§£è€¦ï¼Œä»»æ„ç»„åˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä»»ä½•æµ‹è¯•ç±»å‹ Ã— ä»»ä½•èƒ½åŠ› = æ— é™å¯èƒ½

ç¤ºä¾‹ï¼š
- æ€§èƒ½æµ‹è¯• Ã— APIèƒ½åŠ› = APIæ€§èƒ½æµ‹è¯•
- æ€§èƒ½æµ‹è¯• Ã— UIèƒ½åŠ› = UIæ€§èƒ½æµ‹è¯•
- æ€§èƒ½æµ‹è¯• Ã— æ•°æ®èƒ½åŠ› = æ•°æ®åº“æ€§èƒ½æµ‹è¯•
- å®‰å…¨æµ‹è¯• Ã— APIèƒ½åŠ› = APIå®‰å…¨æµ‹è¯•
- å®‰å…¨æµ‹è¯• Ã— æ•°æ®èƒ½åŠ› = æ•°æ®å®‰å…¨æµ‹è¯•
- æ··æ²Œæµ‹è¯• Ã— æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ› = æ¶ˆæ¯é˜Ÿåˆ—æ··æ²Œæµ‹è¯•
- ...
```

---

### 2.2 å®Œæ•´åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: æ‰©å±•å’Œå·¥å…·å±‚                                    â”‚
â”‚  extensions/  utils/  cli/                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: æµ‹è¯•ç±»å‹å±‚ï¼ˆå®šä¹‰"æ€ä¹ˆæµ‹"ï¼‰                      â”‚
â”‚  testing/                                               â”‚
â”‚   â”œâ”€â”€ functional/      - åŠŸèƒ½æµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ performance/     - æ€§èƒ½æµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ security/        - å®‰å…¨æµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ compatibility/   - å…¼å®¹æ€§æµ‹è¯•                     â”‚
â”‚   â”œâ”€â”€ integration/     - é›†æˆæµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ e2e/             - ç«¯åˆ°ç«¯æµ‹è¯•                     â”‚
â”‚   â”œâ”€â”€ data/            - æµ‹è¯•æ•°æ®ç®¡ç†ï¼ˆé€šç”¨ï¼‰            â”‚
â”‚   â”œâ”€â”€ validation/      - éªŒè¯å™¨ï¼ˆé€šç”¨ï¼‰                 â”‚
â”‚   â”œâ”€â”€ mocks/           - Mockï¼ˆé€šç”¨ï¼‰                   â”‚
â”‚   â”œâ”€â”€ reporting/       - æŠ¥å‘Šï¼ˆé€šç”¨ï¼‰                   â”‚
â”‚   â”œâ”€â”€ fixtures/        - Pytest Fixturesï¼ˆé€šç”¨ï¼‰        â”‚
â”‚   â””â”€â”€ plugins/         - Pytestæ’ä»¶ï¼ˆé€šç”¨ï¼‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: åŸºç¡€è®¾æ–½å±‚                                      â”‚
â”‚  infrastructure/                                        â”‚
â”‚   â”œâ”€â”€ bootstrap/  - å¯åŠ¨ç®¡ç†                           â”‚
â”‚   â”œâ”€â”€ config/     - é…ç½®ç®¡ç†                           â”‚
â”‚   â”œâ”€â”€ logging/    - æ—¥å¿—ç³»ç»Ÿ                           â”‚
â”‚   â”œâ”€â”€ providers/  - ä¾èµ–æ³¨å…¥                           â”‚
â”‚   â””â”€â”€ runtime/    - è¿è¡Œæ—¶ä¸Šä¸‹æ–‡                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: èƒ½åŠ›å±‚ï¼ˆå®šä¹‰"æµ‹è¯•ä»€ä¹ˆ"ï¼‰- å¼€æ”¾å¼ï¼Œå¯æ— é™æ‰©å±•    â”‚
â”‚                                                         â”‚
â”‚  clients/          - APIé€šä¿¡èƒ½åŠ›                        â”‚
â”‚   â”œâ”€â”€ rest/          - REST API                        â”‚
â”‚   â”œâ”€â”€ graphql/       - GraphQL                         â”‚
â”‚   â”œâ”€â”€ grpc/          - gRPC                            â”‚
â”‚   â””â”€â”€ websocket/     - WebSocket                       â”‚
â”‚                                                         â”‚
â”‚  drivers/          - UIäº¤äº’èƒ½åŠ›                         â”‚
â”‚   â”œâ”€â”€ web/           - Web UIï¼ˆPlaywright/Seleniumï¼‰  â”‚
â”‚   â””â”€â”€ mobile/        - Mobile UIï¼ˆAppiumï¼‰            â”‚
â”‚                                                         â”‚
â”‚  engines/          - æ•°æ®å¤„ç†èƒ½åŠ›                       â”‚
â”‚   â”œâ”€â”€ sql/           - SQLæ•°æ®åº“ï¼ˆMySQL/PostgreSQLç­‰ï¼‰ â”‚
â”‚   â”œâ”€â”€ nosql/         - NoSQLæ•°æ®åº“ï¼ˆMongoDB/Redisç­‰ï¼‰  â”‚
â”‚   â”œâ”€â”€ bigdata/       - å¤§æ•°æ®ï¼ˆSpark/Hive/Kafkaç­‰ï¼‰   â”‚
â”‚   â”œâ”€â”€ etl/           - ETL                            â”‚
â”‚   â””â”€â”€ stream/        - æµå¤„ç†                         â”‚
â”‚                                                         â”‚
â”‚  messengers/      - æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰            â”‚
â”‚   â”œâ”€â”€ rabbitmq/      - RabbitMQ                       â”‚
â”‚   â”œâ”€â”€ kafka/         - Kafka                          â”‚
â”‚   â””â”€â”€ rocketmq/      - RocketMQ                       â”‚
â”‚                                                         â”‚
â”‚  chains/          - åŒºå—é“¾èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰              â”‚
â”‚   â”œâ”€â”€ ethereum/      - Ethereum                       â”‚
â”‚   â””â”€â”€ bitcoin/       - Bitcoin                        â”‚
â”‚                                                         â”‚
â”‚  devices/         - IoTè®¾å¤‡èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰             â”‚
â”‚   â”œâ”€â”€ mqtt/          - MQTT                           â”‚
â”‚   â””â”€â”€ coap/          - CoAP                           â”‚
â”‚                                                         â”‚
â”‚  storages/        - å­˜å‚¨ç³»ç»Ÿèƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰            â”‚
â”‚   â”œâ”€â”€ s3/            - AWS S3                         â”‚
â”‚   â”œâ”€â”€ oss/           - é˜¿é‡Œäº‘OSS                      â”‚
â”‚   â””â”€â”€ ftp/           - FTP                            â”‚
â”‚                                                         â”‚
â”‚  ...              - ä»»æ„æ–°èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰                â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 0: å…±äº«åŸºç¡€å±‚                                      â”‚
â”‚  common/                                                â”‚
â”‚   â”œâ”€â”€ exceptions.py   - å¼‚å¸¸å®šä¹‰                       â”‚
â”‚   â”œâ”€â”€ types.py        - ç±»å‹å®šä¹‰                       â”‚
â”‚   â””â”€â”€ protocols.py    - é€šç”¨Protocol                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¾èµ–è§„åˆ™**: Layer N åªèƒ½ä¾èµ– Layer N-1 åŠä»¥ä¸‹ï¼Œä¸èƒ½ä¾èµ–åŒå±‚æˆ–ä¸Šå±‚

---

### 2.3 æ ¸å¿ƒè®¾è®¡åŸåˆ™

#### åŸåˆ™1: èƒ½åŠ›å±‚å¼€æ”¾æ€§

**èƒ½åŠ›å±‚ä¸æ˜¯å›ºå®šçš„"ä¸‰å±‚"ï¼Œè€Œæ˜¯å¼€æ”¾çš„ã€å¯æŒ‰éœ€æ‰©å±•çš„**

```python
# âœ… æ­£ç¡®ç†è§£
èƒ½åŠ›å±‚ = {
    "clients": "APIé€šä¿¡èƒ½åŠ›",
    "drivers": "UIäº¤äº’èƒ½åŠ›",
    "engines": "æ•°æ®å¤„ç†èƒ½åŠ›",
    # æœªæ¥å¯ä»¥æ·»åŠ ï¼š
    "messengers": "æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›",
    "chains": "åŒºå—é“¾èƒ½åŠ›",
    "devices": "IoTè®¾å¤‡èƒ½åŠ›",
    "storages": "å­˜å‚¨ç³»ç»Ÿèƒ½åŠ›",
    # ... æ— é™æ‰©å±•
}

# âŒ é”™è¯¯ç†è§£
èƒ½åŠ›å±‚ = ["clients", "drivers", "engines"]  # å›ºå®šä¸‰å±‚
```

---

#### åŸåˆ™2: æµ‹è¯•ç±»å‹å±‚å¼€æ”¾æ€§

**æµ‹è¯•ç±»å‹å±‚ä¹Ÿæ˜¯å¼€æ”¾çš„ã€å¯æŒ‰éœ€æ‰©å±•çš„**

```python
# âœ… æ­£ç¡®ç†è§£
æµ‹è¯•ç±»å‹ = {
    "functional": "åŠŸèƒ½æµ‹è¯•",
    "performance": "æ€§èƒ½æµ‹è¯•",
    "security": "å®‰å…¨æµ‹è¯•",
    "compatibility": "å…¼å®¹æ€§æµ‹è¯•",
    "integration": "é›†æˆæµ‹è¯•",
    "e2e": "ç«¯åˆ°ç«¯æµ‹è¯•",
    # æœªæ¥å¯ä»¥æ·»åŠ ï¼š
    "accessibility": "å¯è®¿é—®æ€§æµ‹è¯•",
    "chaos": "æ··æ²Œæµ‹è¯•",
    "regression": "å›å½’æµ‹è¯•",
    "smoke": "å†’çƒŸæµ‹è¯•",
    # ... æ— é™æ‰©å±•
}
```

---

#### åŸåˆ™3: ä¸¤ä¸ªç»´åº¦å®Œå…¨è§£è€¦

**ä»»ä½•æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ä»»ä½•èƒ½åŠ›**

```
æµ‹è¯•çŸ©é˜µï¼ˆç¤ºä¾‹ï¼‰ï¼š

                  clients/  drivers/  engines/  messengers/  chains/
                  (API)     (UI)      (æ•°æ®)    (æ¶ˆæ¯é˜Ÿåˆ—)   (åŒºå—é“¾)
functional/         âœ“         âœ“         âœ“          âœ“           âœ“
performance/        âœ“         âœ“         âœ“          âœ“           âœ“
security/           âœ“         âœ“         âœ“          âœ“           âœ“
compatibility/      âœ“         âœ“         âœ“          âœ“           âœ“
chaos/              âœ“         âœ“         âœ“          âœ“           âœ“

è¯´æ˜ï¼šä»»æ„ç»„åˆéƒ½æ˜¯æœ‰æ•ˆçš„æµ‹è¯•åœºæ™¯
```

---

#### åŸåˆ™4: Protocol+Adapter+Factory æ¨¡å¼

**æ‰€æœ‰èƒ½åŠ›å±‚ç»Ÿä¸€ä½¿ç”¨æ­¤æ¨¡å¼ï¼Œæ”¯æŒå¤šç§å®ç°**

```python
# Step 1: å®šä¹‰ Protocolï¼ˆæ¥å£è§„èŒƒï¼‰
from typing import Protocol

class RestClientProtocol(Protocol):
    def get(self, url: str, **kwargs) -> Response: ...
    def post(self, url: str, **kwargs) -> Response: ...

# Step 2: å®ç° Adapterï¼ˆå…·ä½“å®ç°ï¼‰
class HttpxRestClient:
    """httpx å®ç°"""
    def get(self, url: str, **kwargs):
        return self.client.get(url, **kwargs)

class RequestsRestClient:
    """requests å®ç°"""
    def get(self, url: str, **kwargs):
        return self.session.get(url, **kwargs)

# Step 3: ä½¿ç”¨ Factoryï¼ˆè¿è¡Œæ—¶é€‰æ‹©ï¼‰
class RestClientFactory:
    _adapters = {
        "httpx": HttpxRestClient,
        "requests": RequestsRestClient,
    }

    @classmethod
    def create(cls, client_type: str = "httpx", **options):
        adapter_class = cls._adapters[client_type]
        return adapter_class(**options)

# Step 4: é…ç½®åŒ–åˆ‡æ¢
# config.yaml
http_client:
  type: httpx  # æˆ– requests
```

---

### 2.4 æ‰©å±•æ€§éªŒè¯

#### åœºæ™¯1: æ‰©å±•æ–°çš„èƒ½åŠ› - æ¶ˆæ¯é˜Ÿåˆ—

**éœ€æ±‚**ï¼šéœ€è¦æµ‹è¯•RabbitMQæ¶ˆæ¯é˜Ÿåˆ—

**å®æ–½æ­¥éª¤**ï¼š

```bash
# Step 1: åœ¨Layer 1åˆ›å»ºæ–°èƒ½åŠ›å±‚
mkdir -p src/df_test_framework/messengers/rabbitmq
```

```python
# Step 2: å®ç°èƒ½åŠ›ï¼ˆéµå¾ªProtocol+Adapter+Factoryæ¨¡å¼ï¼‰

# messengers/rabbitmq/protocols.py
class MessageQueueProtocol(Protocol):
    def send(self, queue: str, message: str) -> None: ...
    def receive(self, queue: str, timeout: int = None) -> str: ...

# messengers/rabbitmq/client.py
class RabbitMQClient:
    """å®ç°MessageQueueProtocol"""
    def send(self, queue: str, message: str):
        # å‘é€æ¶ˆæ¯
        pass

# messengers/rabbitmq/factory.py
class RabbitMQFactory:
    @classmethod
    def create(cls, host: str, port: int) -> RabbitMQClient:
        return RabbitMQClient(host, port)
```

```python
# Step 3: æ·»åŠ Fixture
# testing/fixtures/messenger_fixtures.py
@pytest.fixture
def rabbitmq_client():
    client = RabbitMQFactory.create(host="localhost", port=5672)
    yield client
    client.close()
```

```python
# Step 4: ä½¿ç”¨ï¼ˆä»»ä½•æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ï¼‰

# åŠŸèƒ½æµ‹è¯•
def test_message_functional(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½æµ‹è¯•"""
    rabbitmq_client.send("test_queue", "hello")
    message = rabbitmq_client.receive("test_queue")
    assert message == "hello"

# æ€§èƒ½æµ‹è¯•
def test_message_performance(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—æ€§èƒ½æµ‹è¯•"""
    from df_test_framework.testing.performance import PerformanceTimer

    with PerformanceTimer() as timer:
        for i in range(1000):
            rabbitmq_client.send("test_queue", f"message_{i}")

    assert timer.elapsed < 5.0  # 1000æ¡æ¶ˆæ¯<5ç§’

# å®‰å…¨æµ‹è¯•
def test_message_security(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—å®‰å…¨æµ‹è¯•"""
    # æµ‹è¯•æœªæˆæƒè®¿é—®
    # ...
```

**å…³é”®**ï¼šæ–°å¢èƒ½åŠ›ä¸å½±å“ä»»ä½•ç°æœ‰ä»£ç ï¼

---

#### åœºæ™¯2: æ‰©å±•æ–°çš„æµ‹è¯•ç±»å‹ - æ··æ²Œæµ‹è¯•

**éœ€æ±‚**ï¼šéœ€è¦è¿›è¡Œæ··æ²Œæµ‹è¯•ï¼ˆChaos Testingï¼‰

**å®æ–½æ­¥éª¤**ï¼š

```bash
# Step 1: åœ¨Layer 3åˆ›å»ºæ–°æµ‹è¯•ç±»å‹
mkdir -p src/df_test_framework/testing/chaos
```

```python
# testing/chaos/api/fault_injection.py
class APIFaultInjection:
    """APIæ•…éšœæ³¨å…¥"""
    def inject_latency(self, endpoint: str, latency_ms: int):
        """æ³¨å…¥å»¶è¿Ÿ"""
        pass

    def inject_error(self, endpoint: str, error_code: int):
        """æ³¨å…¥é”™è¯¯"""
        pass

# testing/chaos/data/db_chaos.py
class DatabaseChaos:
    """æ•°æ®åº“æ··æ²Œæµ‹è¯•"""
    def kill_connection(self):
        """æ€æ­»è¿æ¥"""
        pass

# testing/chaos/message/queue_chaos.py
class MessageQueueChaos:
    """æ¶ˆæ¯é˜Ÿåˆ—æ··æ²Œæµ‹è¯•"""
    def inject_message_loss(self, queue: str, loss_rate: float):
        """æ³¨å…¥æ¶ˆæ¯ä¸¢å¤±"""
        pass
```

```python
# Step 2: ä½¿ç”¨ï¼ˆå¯ä»¥ä½¿ç”¨ä»»ä½•èƒ½åŠ›ï¼‰

# æ··æ²Œæµ‹è¯• Ã— APIèƒ½åŠ›
def test_api_chaos(rest_client):
    """APIæ··æ²Œæµ‹è¯•ï¼ˆä½¿ç”¨clients/èƒ½åŠ›ï¼‰"""
    fault = APIFaultInjection()
    fault.inject_latency("/api/users", latency_ms=5000)

    response = rest_client.get("/api/users")
    assert response.status_code == 504  # è¶…æ—¶

# æ··æ²Œæµ‹è¯• Ã— æ•°æ®èƒ½åŠ›
def test_db_chaos(mysql_engine):
    """æ•°æ®åº“æ··æ²Œæµ‹è¯•ï¼ˆä½¿ç”¨engines/èƒ½åŠ›ï¼‰"""
    chaos = DatabaseChaos()
    chaos.kill_connection()

    # æµ‹è¯•é‡è¿æœºåˆ¶
    mysql_engine.reconnect()
    assert mysql_engine.is_connected()

# æ··æ²Œæµ‹è¯• Ã— æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›
def test_mq_chaos(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—æ··æ²Œæµ‹è¯•ï¼ˆä½¿ç”¨messengers/èƒ½åŠ›ï¼‰"""
    chaos = MessageQueueChaos()
    chaos.inject_message_loss("test_queue", loss_rate=0.1)

    # æµ‹è¯•æ¶ˆæ¯å¯é æ€§æœºåˆ¶
    # ...
```

**å…³é”®**ï¼šæ–°å¢æµ‹è¯•ç±»å‹å¯ä»¥ä½¿ç”¨æ‰€æœ‰èƒ½åŠ›ï¼

---

#### åœºæ™¯3: æ‰©å±•æ–°çš„èƒ½åŠ› - åŒºå—é“¾

**éœ€æ±‚**ï¼šéœ€è¦æµ‹è¯•ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦

**å®æ–½æ­¥éª¤**ï¼š

```bash
# Step 1: åˆ›å»ºåŒºå—é“¾èƒ½åŠ›å±‚
mkdir -p src/df_test_framework/chains/ethereum
```

```python
# chains/ethereum/protocols.py
class BlockchainProtocol(Protocol):
    def deploy_contract(self, contract_code: str) -> str: ...
    def call_function(self, contract_address: str, function: str, args: list) -> Any: ...

# chains/ethereum/client.py
from web3 import Web3

class EthereumClient:
    """ä»¥å¤ªåŠå®¢æˆ·ç«¯"""
    def __init__(self, node_url: str):
        self.w3 = Web3(Web3.HTTPProvider(node_url))

    def deploy_contract(self, contract_code: str) -> str:
        # éƒ¨ç½²åˆçº¦
        pass

    def call_function(self, contract_address: str, function: str, args: list):
        # è°ƒç”¨åˆçº¦å‡½æ•°
        pass
```

```python
# Step 2: ä½¿ç”¨ï¼ˆæ‰€æœ‰æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ï¼‰

# åŠŸèƒ½æµ‹è¯•
def test_contract_functional(ethereum_client):
    """æ™ºèƒ½åˆçº¦åŠŸèƒ½æµ‹è¯•ï¼ˆä½¿ç”¨chains/èƒ½åŠ›ï¼‰"""
    contract_address = ethereum_client.deploy_contract(contract_code)
    result = ethereum_client.call_function(contract_address, "transfer", [100])
    assert result == True

# å®‰å…¨æµ‹è¯•
def test_contract_security(ethereum_client):
    """æ™ºèƒ½åˆçº¦å®‰å…¨æµ‹è¯•"""
    from df_test_framework.testing.security.blockchain import ReentrancyScanner

    scanner = ReentrancyScanner()
    vulnerabilities = scanner.scan(contract_code)
    assert len(vulnerabilities) == 0
```

**å…³é”®**ï¼šæ¶æ„å®Œå…¨æ”¯æŒï¼Œæ— éœ€ä¿®æ”¹ï¼

---

## ğŸ“Š æ¶æ„ä¼˜åŠ¿æ€»ç»“

### 1. æ— é™æ‰©å±•æ€§

| ç»´åº¦ | æ‰©å±•æ–¹å¼ | å½±å“èŒƒå›´ |
|------|---------|---------|
| **æ–°å¢èƒ½åŠ›** | åœ¨Layer 1æ·»åŠ æ–°ç›®å½• | æ— å½±å“ï¼Œæ‰€æœ‰æµ‹è¯•ç±»å‹è‡ªåŠ¨å¯ç”¨ |
| **æ–°å¢æµ‹è¯•ç±»å‹** | åœ¨Layer 3æ·»åŠ æ–°ç›®å½• | æ— å½±å“ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰èƒ½åŠ› |
| **æ–°å¢å®ç°** | åœ¨èƒ½åŠ›å±‚æ·»åŠ Adapter | æ— å½±å“ï¼Œé€šè¿‡é…ç½®åˆ‡æ¢ |

### 2. ç»„åˆçˆ†ç‚¸çš„å¨åŠ›

```
å‡è®¾ï¼š
- 5ç§èƒ½åŠ›ï¼ˆclients/drivers/engines/messengers/chainsï¼‰
- 6ç§æµ‹è¯•ç±»å‹ï¼ˆfunctional/performance/security/chaos/integration/e2eï¼‰

ç»„åˆæ•° = 5 Ã— 6 = 30ç§æµ‹è¯•åœºæ™¯

æœªæ¥ï¼š
- 10ç§èƒ½åŠ›
- 10ç§æµ‹è¯•ç±»å‹

ç»„åˆæ•° = 10 Ã— 10 = 100ç§æµ‹è¯•åœºæ™¯

æ‰€æœ‰åœºæ™¯éƒ½è‡ªåŠ¨æ”¯æŒï¼
```

### 3. æ¸…æ™°çš„æ¦‚å¿µæ¨¡å‹

```
é—®é¢˜ï¼šæˆ‘è¦æµ‹è¯•XXX

Step 1: ç¡®å®šèƒ½åŠ›ï¼ˆæµ‹è¯•ä»€ä¹ˆï¼‰
  - æ˜¯APIå—ï¼Ÿ       â†’ clients/
  - æ˜¯UIå—ï¼Ÿ        â†’ drivers/
  - æ˜¯æ•°æ®å—ï¼Ÿ      â†’ engines/
  - æ˜¯æ¶ˆæ¯é˜Ÿåˆ—å—ï¼Ÿ  â†’ messengers/
  - æ˜¯åŒºå—é“¾å—ï¼Ÿ    â†’ chains/

Step 2: ç¡®å®šæµ‹è¯•ç±»å‹ï¼ˆæ€ä¹ˆæµ‹ï¼‰
  - åŠŸèƒ½æµ‹è¯•ï¼Ÿ      â†’ testing/functional/
  - æ€§èƒ½æµ‹è¯•ï¼Ÿ      â†’ testing/performance/
  - å®‰å…¨æµ‹è¯•ï¼Ÿ      â†’ testing/security/
  - æ··æ²Œæµ‹è¯•ï¼Ÿ      â†’ testing/chaos/

Step 3: ç»„åˆä½¿ç”¨
  ä¾‹å¦‚ï¼šAPIæ€§èƒ½æµ‹è¯• = testing/performance/api/ + clients/rest/
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æ–½æŒ‡å—

### 3.1 å®æ–½è®¡åˆ’

#### Phase 1: æ ¸å¿ƒæ¶æ„é‡æ„ï¼ˆP0 - å¿…é¡»å®ç°ï¼‰

**ç›®æ ‡**: å®ŒæˆåŸºç¡€æ¶æ„è¿ç§»ï¼Œä¿è¯ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ

**ä»»åŠ¡æ¸…å•**:

1. âœ… **åˆ›å»ºæ–°ç›®å½•ç»“æ„**
   ```bash
   mkdir -p src/df_test_framework/common
   mkdir -p src/df_test_framework/clients/rest/httpx
   mkdir -p src/df_test_framework/drivers/web/playwright
   mkdir -p src/df_test_framework/engines/sql
   mkdir -p src/df_test_framework/engines/nosql/redis
   ```

2. âœ… **ç§»åŠ¨ç°æœ‰æ–‡ä»¶**
   ```bash
   # exceptions.py â†’ common/exceptions.py
   # models/types.py â†’ common/types.py
   # core/http/ â†’ clients/rest/httpx/
   # ui/ â†’ drivers/web/playwright/
   # core/database/ â†’ engines/sql/
   # core/redis/ â†’ engines/nosql/redis/
   # patterns/repositories/ â†’ engines/sql/repositories/
   # patterns/builders/ â†’ testing/data/builders/
   ```

3. âœ… **æ›´æ–°æ‰€æœ‰å¯¼å…¥è¯­å¥**
   - ä½¿ç”¨ IDE çš„é‡æ„åŠŸèƒ½æ‰¹é‡æ›´æ–°
   - è¿è¡Œæµ‹è¯•ç¡®ä¿æ— é—æ¼

4. âœ… **æ›´æ–°é¡¶å±‚ `__init__.py`**
   - é‡æ–°å¯¼å‡ºæ‰€æœ‰å…¬å…± API
   - ç¡®ä¿ç”¨æˆ·ä½¿ç”¨æ–¹å¼ç®€æ´

5. âœ… **è¿è¡Œæµ‹è¯•éªŒè¯**
   ```bash
   pytest -v
   ```

**é¢„è®¡æ—¶é—´**: 1-2å¤©

---

#### Phase 2: å®Œå–„æµ‹è¯•æ”¯æŒï¼ˆP1 - é‡è¦ï¼‰

**ç›®æ ‡**: è¡¥å……é—æ¼çš„æµ‹è¯•æ”¯æŒåŠŸèƒ½

**ä»»åŠ¡æ¸…å•**:

1. âœ… **å®ç°æµ‹è¯•æ•°æ®ç®¡ç†**
   ```bash
   mkdir -p src/df_test_framework/testing/data/factories
   mkdir -p src/df_test_framework/testing/data/loaders
   mkdir -p src/df_test_framework/testing/data/cleaners
   mkdir -p src/df_test_framework/testing/data/snapshots
   ```

2. âœ… **å®ç° API éªŒè¯ç³»ç»Ÿ**
   ```bash
   mkdir -p src/df_test_framework/testing/validation/response
   ```

3. âœ… **å®ç° Mock æ”¯æŒ**
   ```bash
   mkdir -p src/df_test_framework/testing/mocks/http
   mkdir -p src/df_test_framework/testing/mocks/database
   mkdir -p src/df_test_framework/testing/mocks/time
   ```

4. âœ… **å®Œå–„æŠ¥å‘Šç³»ç»Ÿ**
   ```bash
   mkdir -p src/df_test_framework/testing/reporting/screenshots
   mkdir -p src/df_test_framework/testing/reporting/videos
   ```

**é¢„è®¡æ—¶é—´**: 2-3å¤©

---

#### Phase 3: å¤‡é€‰å®ç°ï¼ˆP2 - å¯é€‰ï¼‰

**ç›®æ ‡**: å®ç°å¤‡é€‰çš„é€‚é…å™¨ï¼ŒéªŒè¯å¯æ’æ‹”æ€§

**ä»»åŠ¡æ¸…å•**:

1. âœ… **å®ç° requests é€‚é…å™¨**
   ```bash
   mkdir -p src/df_test_framework/clients/rest/requests
   ```

2. âœ… **å®ç° Selenium é€‚é…å™¨**
   ```bash
   mkdir -p src/df_test_framework/drivers/web/selenium
   ```

3. âœ… **éªŒè¯é…ç½®åˆ‡æ¢**
   ```yaml
   # config.yaml
   http_client:
     type: requests  # ä» httpx åˆ‡æ¢åˆ° requests

   web_driver:
     type: selenium  # ä» playwright åˆ‡æ¢åˆ° selenium
   ```

**é¢„è®¡æ—¶é—´**: 1-2å¤©

---

#### Phase 4: æ‰©å±•åŠŸèƒ½ï¼ˆP3 - æœªæ¥è§„åˆ’ï¼‰

**ç›®æ ‡**: æŒ‰éœ€å®ç°æ‰©å±•èƒ½åŠ›å’Œæµ‹è¯•ç±»å‹

**å¯é€‰ä»»åŠ¡**:

- `clients/graphql/` - GraphQL å®¢æˆ·ç«¯
- `engines/bigdata/spark/` - Spark å¼•æ“
- `messengers/rabbitmq/` - RabbitMQ å®¢æˆ·ç«¯
- `testing/performance/` - æ€§èƒ½æµ‹è¯•å®Œæ•´å®ç°
- `testing/security/` - å®‰å…¨æµ‹è¯•å®Œæ•´å®ç°
- `testing/chaos/` - æ··æ²Œæµ‹è¯•

**æŒ‰éœ€å®æ–½ï¼Œä¸è®¾æ—¶é—´é™åˆ¶**

---

### 3.2 ç›®å½•ç»“æ„å¯¹ç…§

#### v2 â†’ v3 æ–‡ä»¶è¿ç§»å¯¹ç…§è¡¨

| v2 è·¯å¾„ | v3 è·¯å¾„ | è¯´æ˜ |
|---------|---------|------|
| `exceptions.py` | `common/exceptions.py` | ç§»åˆ°å…±äº«åŸºç¡€å±‚ |
| `models/types.py` | `common/types.py` | ç§»åˆ°å…±äº«åŸºç¡€å±‚ |
| `core/http/client.py` | `clients/rest/httpx/client.py` | RESTå®¢æˆ·ç«¯ |
| `core/http/base_api.py` | `clients/rest/httpx/base_api.py` | åŸºç¡€APIç±» |
| `ui/page.py` | `drivers/web/playwright/page.py` | é¡µé¢å¯¹è±¡ |
| `ui/browser.py` | `drivers/web/playwright/browser.py` | æµè§ˆå™¨ç®¡ç† |
| `ui/locator.py` | `drivers/web/playwright/locator.py` | å®šä½å™¨ |
| `core/database/` | `engines/sql/` | SQLå¼•æ“ |
| `core/redis/` | `engines/nosql/redis/` | Rediså¼•æ“ |
| `patterns/repositories/` | `engines/sql/repositories/` | Repositoryæ¨¡å¼ |
| `patterns/builders/` | `testing/data/builders/` | Builderæ¨¡å¼ |
| `infrastructure/*` | `infrastructure/*` | ä¿æŒä¸å˜ |
| `extensions/*` | `extensions/*` | ä¿æŒä¸å˜ |
| `utils/*` | `utils/*` | ä¿æŒä¸å˜ |
| `cli/*` | `cli/*` | ä¿æŒä¸å˜ |

---

### 3.3 é‡è¦æé†’

#### âš ï¸ ä¸éœ€è¦å‘åå…¼å®¹

**ç”¨æˆ·ç¡®è®¤**: é¡¹ç›®ä»åœ¨æ­å»ºé˜¶æ®µï¼Œæœªå¤§è§„æ¨¡ä½¿ç”¨ï¼Œå¯ä»¥å¤§èƒ†é‡æ„

**å½±å“**:
- âœ… ä¸éœ€è¦ä¿ç•™æ—§çš„å¯¼å…¥è·¯å¾„
- âœ… ä¸éœ€è¦å®ç°å…¼å®¹æ€§å±‚
- âœ… å¯ä»¥ç›´æ¥ä¿®æ”¹ä½¿ç”¨æ–¹å¼
- âœ… å¯ä»¥åˆ é™¤ä¸åˆç†çš„è®¾è®¡

**è¡ŒåŠ¨**:
- ç›´æ¥æŒ‰ç…§ v3 æ¶æ„å®æ–½
- æ›´æ–°æ‰€æœ‰ç¤ºä¾‹ä»£ç å’Œæ–‡æ¡£
- é€šçŸ¥ç”¨æˆ·è¿ç§»åˆ°æ–°çš„ä½¿ç”¨æ–¹å¼

---

#### ğŸ“‹ å®æ–½æ£€æŸ¥æ¸…å•

- [ ] Phase 1: æ ¸å¿ƒæ¶æ„é‡æ„å®Œæˆ
  - [ ] åˆ›å»ºæ–°ç›®å½•ç»“æ„
  - [ ] ç§»åŠ¨ç°æœ‰æ–‡ä»¶
  - [ ] æ›´æ–°å¯¼å…¥è¯­å¥
  - [ ] æ›´æ–° `__init__.py`
  - [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] Phase 2: å®Œå–„æµ‹è¯•æ”¯æŒ
  - [ ] æ•°æ®ç®¡ç†ç³»ç»Ÿ
  - [ ] APIéªŒè¯ç³»ç»Ÿ
  - [ ] Mockæ”¯æŒ
  - [ ] æŠ¥å‘Šç³»ç»Ÿ
- [ ] Phase 3: å¤‡é€‰å®ç°ï¼ˆå¯é€‰ï¼‰
  - [ ] requests é€‚é…å™¨
  - [ ] Selenium é€‚é…å™¨
  - [ ] é…ç½®åˆ‡æ¢éªŒè¯
- [ ] æ–‡æ¡£æ›´æ–°
  - [ ] README.md
  - [ ] APIæ–‡æ¡£
  - [ ] ç¤ºä¾‹ä»£ç 
  - [ ] è¿ç§»æŒ‡å—
- [ ] æœ€ç»ˆéªŒè¯
  - [ ] è¦†ç›–ç‡æµ‹è¯•
  - [ ] é›†æˆæµ‹è¯•
  - [ ] ç”¨æˆ·éªŒæ”¶

---

## âœ… æ¶æ„è®¾è®¡å®Œæˆæ ‡å¿—

æˆ‘ä»¬çš„æ¶æ„è®¨è®ºå·²ç»è¾¾æˆå…±è¯†ï¼Œå…³é”®ç‚¹ï¼š

1. âœ… **ä¸æ˜¯"ä¸‰å±‚å¯¹ç§°"**ï¼Œè€Œæ˜¯"èƒ½åŠ›å±‚å¯æ— é™æ‰©å±•"
2. âœ… **ä¸æ˜¯å›ºå®šç»“æ„**ï¼Œè€Œæ˜¯"å¼€æ”¾å¼æ¶æ„"
3. âœ… **æ ¸å¿ƒæ˜¯è§£è€¦**ï¼šèƒ½åŠ›å±‚ âŠ¥ æµ‹è¯•ç±»å‹å±‚
4. âœ… **æ‰©å±•éªŒè¯é€šè¿‡**ï¼šæ¶ˆæ¯é˜Ÿåˆ—ã€åŒºå—é“¾ã€IoTç­‰éƒ½å¯ä»¥æ— ç¼æ‰©å±•
5. âœ… **æµ‹è¯•ç±»å‹éªŒè¯é€šè¿‡**ï¼šæ··æ²Œæµ‹è¯•ã€å¯è®¿é—®æ€§æµ‹è¯•ç­‰éƒ½å¯ä»¥æ— ç¼æ‰©å±•
6. âœ… **ä¸éœ€è¦å‘åå…¼å®¹**ï¼šé¡¹ç›®æ­å»ºé˜¶æ®µï¼Œå¯ä»¥å¤§èƒ†é‡æ„

---

**ğŸ‰ æ¶æ„è®¾è®¡å®Œæˆï¼å‡†å¤‡å¼€å§‹å®æ–½ï¼**

---

## é™„å½•

### é™„å½•A: å®Œæ•´ç›®å½•ç»“æ„

```
src/df_test_framework/
â”œâ”€â”€ common/                          # Layer 0: å…±äº«åŸºç¡€
â”‚   â”œâ”€â”€ exceptions.py
â”‚   â”œâ”€â”€ types.py
â”‚   â””â”€â”€ protocols.py
â”‚
â”œâ”€â”€ clients/                         # Layer 1: APIé€šä¿¡èƒ½åŠ›
â”‚   â”œâ”€â”€ rest/
â”‚   â”‚   â”œâ”€â”€ protocols.py
â”‚   â”‚   â”œâ”€â”€ httpx/                   # é»˜è®¤å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ client.py
â”‚   â”‚   â”‚   â””â”€â”€ base_api.py
â”‚   â”‚   â””â”€â”€ requests/                # å¤‡é€‰å®ç°
â”‚   â”œâ”€â”€ graphql/                     # é¢„ç•™
â”‚   â”œâ”€â”€ grpc/                        # é¢„ç•™
â”‚   â””â”€â”€ websocket/                   # é¢„ç•™
â”‚
â”œâ”€â”€ drivers/                         # Layer 1: UIäº¤äº’èƒ½åŠ›
â”‚   â”œâ”€â”€ web/
â”‚   â”‚   â”œâ”€â”€ protocols.py
â”‚   â”‚   â”œâ”€â”€ playwright/              # é»˜è®¤å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ browser.py
â”‚   â”‚   â”‚   â”œâ”€â”€ page.py
â”‚   â”‚   â”‚   â””â”€â”€ locator.py
â”‚   â”‚   â””â”€â”€ selenium/                # å¤‡é€‰å®ç°
â”‚   â””â”€â”€ mobile/                      # é¢„ç•™
â”‚       â””â”€â”€ appium/
â”‚
â”œâ”€â”€ engines/                         # Layer 1: æ•°æ®å¤„ç†èƒ½åŠ›
â”‚   â”œâ”€â”€ sql/
â”‚   â”‚   â”œâ”€â”€ database.py
â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â”‚       â”œâ”€â”€ base.py
â”‚   â”‚       â””â”€â”€ query_spec.py
â”‚   â”œâ”€â”€ nosql/
â”‚   â”‚   â”œâ”€â”€ redis/
â”‚   â”‚   â””â”€â”€ mongodb/                 # é¢„ç•™
â”‚   â”œâ”€â”€ bigdata/                     # é¢„ç•™
â”‚   â”‚   â”œâ”€â”€ spark/
â”‚   â”‚   â”œâ”€â”€ hive/
â”‚   â”‚   â””â”€â”€ kafka/
â”‚   â”œâ”€â”€ etl/                         # é¢„ç•™
â”‚   â””â”€â”€ stream/                      # é¢„ç•™
â”‚
â”œâ”€â”€ infrastructure/                  # Layer 2: åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ bootstrap/
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ logging/
â”‚   â”œâ”€â”€ providers/
â”‚   â””â”€â”€ runtime/
â”‚
â”œâ”€â”€ testing/                         # Layer 3: æµ‹è¯•ç±»å‹å±‚
â”‚   â”œâ”€â”€ functional/                  # åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ performance/                 # æ€§èƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ security/                    # å®‰å…¨æµ‹è¯•
â”‚   â”œâ”€â”€ compatibility/               # å…¼å®¹æ€§æµ‹è¯•ï¼ˆé¢„ç•™ï¼‰
â”‚   â”œâ”€â”€ integration/                 # é›†æˆæµ‹è¯•ï¼ˆé¢„ç•™ï¼‰
â”‚   â”œâ”€â”€ e2e/                         # ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆé¢„ç•™ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                        # æµ‹è¯•æ•°æ®ç®¡ç†ï¼ˆé€šç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ builders/
â”‚   â”‚   â”œâ”€â”€ factories/
â”‚   â”‚   â”œâ”€â”€ loaders/
â”‚   â”‚   â”œâ”€â”€ cleaners/
â”‚   â”‚   â””â”€â”€ snapshots/
â”‚   â”‚
â”‚   â”œâ”€â”€ validation/                  # éªŒè¯å™¨ï¼ˆé€šç”¨ï¼‰
â”‚   â”‚   â””â”€â”€ response/
â”‚   â”‚
â”‚   â”œâ”€â”€ mocks/                       # Mockï¼ˆé€šç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ http/
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â””â”€â”€ time/
â”‚   â”‚
â”‚   â”œâ”€â”€ reporting/                   # æŠ¥å‘Šï¼ˆé€šç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ allure/
â”‚   â”‚   â”œâ”€â”€ html/
â”‚   â”‚   â”œâ”€â”€ screenshots/
â”‚   â”‚   â””â”€â”€ videos/
â”‚   â”‚
â”‚   â”œâ”€â”€ fixtures/                    # Pytest Fixtures
â”‚   â”‚   â”œâ”€â”€ core_fixtures.py
â”‚   â”‚   â”œâ”€â”€ client_fixtures.py
â”‚   â”‚   â”œâ”€â”€ driver_fixtures.py
â”‚   â”‚   â””â”€â”€ engine_fixtures.py
â”‚   â”‚
â”‚   â”œâ”€â”€ plugins/                     # Pytestæ’ä»¶
â”‚   â”‚   â”œâ”€â”€ allure.py
â”‚   â”‚   â”œâ”€â”€ markers.py
â”‚   â”‚   â””â”€â”€ debug.py
â”‚   â”‚
â”‚   â””â”€â”€ debug/                       # è°ƒè¯•å·¥å…·
â”‚       â”œâ”€â”€ http_debugger.py
â”‚       â””â”€â”€ db_debugger.py
â”‚
â”œâ”€â”€ extensions/                      # Layer 4: æ‰©å±•ç³»ç»Ÿ
â”‚   â”œâ”€â”€ core/
â”‚   â””â”€â”€ builtin/
â”‚
â”œâ”€â”€ utils/                           # Layer 4: å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ assertion.py
â”‚   â”œâ”€â”€ decorator.py
â”‚   â”œâ”€â”€ performance.py
â”‚   â””â”€â”€ data_generator.py
â”‚
â”œâ”€â”€ cli/                             # Layer 4: å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ commands/
â”‚   â”œâ”€â”€ templates/
â”‚   â””â”€â”€ main.py
â”‚
â””â”€â”€ __init__.py
```

### é™„å½•B: å‚è€ƒæ–‡æ¡£

æœ¬æ–‡æ¡£æ•´åˆäº†ä»¥ä¸‹è®¨è®ºè¿‡ç¨‹ï¼š
- `1.md` - åˆå§‹é—®é¢˜è¯†åˆ«ï¼ˆexceptions.pyã€patterns/ï¼‰
- `2.md` - é—æ¼ç‚¹è¡¥å……ï¼ˆæ€§èƒ½æµ‹è¯•ã€æ•°æ®ç®¡ç†ã€Mockç­‰ï¼‰
- `REFACTORING_PLAN_V3_COMPLETE.md` - ç¬¬ä¸€ç‰ˆå®Œæ•´æ¶æ„æ–¹æ¡ˆ
- `REFACTORING_PLAN_V3_FINAL.md` - å¼ºè°ƒå¼€æ”¾æ‰©å±•æ€§çš„æœ€ç»ˆç‰ˆ

ä»¥ä¸Šè®¨è®ºæ–‡æ¡£å·²å½’æ¡£è‡³ `docs/architecture/archive/`
