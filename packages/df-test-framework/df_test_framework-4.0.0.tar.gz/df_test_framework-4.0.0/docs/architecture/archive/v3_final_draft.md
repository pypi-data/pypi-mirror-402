# DF Test Framework v3 - æœ€ç»ˆæ¶æ„æ–¹æ¡ˆ

> åŸºäº"èƒ½åŠ›å±‚ä¸æµ‹è¯•ç±»å‹å±‚è§£è€¦"çš„å¯æ— é™æ‰©å±•æ¶æ„
>
> æ—¥æœŸ: 2025-11-02
> ç‰ˆæœ¬: v3.0.0ï¼ˆæœ€ç»ˆç‰ˆï¼‰
> çŠ¶æ€: æ¶æ„è®¾è®¡å®Œæˆï¼Œå¾…å®æ–½

---

## ğŸ‰ æ¶æ„æ ¸å¿ƒçªç ´

ç»è¿‡æ·±åº¦è®¨è®ºï¼Œæˆ‘ä»¬å‘ç°äº†æµ‹è¯•æ¡†æ¶æ¶æ„çš„æœ¬è´¨é—®é¢˜ï¼Œå¹¶ç»™å‡ºäº†ç»ˆæè§£å†³æ–¹æ¡ˆï¼š

### é—®é¢˜ï¼šèƒ½åŠ›ä¸æµ‹è¯•ç±»å‹æ··æ·†

```
âŒ é”™è¯¯çš„æ¶æ„ï¼ˆv2åŠä¹‹å‰ï¼‰ï¼š

clients/         # APIèƒ½åŠ›
drivers/         # UIèƒ½åŠ›
core/
â”œâ”€â”€ database/    # â“ æ•°æ®åº“æ˜¯èƒ½åŠ›ï¼Ÿè¿˜æ˜¯å·¥å…·ï¼Ÿ
â””â”€â”€ redis/       # â“ Redisæ˜¯èƒ½åŠ›ï¼Ÿè¿˜æ˜¯å·¥å…·ï¼Ÿ
testing/
â”œâ”€â”€ performance/ # â“ æ€§èƒ½æµ‹è¯•ä¸ºä»€ä¹ˆåœ¨testingï¼Ÿ
â””â”€â”€ security/    # â“ å®‰å…¨æµ‹è¯•ä¸ºä»€ä¹ˆåœ¨testingï¼Ÿ

é—®é¢˜ï¼š
1. èƒ½åŠ›å±‚ä¸å®Œæ•´ï¼ˆç¼ºå°‘æ•°æ®æµ‹è¯•èƒ½åŠ›ï¼‰
2. æ¦‚å¿µæ··æ·†ï¼ˆæ•°æ®åº“æ—¢æ˜¯èƒ½åŠ›åˆæ˜¯å·¥å…·ï¼‰
3. æµ‹è¯•ç±»å‹ä¸å®Œæ•´ï¼ˆåŠŸèƒ½æµ‹è¯•å»å“ªäº†ï¼Ÿï¼‰
```

### è§£å†³æ–¹æ¡ˆï¼šä¸¤ä¸ªç»´åº¦å®Œå…¨åˆ†ç¦»

```
âœ… æ­£ç¡®çš„æ¶æ„ï¼ˆv3ï¼‰ï¼š

ç»´åº¦1: èƒ½åŠ›å±‚ï¼ˆLayer 1ï¼‰- å®šä¹‰"æµ‹è¯•ä»€ä¹ˆ"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
clients/      - APIé€šä¿¡èƒ½åŠ›
drivers/      - UIäº¤äº’èƒ½åŠ›
engines/      - æ•°æ®å¤„ç†èƒ½åŠ›
messengers/   - æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
chains/       - åŒºå—é“¾èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
devices/      - IoTè®¾å¤‡èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
storages/     - æ–‡ä»¶å­˜å‚¨èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰
...           - ä»»æ„æ–°èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰

ç»´åº¦2: æµ‹è¯•ç±»å‹å±‚ï¼ˆLayer 3ï¼‰- å®šä¹‰"æ€ä¹ˆæµ‹"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
testing/
â”œâ”€â”€ functional/     - åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ performance/    - æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ security/       - å®‰å…¨æµ‹è¯•
â”œâ”€â”€ compatibility/  - å…¼å®¹æ€§æµ‹è¯•
â”œâ”€â”€ integration/    - é›†æˆæµ‹è¯•
â”œâ”€â”€ e2e/            - ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ accessibility/  - å¯è®¿é—®æ€§æµ‹è¯•ï¼ˆå¯æ‰©å±•ï¼‰
â”œâ”€â”€ chaos/          - æ··æ²Œæµ‹è¯•ï¼ˆå¯æ‰©å±•ï¼‰
â””â”€â”€ ...             - ä»»æ„æ–°æµ‹è¯•ç±»å‹ï¼ˆå¯æ‰©å±•ï¼‰

å…³é”®ï¼šä¸¤ä¸ªç»´åº¦å®Œå…¨è§£è€¦ï¼Œä»»æ„ç»„åˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä»»ä½•æµ‹è¯•ç±»å‹ Ã— ä»»ä½•èƒ½åŠ› = æ— é™å¯èƒ½

ç¤ºä¾‹ï¼š
- æ€§èƒ½æµ‹è¯• Ã— APIèƒ½åŠ› = APIæ€§èƒ½æµ‹è¯•
- æ€§èƒ½æµ‹è¯• Ã— UIèƒ½åŠ› = UIæ€§èƒ½æµ‹è¯•
- æ€§èƒ½æµ‹è¯• Ã— æ•°æ®èƒ½åŠ› = æ•°æ®åº“æ€§èƒ½æµ‹è¯•
- å®‰å…¨æµ‹è¯• Ã— APIèƒ½åŠ› = APIå®‰å…¨æµ‹è¯•
- å®‰å…¨æµ‹è¯• Ã— æ•°æ®èƒ½åŠ› = æ•°æ®å®‰å…¨æµ‹è¯•
- æ··æ²Œæµ‹è¯• Ã— æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ› = æ¶ˆæ¯é˜Ÿåˆ—æ··æ²Œæµ‹è¯•
- ...
```

---

## ğŸ—ï¸ å®Œæ•´åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: æ‰©å±•å’Œå·¥å…·å±‚                                    â”‚
â”‚  extensions/  utils/  cli/                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: æµ‹è¯•ç±»å‹å±‚ï¼ˆå®šä¹‰"æ€ä¹ˆæµ‹"ï¼‰                      â”‚
â”‚  testing/                                               â”‚
â”‚   â”œâ”€â”€ functional/      - åŠŸèƒ½æµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ performance/     - æ€§èƒ½æµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ security/        - å®‰å…¨æµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ compatibility/   - å…¼å®¹æ€§æµ‹è¯•                     â”‚
â”‚   â”œâ”€â”€ integration/     - é›†æˆæµ‹è¯•                       â”‚
â”‚   â”œâ”€â”€ e2e/             - ç«¯åˆ°ç«¯æµ‹è¯•                     â”‚
â”‚   â”œâ”€â”€ data/            - æµ‹è¯•æ•°æ®ç®¡ç†ï¼ˆé€šç”¨ï¼‰            â”‚
â”‚   â”œâ”€â”€ validation/      - éªŒè¯å™¨ï¼ˆé€šç”¨ï¼‰                 â”‚
â”‚   â”œâ”€â”€ mocks/           - Mockï¼ˆé€šç”¨ï¼‰                   â”‚
â”‚   â”œâ”€â”€ reporting/       - æŠ¥å‘Šï¼ˆé€šç”¨ï¼‰                   â”‚
â”‚   â”œâ”€â”€ fixtures/        - Pytest Fixturesï¼ˆé€šç”¨ï¼‰        â”‚
â”‚   â””â”€â”€ plugins/         - Pytestæ’ä»¶ï¼ˆé€šç”¨ï¼‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: åŸºç¡€è®¾æ–½å±‚                                      â”‚
â”‚  infrastructure/                                        â”‚
â”‚   â”œâ”€â”€ bootstrap/  - å¯åŠ¨ç®¡ç†                           â”‚
â”‚   â”œâ”€â”€ config/     - é…ç½®ç®¡ç†                           â”‚
â”‚   â”œâ”€â”€ logging/    - æ—¥å¿—ç³»ç»Ÿ                           â”‚
â”‚   â”œâ”€â”€ providers/  - ä¾èµ–æ³¨å…¥                           â”‚
â”‚   â””â”€â”€ runtime/    - è¿è¡Œæ—¶ä¸Šä¸‹æ–‡                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: èƒ½åŠ›å±‚ï¼ˆå®šä¹‰"æµ‹è¯•ä»€ä¹ˆ"ï¼‰- å¼€æ”¾å¼ï¼Œå¯æ— é™æ‰©å±•    â”‚
â”‚                                                         â”‚
â”‚  clients/          - APIé€šä¿¡èƒ½åŠ›                        â”‚
â”‚   â”œâ”€â”€ rest/          - REST API                        â”‚
â”‚   â”œâ”€â”€ graphql/       - GraphQL                         â”‚
â”‚   â”œâ”€â”€ grpc/          - gRPC                            â”‚
â”‚   â””â”€â”€ websocket/     - WebSocket                       â”‚
â”‚                                                         â”‚
â”‚  drivers/          - UIäº¤äº’èƒ½åŠ›                         â”‚
â”‚   â”œâ”€â”€ web/           - Web UIï¼ˆPlaywright/Seleniumï¼‰  â”‚
â”‚   â””â”€â”€ mobile/        - Mobile UIï¼ˆAppiumï¼‰            â”‚
â”‚                                                         â”‚
â”‚  engines/          - æ•°æ®å¤„ç†èƒ½åŠ›                       â”‚
â”‚   â”œâ”€â”€ sql/           - SQLæ•°æ®åº“ï¼ˆMySQL/PostgreSQLç­‰ï¼‰ â”‚
â”‚   â”œâ”€â”€ nosql/         - NoSQLæ•°æ®åº“ï¼ˆMongoDB/Redisç­‰ï¼‰  â”‚
â”‚   â”œâ”€â”€ bigdata/       - å¤§æ•°æ®ï¼ˆSpark/Hive/Kafkaç­‰ï¼‰   â”‚
â”‚   â”œâ”€â”€ etl/           - ETL                            â”‚
â”‚   â””â”€â”€ stream/        - æµå¤„ç†                         â”‚
â”‚                                                         â”‚
â”‚  messengers/      - æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰            â”‚
â”‚   â”œâ”€â”€ rabbitmq/      - RabbitMQ                       â”‚
â”‚   â”œâ”€â”€ kafka/         - Kafka                          â”‚
â”‚   â””â”€â”€ rocketmq/      - RocketMQ                       â”‚
â”‚                                                         â”‚
â”‚  chains/          - åŒºå—é“¾èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰              â”‚
â”‚   â”œâ”€â”€ ethereum/      - Ethereum                       â”‚
â”‚   â””â”€â”€ bitcoin/       - Bitcoin                        â”‚
â”‚                                                         â”‚
â”‚  devices/         - IoTè®¾å¤‡èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰             â”‚
â”‚   â”œâ”€â”€ mqtt/          - MQTT                           â”‚
â”‚   â””â”€â”€ coap/          - CoAP                           â”‚
â”‚                                                         â”‚
â”‚  storages/        - å­˜å‚¨ç³»ç»Ÿèƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰            â”‚
â”‚   â”œâ”€â”€ s3/            - AWS S3                         â”‚
â”‚   â”œâ”€â”€ oss/           - é˜¿é‡Œäº‘OSS                      â”‚
â”‚   â””â”€â”€ ftp/           - FTP                            â”‚
â”‚                                                         â”‚
â”‚  ...              - ä»»æ„æ–°èƒ½åŠ›ï¼ˆå¯æ‰©å±•ï¼‰                â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†‘ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 0: å…±äº«åŸºç¡€å±‚                                      â”‚
â”‚  common/                                                â”‚
â”‚   â”œâ”€â”€ exceptions.py   - å¼‚å¸¸å®šä¹‰                       â”‚
â”‚   â”œâ”€â”€ types.py        - ç±»å‹å®šä¹‰                       â”‚
â”‚   â””â”€â”€ protocols.py    - é€šç”¨Protocol                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™

### åŸåˆ™1: èƒ½åŠ›å±‚å¼€æ”¾æ€§

**èƒ½åŠ›å±‚ä¸æ˜¯å›ºå®šçš„"ä¸‰å±‚"ï¼Œè€Œæ˜¯å¼€æ”¾çš„ã€å¯æŒ‰éœ€æ‰©å±•çš„**

```python
# âœ… æ­£ç¡®ç†è§£
èƒ½åŠ›å±‚ = {
    "clients": "APIé€šä¿¡èƒ½åŠ›",
    "drivers": "UIäº¤äº’èƒ½åŠ›",
    "engines": "æ•°æ®å¤„ç†èƒ½åŠ›",
    # æœªæ¥å¯ä»¥æ·»åŠ ï¼š
    "messengers": "æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›",
    "chains": "åŒºå—é“¾èƒ½åŠ›",
    "devices": "IoTè®¾å¤‡èƒ½åŠ›",
    "storages": "å­˜å‚¨ç³»ç»Ÿèƒ½åŠ›",
    # ... æ— é™æ‰©å±•
}

# âŒ é”™è¯¯ç†è§£
èƒ½åŠ›å±‚ = ["clients", "drivers", "engines"]  # å›ºå®šä¸‰å±‚
```

### åŸåˆ™2: æµ‹è¯•ç±»å‹å±‚å¼€æ”¾æ€§

**æµ‹è¯•ç±»å‹å±‚ä¹Ÿæ˜¯å¼€æ”¾çš„ã€å¯æŒ‰éœ€æ‰©å±•çš„**

```python
# âœ… æ­£ç¡®ç†è§£
æµ‹è¯•ç±»å‹ = {
    "functional": "åŠŸèƒ½æµ‹è¯•",
    "performance": "æ€§èƒ½æµ‹è¯•",
    "security": "å®‰å…¨æµ‹è¯•",
    "compatibility": "å…¼å®¹æ€§æµ‹è¯•",
    "integration": "é›†æˆæµ‹è¯•",
    "e2e": "ç«¯åˆ°ç«¯æµ‹è¯•",
    # æœªæ¥å¯ä»¥æ·»åŠ ï¼š
    "accessibility": "å¯è®¿é—®æ€§æµ‹è¯•",
    "chaos": "æ··æ²Œæµ‹è¯•",
    "regression": "å›å½’æµ‹è¯•",
    "smoke": "å†’çƒŸæµ‹è¯•",
    # ... æ— é™æ‰©å±•
}
```

### åŸåˆ™3: ä¸¤ä¸ªç»´åº¦å®Œå…¨è§£è€¦

**ä»»ä½•æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ä»»ä½•èƒ½åŠ›**

```
æµ‹è¯•çŸ©é˜µï¼ˆç¤ºä¾‹ï¼‰ï¼š

                  clients/  drivers/  engines/  messengers/  chains/
                  (API)     (UI)      (æ•°æ®)    (æ¶ˆæ¯é˜Ÿåˆ—)   (åŒºå—é“¾)
functional/         âœ“         âœ“         âœ“          âœ“           âœ“
performance/        âœ“         âœ“         âœ“          âœ“           âœ“
security/           âœ“         âœ“         âœ“          âœ“           âœ“
compatibility/      âœ“         âœ“         âœ“          âœ“           âœ“
chaos/              âœ“         âœ“         âœ“          âœ“           âœ“

è¯´æ˜ï¼šä»»æ„ç»„åˆéƒ½æ˜¯æœ‰æ•ˆçš„æµ‹è¯•åœºæ™¯
```

---

## ğŸš€ æ‰©å±•æ€§éªŒè¯

### åœºæ™¯1: æ‰©å±•æ–°çš„èƒ½åŠ› - æ¶ˆæ¯é˜Ÿåˆ—

**éœ€æ±‚**ï¼šéœ€è¦æµ‹è¯•RabbitMQæ¶ˆæ¯é˜Ÿåˆ—

**å®æ–½æ­¥éª¤**ï¼š

```bash
# Step 1: åœ¨Layer 1åˆ›å»ºæ–°èƒ½åŠ›å±‚
mkdir -p src/df_test_framework/messengers/rabbitmq

# Step 2: å®ç°èƒ½åŠ›ï¼ˆéµå¾ªProtocol+Adapter+Factoryæ¨¡å¼ï¼‰
```

```python
# messengers/rabbitmq/protocols.py
class MessageQueueProtocol(Protocol):
    def send(self, queue: str, message: str) -> None: ...
    def receive(self, queue: str, timeout: int = None) -> str: ...

# messengers/rabbitmq/client.py
class RabbitMQClient:
    """å®ç°MessageQueueProtocol"""
    def send(self, queue: str, message: str):
        # å‘é€æ¶ˆæ¯
        pass

# messengers/rabbitmq/factory.py
class RabbitMQFactory:
    @classmethod
    def create(cls, host: str, port: int) -> RabbitMQClient:
        return RabbitMQClient(host, port)
```

```python
# Step 3: æ·»åŠ Fixture
# testing/fixtures/messenger_fixtures.py
@pytest.fixture
def rabbitmq_client():
    client = RabbitMQFactory.create(host="localhost", port=5672)
    yield client
    client.close()
```

```python
# Step 4: ä½¿ç”¨ï¼ˆä»»ä½•æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ï¼‰

# åŠŸèƒ½æµ‹è¯•
def test_message_functional(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½æµ‹è¯•"""
    rabbitmq_client.send("test_queue", "hello")
    message = rabbitmq_client.receive("test_queue")
    assert message == "hello"

# æ€§èƒ½æµ‹è¯•
def test_message_performance(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—æ€§èƒ½æµ‹è¯•"""
    from df_test_framework.testing.performance import PerformanceTimer

    with PerformanceTimer() as timer:
        for i in range(1000):
            rabbitmq_client.send("test_queue", f"message_{i}")

    assert timer.elapsed < 5.0  # 1000æ¡æ¶ˆæ¯<5ç§’

# å®‰å…¨æµ‹è¯•
def test_message_security(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—å®‰å…¨æµ‹è¯•"""
    # æµ‹è¯•æœªæˆæƒè®¿é—®
    # ...
```

**å…³é”®**ï¼šæ–°å¢èƒ½åŠ›ä¸å½±å“ä»»ä½•ç°æœ‰ä»£ç ï¼

---

### åœºæ™¯2: æ‰©å±•æ–°çš„æµ‹è¯•ç±»å‹ - æ··æ²Œæµ‹è¯•

**éœ€æ±‚**ï¼šéœ€è¦è¿›è¡Œæ··æ²Œæµ‹è¯•ï¼ˆChaos Testingï¼‰

**å®æ–½æ­¥éª¤**ï¼š

```bash
# Step 1: åœ¨Layer 3åˆ›å»ºæ–°æµ‹è¯•ç±»å‹
mkdir -p src/df_test_framework/testing/chaos
```

```python
# testing/chaos/api/fault_injection.py
class APIFaultInjection:
    """APIæ•…éšœæ³¨å…¥"""
    def inject_latency(self, endpoint: str, latency_ms: int):
        """æ³¨å…¥å»¶è¿Ÿ"""
        pass

    def inject_error(self, endpoint: str, error_code: int):
        """æ³¨å…¥é”™è¯¯"""
        pass

# testing/chaos/data/db_chaos.py
class DatabaseChaos:
    """æ•°æ®åº“æ··æ²Œæµ‹è¯•"""
    def kill_connection(self):
        """æ€æ­»è¿æ¥"""
        pass

# testing/chaos/message/queue_chaos.py
class MessageQueueChaos:
    """æ¶ˆæ¯é˜Ÿåˆ—æ··æ²Œæµ‹è¯•"""
    def inject_message_loss(self, queue: str, loss_rate: float):
        """æ³¨å…¥æ¶ˆæ¯ä¸¢å¤±"""
        pass
```

```python
# Step 2: ä½¿ç”¨ï¼ˆå¯ä»¥ä½¿ç”¨ä»»ä½•èƒ½åŠ›ï¼‰

# æ··æ²Œæµ‹è¯• Ã— APIèƒ½åŠ›
def test_api_chaos(rest_client):
    """APIæ··æ²Œæµ‹è¯•ï¼ˆä½¿ç”¨clients/èƒ½åŠ›ï¼‰"""
    fault = APIFaultInjection()
    fault.inject_latency("/api/users", latency_ms=5000)

    response = rest_client.get("/api/users")
    assert response.status_code == 504  # è¶…æ—¶

# æ··æ²Œæµ‹è¯• Ã— æ•°æ®èƒ½åŠ›
def test_db_chaos(mysql_engine):
    """æ•°æ®åº“æ··æ²Œæµ‹è¯•ï¼ˆä½¿ç”¨engines/èƒ½åŠ›ï¼‰"""
    chaos = DatabaseChaos()
    chaos.kill_connection()

    # æµ‹è¯•é‡è¿æœºåˆ¶
    mysql_engine.reconnect()
    assert mysql_engine.is_connected()

# æ··æ²Œæµ‹è¯• Ã— æ¶ˆæ¯é˜Ÿåˆ—èƒ½åŠ›
def test_mq_chaos(rabbitmq_client):
    """æ¶ˆæ¯é˜Ÿåˆ—æ··æ²Œæµ‹è¯•ï¼ˆä½¿ç”¨messengers/èƒ½åŠ›ï¼‰"""
    chaos = MessageQueueChaos()
    chaos.inject_message_loss("test_queue", loss_rate=0.1)

    # æµ‹è¯•æ¶ˆæ¯å¯é æ€§æœºåˆ¶
    # ...
```

**å…³é”®**ï¼šæ–°å¢æµ‹è¯•ç±»å‹å¯ä»¥ä½¿ç”¨æ‰€æœ‰èƒ½åŠ›ï¼

---

### åœºæ™¯3: æ‰©å±•æ–°çš„èƒ½åŠ› - åŒºå—é“¾

**éœ€æ±‚**ï¼šéœ€è¦æµ‹è¯•ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦

**å®æ–½æ­¥éª¤**ï¼š

```bash
# Step 1: åˆ›å»ºåŒºå—é“¾èƒ½åŠ›å±‚
mkdir -p src/df_test_framework/chains/ethereum
```

```python
# chains/ethereum/protocols.py
class BlockchainProtocol(Protocol):
    def deploy_contract(self, contract_code: str) -> str: ...
    def call_function(self, contract_address: str, function: str, args: list) -> Any: ...

# chains/ethereum/client.py
from web3 import Web3

class EthereumClient:
    """ä»¥å¤ªåŠå®¢æˆ·ç«¯"""
    def __init__(self, node_url: str):
        self.w3 = Web3(Web3.HTTPProvider(node_url))

    def deploy_contract(self, contract_code: str) -> str:
        # éƒ¨ç½²åˆçº¦
        pass

    def call_function(self, contract_address: str, function: str, args: list):
        # è°ƒç”¨åˆçº¦å‡½æ•°
        pass
```

```python
# Step 2: ä½¿ç”¨ï¼ˆæ‰€æœ‰æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨ï¼‰

# åŠŸèƒ½æµ‹è¯•
def test_contract_functional(ethereum_client):
    """æ™ºèƒ½åˆçº¦åŠŸèƒ½æµ‹è¯•ï¼ˆä½¿ç”¨chains/èƒ½åŠ›ï¼‰"""
    contract_address = ethereum_client.deploy_contract(contract_code)
    result = ethereum_client.call_function(contract_address, "transfer", [100])
    assert result == True

# å®‰å…¨æµ‹è¯•
def test_contract_security(ethereum_client):
    """æ™ºèƒ½åˆçº¦å®‰å…¨æµ‹è¯•"""
    from df_test_framework.testing.security.blockchain import ReentrancyScanner

    scanner = ReentrancyScanner()
    vulnerabilities = scanner.scan(contract_code)
    assert len(vulnerabilities) == 0
```

**å…³é”®**ï¼šæ¶æ„å®Œå…¨æ”¯æŒï¼Œæ— éœ€ä¿®æ”¹ï¼

---

## ğŸ“Š æ¶æ„ä¼˜åŠ¿æ€»ç»“

### 1. æ— é™æ‰©å±•æ€§

| ç»´åº¦ | æ‰©å±•æ–¹å¼ | å½±å“èŒƒå›´ |
|------|---------|---------|
| **æ–°å¢èƒ½åŠ›** | åœ¨Layer 1æ·»åŠ æ–°ç›®å½• | æ— å½±å“ï¼Œæ‰€æœ‰æµ‹è¯•ç±»å‹è‡ªåŠ¨å¯ç”¨ |
| **æ–°å¢æµ‹è¯•ç±»å‹** | åœ¨Layer 3æ·»åŠ æ–°ç›®å½• | æ— å½±å“ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰èƒ½åŠ› |
| **æ–°å¢å®ç°** | åœ¨èƒ½åŠ›å±‚æ·»åŠ Adapter | æ— å½±å“ï¼Œé€šè¿‡é…ç½®åˆ‡æ¢ |

### 2. ç»„åˆçˆ†ç‚¸çš„å¨åŠ›

```
å‡è®¾ï¼š
- 5ç§èƒ½åŠ›ï¼ˆclients/drivers/engines/messengers/chainsï¼‰
- 6ç§æµ‹è¯•ç±»å‹ï¼ˆfunctional/performance/security/chaos/integration/e2eï¼‰

ç»„åˆæ•° = 5 Ã— 6 = 30ç§æµ‹è¯•åœºæ™¯

æœªæ¥ï¼š
- 10ç§èƒ½åŠ›
- 10ç§æµ‹è¯•ç±»å‹

ç»„åˆæ•° = 10 Ã— 10 = 100ç§æµ‹è¯•åœºæ™¯

æ‰€æœ‰åœºæ™¯éƒ½è‡ªåŠ¨æ”¯æŒï¼
```

### 3. æ¸…æ™°çš„æ¦‚å¿µæ¨¡å‹

```
é—®é¢˜ï¼šæˆ‘è¦æµ‹è¯•XXX

Step 1: ç¡®å®šèƒ½åŠ›ï¼ˆæµ‹è¯•ä»€ä¹ˆï¼‰
  - æ˜¯APIå—ï¼Ÿ       â†’ clients/
  - æ˜¯UIå—ï¼Ÿ        â†’ drivers/
  - æ˜¯æ•°æ®å—ï¼Ÿ      â†’ engines/
  - æ˜¯æ¶ˆæ¯é˜Ÿåˆ—å—ï¼Ÿ  â†’ messengers/
  - æ˜¯åŒºå—é“¾å—ï¼Ÿ    â†’ chains/

Step 2: ç¡®å®šæµ‹è¯•ç±»å‹ï¼ˆæ€ä¹ˆæµ‹ï¼‰
  - åŠŸèƒ½æµ‹è¯•ï¼Ÿ      â†’ testing/functional/
  - æ€§èƒ½æµ‹è¯•ï¼Ÿ      â†’ testing/performance/
  - å®‰å…¨æµ‹è¯•ï¼Ÿ      â†’ testing/security/
  - æ··æ²Œæµ‹è¯•ï¼Ÿ      â†’ testing/chaos/

Step 3: ç»„åˆä½¿ç”¨
  ä¾‹å¦‚ï¼šAPIæ€§èƒ½æµ‹è¯• = testing/performance/api/ + clients/rest/
```

---

## ğŸ¯ å®æ–½å»ºè®®

### é˜¶æ®µ1: æ ¸å¿ƒæ¶æ„ï¼ˆP0 - å¿…é¡»ï¼‰

å®ç°Layer 1çš„**ç°æœ‰èƒ½åŠ›**ï¼š
1. âœ… `clients/rest/` - RESTå®¢æˆ·ç«¯ï¼ˆhttpxå®ç°ï¼‰
2. âœ… `drivers/web/` - Webé©±åŠ¨ï¼ˆplaywrightå®ç°ï¼‰
3. âœ… `engines/sql/` - SQLå¼•æ“ï¼ˆMySQLå®ç°ï¼‰
4. âœ… `engines/nosql/redis/` - Rediså¼•æ“

å®ç°Layer 3çš„**æ ¸å¿ƒæµ‹è¯•ç±»å‹**ï¼š
1. âœ… `testing/functional/` - åŠŸèƒ½æµ‹è¯•å·¥å…·
2. âœ… `testing/validation/` - éªŒè¯å™¨
3. âœ… `testing/data/` - æ•°æ®ç®¡ç†

### é˜¶æ®µ2: å¤‡é€‰å®ç°ï¼ˆP1 - é‡è¦ï¼‰

1. âœ… `clients/rest/requests/` - requestså®ç°
2. âœ… `drivers/web/selenium/` - seleniumå®ç°

### é˜¶æ®µ3: æ‰©å±•èƒ½åŠ›ï¼ˆP2 - å¯é€‰ï¼‰

æŒ‰éœ€å®ç°ï¼š
- `clients/graphql/` - GraphQLå®¢æˆ·ç«¯
- `engines/bigdata/spark/` - Sparkå¼•æ“
- `messengers/rabbitmq/` - RabbitMQå®¢æˆ·ç«¯

### é˜¶æ®µ4: æ‰©å±•æµ‹è¯•ç±»å‹ï¼ˆP2 - å¯é€‰ï¼‰

æŒ‰éœ€å®ç°ï¼š
- `testing/performance/` - æ€§èƒ½æµ‹è¯•å®Œæ•´å®ç°
- `testing/security/` - å®‰å…¨æµ‹è¯•å®Œæ•´å®ç°
- `testing/chaos/` - æ··æ²Œæµ‹è¯•

---

## âœ… æ¶æ„è®¾è®¡å®Œæˆæ ‡å¿—

æˆ‘ä»¬çš„æ¶æ„è®¨è®ºå·²ç»è¾¾æˆå…±è¯†ï¼Œå…³é”®ç‚¹ï¼š

1. âœ… **ä¸æ˜¯"ä¸‰å±‚å¯¹ç§°"**ï¼Œè€Œæ˜¯"èƒ½åŠ›å±‚å¯æ— é™æ‰©å±•"
2. âœ… **ä¸æ˜¯å›ºå®šç»“æ„**ï¼Œè€Œæ˜¯"å¼€æ”¾å¼æ¶æ„"
3. âœ… **æ ¸å¿ƒæ˜¯è§£è€¦**ï¼šèƒ½åŠ›å±‚ âŠ¥ æµ‹è¯•ç±»å‹å±‚
4. âœ… **æ‰©å±•éªŒè¯é€šè¿‡**ï¼šæ¶ˆæ¯é˜Ÿåˆ—ã€åŒºå—é“¾ã€IoTç­‰éƒ½å¯ä»¥æ— ç¼æ‰©å±•
5. âœ… **æµ‹è¯•ç±»å‹éªŒè¯é€šè¿‡**ï¼šæ··æ²Œæµ‹è¯•ã€å¯è®¿é—®æ€§æµ‹è¯•ç­‰éƒ½å¯ä»¥æ— ç¼æ‰©å±•

---

**æ¶æ„è®¾è®¡å®Œæˆï¼å¯ä»¥å¼€å§‹å®æ–½ã€‚**

**ä¸‹ä¸€æ­¥**: åˆ›å»ºç›®å½•ç»“æ„å¹¶å¼€å§‹é‡æ„
