# DF Test Framework v3 æ¶æ„è®¾è®¡æ–¹æ¡ˆ

> åŸºäºäº¤äº’æ¨¡å¼åˆ†ç±»çš„ç°ä»£åŒ–æµ‹è¯•æ¡†æ¶æ¶æ„
>
> ğŸ“… 2025-11-03 | v3.0.0 | çŠ¶æ€: âœ… å·²å®æ–½

---

## ğŸ¯ æ ¸å¿ƒè®¾è®¡å†³ç­–

### å…³é”®æ´å¯Ÿ

**æµ‹è¯•æ¡†æ¶çš„èƒ½åŠ›å±‚åº”è¯¥åæ˜ "æµ‹è¯•æ¡†æ¶ä¸è¢«æµ‹ç³»ç»Ÿçš„äº¤äº’æ–¹å¼"ï¼Œè€ŒéæŠ€æœ¯æ ˆæœ¬èº«ã€‚**

### ä¸‰å¤§è®¾è®¡åŸåˆ™

1. **äº¤äº’æ¨¡å¼ä¼˜å…ˆ** - æŒ‰è¯·æ±‚-å“åº”ã€æ•°æ®è®¿é—®ã€æ¶ˆæ¯ä¼ é€’ç­‰äº¤äº’æ¨¡å¼åˆ†ç±»
2. **è¯­ä¹‰å‡†ç¡®æ€§** - ä½¿ç”¨å‡†ç¡®çš„æœ¯è¯­ï¼ˆdatabasesè€Œéenginesï¼‰
3. **æ‰©å±•å¼€æ”¾æ€§** - èƒ½åŠ›å±‚ä¸æµ‹è¯•ç±»å‹å±‚å®Œå…¨è§£è€¦ï¼Œå¯æ— é™æ‰©å±•

---

## ğŸ“ æ¶æ„çªç ´ç‚¹

### çªç ´1: èƒ½åŠ›å±‚æŒ‰äº¤äº’æ¨¡å¼åˆ†ç±»

```
âŒ æ—§æ¶æ„é—®é¢˜:
engines/
  â”œâ”€â”€ sql/        # æ•°æ®åº“
  â”œâ”€â”€ nosql/      # æ•°æ®åº“
  â””â”€â”€ bigdata/    # âŒ åˆ†ç±»æ··ä¹±
      â”œâ”€â”€ spark/  # è®¡ç®—å¼•æ“
      â””â”€â”€ kafka/  # âŒ æ¶ˆæ¯é˜Ÿåˆ—ä¸ºä½•åœ¨è¿™ï¼Ÿ

é—®é¢˜:
- enginesè¯­ä¹‰ä¸å‡†ç¡®ï¼ˆDBä¸æ˜¯å¼•æ“ï¼‰
- åˆ†ç±»ç»´åº¦æ··ä¹±ï¼ˆKafkaæ˜¯æ¶ˆæ¯ç³»ç»Ÿï¼‰
- æ‰©å±•æ€§å·®

âœ… æ–°æ¶æ„:
clients/         # è¯·æ±‚-å“åº”æ¨¡å¼ï¼ˆHTTP/RPC/GraphQLï¼‰
drivers/         # ä¼šè¯å¼äº¤äº’æ¨¡å¼ï¼ˆæµè§ˆå™¨/ç§»åŠ¨è®¾å¤‡ï¼‰
databases/       # æ•°æ®è®¿é—®æ¨¡å¼ï¼ˆMySQL/Redis/MongoDBï¼‰
messengers/      # æ¶ˆæ¯ä¼ é€’æ¨¡å¼ï¼ˆKafka/RabbitMQ/Pulsarï¼‰
storages/        # æ–‡ä»¶å­˜å‚¨æ¨¡å¼ï¼ˆS3/MinIO/OSSï¼‰
engines/         # è®¡ç®—å¼•æ“æ¨¡å¼ï¼ˆSpark/Flinkï¼‰

ä¼˜åŠ¿:
- âœ… æ¯ä¸ªèƒ½åŠ›å±‚èŒè´£å•ä¸€ã€è¯­ä¹‰æ˜ç¡®
- âœ… å¯æ— é™æ·»åŠ æ–°èƒ½åŠ›å±‚ï¼ˆå¦‚åŒºå—é“¾ã€AIç­‰ï¼‰
- âœ… æ‰©å±•æ—¶ä¸å½±å“ç°æœ‰ç»“æ„
```

### çªç ´2: databasesæ‰å¹³åŒ–

```
âŒ æ—§æ–¹æ¡ˆ:
databases/
  â”œâ”€â”€ sql/              # âŒ å¤šä½™çš„åˆ†ç±»å±‚
  â”‚   â”œâ”€â”€ mysql/
  â”‚   â””â”€â”€ postgresql/
  â””â”€â”€ nosql/            # âŒ å¤šä½™çš„åˆ†ç±»å±‚
      â”œâ”€â”€ redis/
      â””â”€â”€ mongodb/

âœ… æ–°æ–¹æ¡ˆï¼ˆæ‰å¹³åŒ–ï¼‰:
databases/
  â”œâ”€â”€ mysql/            # âœ… æŒ‰æ•°æ®åº“ç±»å‹ç»„ç»‡
  â”œâ”€â”€ postgresql/
  â”œâ”€â”€ redis/
  â”œâ”€â”€ mongodb/
  â”œâ”€â”€ database.py       # é€šç”¨Databaseç±»
  â”œâ”€â”€ repositories/     # Repositoryæ¨¡å¼
  â””â”€â”€ factory.py        # DatabaseFactory

ä¼˜åŠ¿:
- âœ… å‡å°‘åµŒå¥—å±‚çº§
- âœ… æ·»åŠ æ–°æ•°æ®åº“æ›´ç®€å•
- âœ… é¿å…SQL/NoSQLçš„æ¨¡ç³Šè¾¹ç•Œ
```

### çªç ´3: èƒ½åŠ›å±‚ä¸æµ‹è¯•æ”¯æŒå±‚è§£è€¦

```
èƒ½åŠ›å±‚ï¼ˆCapability Layerï¼‰    æµ‹è¯•æ”¯æŒå±‚ï¼ˆTest Support Layerï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
clients/                      testing/
drivers/                        â”œâ”€â”€ assertions/   # æ–­è¨€å·¥å…·
databases/                      â”œâ”€â”€ data/         # æµ‹è¯•æ•°æ®
messengers/                     â”‚   â””â”€â”€ builders/ # æ•°æ®æ„å»º
storages/                       â”œâ”€â”€ fixtures/     # Pytest fixtures
engines/                        â”œâ”€â”€ plugins/      # Pytestæ’ä»¶
                                â””â”€â”€ debug/        # è°ƒè¯•å·¥å…·

å…³é”®:
- èƒ½åŠ›å±‚æä¾›"æŠ€æœ¯èƒ½åŠ›"ï¼ˆå¦‚ä½•ä¸ç³»ç»Ÿäº¤äº’ï¼‰
- æµ‹è¯•æ”¯æŒå±‚æä¾›"æµ‹è¯•å·¥å…·"ï¼ˆå¦‚ä½•ç¼–å†™æµ‹è¯•ï¼‰
- ä¸æŒ‰æµ‹è¯•ç±»å‹ç»„ç»‡ï¼ˆapi/ui/e2eï¼‰ï¼Œè€Œæ˜¯æŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡
- æ‰€æœ‰æµ‹è¯•å·¥å…·é€‚ç”¨äºä»»ä½•æµ‹è¯•ç±»å‹
```

---

## ğŸ—ï¸ å®Œæ•´åˆ†å±‚æ¶æ„

### Layer 0: åŸºç¡€å±‚ï¼ˆcommon/ï¼‰
```
common/
â”œâ”€â”€ exceptions.py      # å¼‚å¸¸ä½“ç³»
â””â”€â”€ types.py           # ç±»å‹å®šä¹‰
```

**èŒè´£**: æœ€åº•å±‚æ¨¡å—ï¼Œè¢«æ‰€æœ‰å…¶ä»–å±‚ä¾èµ–ï¼Œé¿å…å¾ªç¯ä¾èµ–

**è¯´æ˜**: Protocolå®šä¹‰åˆ†æ•£åœ¨å„èƒ½åŠ›å±‚ï¼ˆå¦‚`clients/http/rest/protocols.py`ï¼‰

---

### Layer 1: èƒ½åŠ›å±‚ï¼ˆ6ä¸ªèƒ½åŠ›ç»´åº¦ï¼‰

#### ğŸ“ ç›®å½•ç»„ç»‡è®¾è®¡åŸåˆ™

**åŸåˆ™ 1ï¼šä¸¤å±‚ç»“æ„ï¼ˆç±»å‹ + å®ç°ï¼‰**
- **é€‚ç”¨åœºæ™¯**ï¼šåŒä¸€ç±»åˆ«æœ‰å¤šç§å¯æ›¿æ¢çš„å®ç°
- **ç›®å½•å±‚çº§**ï¼š
  - ç¬¬ä¸€å±‚ï¼šèƒ½åŠ›ç±»å‹åˆ†ç±»ï¼ˆæŒ‰æŠ€æœ¯ç‰¹å¾/ç”¨é€”ï¼‰
  - ç¬¬äºŒå±‚ï¼šå…·ä½“å®ç°ï¼ˆä¸åŒSDK/åè®®/å¼•æ“ï¼‰
- **ç¤ºä¾‹**ï¼š
  ```
  storages/object/{s3, oss}      # å¯¹è±¡å­˜å‚¨ï¼šä¸åŒäº‘å‚å•†å®ç°
  drivers/web/{playwright, selenium}  # Webè‡ªåŠ¨åŒ–ï¼šä¸åŒå¼•æ“å®ç°
  messengers/queue/{kafka, rabbitmq}  # æ¶ˆæ¯é˜Ÿåˆ—ï¼šä¸åŒMQå®ç°
  ```

**åŸåˆ™ 2ï¼šä¸€å±‚ç»“æ„ï¼ˆç‹¬ç«‹æŠ€æœ¯æ ˆï¼‰**
- **é€‚ç”¨åœºæ™¯**ï¼šæ¯ä¸ªæŠ€æœ¯éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ç³»ç»Ÿ
- **ç›®å½•å±‚çº§**ï¼šç›´æ¥æŒ‰æŠ€æœ¯åç§°åˆ’åˆ†å­ç›®å½•
- **ç¤ºä¾‹**ï¼š
  ```
  databases/{redis, mysql, postgresql}  # æ¯ä¸ªéƒ½æ˜¯ä¸åŒçš„æ•°æ®åº“ç³»ç»Ÿ
  clients/{http, graphql, grpc}         # æ¯ä¸ªéƒ½æ˜¯ä¸åŒçš„é€šä¿¡åè®®
  ```

**åˆ¤æ–­æ ‡å‡†**ï¼š
- âœ… ä½¿ç”¨ä¸¤å±‚ï¼šå¦‚æœå®ç°ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼ˆç›¸åŒæ¥å£/ç”¨é€”ï¼‰
- âœ… ä½¿ç”¨ä¸€å±‚ï¼šå¦‚æœæ¯ä¸ªæŠ€æœ¯éƒ½æœ‰ç‹¬ç‰¹çš„APIå’Œç”¨é€”

---

#### 1ï¸âƒ£ clients/ - è¯·æ±‚-å“åº”æ¨¡å¼
```
clients/
â””â”€â”€ http/              # HTTPåè®®
    â””â”€â”€ rest/          # RESTé£æ ¼
        â”œâ”€â”€ httpx/     # âœ… httpxå®ç°ï¼ˆå·²å®ç°ï¼‰
        â”œâ”€â”€ protocols.py  # RESTå®¢æˆ·ç«¯Protocolå®šä¹‰
        â”œâ”€â”€ factory.py    # RESTå®¢æˆ·ç«¯å·¥å‚
        â””â”€â”€ __init__.py

# é¢„ç•™ï¼ˆæœªå®ç°ï¼‰ï¼š
# â”œâ”€â”€ requests/      # requestså®ç°
# â”œâ”€â”€ graphql/       # GraphQL
# â””â”€â”€ grpc/          # gRPC
```

#### 2ï¸âƒ£ drivers/ - ä¼šè¯å¼äº¤äº’æ¨¡å¼
```
drivers/
â””â”€â”€ web/               # ç¬¬ä¸€å±‚ï¼šè®¾å¤‡ç±»å‹ - Webæµè§ˆå™¨
    â”œâ”€â”€ playwright/    # ç¬¬äºŒå±‚ï¼šå¼•æ“å®ç° - âœ… Playwrightï¼ˆå·²å®ç°ï¼‰
    â”œâ”€â”€ protocols.py   # Webé©±åŠ¨Protocolå®šä¹‰
    â”œâ”€â”€ factory.py     # Webé©±åŠ¨å·¥å‚
    â””â”€â”€ __init__.py

# é¢„ç•™ï¼ˆæœªå®ç°ï¼‰ï¼š
# drivers/
# â”œâ”€â”€ web/           # Webæµè§ˆå™¨
# â”‚   â””â”€â”€ selenium/  # Seleniumå®ç°ï¼ˆé¢„ç•™ï¼‰
# â”œâ”€â”€ mobile/        # ç§»åŠ¨è®¾å¤‡ï¼ˆé¢„ç•™ï¼Œä¸ web å¹³çº§ï¼‰
# â”‚   â””â”€â”€ appium/    # Appiumå®ç°
# â””â”€â”€ desktop/       # æ¡Œé¢åº”ç”¨ï¼ˆé¢„ç•™ï¼Œä¸ web å¹³çº§ï¼‰
#     â””â”€â”€ winappdriver/  # Windowsåº”ç”¨é©±åŠ¨
```

**è®¾è®¡è¯´æ˜**ï¼š
- **ç¬¬ä¸€å±‚**ï¼ˆè®¾å¤‡ç±»å‹ï¼‰ï¼šwebã€mobileã€desktop å¹³çº§
- **ç¬¬äºŒå±‚**ï¼ˆå¼•æ“å®ç°ï¼‰ï¼šplaywrightã€seleniumã€appium ç­‰å…·ä½“å®ç°
- **å¯æ›¿æ¢æ€§**ï¼šåŒä¸€è®¾å¤‡ç±»å‹ä¸‹çš„ä¸åŒå¼•æ“å¯ä»¥äº’æ¢

#### 3ï¸âƒ£ databases/ - æ•°æ®è®¿é—®æ¨¡å¼
```
databases/
â”œâ”€â”€ redis/             # âœ… Rediså®¢æˆ·ç«¯ï¼ˆå·²å®ç°ï¼‰
â”œâ”€â”€ database.py        # âœ… é€šç”¨Databaseç±»ï¼ˆå·²å®ç°ï¼ŒåŸºäº SQLAlchemyï¼‰
â”œâ”€â”€ repositories/      # âœ… Repositoryæ¨¡å¼ï¼ˆå·²å®ç°ï¼‰
â”œâ”€â”€ uow.py             # âœ… Unit of Workæ¨¡å¼ï¼ˆå·²å®ç°ï¼‰
â”œâ”€â”€ factory.py         # âœ… DatabaseFactoryï¼ˆå·²å®ç°ï¼‰
â””â”€â”€ __init__.py

# é¢„ç•™ï¼ˆæœªå®ç°ï¼‰ï¼š
# â”œâ”€â”€ mysql/         # MySQLä¸“ç”¨å®¢æˆ·ç«¯ï¼ˆç‰¹å®šåŠŸèƒ½ï¼‰
# â”œâ”€â”€ postgresql/    # PostgreSQLä¸“ç”¨å®¢æˆ·ç«¯ï¼ˆç‰¹å®šåŠŸèƒ½ï¼‰
# â”œâ”€â”€ mongodb/       # MongoDBå®¢æˆ·ç«¯ï¼ˆNoSQLï¼‰
# â””â”€â”€ elasticsearch/ # Elasticsearchå®¢æˆ·ç«¯ï¼ˆæœç´¢å¼•æ“ï¼‰
```

**è®¾è®¡è¯´æ˜**ï¼š
- **ä¸€å±‚ç»“æ„**ï¼šæ¯ä¸ªæ•°æ®åº“éƒ½æ˜¯ç‹¬ç«‹çš„æŠ€æœ¯æ ˆï¼ŒAPI ä¸åŒ
- **database.py**ï¼šé€šç”¨å…³ç³»å‹æ•°æ®åº“ç±»ï¼ˆåŸºäº SQLAlchemy ORMï¼‰
- **ä¸“ç”¨å®¢æˆ·ç«¯**ï¼šå¦‚ redis/ã€mysql/ã€mongodb/ æä¾›ç‰¹å®šæ•°æ®åº“çš„åŸç”ŸåŠŸèƒ½
- **ä¸å¯æ›¿æ¢**ï¼šRedisã€MySQLã€MongoDB ç”¨é€”ä¸åŒï¼Œæ— æ³•äº’æ¢

#### 4ï¸âƒ£ messengers/ - æ¶ˆæ¯ä¼ é€’æ¨¡å¼
```
messengers/
â”œâ”€â”€ queue/             # ç¬¬ä¸€å±‚ï¼šæ¶ˆæ¯ç±»å‹ - æ¶ˆæ¯é˜Ÿåˆ—
â”‚   â”œâ”€â”€ kafka/         # ç¬¬äºŒå±‚ï¼šMQå®ç° - âœ… Kafkaï¼ˆå·²å®ç°ï¼ŒåŸºäº confluent-kafkaï¼‰
â”‚   â”œâ”€â”€ rabbitmq/      # ç¬¬äºŒå±‚ï¼šMQå®ç° - âœ… RabbitMQï¼ˆå·²å®ç°ï¼ŒåŸºäº pikaï¼‰
â”‚   â””â”€â”€ rocketmq/      # ç¬¬äºŒå±‚ï¼šMQå®ç° - âœ… RocketMQï¼ˆå·²å®ç°ï¼‰
â””â”€â”€ pubsub/            # ç¬¬ä¸€å±‚ï¼šæ¶ˆæ¯ç±»å‹ - å‘å¸ƒè®¢é˜…ï¼ˆé¢„ç•™ï¼‰
    â””â”€â”€ __init__.py    # â³ é¢„ç•™

# é¢„ç•™ï¼ˆæœªå®ç°ï¼‰ï¼š
# â””â”€â”€ queue/pulsar/  # Pulsar
```

**è®¾è®¡è¯´æ˜**ï¼š
- **ä¸¤å±‚ç»“æ„**ï¼šç¬¬ä¸€å±‚æŒ‰æ¶ˆæ¯ä¼ é€’ç±»å‹åˆ†ç±»ï¼Œç¬¬äºŒå±‚æŒ‰å…·ä½“å®ç°
- **ç¬¬ä¸€å±‚åˆ†ç±»**ï¼ˆæ¶ˆæ¯ç±»å‹ï¼‰ï¼š
  - `queue/` - æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆç‚¹å¯¹ç‚¹æ¨¡å¼ï¼‰
  - `pubsub/` - å‘å¸ƒè®¢é˜…ï¼ˆå¹¿æ’­æ¨¡å¼ï¼‰
- **ç¬¬äºŒå±‚å®ç°**ï¼ˆMQç³»ç»Ÿï¼‰ï¼š
  - `kafka/`ã€`rabbitmq/`ã€`rocketmq/` æä¾›æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸åŒMQç³»ç»Ÿå®ç°
- **å¯æ›¿æ¢æ€§**ï¼šåŒä¸€æ¶ˆæ¯ç±»å‹ä¸‹çš„ä¸åŒå®ç°å¯ä»¥äº’æ¢ï¼ˆç»Ÿä¸€çš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…APIï¼‰

#### 5ï¸âƒ£ storages/ - æ–‡ä»¶å­˜å‚¨æ¨¡å¼
```
storages/
â”œâ”€â”€ object/            # ç¬¬ä¸€å±‚ï¼šå­˜å‚¨ç±»å‹ - å¯¹è±¡å­˜å‚¨
â”‚   â”œâ”€â”€ s3/            # ç¬¬äºŒå±‚ï¼šäº‘å‚å•†å®ç° - âœ… AWS S3ï¼ˆå·²å®ç°ï¼ŒåŸºäº boto3ï¼‰
â”‚   â””â”€â”€ oss/           # ç¬¬äºŒå±‚ï¼šäº‘å‚å•†å®ç° - âœ… é˜¿é‡Œäº‘ OSSï¼ˆå·²å®ç°ï¼ŒåŸºäº oss2ï¼‰
â”œâ”€â”€ file/              # ç¬¬ä¸€å±‚ï¼šå­˜å‚¨ç±»å‹ - æ–‡ä»¶ç³»ç»Ÿ
â”‚   â””â”€â”€ local/         # ç¬¬äºŒå±‚ï¼šæ–‡ä»¶ç³»ç»Ÿå®ç° - âœ… æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ˆå·²å®ç°ï¼‰
â””â”€â”€ blob/              # ç¬¬ä¸€å±‚ï¼šå­˜å‚¨ç±»å‹ - Blobå­˜å‚¨ï¼ˆé¢„ç•™ï¼‰
    â””â”€â”€ __init__.py

# é¢„ç•™ï¼ˆæœªå®ç°ï¼‰ï¼š
# storages/
# â”œâ”€â”€ object/
# â”‚   â”œâ”€â”€ minio/     # MinIOï¼ˆå¯ä½¿ç”¨ S3Clientï¼ŒS3åè®®å…¼å®¹ï¼‰
# â”‚   â”œâ”€â”€ gcs/       # Google Cloud Storage
# â”‚   â””â”€â”€ azure/     # Azure Blob Storage
# â”œâ”€â”€ file/
# â”‚   â”œâ”€â”€ nfs/       # ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ
# â”‚   â””â”€â”€ ftp/       # FTPæ–‡ä»¶ç³»ç»Ÿ
# â””â”€â”€ blob/
#     â””â”€â”€ hdfs/      # Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ
```

**è®¾è®¡è¯´æ˜**ï¼š
- **ä¸¤å±‚ç»“æ„**ï¼šç¬¬ä¸€å±‚æŒ‰å­˜å‚¨ç±»å‹åˆ†ç±»ï¼Œç¬¬äºŒå±‚æŒ‰å…·ä½“å®ç°
- **ç¬¬ä¸€å±‚åˆ†ç±»**ï¼ˆå­˜å‚¨ç±»å‹ï¼‰ï¼š
  - `object/` - å¯¹è±¡å­˜å‚¨ï¼ˆS3åè®®ã€OSSåè®®ç­‰ï¼‰
  - `file/` - æ–‡ä»¶ç³»ç»Ÿï¼ˆæœ¬åœ°ã€ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿç­‰ï¼‰
  - `blob/` - Blobå­˜å‚¨ï¼ˆå¤§æ•°æ®åœºæ™¯ï¼‰
- **ç¬¬äºŒå±‚å®ç°**ï¼ˆäº‘å‚å•†/æŠ€æœ¯ï¼‰ï¼š
  - `s3/`ã€`oss/`ã€`gcs/` æä¾›å¯¹è±¡å­˜å‚¨çš„ä¸åŒäº‘å‚å•†å®ç°
  - `local/`ã€`nfs/`ã€`ftp/` æä¾›æ–‡ä»¶ç³»ç»Ÿçš„ä¸åŒåè®®å®ç°
- **å¯æ›¿æ¢æ€§**ï¼šåŒä¸€å­˜å‚¨ç±»å‹ä¸‹çš„ä¸åŒå®ç°å¯ä»¥äº’æ¢ï¼ˆç»Ÿä¸€ APIï¼‰

#### 6ï¸âƒ£ engines/ - è®¡ç®—å¼•æ“æ¨¡å¼
```
engines/
â”œâ”€â”€ batch/             # ç¬¬ä¸€å±‚ï¼šå¼•æ“ç±»å‹ - æ‰¹å¤„ç†å¼•æ“
â”‚   â””â”€â”€ spark/         # ç¬¬äºŒå±‚ï¼šå¼•æ“å®ç° - â³ Apache Sparkï¼ˆé¢„ç•™ï¼‰
â”œâ”€â”€ stream/            # ç¬¬ä¸€å±‚ï¼šå¼•æ“ç±»å‹ - æµå¤„ç†å¼•æ“
â”‚   â””â”€â”€ flink/         # ç¬¬äºŒå±‚ï¼šå¼•æ“å®ç° - â³ Apache Flinkï¼ˆé¢„ç•™ï¼‰
â””â”€â”€ olap/              # ç¬¬ä¸€å±‚ï¼šå¼•æ“ç±»å‹ - OLAPåˆ†æå¼•æ“ï¼ˆé¢„ç•™ï¼‰
    â””â”€â”€ __init__.py    # â³ é¢„ç•™

# é¢„ç•™ï¼ˆæœªå®ç°ï¼‰ï¼š
# engines/
# â”œâ”€â”€ batch/
# â”‚   â””â”€â”€ hadoop/    # Hadoop MapReduce
# â””â”€â”€ olap/
#     â”œâ”€â”€ clickhouse/  # ClickHouse
#     â””â”€â”€ druid/       # Apache Druid
```

**è®¾è®¡è¯´æ˜**ï¼š
- **ä¸¤å±‚ç»“æ„**ï¼šç¬¬ä¸€å±‚æŒ‰è®¡ç®—æ¨¡å¼åˆ†ç±»ï¼Œç¬¬äºŒå±‚æŒ‰å…·ä½“å¼•æ“å®ç°
- **ç¬¬ä¸€å±‚åˆ†ç±»**ï¼ˆè®¡ç®—æ¨¡å¼ï¼‰ï¼š
  - `batch/` - æ‰¹å¤„ç†å¼•æ“ï¼ˆç¦»çº¿è®¡ç®—ï¼‰
  - `stream/` - æµå¤„ç†å¼•æ“ï¼ˆå®æ—¶è®¡ç®—ï¼‰
  - `olap/` - OLAPåˆ†æå¼•æ“ï¼ˆå¤šç»´åˆ†æï¼‰
- **ç¬¬äºŒå±‚å®ç°**ï¼ˆè®¡ç®—å¼•æ“ï¼‰ï¼š
  - `spark/`ã€`hadoop/` æä¾›æ‰¹å¤„ç†çš„ä¸åŒå¼•æ“å®ç°
  - `flink/` æä¾›æµå¤„ç†å¼•æ“å®ç°
  - `clickhouse/`ã€`druid/` æä¾›OLAPåˆ†æå¼•æ“å®ç°
- **å¯æ›¿æ¢æ€§**ï¼šåŒä¸€è®¡ç®—æ¨¡å¼ä¸‹çš„ä¸åŒå¼•æ“å¯ä»¥äº’æ¢ï¼ˆä¾‹å¦‚ Spark å’Œ Hadoop éƒ½å¯ç”¨äºæ‰¹å¤„ç†ï¼‰

---

### Layer 2: åŸºç¡€è®¾æ–½å±‚ï¼ˆinfrastructure/ï¼‰
```
infrastructure/
â”œâ”€â”€ config/            # é…ç½®ç®¡ç†
â”œâ”€â”€ logging/           # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ providers/         # ä¾èµ–æ³¨å…¥
â”œâ”€â”€ bootstrap/         # åº”ç”¨å¯åŠ¨
â””â”€â”€ runtime/           # è¿è¡Œæ—¶ä¸Šä¸‹æ–‡
```

---

### Layer 3: æµ‹è¯•æ”¯æŒå±‚ï¼ˆtesting/ï¼‰

> âš ï¸ **v3.12.0 æ¶æ„æ¼”è¿›**ï¼šåŸºäºå®è·µç»éªŒä¼˜åŒ–äº†æ¨¡å—ç»„ç»‡ï¼Œè¯¦è§ [TESTING_MODULE_OPTIMIZATION.md](./TESTING_MODULE_OPTIMIZATION.md)

```
testing/
â”œâ”€â”€ fixtures/                       # ğŸ—ï¸ Pytest fixturesï¼ˆä¾èµ– pytestï¼‰
â”‚   â”œâ”€â”€ core.py                     # æ ¸å¿ƒfixturesï¼ˆruntimeã€http_clientã€databaseï¼‰
â”‚   â”œâ”€â”€ allure.py                   # Allure fixtureï¼ˆè–„åŒ…è£…å±‚ï¼‰
â”‚   â”œâ”€â”€ cleanup.py                  # æµ‹è¯•æ•°æ®æ¸…ç†ï¼ˆv3.11.1ï¼‰
â”‚   â”œâ”€â”€ ui.py                       # UIæµ‹è¯•fixtures
â”‚   â”œâ”€â”€ monitoring.py               # æ€§èƒ½ç›‘æ§
â”‚   â””â”€â”€ message_queue.py            # æ¶ˆæ¯é˜Ÿåˆ—fixtures
â”‚
â”œâ”€â”€ plugins/                        # ğŸ”Œ Pytestæ’ä»¶ï¼ˆä¾èµ– pytestï¼‰
â”‚   â”œâ”€â”€ markers.py                  # ç¯å¢ƒæ ‡è®°
â”‚   â”œâ”€â”€ debug.py                    # è°ƒè¯•æ’ä»¶ï¼ˆæµ‹è¯•å¤±è´¥è¯Šæ–­ï¼‰
â”‚   â””â”€â”€ api_autodiscovery.py        # APIè‡ªåŠ¨å‘ç°
â”‚
â”œâ”€â”€ reporting/                      # ğŸ“Š æµ‹è¯•æŠ¥å‘Šï¼ˆä¸ä¾èµ– pytestï¼‰
â”‚   â””â”€â”€ allure/                     # Allure å­ç³»ç»Ÿ
â”‚       â”œâ”€â”€ observer.py             # AllureObserverï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰
â”‚       â””â”€â”€ helper.py               # AllureHelperï¼ˆå·¥å…·ç±»ï¼‰
â”‚
â”œâ”€â”€ debugging/                      # ğŸ› è°ƒè¯•å·¥å…·ï¼ˆä¸ä¾èµ– pytestï¼‰
â”‚   â”œâ”€â”€ http.py                     # HTTPDebugger
â”‚   â””â”€â”€ database.py                 # DBDebugger
â”‚
â”œâ”€â”€ mocking/                        # ğŸ­ Mock å·¥å…·
â”‚   â”œâ”€â”€ http_mock.py
â”‚   â”œâ”€â”€ database_mock.py
â”‚   â”œâ”€â”€ redis_mock.py
â”‚   â””â”€â”€ time_mock.py
â”‚
â”œâ”€â”€ assertions/                     # âœ… æ–­è¨€å·¥å…·
â”‚   â””â”€â”€ response.py
â”‚
â”œâ”€â”€ data/                           # ğŸ“¦ æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ builders/                   # Builderæ¨¡å¼
â”‚   â””â”€â”€ loaders/                    # æ•°æ®åŠ è½½å™¨ï¼ˆCSV/JSON/YAMLï¼‰
â”‚
â”œâ”€â”€ factories/                      # ğŸ­ æ•°æ®å·¥å‚
â”‚   â”œâ”€â”€ base.py
â”‚   â””â”€â”€ presets.py
â”‚
â””â”€â”€ decorators/                     # ğŸ¨ è£…é¥°å™¨
    â””â”€â”€ api_class.py
```

**èŒè´£åˆ’åˆ†**:

| æ¨¡å— | èŒè´£ | ä¾èµ– pytest |
|-----|------|-----------|
| `fixtures/` | pytest fixture å®šä¹‰ | âœ… æ˜¯ |
| `plugins/` | pytest hooks/markers | âœ… æ˜¯ |
| `reporting/allure/` | Allure è§‚å¯Ÿè€…ã€å·¥å…·ç±» | âŒ å¦ |
| `debugging/` | è°ƒè¯•å™¨å®ç° | âŒ å¦ |

**è¯´æ˜**:
- ä¸å†æŒ‰æµ‹è¯•ç±»å‹ç»„ç»‡ï¼ˆapi/ã€ui/ï¼‰ï¼Œè€Œæ˜¯æŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡
- `fixtures/` - pytest fixturesï¼ŒåŒ…å« Allure è–„åŒ…è£…å±‚
- `plugins/` - pytest æ’ä»¶ï¼ˆhooks/markers/debugï¼‰
- `reporting/allure/` - Allure æ ¸å¿ƒå®ç°ï¼ˆä¸ä¾èµ– pytestï¼Œå¯ç‹¬ç«‹æµ‹è¯•ï¼‰
- `debugging/` - è°ƒè¯•å™¨å®ç°ï¼ˆä¸ä¾èµ– pytestï¼Œå¯ç‹¬ç«‹æµ‹è¯•ï¼‰
- `mocking/` - Mock å·¥å…·é›†åˆ
- `assertions/` - æ–­è¨€å·¥å…·
- `data/` - æµ‹è¯•æ•°æ®æ„å»ºå™¨å’ŒåŠ è½½å™¨
- `factories/` - å·¥å‚æ¨¡å¼æ•°æ®ç”Ÿæˆ

**v3.12.0 æ¶æ„æ¼”è¿›è¦ç‚¹**:
1. **èŒè´£åˆ†ç¦»** - pytest ä¾èµ–ä»£ç ï¼ˆfixtures/ã€plugins/ï¼‰ä¸æ ¸å¿ƒå®ç°ï¼ˆreporting/ã€debugging/ï¼‰åˆ†ç¦»
2. **å¯æµ‹è¯•æ€§** - reporting/allure/ å’Œ debugging/ ä¸ä¾èµ– pytestï¼Œå¯ç‹¬ç«‹å•å…ƒæµ‹è¯•
3. **å•ä¸€å…¥å£** - ç”¨æˆ·åªéœ€ `pytest_plugins = ["df_test_framework.testing.fixtures"]`
4. **è–„åŒ…è£…å±‚** - fixtures/allure.py åªåš pytest é›†æˆï¼Œæ ¸å¿ƒé€»è¾‘åœ¨ reporting/allure/

---

### Layer 4: æ‰©å±•å’Œå·¥å…·å±‚
```
extensions/            # æ’ä»¶ç³»ç»Ÿ
models/                # æ•°æ®æ¨¡å‹
utils/                 # å·¥å…·å‡½æ•°
cli/                   # å‘½ä»¤è¡Œå·¥å…·
```

---

## ğŸ“ æ‰©å±•æ€§éªŒè¯

### åœºæ™¯1: æ·»åŠ æ¶ˆæ¯é˜Ÿåˆ—æµ‹è¯•ï¼ˆKafkaï¼‰
```
åªéœ€æ·»åŠ :
messengers/queue/kafka/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ kafka_client.py
  â””â”€â”€ producer.py

ä¸å½±å“:
- clients/ï¼ˆAPIæµ‹è¯•ï¼‰
- drivers/ï¼ˆUIæµ‹è¯•ï¼‰
- databases/ï¼ˆæ•°æ®åº“æµ‹è¯•ï¼‰
- testing/ï¼ˆæµ‹è¯•ç»„ç»‡æ–¹å¼ï¼‰
```

### åœºæ™¯2: æ·»åŠ åŒºå—é“¾æµ‹è¯•
```
åªéœ€æ·»åŠ æ–°èƒ½åŠ›å±‚:
blockchains/
  â”œâ”€â”€ ethereum/
  â”œâ”€â”€ bitcoin/
  â””â”€â”€ factory.py

ä¸å½±å“ä»»ä½•ç°æœ‰æ¨¡å—
```

### åœºæ™¯3: æ·»åŠ AIæ¨¡å‹æµ‹è¯•
```
åªéœ€æ·»åŠ æ–°èƒ½åŠ›å±‚:
ai/
  â”œâ”€â”€ llm/           # å¤§è¯­è¨€æ¨¡å‹
  â”œâ”€â”€ vision/        # è®¡ç®—æœºè§†è§‰
  â””â”€â”€ speech/        # è¯­éŸ³è¯†åˆ«

ä¸å½±å“ä»»ä½•ç°æœ‰æ¨¡å—
```

---

## ğŸ“Š è®¾è®¡å¯¹æ¯”æ€»ç»“

| ç»´åº¦ | v2.x | v3.0 | æ”¹è¿› |
|------|------|------|------|
| **æ•°æ®åº“** | `engines/sql/` | `databases/mysql/` | âœ… è¯­ä¹‰å‡†ç¡®+æ‰å¹³åŒ– |
| **HTTP** | `clients/rest/` | `clients/http/rest/` | âœ… åè®®å±‚çº§æ¸…æ™° |
| **æ¶ˆæ¯é˜Ÿåˆ—** | `engines/bigdata/kafka/` | `messengers/queue/kafka/` | âœ… èŒè´£æ˜ç¡® |
| **UIè‡ªåŠ¨åŒ–** | `ui/` | `drivers/web/` | âœ… æŒ‰äº¤äº’æ¨¡å¼åˆ†ç±» |
| **æµ‹è¯•æ•°æ®** | `patterns/builders/` | `testing/data/builders/` | âœ… èŒè´£å½’ä½ |
| **å¼‚å¸¸å®šä¹‰** | é¡¶çº§`exceptions.py` | `common/exceptions.py` | âœ… åˆ†å±‚æ¸…æ™° |
| **æ‰©å±•æ€§** | å—é™äºæŠ€æœ¯æ ˆåˆ†ç±» | å¯æ— é™æ·»åŠ èƒ½åŠ›å±‚ | âœ… æ¶æ„å¼€æ”¾ |

---

## ğŸ¯ å®æ–½çŠ¶æ€

- âœ… Phase 1: ç›®å½•é‡æ„ï¼ˆå·²å®Œæˆï¼‰
- âœ… Phase 2: å¯¼å…¥è·¯å¾„æ›´æ–°ï¼ˆå·²å®Œæˆï¼‰
- âœ… Phase 3: databasesæ‰å¹³åŒ–ï¼ˆå·²å®Œæˆï¼‰
- âœ… Phase 4: æµ‹è¯•éªŒè¯ï¼ˆ906/906é€šè¿‡ï¼‰
- âœ… Phase 5: æ–‡æ¡£æ›´æ–°ï¼ˆå·²å®Œæˆï¼‰

**å½“å‰ç‰ˆæœ¬**: v3.10.0
**Gitæ ‡ç­¾**: v3.10.0

---

## ğŸ“ å¤‡æ³¨

1. **å‘åå…¼å®¹æ€§**: v3.x ä¿æŒå‘åå…¼å®¹ï¼Œéœ€å‚è€ƒè¿ç§»æ–‡æ¡£ä» v2 å‡çº§
2. **é¡¶å±‚å¯¼å…¥**: ä»ç„¶æ”¯æŒ`from df_test_framework import Database`
3. **æµ‹è¯•è¦†ç›–**: å½“å‰æµ‹è¯•è¦†ç›–ç‡ 80%+ï¼Œç›®æ ‡80%ï¼ˆå·²è¾¾æˆï¼‰
4. **æ–‡æ¡£ä½ç½®**:
   - æ¶æ„æ–¹æ¡ˆ: `docs/architecture/V3_ARCHITECTURE.md`ï¼ˆæœ¬æ–‡æ¡£ï¼‰
   - å®æ–½æŒ‡å—: `docs/architecture/V3_IMPLEMENTATION.md`
   - è¿ç§»æ–‡æ¡£: `docs/migration/v2-to-v3.md`
