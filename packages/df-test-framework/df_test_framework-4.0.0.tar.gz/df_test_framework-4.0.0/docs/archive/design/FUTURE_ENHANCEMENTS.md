# DF Test Framework v3 - æœªæ¥å¢å¼ºåŠŸèƒ½è§„åˆ’

> **çŠ¶æ€**: âš ï¸ å·²å½’æ¡£
> **åŸç‰ˆæœ¬**: v3.x
> **å½’æ¡£åŸå› **: v4.0.0 å·²å‘å¸ƒï¼Œv3 è§„åˆ’å·²è¿‡æ—¶
> **å½“å‰æ–‡æ¡£**: è¯·å‚è€ƒ [v4.0 æ¶æ„æ€»è§ˆ](../../architecture/ARCHITECTURE_V4.0.md)
>
> **åˆ›å»ºæ—¥æœŸ**: 2025-11-03
> **ä¼˜å…ˆçº§**: P2-P3ï¼ˆéæ ¸å¿ƒåŠŸèƒ½ï¼Œé€æ­¥å®ç°ï¼‰

---

## ğŸ“‹ èƒŒæ™¯è¯´æ˜

åœ¨æ—©æœŸv3æ¶æ„è®¨è®ºä¸­ï¼ˆREFACTORING_PLAN_V3.mdï¼‰ï¼Œæˆ‘ä»¬è¯†åˆ«å‡ºäº†6ä¸ªé—æ¼ç‚¹ã€‚ç»è¿‡v3æ¶æ„å®æ–½å’Œå®¡è®¡åï¼Œæˆ‘ä»¬éœ€è¦åŸºäº**æœ€æ–°çš„v3æ¶æ„åŸåˆ™**é‡æ–°è¯„ä¼°è¿™äº›é—æ¼ç‚¹ã€‚

**v3æ¶æ„æ ¸å¿ƒåŸåˆ™**:
1. **æŒ‰äº¤äº’æ¨¡å¼åˆ†ç±»èƒ½åŠ›å±‚** - clients/drivers/databases/messengers/storages/engines
2. **testing/æŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡** - ä¸æŒ‰æµ‹è¯•ç±»å‹ï¼ˆapi/uiï¼‰ï¼Œè€ŒæŒ‰å·¥å…·èŒè´£ï¼ˆassertions/fixtures/pluginsï¼‰
3. **èƒ½åŠ›å±‚ä¸æµ‹è¯•æ”¯æŒå±‚è§£è€¦** - ä»»ä½•æµ‹è¯•éƒ½å¯ä½¿ç”¨ä»»ä½•èƒ½åŠ›

---

## âœ… å·²è§£å†³çš„é—æ¼ç‚¹

### 1. æ•°æ®æµ‹è¯•èƒ½åŠ› âœ…
**åŸå§‹éœ€æ±‚**: ç¼ºå°‘æ•°æ®æµ‹è¯•èƒ½åŠ›

**v3è§£å†³æ–¹æ¡ˆ**:
- `databases/` - æ•°æ®è®¿é—®æ¨¡å¼ï¼ˆå·²æ‰å¹³åŒ–ï¼‰
  - `databases/redis/` âœ…
  - `databases/repositories/` âœ…
  - `databases/database.py` âœ…
  - `databases/factory.py` âœ…
- é¢„ç•™èƒ½åŠ›å±‚:
  - `messengers/queue/{kafka,rabbitmq}/` â³
  - `storages/object/s3/`, `storages/file/local/` â³
  - `engines/batch/spark/`, `engines/stream/flink/` â³

**çŠ¶æ€**: âœ… å·²å®Œå…¨è§£å†³

---

### 2. æµ‹è¯•ç±»å‹ç»´åº¦æ··æ·† âœ…
**åŸå§‹éœ€æ±‚**: æ€§èƒ½æµ‹è¯•ã€å®‰å…¨æµ‹è¯•åº”è¯¥æ”¾åœ¨testing/ä¸‹

**åŸå§‹æ–¹æ¡ˆ** (å·²åºŸå¼ƒ):
```
testing/
â”œâ”€â”€ functional/       # åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ performance/      # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ security/         # å®‰å…¨æµ‹è¯•
â””â”€â”€ ...
```

**v3æœ€ç»ˆæ–¹æ¡ˆ** (å·²å®æ–½):
```
testing/
â”œâ”€â”€ assertions/       # æ–­è¨€å·¥å…·ï¼ˆæ‰€æœ‰æµ‹è¯•éƒ½å¯ç”¨ï¼‰
â”œâ”€â”€ data/builders/    # æ•°æ®æ„å»ºï¼ˆæ‰€æœ‰æµ‹è¯•éƒ½å¯ç”¨ï¼‰
â”œâ”€â”€ fixtures/         # Pytest fixturesï¼ˆæ‰€æœ‰æµ‹è¯•éƒ½å¯ç”¨ï¼‰
â”œâ”€â”€ plugins/          # Pytestæ’ä»¶ï¼ˆæ‰€æœ‰æµ‹è¯•éƒ½å¯ç”¨ï¼‰
â””â”€â”€ debug/            # è°ƒè¯•å·¥å…·ï¼ˆæ‰€æœ‰æµ‹è¯•éƒ½å¯ç”¨ï¼‰
```

**è®¾è®¡å†³ç­–**:
- âœ… **ä¸æŒ‰æµ‹è¯•ç±»å‹ç»„ç»‡**ï¼ˆapi/ui/performance/securityï¼‰
- âœ… **æŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡**ï¼ˆassertions/fixtures/pluginsï¼‰
- âœ… **åŸå› **: é¿å…å·¥å…·é‡å¤ï¼Œä»»ä½•æµ‹è¯•ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›å·¥å…·

**çŠ¶æ€**: âœ… å·²æŒ‰æ›´å¥½çš„æ–¹å¼è§£å†³ï¼ˆå®¡è®¡å·²ç¡®è®¤ï¼‰

---

## ğŸ”„ éœ€è¦é‡æ–°è¯„ä¼°çš„é—æ¼ç‚¹

ä»¥ä¸‹é—æ¼ç‚¹éœ€è¦åŸºäºv3æ¶æ„åŸåˆ™é‡æ–°è¯„ä¼°ï¼Œçœ‹æ˜¯å¦ä»ç„¶é€‚ç”¨ã€‚

---

### 3. æµ‹è¯•æ•°æ®ç®¡ç†å¢å¼º

#### å½“å‰çŠ¶æ€
```
testing/data/
â””â”€â”€ builders/         # âœ… Builderæ¨¡å¼ï¼ˆå·²å®ç°ï¼‰
```

#### åŸå§‹å»ºè®®
```
testing/data/
â”œâ”€â”€ builders/         # âœ… å·²å®ç°
â”œâ”€â”€ factories/        # âŒ æœªå®ç° - åŸºäºFakerçš„éšæœºæ•°æ®ç”Ÿæˆ
â”œâ”€â”€ loaders/          # âŒ æœªå®ç° - ä»JSON/CSV/ExcelåŠ è½½
â”œâ”€â”€ cleaners/         # âŒ æœªå®ç° - æµ‹è¯•åæ¸…ç†
â””â”€â”€ snapshots/        # âŒ æœªå®ç° - æ•°æ®åº“å¿«ç…§
```

#### v3æ¶æ„è¯„ä¼°

**âœ… ä¿ç•™å»ºè®®**:

1. **testing/data/factories/** - éšæœºæ•°æ®ç”Ÿæˆ
   - **ç†ç”±**: ç¬¦åˆ"æµ‹è¯•æ•°æ®æ„å»º"èŒè´£ï¼Œä¸builders/å¹¶åˆ—
   - **ç”¨é€”**: ä½¿ç”¨Fakeråº“ç”Ÿæˆéšæœºæµ‹è¯•æ•°æ®
   - **ä¼˜å…ˆçº§**: P2
   - **ç¤ºä¾‹**:
   ```python
   # testing/data/factories/user_factory.py
   from faker import Faker

   class UserFactory:
       def __init__(self):
           self.faker = Faker('zh_CN')

       def create_user(self, **overrides):
           return {
               'name': self.faker.name(),
               'email': self.faker.email(),
               'phone': self.faker.phone_number(),
               **overrides
           }
   ```

2. **testing/data/loaders/** - æ•°æ®åŠ è½½å™¨
   - **ç†ç”±**: ç¬¦åˆ"æµ‹è¯•æ•°æ®ç®¡ç†"èŒè´£
   - **ç”¨é€”**: ä»å¤–éƒ¨æ–‡ä»¶åŠ è½½æµ‹è¯•æ•°æ®ï¼ˆJSON/CSV/Excel/YAMLï¼‰
   - **ä¼˜å…ˆçº§**: P2
   - **ç¤ºä¾‹**:
   ```python
   # testing/data/loaders/json_loader.py
   class JsonDataLoader:
       def load(self, file_path: str) -> dict:
           """ä»JSONæ–‡ä»¶åŠ è½½æµ‹è¯•æ•°æ®"""
           pass
   ```

**âš ï¸ éœ€è¦è°ƒæ•´**:

3. **testing/data/cleaners/** â†’ **testing/fixtures/cleanup.py**
   - **åŸå› **: æ•°æ®æ¸…ç†å·²åœ¨`testing/fixtures/cleanup.py`ä¸­å®ç°
   - **å†³ç­–**: âœ… **ä¸éœ€è¦æ–°ç›®å½•**ï¼Œç°æœ‰å®ç°å·²æ»¡è¶³éœ€æ±‚
   - **çŠ¶æ€**: âœ… å·²è§£å†³ï¼ˆä»¥ä¸åŒå½¢å¼å®ç°ï¼‰

4. **testing/data/snapshots/** - æ•°æ®åº“å¿«ç…§
   - **é—®é¢˜**: è¿™æ˜¯å¦å±äº"æµ‹è¯•æ•°æ®"èŒè´£ï¼Ÿ
   - **é‡æ–°è¯„ä¼°**: æ•°æ®åº“å¿«ç…§æ›´åƒæ˜¯"æ•°æ®åº“å·¥å…·"è€Œé"æµ‹è¯•æ•°æ®"
   - **å»ºè®®**:
     - é€‰é¡¹A: æ”¾åœ¨`databases/snapshots/`ï¼ˆå±äºèƒ½åŠ›å±‚ï¼‰
     - é€‰é¡¹B: æ”¾åœ¨`testing/fixtures/`ï¼ˆä½œä¸ºfixtureæä¾›ï¼‰
     - é€‰é¡¹C: æš‚ä¸å®ç°ï¼ˆä½¿ç”¨æ•°æ®åº“è‡ªå¸¦å·¥å…·ï¼‰
   - **ä¼˜å…ˆçº§**: P3ï¼ˆå¯é€‰ï¼‰

**ç»“è®º**:
- âœ… `factories/` - å»ºè®®å®ç°ï¼ˆP2ï¼‰
- âœ… `loaders/` - å»ºè®®å®ç°ï¼ˆP2ï¼‰
- âœ… `cleaners/` - å·²è§£å†³ï¼ˆåœ¨fixtures/cleanup.pyä¸­ï¼‰
- âš ï¸ `snapshots/` - éœ€è¦é‡æ–°è€ƒè™‘å½’å±ï¼ˆP3ï¼‰

---

### 4. APIéªŒè¯æœºåˆ¶

#### åŸå§‹å»ºè®®
```
testing/validation/
â””â”€â”€ response/
    â”œâ”€â”€ validator.py      # å“åº”éªŒè¯å™¨ï¼ˆFluent APIï¼‰
    â”œâ”€â”€ json_schema.py    # JSON SchemaéªŒè¯
    â””â”€â”€ matchers.py       # æ–­è¨€åŒ¹é…å™¨
```

#### v3æ¶æ„è¯„ä¼°

**é—®é¢˜åˆ†æ**:
1. **ä¸assertions/é‡å¤ï¼Ÿ** - testing/assertions/å·²å­˜åœ¨ï¼Œæ˜¯å¦éœ€è¦å•ç‹¬çš„validation/ï¼Ÿ
2. **èŒè´£è¾¹ç•Œæ¨¡ç³Š** - validator vs assertionsçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

**é‡æ–°è¯„ä¼°**:

**é€‰é¡¹A: åˆå¹¶åˆ°assertions/** (æ¨è)
```
testing/assertions/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ base.py              # åŸºç¡€æ–­è¨€ï¼ˆassertpyå°è£…ï¼‰
â”œâ”€â”€ response.py          # âœ… æ–°å¢ - HTTPå“åº”æ–­è¨€
â”œâ”€â”€ json_schema.py       # âœ… æ–°å¢ - JSON SchemaéªŒè¯
â””â”€â”€ matchers.py          # âœ… æ–°å¢ - è‡ªå®šä¹‰åŒ¹é…å™¨
```

**é€‰é¡¹B: ä¿ç•™ç‹¬ç«‹çš„validation/** (ä¸æ¨è)
```
testing/validation/
â””â”€â”€ response/            # ç‹¬ç«‹çš„éªŒè¯å™¨
```

**å»ºè®®**: âœ… **é€‰é¡¹A - åˆå¹¶åˆ°assertions/**
- **ç†ç”±1**: é¿å…æ¦‚å¿µæ··æ·†ï¼ˆassertions vs validationéƒ½æ˜¯éªŒè¯ï¼‰
- **ç†ç”±2**: ç¬¦åˆv3åŸåˆ™ï¼ˆæŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡ï¼Œä¸è¿‡åº¦ç»†åˆ†ï¼‰
- **ç†ç”±3**: ç”¨æˆ·æ›´å®¹æ˜“æ‰¾åˆ°ï¼ˆæ‰€æœ‰æ–­è¨€éƒ½åœ¨assertions/ï¼‰

**ä¼˜å…ˆçº§**: P2

**ç»“è®º**:
- âŒ ä¸åˆ›å»º`testing/validation/`ç›®å½•
- âœ… åœ¨`testing/assertions/`ä¸­å¢å¼ºåŠŸèƒ½ï¼ˆresponse.py, json_schema.pyï¼‰

---

### 5. Mockæ”¯æŒ

#### åŸå§‹å»ºè®®
```
testing/mocks/
â”œâ”€â”€ http/             # HTTP Mock
â”œâ”€â”€ database/         # æ•°æ®åº“Mock
â””â”€â”€ time/             # æ—¶é—´Mock
```

#### v3æ¶æ„è¯„ä¼°

**é—®é¢˜åˆ†æ**:
1. **æ˜¯å¦ç¬¦åˆtesting/èŒè´£ï¼Ÿ** - Mockæ˜¯æµ‹è¯•å·¥å…·ï¼Œç¬¦åˆ
2. **æ˜¯å¦æœ‰æ›´å¥½çš„ä½ç½®ï¼Ÿ** - testing/mocks/ä¼¼ä¹åˆç†

**é‡æ–°è¯„ä¼°**:

**âœ… ä¿ç•™å»ºè®®** - åˆ›å»º`testing/mocks/`ç›®å½•

**ç†ç”±**:
- Mockæ˜¯é€šç”¨æµ‹è¯•å·¥å…·ï¼ˆæ‰€æœ‰æµ‹è¯•éƒ½å¯èƒ½éœ€è¦ï¼‰
- ç¬¦åˆtesting/æŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡çš„åŸåˆ™
- ä¸fixtures/ã€plugins/å¹¶åˆ—ï¼ŒèŒè´£æ¸…æ™°

**å»ºè®®å®ç°**:
```
testing/mocks/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ http/             # HTTP Mockï¼ˆresponsesåº“å°è£…ï¼‰
â”‚   â””â”€â”€ mock_server.py
â”œâ”€â”€ database/         # æ•°æ®åº“Mockï¼ˆå†…å­˜æ•°æ®åº“ï¼‰
â”‚   â””â”€â”€ sqlite_mock.py
â””â”€â”€ time/             # æ—¶é—´Mockï¼ˆfreezegunå°è£…ï¼‰
    â””â”€â”€ time_mock.py
```

**ç¤ºä¾‹**:
```python
# testing/mocks/http/mock_server.py
import responses

class HttpMock:
    """HTTPè¯·æ±‚Mock"""
    def __init__(self):
        self.mock = responses.RequestsMock()

    def add_response(self, method: str, url: str, json: dict, status: int = 200):
        self.mock.add(method, url, json=json, status=status)
```

**ä¼˜å…ˆçº§**: P2

**ç»“è®º**: âœ… å»ºè®®å®ç°`testing/mocks/`ï¼ˆP2ï¼‰

---

### 6. æŠ¥å‘Šç³»ç»Ÿå¢å¼º

#### åŸå§‹å»ºè®®
```
testing/reporting/
â”œâ”€â”€ allure/           # AllureæŠ¥å‘Š
â”œâ”€â”€ html/             # HTMLæŠ¥å‘Š
â”œâ”€â”€ screenshots/      # æˆªå›¾ç®¡ç†
â””â”€â”€ videos/           # è§†é¢‘å½•åˆ¶
```

#### å½“å‰çŠ¶æ€
```
testing/plugins/
â””â”€â”€ allure.py         # âœ… Allureé›†æˆå·²å®ç°
```

#### v3æ¶æ„è¯„ä¼°

**é—®é¢˜åˆ†æ**:
1. **Allureå·²åœ¨plugins/ä¸­å®ç°** - æ— éœ€é‡å¤
2. **screenshots/videos/** - è¿™æ˜¯"æŠ¥å‘Šå†…å®¹"è¿˜æ˜¯"æµ‹è¯•å·¥å…·"ï¼Ÿ
3. **html/æŠ¥å‘Š** - pytestå·²æœ‰HTMLæŠ¥å‘Šæ’ä»¶ï¼ˆpytest-htmlï¼‰

**é‡æ–°è¯„ä¼°**:

**é€‰é¡¹A: ä¸åˆ›å»ºreporting/ç›®å½•** (æ¨è)
- Allureé›†æˆ â†’ `testing/plugins/allure.py` âœ… å·²å®ç°
- HTMLæŠ¥å‘Š â†’ ä½¿ç”¨`pytest-html`æ’ä»¶ï¼ˆå¤–éƒ¨ä¾èµ–ï¼‰
- æˆªå›¾ â†’ åœ¨`testing/fixtures/ui.py`ä¸­å®ç°ï¼ˆå¤±è´¥è‡ªåŠ¨æˆªå›¾ï¼‰
- è§†é¢‘ â†’ Playwrightè‡ªå¸¦å½•åˆ¶åŠŸèƒ½

**é€‰é¡¹B: åˆ›å»ºreporting/ç›®å½•** (ä¸æ¨è)
```
testing/reporting/
â”œâ”€â”€ screenshots/      # æˆªå›¾ç®¡ç†
â”‚   â””â”€â”€ manager.py
â””â”€â”€ videos/           # è§†é¢‘ç®¡ç†
    â””â”€â”€ recorder.py
```

**å»ºè®®**: âœ… **é€‰é¡¹A - ä¸åˆ›å»ºç‹¬ç«‹reporting/ç›®å½•**
- **ç†ç”±1**: åŠŸèƒ½åˆ†æ•£åœ¨æ›´åˆé€‚çš„ä½ç½®ï¼ˆplugins/ã€fixtures/ï¼‰
- **ç†ç”±2**: é¿å…è¿‡åº¦ç»†åˆ†ç›®å½•
- **ç†ç”±3**: ç¬¦åˆv3åŸåˆ™ï¼ˆæŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡ï¼‰

**å…·ä½“å®ç°ä½ç½®**:
- Allureé›†æˆ â†’ `testing/plugins/allure.py` âœ…
- å¤±è´¥æˆªå›¾ â†’ `testing/fixtures/ui.py`ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
- è§†é¢‘å½•åˆ¶ â†’ Playwrightè‡ªå¸¦ï¼Œé€šè¿‡é…ç½®å¯ç”¨

**ä¼˜å…ˆçº§**: P3ï¼ˆå¯é€‰ï¼Œå¤§éƒ¨åˆ†å·²æœ‰è§£å†³æ–¹æ¡ˆï¼‰

**ç»“è®º**:
- âŒ ä¸åˆ›å»º`testing/reporting/`ç›®å½•
- âœ… åœ¨ç°æœ‰ä½ç½®å¢å¼ºåŠŸèƒ½ï¼ˆfixtures/ui.pyæ·»åŠ å¤±è´¥æˆªå›¾ï¼‰

---

## ğŸ“Š æ±‡æ€»å»ºè®®

### å»ºè®®å®ç°ï¼ˆP2ä¼˜å…ˆçº§ï¼‰

| åŠŸèƒ½ | ä½ç½® | ç†ç”± | å·¥ä½œé‡ |
|------|------|------|--------|
| **éšæœºæ•°æ®ç”Ÿæˆ** | `testing/data/factories/` | è¡¥å……æµ‹è¯•æ•°æ®æ„å»ºèƒ½åŠ› | ä¸­ |
| **æ•°æ®åŠ è½½å™¨** | `testing/data/loaders/` | ä»å¤–éƒ¨æ–‡ä»¶åŠ è½½æµ‹è¯•æ•°æ® | ä¸­ |
| **å“åº”æ–­è¨€å¢å¼º** | `testing/assertions/response.py` | HTTPå“åº”ä¸“ç”¨æ–­è¨€ | å° |
| **JSON SchemaéªŒè¯** | `testing/assertions/json_schema.py` | SchemaéªŒè¯èƒ½åŠ› | å° |
| **Mockæ”¯æŒ** | `testing/mocks/` | HTTP/æ•°æ®åº“/æ—¶é—´Mock | ä¸­ |

### å·²æœ‰è§£å†³æ–¹æ¡ˆï¼ˆæ— éœ€æ–°å¢ï¼‰

| åŠŸèƒ½ | ç°æœ‰å®ç° | è¯´æ˜ |
|------|----------|------|
| **æ•°æ®æ¸…ç†** | `testing/fixtures/cleanup.py` | âœ… å·²å®ç° |
| **AllureæŠ¥å‘Š** | `testing/plugins/allure.py` | âœ… å·²å®ç° |
| **HTMLæŠ¥å‘Š** | ä½¿ç”¨`pytest-html`æ’ä»¶ | å¤–éƒ¨ä¾èµ– |
| **è§†é¢‘å½•åˆ¶** | Playwrightè‡ªå¸¦åŠŸèƒ½ | é€šè¿‡é…ç½®å¯ç”¨ |

### éœ€è¦é‡æ–°è€ƒè™‘ï¼ˆP3æˆ–æš‚ä¸å®ç°ï¼‰

| åŠŸèƒ½ | é—®é¢˜ | å»ºè®® |
|------|------|------|
| **æ•°æ®åº“å¿«ç…§** | å½’å±ä¸æ˜ç¡®ï¼ˆèƒ½åŠ›å±‚ï¼Ÿå·¥å…·å±‚ï¼Ÿï¼‰ | ä½¿ç”¨æ•°æ®åº“è‡ªå¸¦å·¥å…·ï¼Œæš‚ä¸å®ç° |
| **ç‹¬ç«‹validation/ç›®å½•** | ä¸assertions/é‡å¤ | åˆå¹¶åˆ°assertions/ |
| **ç‹¬ç«‹reporting/ç›®å½•** | åŠŸèƒ½åˆ†æ•£æ›´åˆé€‚ | ä¸åˆ›å»ºï¼Œä½¿ç”¨ç°æœ‰æ–¹æ¡ˆ |

---

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§

### Phase 2A: æµ‹è¯•æ•°æ®å¢å¼ºï¼ˆP2 - å»ºè®®è¿‘æœŸå®ç°ï¼‰
**é¢„è®¡æ—¶é—´**: 2-3å¤©

1. âœ… **å®ç°testing/data/factories/**
   - é›†æˆFakeråº“
   - æä¾›å¸¸ç”¨æ•°æ®å·¥å‚ï¼ˆUserã€Orderã€Productç­‰ï¼‰
   - ç¼–å†™å•å…ƒæµ‹è¯•

2. âœ… **å®ç°testing/data/loaders/**
   - JSONåŠ è½½å™¨
   - CSVåŠ è½½å™¨
   - YAMLåŠ è½½å™¨
   - ç¼–å†™å•å…ƒæµ‹è¯•

### Phase 2B: æ–­è¨€å¢å¼ºï¼ˆP2 - å»ºè®®è¿‘æœŸå®ç°ï¼‰
**é¢„è®¡æ—¶é—´**: 1-2å¤©

3. âœ… **å¢å¼ºtesting/assertions/**
   - å®ç°`response.py` - HTTPå“åº”æ–­è¨€
   - å®ç°`json_schema.py` - JSON SchemaéªŒè¯
   - å®ç°`matchers.py` - è‡ªå®šä¹‰åŒ¹é…å™¨
   - ç¼–å†™å•å…ƒæµ‹è¯•

### Phase 2C: Mockæ”¯æŒï¼ˆP2 - å»ºè®®ä¸­æœŸå®ç°ï¼‰
**é¢„è®¡æ—¶é—´**: 2-3å¤©

4. âœ… **å®ç°testing/mocks/**
   - `mocks/http/` - HTTP Mockï¼ˆåŸºäºresponsesåº“ï¼‰
   - `mocks/database/` - æ•°æ®åº“Mockï¼ˆSQLiteå†…å­˜ï¼‰
   - `mocks/time/` - æ—¶é—´Mockï¼ˆåŸºäºfreezegunï¼‰
   - ç¼–å†™å•å…ƒæµ‹è¯•

### Phase 2D: UIæµ‹è¯•å¢å¼ºï¼ˆP3 - å¯é€‰ï¼‰
**é¢„è®¡æ—¶é—´**: 1å¤©

5. âœ… **å¢å¼ºtesting/fixtures/ui.py**
   - å®ç°å¤±è´¥è‡ªåŠ¨æˆªå›¾
   - é›†æˆPlaywrightè§†é¢‘å½•åˆ¶
   - ç¼–å†™å•å…ƒæµ‹è¯•

---

## ğŸ“ å®æ–½æ£€æŸ¥æ¸…å•

### Phase 2A: æµ‹è¯•æ•°æ®å¢å¼º
- [ ] å®ç°`testing/data/factories/`
  - [ ] é›†æˆFakeråº“
  - [ ] å®ç°`UserFactory`
  - [ ] å®ç°`BaseFactory`æŠ½è±¡ç±»
  - [ ] ç¼–å†™å•å…ƒæµ‹è¯•
  - [ ] æ›´æ–°æ–‡æ¡£
- [ ] å®ç°`testing/data/loaders/`
  - [ ] å®ç°`JsonLoader`
  - [ ] å®ç°`CsvLoader`
  - [ ] å®ç°`YamlLoader`
  - [ ] ç¼–å†™å•å…ƒæµ‹è¯•
  - [ ] æ›´æ–°æ–‡æ¡£

### Phase 2B: æ–­è¨€å¢å¼º
- [ ] å¢å¼º`testing/assertions/`
  - [ ] å®ç°`response.py`
  - [ ] å®ç°`json_schema.py`
  - [ ] å®ç°`matchers.py`
  - [ ] ç¼–å†™å•å…ƒæµ‹è¯•
  - [ ] æ›´æ–°æ–‡æ¡£

### Phase 2C: Mockæ”¯æŒ
- [ ] å®ç°`testing/mocks/`
  - [ ] å®ç°`mocks/http/mock_server.py`
  - [ ] å®ç°`mocks/database/sqlite_mock.py`
  - [ ] å®ç°`mocks/time/time_mock.py`
  - [ ] ç¼–å†™å•å…ƒæµ‹è¯•
  - [ ] æ›´æ–°æ–‡æ¡£

### Phase 2D: UIæµ‹è¯•å¢å¼º
- [ ] å¢å¼º`testing/fixtures/ui.py`
  - [ ] å®ç°å¤±è´¥è‡ªåŠ¨æˆªå›¾
  - [ ] é›†æˆè§†é¢‘å½•åˆ¶
  - [ ] ç¼–å†™å•å…ƒæµ‹è¯•
  - [ ] æ›´æ–°æ–‡æ¡£

---

## ğŸ” è®¾è®¡åŸåˆ™éªŒè¯

æ‰€æœ‰å»ºè®®çš„å¢å¼ºåŠŸèƒ½éƒ½ç¬¦åˆv3æ¶æ„åŸåˆ™ï¼š

| åŸåˆ™ | éªŒè¯ |
|------|------|
| **æŒ‰äº¤äº’æ¨¡å¼åˆ†ç±»èƒ½åŠ›å±‚** | âœ… æ‰€æœ‰å¢å¼ºéƒ½åœ¨testing/å±‚ï¼ˆæµ‹è¯•æ”¯æŒå±‚ï¼‰ï¼Œä¸å½±å“èƒ½åŠ›å±‚ |
| **testing/æŒ‰åŠŸèƒ½èŒè´£ç»„ç»‡** | âœ… factories/loaders/assertions/mocks/éƒ½æ˜¯åŠŸèƒ½èŒè´£åˆ†ç±» |
| **èƒ½åŠ›å±‚ä¸æµ‹è¯•æ”¯æŒå±‚è§£è€¦** | âœ… æ‰€æœ‰å·¥å…·é€‚ç”¨äºä»»ä½•æµ‹è¯•ç±»å‹ |
| **é¿å…æ¦‚å¿µæ··æ·†** | âœ… åºŸå¼ƒvalidation/å’Œreporting/ï¼Œé¿å…ä¸assertions/å’Œplugins/æ··æ·† |
| **é¿å…è¿‡åº¦ç»†åˆ†** | âœ… å°†åŠŸèƒ½åˆå¹¶åˆ°ç°æœ‰ç›®å½•ï¼Œä¸åˆ›å»ºè¿‡å¤šé¡¶çº§ç›®å½• |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **V3_ARCHITECTURE.md** - v3æ¶æ„è®¾è®¡æ–¹æ¡ˆï¼ˆæ ¸å¿ƒåŸåˆ™ï¼‰
- **V3_IMPLEMENTATION.md** - v3å®æ–½æŒ‡å—
- **ARCHITECTURE_AUDIT.md** - æ¶æ„å®¡è®¡æŠ¥å‘Š
- **archive/REFACTORING_PLAN_V3.md** - æ—©æœŸè®¨è®ºï¼ˆåŒ…å«6ä¸ªé—æ¼ç‚¹ï¼‰

---

## âœ… ç»“è®º

**æ ¸å¿ƒæ¶æ„å·²å®Œæˆ**: v3æ¶æ„é‡æ„å·²100%å®Œæˆï¼Œæ‰€æœ‰æ ¸å¿ƒç›®æ ‡è¾¾æˆ

**åç»­å¢å¼ºè§„åˆ’**:
- âœ… **å»ºè®®å®ç°** (P2): factories/, loaders/, assertions/å¢å¼º, mocks/
- âŒ **ä¸å»ºè®®å®ç°**: validation/, reporting/, snapshots/
- âœ… **å·²æœ‰è§£å†³æ–¹æ¡ˆ**: cleaners/, Allure, HTMLæŠ¥å‘Š, è§†é¢‘å½•åˆ¶

**å®æ–½ç­–ç•¥**:
- ä½œä¸ºç‹¬ç«‹çš„Phase 2ä»»åŠ¡é€æ­¥å®ç°
- ä¸å½±å“v3æ ¸å¿ƒæ¶æ„
- æ‰€æœ‰åŠŸèƒ½ç¬¦åˆv3è®¾è®¡åŸåˆ™

---

**æ–‡æ¡£åˆ›å»ºæ—¥æœŸ**: 2025-11-03
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸
**ä¼˜å…ˆçº§**: P2-P3ï¼ˆéç´§æ€¥ï¼Œé€æ­¥å®ç°ï¼‰
