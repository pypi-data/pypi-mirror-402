Metadata-Version: 2.1
Name: nonebot-plugin-internet-outage
Version: 0.1.4
Summary: NoneBot2 plugin for monitoring global internet outages based on Cloudflare Radar
Author-Email: CN171-1 <CN171_11_@outlook.com>
License: MIT
Project-URL: Homepage, https://github.com/CN171-1/nonebot-plugin-internet-outage
Project-URL: Repository, https://github.com/CN171-1/nonebot-plugin-internet-outage
Requires-Python: >=3.9
Requires-Dist: nonebot2<3.0.0,>=2.3.0
Requires-Dist: nonebot-adapter-onebot>=2.1.5
Requires-Dist: nonebot-plugin-apscheduler>=0.2.0
Requires-Dist: nonebot-plugin-localstore>=0.6.0
Requires-Dist: httpx>=0.28.0
Description-Content-Type: text/markdown

# nonebot-plugin-internet-outage

## æè¿°

ä¸€ä¸ªåŸºäº NoneBot2 çš„æ’ä»¶ï¼Œç”¨äºå®šæ—¶è·å– Cloudflare Radar çš„å…¨çƒäº’è”ç½‘ä¸­æ–­äº‹ä»¶æ•°æ®ï¼Œå¹¶åœ¨æŒ‡å®šçš„ç¾¤ç»„å†…å‘é€æ¶ˆæ¯é€šçŸ¥ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

* å®šæ—¶ä» **Cloudflare Radar API** è·å–å…¨çƒç½‘ç»œäº‹ä»¶æ•°æ®
* åŒæ—¶ç›‘æµ‹ï¼š

  * **æµé‡å¼‚å¸¸ï¼ˆTraffic Anomalyï¼‰**
  * **å·²ç¡®è®¤ä¸­æ–­ï¼ˆOutage Annotationï¼‰**
* è‡ªåŠ¨åŒºåˆ†å¹¶æ¨é€ä»¥ä¸‹å››ç§æƒ…å†µï¼š

  1. **ä»…æµé‡å¼‚å¸¸**
  2. **ä»…å·²ç¡®è®¤ä¸­æ–­**
  3. **æµé‡å¼‚å¸¸ + å·²ç¡®è®¤ä¸­æ–­ï¼ˆåŒæ—¶å­˜åœ¨ï¼‰**
  4. **æµé‡å¼‚å¸¸ â†’ åæœŸå‡çº§ä¸ºå·²ç¡®è®¤ä¸­æ–­**
* å‡çº§äº‹ä»¶ä¼š **é‡æ–°æ¨é€ä¸€æ¬¡**ï¼Œé¿å…ä¿¡æ¯é—æ¼

## å®‰è£…

<details>
<summary>ä½¿ç”¨ nb-cli å®‰è£…</summary>
åœ¨ nonebot2 é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯å®‰è£…

```bash
nb plugin install nonebot-plugin-internet-outage
```

</details>

<details>
<summary>ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…</summary>
åœ¨ nonebot2 é¡¹ç›®çš„æ’ä»¶ç›®å½•ä¸‹ï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œæ ¹æ®ä½ ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ï¼Œè¾“å…¥ç›¸åº”çš„å®‰è£…å‘½ä»¤

<details>
<summary>pip</summary>

```bash
pip install nonebot-plugin-internet-outage
```
</details>
<details>
<summary>pdm</summary>

```bash
pdm add nonebot-plugin-internet-outage
```
</details>
<details>
<summary>poetry</summary>

```bash
poetry add nonebot-plugin-internet-outage
```
</details>

æ‰“å¼€ nonebot2 é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `pyproject.toml` æ–‡ä»¶ï¼Œåœ¨ `[tool.nonebot]` éƒ¨åˆ†è¿½åŠ å†™å…¥

```toml
plugins = ["nonebot-plugin-internet-outage"]
```

</details>

## ä¾èµ–æ’ä»¶

æœ¬æ’ä»¶éœ€è¦ä»¥ä¸‹ä¾èµ–æ’ä»¶ï¼š
- `nonebot_plugin_apscheduler`ï¼šç”¨äºå®šæ—¶ä»»åŠ¡è°ƒåº¦
- `nonebot_plugin_localstore`ï¼šç”¨äºæœ¬åœ°æ•°æ®å­˜å‚¨

## é…ç½®é¡¹

åœ¨ NoneBot2 é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `.env`ã€`.env.prod`ï¼‰ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `outage_cf_token` | `str` | æ—  |  Cloudflare API Tokenï¼ˆå¿…å¡«ï¼‰ |
| `outage_group_id` | `list[int \| str]` | `[]` | æ¥æ”¶é€šçŸ¥çš„ç¾¤å·åˆ—è¡¨ |
| `outage_proxies` | `str` | `None` | HTTP ä»£ç†åœ°å€ï¼ˆå¯é€‰ï¼‰ |
| `outage_debug` | `bool` | `False` | è°ƒè¯•æ¨¡å¼ |

## Cloudflare API Token æƒé™è¯´æ˜

ä½ éœ€è¦åœ¨ Cloudflare æ§åˆ¶å°åˆ›å»ºä¸€ä¸ª **API Token**ï¼Œå¹¶è‡³å°‘å¯ç”¨ä»¥ä¸‹æƒé™ï¼š

* **Account â†’ Radar â†’ Read**

è¯¥æ’ä»¶ä»…ä½¿ç”¨ Radar æ•°æ®ï¼Œä¸æ¶‰åŠä»»ä½•è´¦å·å†™å…¥æ“ä½œã€‚

### é…ç½®ç¤ºä¾‹

```ini
# åœ¨ .env æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®
outage_cf_token="your_cloudflare_api_token_here"
outage_group_id=[123456789, 987654321]
outage_proxies="http://127.0.0.1:7890"  # å¯é€‰
outage_debug=false
```

## æ¶ˆæ¯ç¤ºä¾‹

### ç¡®è®¤ä¸­æ–­äº‹ä»¶
```
ğŸŒ äº’è”ç½‘ä¸­æ–­äº‹ä»¶

ğŸ“ å›½å®¶ï¼šæ—¥æœ¬
ğŸ•’ å¼€å§‹æ—¶é—´ï¼š2025-12-01T08:30:00Z UTC
ğŸ“¡ å½±å“èŒƒå›´ï¼šå…¨å›½çº§ä¸­æ–­
âš ï¸ åŸå› ï¼šå…‰ç¼†æ–­è£‚

ğŸ“ è¯´æ˜ï¼š
æ—¥æœ¬éƒ¨åˆ†åŒºåŸŸå‘ç”Ÿæµ·åº•å…‰ç¼†æ–­è£‚ï¼Œå¯¼è‡´å…¨å›½èŒƒå›´å†…äº’è”ç½‘æœåŠ¡ä¸­æ–­...

ğŸ”— æ¥æºï¼š
https://radar.cloudflare.com/...
```

### æµé‡å¼‚å¸¸äº‹ä»¶
```
âš ï¸ äº’è”ç½‘æµé‡å¼‚å¸¸

ğŸ“ å›½å®¶ï¼šç¾å›½
ğŸ•’ å¼€å§‹æ—¶é—´ï¼š2025-12-01T10:15:00Z UTC
ğŸ’¡ å¤‡æ³¨ï¼šè¯¥äº‹ä»¶ä¸ºæµé‡å¼‚å¸¸ï¼Œå°šæœªç¡®è®¤ä¸­æ–­ã€‚
```

## å·¥ä½œæœºåˆ¶

1. **æ•°æ®è·å–**ï¼šæ¯10åˆ†é’Ÿä» Cloudflare Radar API è·å–æœ€è¿‘7å¤©çš„æµé‡å¼‚å¸¸å’Œä¸­æ–­äº‹ä»¶æ•°æ®
2. **äº‹ä»¶åŒ¹é…**ï¼šå°è¯•å°†æµé‡å¼‚å¸¸ä¸ä¸­æ–­äº‹ä»¶è¿›è¡Œæ—¶é—´å…³è”ï¼ˆÂ±15åˆ†é’Ÿï¼‰
3. **çŠ¶æ€å¤„ç†**ï¼š
   - æ–°æµé‡å¼‚å¸¸ â†’ å‘é€å¼‚å¸¸é€šçŸ¥
   - æ–°ç¡®è®¤ä¸­æ–­ â†’ å‘é€ä¸­æ–­é€šçŸ¥
   - å·²å­˜åœ¨çš„å¼‚å¸¸åŒ¹é…åˆ°ä¸­æ–­ â†’ æ›´æ–°ä¸ºä¸­æ–­é€šçŸ¥
4. **é¿å…é‡å¤**ï¼šä½¿ç”¨æœ¬åœ°å­˜å‚¨è®°å½•å·²å¤„ç†çš„äº‹ä»¶UUIDï¼Œé¿å…é‡å¤æ¨é€

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ— æ³•è·å–æ•°æ®**
   - æ£€æŸ¥ `outage_cf_token` æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œå¦‚æœ‰éœ€è¦é…ç½®ä»£ç†
   - æŸ¥çœ‹ NoneBot æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

2. **æœªæ”¶åˆ°æ¨é€**
   - æ£€æŸ¥ `outage_group_id` æ˜¯å¦æ­£ç¡®é…ç½®
   - ç¡®è®¤æœºå™¨äººå·²åŠ å…¥ç›®æ ‡ç¾¤ç»„
   - æ£€æŸ¥æ˜¯å¦æœ‰æƒé™åœ¨ç¾¤ç»„ä¸­å‘é€æ¶ˆæ¯

3. **é‡å¤æ¨é€**
   - æ£€æŸ¥æœ¬åœ°å­˜å‚¨æ–‡ä»¶æ˜¯å¦æŸåï¼ˆä½äºæ’ä»¶æ•°æ®ç›®å½•ï¼‰
   - å¯å°è¯•åˆ é™¤å­˜å‚¨æ–‡ä»¶é‡æ–°å¼€å§‹

## é¸£è°¢

- [Cloudflare Radar](https://radar.cloudflare.com/) - æä¾›å…¨çƒäº’è”ç½‘ä¸­æ–­æ•°æ®
- [nonebot-plugin-apscheduler](https://github.com/nonebot/plugin-apscheduler) - NoneBot çš„å®šæ—¶ä»»åŠ¡æ’ä»¶
- [nonebot-plugin-localstore](https://github.com/nonebot/plugin-localstore) - NoneBot çš„æœ¬åœ°æ•°æ®å­˜å‚¨æ’ä»¶

## è®¸å¯è¯

MIT License
