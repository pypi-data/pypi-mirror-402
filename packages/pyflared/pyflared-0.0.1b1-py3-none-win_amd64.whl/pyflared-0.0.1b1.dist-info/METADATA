Metadata-Version: 2.4
Name: pyflared
Version: 0.0.1b1
Summary: A Python wrapper for Cloudflare Tunnel (cloudflared)
Project-URL: Documentation, https://github.com/Azmain/pyflared#readme
Project-URL: Issues, https://github.com/Azmain/pyflared/issues
Project-URL: Source, https://github.com/Azmain/pyflared
Author-email: Azmain <azmainmahatab012@gmail.com>
License-Expression: MIT
License-File: LICENSE.txt
Classifier: Development Status :: 4 - Beta
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: Implementation :: CPython
Classifier: Programming Language :: Python :: Implementation :: PyPy
Requires-Python: >=3.12
Requires-Dist: aiostream
Requires-Dist: beartype
Requires-Dist: cloudflare
Requires-Dist: loguru
Requires-Dist: platformdirs
Requires-Dist: pydantic
Requires-Dist: pydantic-settings
Requires-Dist: rich
Requires-Dist: typer
Description-Content-Type: text/markdown

<p align="center">
  <h1 align="center">pyflared</h1>
  <p align="center">
    <strong>A Python CLI tool for effortless Cloudflare Tunnel management</strong>
  </p>
  <p align="center">
    <a href="https://pypi.org/project/pyflared"><img src="https://img.shields.io/pypi/v/pyflared.svg?style=flat-square" alt="PyPI - Version"></a>
    <a href="https://pypi.org/project/pyflared"><img src="https://img.shields.io/pypi/pyversions/pyflared.svg?style=flat-square" alt="PyPI - Python Version"></a>
    <a href="https://github.com/Azmain/pyflared/blob/main/LICENSE.txt"><img src="https://img.shields.io/github/license/Azmain/pyflared?style=flat-square" alt="License"></a>
  </p>
</p>

---

**pyflared** wraps the official `cloudflared` binary and the Cloudflare API to provide a seamless CLI experience for
creating and managing Cloudflare Tunnels. No more manual token juggling or complex configurationsâ€”just simple commands
to expose your local services to the internet.

## âœ¨ Features

- ğŸš€ **Quick Tunnels** â€” Spin up instant, temporary public URLs for local services with a single command
- ğŸ”— **DNS-Mapped Tunnels** â€” Create persistent tunnels with automatic DNS record management
- ğŸ§¹ **Automatic Cleanup** â€” Orphan tunnel and stale DNS record detection & removal
- ğŸ“¦ **Batteries Included** â€” Bundles the `cloudflared` binary, no separate installation required
- ğŸ³ **Docker Ready** â€” Run as a container with minimal setup
- ğŸ” **Secure by Design** â€” API tokens are never logged or exposed; uses Pydantic's `SecretStr`

## ğŸ“¦ Installation

### Using `uv` (Recommended)

```console
uv tool install pyflared
```

### Using `pip`

```console
pip install pyflared
```

### Using Docker

```console
docker pull ghcr.io/azmain/pyflared:latest
docker run --rm ghcr.io/azmain/pyflared --help
```

## ğŸš€ Quick Start

### Create a Quick Tunnel

Expose a local service instantly with a temporary `trycloudflare.com` URL:

```console
pyflared tunnel quick 8000
```

This creates a public URL (e.g., `https://random-name.trycloudflare.com`) pointing to `localhost:8000`.

### Create a DNS-Mapped Tunnel

Create a persistent tunnel with your own domain:

```console
pyflared tunnel mapped api.example.com=localhost:8000 web.example.com=localhost:3000
```

This will:

1. Create a new Cloudflare Tunnel
2. Configure DNS records for your domains
3. Route traffic to your local services

> **Note:** Requires a Cloudflare API token with tunnel and DNS permissions. Set via `CLOUDFLARE_API_TOKEN` environment
> variable or enter when prompted.

### Cleanup Orphan Tunnels

Remove stale tunnels and DNS records created by pyflared:

```console
pyflared tunnel cleanup
```

## ğŸ“– Usage

```
pyflared --help
```

### Commands

| Command                             | Description                              |
|-------------------------------------|------------------------------------------|
| `pyflared version`                  | Show the bundled cloudflared version     |
| `pyflared tunnel quick <service>`   | Create a quick tunnel to a local service |
| `pyflared tunnel mapped <pairs...>` | Create DNS-mapped tunnel(s)              |
| `pyflared tunnel cleanup`           | Remove orphan tunnels and DNS records    |

### Options

| Option                  | Description                                    |
|-------------------------|------------------------------------------------|
| `--verbose, -v`         | Show detailed cloudflared logs                 |
| `--remove-orphans, -ro` | Remove orphan tunnels before creating new ones |
| `--tunnel-name`         | Specify a custom tunnel name                   |

## ğŸ”§ Configuration

### Environment Variables

| Variable               | Description                                     |
|------------------------|-------------------------------------------------|
| `CLOUDFLARE_API_TOKEN` | Your Cloudflare API token for tunnel management |

### API Token Permissions

For DNS-mapped tunnels, your API token needs the following permissions:

- **Account** > **Cloudflare Tunnel** > **Edit**
- **Zone** > **DNS** > **Edit**
- **Zone** > **Zone** > **Read**

## ğŸ› ï¸ Development

### Prerequisites

- Python 3.12+
- [Hatch](https://hatch.pypa.io/)

### Setup

```console
git clone https://github.com/Azmain/pyflared.git
cd pyflared
hatch env create
```

### Running Tests

```console
hatch test
```

### Type Checking

```console
hatch run types:check
```

### Building

```console
hatch build
```

## ğŸ—ï¸ Architecture

```
pyflared/
â”œâ”€â”€ cli.py           # Typer CLI application
â”œâ”€â”€ _commands.py     # Core tunnel command wrappers
â”œâ”€â”€ api_sdk/         # Cloudflare API integration
â”‚   â””â”€â”€ tunnel_manager.py  # Tunnel & DNS management
â”œâ”€â”€ binary/          # cloudflared binary handling
â”‚   â”œâ”€â”€ binary_decorator.py
â”‚   â””â”€â”€ process.py   # Async subprocess management
â”œâ”€â”€ log/             # Logging configuration
â”œâ”€â”€ shared/          # Shared types and utilities
â””â”€â”€ utils/           # Helper utilities
```

## ğŸ“„ License

`pyflared` is distributed under the terms of the [MIT](https://spdx.org/licenses/MIT.html) license.

## ğŸ™ Acknowledgments

- [cloudflared](https://github.com/cloudflare/cloudflared) â€” The official Cloudflare Tunnel client
- [Typer](https://typer.tiangolo.com/) â€” CLI framework
- [Cloudflare Python SDK](https://github.com/cloudflare/cloudflare-python) â€” Official API client

---

<p align="center">
  Made with â¤ï¸ by <a href="https://github.com/Azmain">Azmain</a>
</p>
