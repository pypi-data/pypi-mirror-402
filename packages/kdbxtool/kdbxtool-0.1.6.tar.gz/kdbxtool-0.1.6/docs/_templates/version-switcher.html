<div class="version-switcher">
  <select id="version-select" onchange="if(this.value) window.location.href=this.value">
    <option value="" disabled selected>Loading...</option>
  </select>
</div>

<script>
(function() {
  // Determine current version from URL path
  const path = window.location.pathname;
  const match = path.match(/\/kdbxtool\/([^\/]+)\//);
  const currentVersion = match ? match[1] : 'latest';

  // Fetch versions.json from site root
  const baseUrl = window.location.origin + '/kdbxtool';
  fetch(baseUrl + '/versions.json')
    .then(response => response.json())
    .then(versions => {
      const select = document.getElementById('version-select');
      select.innerHTML = '';

      versions.forEach(v => {
        const option = document.createElement('option');
        option.value = baseUrl + '/' + v.version + '/';
        option.textContent = v.name;
        if (v.version === currentVersion) {
          option.selected = true;
        }
        select.appendChild(option);
      });
    })
    .catch(() => {
      // Fallback if versions.json fails to load
      const select = document.getElementById('version-select');
      select.innerHTML = '<option selected>latest</option>';
    });
})();
</script>

<style>
.version-switcher {
  padding: 0 var(--sidebar-item-spacing-horizontal);
  margin-bottom: 1em;
}
.version-switcher select {
  width: 100%;
  padding: 0.5em;
  border: 1px solid var(--color-sidebar-link-text);
  background: var(--color-sidebar-background);
  color: var(--color-sidebar-link-text);
  border-radius: 4px;
  cursor: pointer;
}
</style>
