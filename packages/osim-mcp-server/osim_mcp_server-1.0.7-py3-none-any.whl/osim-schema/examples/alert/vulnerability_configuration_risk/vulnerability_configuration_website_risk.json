{
  "group": "alert",
  "category": "vulnerability_configuration_risk",
  "title": "website_vulnerability_risk",
  "label": "Website Vulnerability Risk",
  "description": "Alerts indicating potential security risks due to misconfigurations or vulnerabilities in web applications.",
  "dataSource": [
    "Vulnerability Scanner"
  ],
  "definitions": {
    "startTime": {
      "example": "2023-10-26 14:32:18"
    },
    "endTime": {
      "example": "2023-10-26 14:32:48"
    },
    "deviceReceiptTime": {
      "example": "2023-10-26 14:32:20"
    },
    "destHostName": {
      "example": "webserver01.company.local"
    },
    "requestMethod": {
      "example": "POST"
    },
    "requestUrlQuery": {
      "example": "/admin/login.php?username=admin&password=123456&redirect=%2Fdashboard"
    },
    "requestUrl": {
      "example": "/admin/login.php"
    },
    "requestHeader": {
      "example": "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36\nHost: webserver01.company.local\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Language: en-US,en;q=0.9\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 67\nCache-Control: max-age=0\nOrigin: https://webserver01.company.local\nReferer: https://webserver01.company.local/admin/\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1"
    },
    "requestBody": {
      "example": "username=admin&password=123456&redirect=%2Fdashboard"
    },
    "requestCookies": {
      "example": "sessionId=abc123def456; userId=789; csrfToken=xyz789abc456; language=en_US; theme=dark; lastVisit=2023-10-26T14:30:00Z"
    },
    "httpReferer": {
      "example": "https://webserver01.company.local/admin/"
    },
    "userAgent": {
      "example": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36"
    },
    "requestContentType": {
      "example": "application/x-www-form-urlencoded"
    },
    "responseHeader": {
      "example": "HTTP/1.1 200 OK\nDate: Thu, 26 Oct 2023 14:32:48 GMT\nServer: Apache/2.4.41 (Ubuntu)\nContent-Type: text/html; charset=UTF-8\nContent-Length: 1245\nConnection: keep-alive\nSet-Cookie: sessionId=ghi789jkl012; Path=/; HttpOnly; Secure\nX-Powered-By: PHP/7.4.3\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains"
    },
    "responseBody": {
      "example": "en"
    },
    "responseContentType": {
      "example": "text/html; charset=UTF-8"
    },
    "cve": {
      "example": "CVE-2021-44228"
    },
    "cvssVector": {
      "example": "AV:N/AC:L/Au:N/C:P/I:P/A:P"
    },
    "cncve": {
      "example": "CNCVE-2021-001234"
    },
    "cnvd": {
      "example": "CNVD-2021-123456"
    },
    "cnnvd": {
      "example": "CNNVD-2021-001234"
    },
    "webServerSoftware": {
      "example": "Apache/2.4.41"
    },
    "machineCode": {
      "example": "WS-APACHE-01"
    },
    "productVendorName": {
      "example": "Tenable, Inc."
    },
    "deviceSendProductName": {
      "example": "Tenable Vulnerability Management"
    },
    "deviceName": {
      "example": "webserver01.company.local"
    },
    "deviceAddress": {
      "example": "192.168.10.5"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "Web Application Vulnerability Alert - Authentication Bypass Attempt"
    },
    "message": {
      "example": "Potential authentication bypass attempt detected via insecure direct object reference (IDOR) in admin login endpoint. POST request to /admin/login.php contained plaintext credentials and redirect parameter manipulation. Vulnerability CVE-2021-44228 (Log4Shell) may be exploitable on target Apache/2.4.41 server."
    },
    "collectorReceiptTime": {
      "example": "2023-10-26 14:32:50"
    },
    "severity": {
      "example": "medium"
    },
    "catOutcome": {
      "example": "Attempt"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "access"
    },
    "dataSourceAddress": {
      "example": "192.168.10.100"
    },
    "deviceVersion": {
      "example": "Apache/2.4.41 (Ubuntu)"
    },
    "subTechniqueId": {
      "example": "T1190"
    },
    "techniqueName": {
      "example": "Exploit Public-Facing Application"
    },
    "techniqueId": {
      "example": "T1190"
    },
    "tacticName": {
      "example": "Initial Access"
    },
    "tacticId": {
      "example": "TA0001"
    },
    "killChain": {
      "example": "KC_Exploitation"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "WEB-VULN-AUTH-BYPASS-001"
    },
    "ruleType": {
      "example": "/WebAttack/InfoLeak"
    },
    "ruleName": {
      "example": "Web Application Authentication Bypass Attempt Detection"
    },
    "subTechniqueName": {
      "example": "Exploit Public-Facing Application"
    },
    "suggestion": {
      "example": "1. Immediately patch the affected Apache server to version 2.4.56 or later to address CVE-2021-44228.\n2. Implement strong input validation and sanitization on the /admin/login.php endpoint, particularly for the `redirect` parameter, to prevent IDOR attacks.\n3. Enforce HTTPS and HSTS across the entire application. Ensure the `Strict-Transport-Security` header is correctly configured.\n4. Review and strengthen authentication mechanisms. Consider implementing multi-factor authentication (MFA) for the admin interface.\n5. Disable detailed error messages in production environments to prevent information leakage.\n6. Conduct a thorough code review of the login functionality to identify and remediate other potential authentication bypass vectors.\n7. Update the web application framework (PHP) to a supported, non-vulnerable version.\n8. Monitor logs for similar suspicious POST requests to administrative endpoints."
    },
    "affectAssetIp": {
      "example": "192.168.10.5"
    },
    "vulName": {
      "example": "Apache Log4j2 Remote Code Execution Vulnerability (Log4Shell)"
    },
    "vulDescription": {
      "example": "The target Apache/2.4.41 server is vulnerable to CVE-2021-44228 (Log4Shell), a critical remote code execution vulnerability in the Apache Log4j2 library. This vulnerability allows an unauthenticated remote attacker to execute arbitrary code on the target system by sending a specially crafted request that triggers JNDI lookups, potentially leading to full system compromise. The observed POST request to `/admin/login.php` with plaintext credentials and parameter manipulation indicates an active exploitation attempt, which could be used to bypass authentication and gain unauthorized access to the administrative interface. The risk includes data theft, lateral movement within the network, and deployment of ransomware or other malware. The CVSS vector AV:N/AC:L/Au:N/C:P/I:P/A:P confirms the high attack complexity and impact on confidentiality, integrity, and availability."
    },
    "vulPublicTime": {
      "example": "2021-12-09 00:00:00"
    },
    "osName": {
      "example": "Ubuntu 20.04.6 LTS"
    },
    "osType": {
      "example": "Linux"
    },
    "osVersion": {
      "example": "20.04.6"
    }
  }
}