{
  "group": "alert",
  "category": "network_attack",
  "title": "host_exploit",
  "label": "Host Exploit",
  "description": "Monitors and alerts on network-based exploitation attempts targeting vulnerabilities in host systems.",
  "dataSource": [
    "Endpoint Detection And Response System",
    "Network Detection and Response"
  ],
  "definitions": {
    "processUserName": {
      "example": "root"
    },
    "image": {
      "example": "/usr/bin/nginx"
    },
    "parentProcessUserName": {
      "example": "root"
    },
    "parentImage": {
      "example": "/usr/bin/bash"
    },
    "startTime": {
      "example": "2023-08-15 12:21:00"
    },
    "endTime": {
      "example": "2023-08-15 12:21:05"
    },
    "deviceReceiptTime": {
      "example": "2023-08-15 12:21:03"
    },
    "processStartTime": {
      "example": "2023-08-15 12:20:58"
    },
    "parentProcessStartTime": {
      "example": "2023-08-15 12:20:55"
    },
    "processName": {
      "example": "nginx"
    },
    "parentProcessName": {
      "example": "bash"
    },
    "vulName": {
      "example": "CVE-2021-23017"
    },
    "vulOrg": {
      "example": "Nginx, Inc."
    },
    "vulCode": {
      "example": "CNVD-2021-12345"
    },
    "vulDescription": {
      "example": "CVE-2021-23017 affects Nginx resolver, allowing an attacker to cause a worker process crash or achieve remote code execution by sending specially crafted DNS responses, leading to a buffer overflow in the ngx_resolver_copy function."
    },
    "vulDetector": {
      "example": "Tenable Research"
    },
    "processMd5": {
      "example": "a1b2c3d4e5f67890123456789abcdef0"
    },
    "parentProcessMd5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "processChain": {
      "example": "/usr/bin/bash -> /usr/bin/nginx"
    },
    "commandLine": {
      "example": "daemon off; master_process on;"
    },
    "parentCommandLine": {
      "example": "daemon off; master_process on;"
    },
    "md5": {
      "example": "a1b2c3d4e5f67890123456789abcdef0"
    },
    "cve": {
      "example": "CVE-2021-23017"
    },
    "hostName": {
      "example": "webserver-01.example.com"
    },
    "machineCode": {
      "example": "webserver-01-7A3B9F2C"
    },
    "productVendorName": {
      "example": "Tenable, Inc."
    },
    "deviceSendProductName": {
      "example": "Tenable SecurityCenter"
    },
    "deviceName": {
      "example": "webserver-01"
    },
    "deviceAddress": {
      "example": "192.168.1.100"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "Exploitation Attempt Detected on webserver-01 via Nginx CVE-2021-23017"
    },
    "message": {
      "example": "Detected potential exploitation attempt targeting CVE-2021-23017 on host webserver-01 (192.168.1.100). The nginx process (PID: 12345, MD5: a1b2c3d4e5f67890123456789abcdef0), spawned by bash, processed a malicious DNS response that triggered a buffer overflow condition in the ngx_resolver_copy function. The attempt occurred between 2023-08-15 12:21:00 and 2023-08-15 12:21:05. This activity matches known exploit patterns for this vulnerability and may indicate an attempt to achieve remote code execution or cause a denial of service."
    },
    "collectorReceiptTime": {
      "example": "2023-08-15 12:21:06"
    },
    "catOutcome": {
      "example": "Attempt"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "execute"
    },
    "XFF": {
      "example": "203.0.113.195, 198.51.100.23, 192.168.1.150"
    },
    "srcMacAddress": {
      "example": "00:1A:2B:3C:4D:5E"
    },
    "destMacAddress": {
      "example": "00:0C:29:8B:13:6F"
    },
    "srcGeoCountry": {
      "example": "United States"
    },
    "srcGeoRegion": {
      "example": "California"
    },
    "srcGeoCity": {
      "example": "San Francisco"
    },
    "srcGeoAddress": {
      "example": "123 Main Street, San Francisco, CA 94105, United States"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "San Jose"
    },
    "destGeoAddress": {
      "example": "1600 Amphitheatre Parkway, Mountain View, CA 94043, United States"
    },
    "dataSourceAddress": {
      "example": "192.168.1.100"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "http"
    },
    "dvcAction": {
      "example": "blocked"
    },
    "direction": {
      "example": "01"
    },
    "deviceVersion": {
      "example": "nginx/1.18.0 (Ubuntu)"
    },
    "srcAddress": {
      "example": "203.0.113.195"
    },
    "destAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueId": {
      "example": "T1595.002"
    },
    "techniqueName": {
      "example": "Active Scanning"
    },
    "techniqueId": {
      "example": "T1595"
    },
    "tacticName": {
      "example": "Initial Access"
    },
    "tacticId": {
      "example": "TA0001"
    },
    "killChain": {
      "example": "KC_Exploitation"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "TENABLE-HOST-EXPLOIT-2021-23017"
    },
    "ruleType": {
      "example": "/Exploit/SystemVul"
    },
    "ruleName": {
      "example": "Exploitation Attempt Detected: Nginx CVE-2021-23017 Buffer Overflow"
    },
    "attackerAddress": {
      "example": "203.0.113.195"
    },
    "victimAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueName": {
      "example": "Vulnerability Scanning"
    },
    "suggestion": {
      "example": "Isolate the affected host (webserver-01) from the network. Immediately patch Nginx to version 1.20.1 or later, or apply the vendor-provided patch for CVE-2021-23017. Restrict DNS resolver queries to trusted internal DNS servers only. Review firewall rules to block inbound traffic from source IP 203.0.113.195. Investigate the bash process (PID: parent) for signs of persistence or lateral movement. Perform a full malware scan on the host using updated signatures."
    },
    "hostAddress": {
      "example": "192.168.1.100"
    },
    "integrityLevel": {
      "example": "Medium"
    },
    "processGuid": {
      "example": "{550e8400-e29b-41d4-a716-446655440001}"
    },
    "parentProcessGuid": {
      "example": "{550e8400-e29b-41d4-a716-446655440000}"
    }
  }
}