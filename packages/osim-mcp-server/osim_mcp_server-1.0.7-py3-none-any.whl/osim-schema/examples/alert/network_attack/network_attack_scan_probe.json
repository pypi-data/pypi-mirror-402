{
  "group": "alert",
  "category": "network_attack",
  "title": "scan_probe",
  "label": "Scan Probe",
  "description": "Records network scanning and probing activities, typically involving port scans, service discovery, or vulnerability assessment attempts.",
  "dataSource": [
    "Endpoint Detection And Response System",
    "Honeypot System",
    "Network Detection and Response"
  ],
  "definitions": {
    "startTime": {
      "example": "2023-10-26 14:32:18"
    },
    "endTime": {
      "example": "2023-10-26 14:32:48"
    },
    "deviceReceiptTime": {
      "example": "2023-10-26 14:32:20"
    },
    "scanPortList": {
      "example": "80,443,22,3389,8080"
    },
    "scanIpList": {
      "example": "192.168.1.10,10.0.0.5,172.16.254.3"
    },
    "destHostName": {
      "example": "webserver-01.prod.example.com"
    },
    "requestMethod": {
      "example": "GET"
    },
    "requestUrlQuery": {
      "example": "/index.php?action=login&username=admin&password=test123"
    },
    "requestUrl": {
      "example": "/index.php"
    },
    "requestHeader": {
      "example": "User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)\nHost: webserver-01.prod.example.com\nAccept: */*\nConnection: keep-alive\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9"
    },
    "requestBody": {
      "example": "username=admin&password=test123&action=login"
    },
    "requestCookies": {
      "example": "session_id=abc123def456; csrf_token=xyz789; user_pref=dark_mode"
    },
    "httpReferer": {
      "example": "http://scanner-tool.example.net/scan_results.php?target=webserver-01.prod.example.com"
    },
    "userAgent": {
      "example": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
    },
    "requestContentType": {
      "example": "application/x-www-form-urlencoded"
    },
    "responseHeader": {
      "example": "HTTP/1.1 200 OK\nDate: Thu, 26 Oct 2023 14:32:18 GMT\nServer: Apache/2.4.41 (Ubuntu)\nContent-Type: text/html; charset=UTF-8\nContent-Length: 1256\nConnection: close\nX-Powered-By: PHP/7.4.3\nSet-Cookie: PHPSESSID=s2c8v7q5m9p1r3t6; path=/; HttpOnly\nCache-Control: no-cache, must-revalidate\nExpires: 0"
    },
    "responseBody": {
      "example": "en"
    },
    "responseContentType": {
      "example": "text/html; charset=UTF-8"
    },
    "machineCode": {
      "example": "IDP-SENSOR-01-ALPHA"
    },
    "productVendorName": {
      "example": "Cisco"
    },
    "deviceSendProductName": {
      "example": "Cisco Firepower Threat Defense"
    },
    "deviceName": {
      "example": "FW-PROD-IPS-01"
    },
    "deviceAddress": {
      "example": "192.168.100.1"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "Network Scanning Activity Detected: Port Scan and Service Probe on webserver-01.prod.example.com"
    },
    "message": {
      "example": "Detected potential network scanning activity from source IP 192.168.1.10 targeting host webserver-01.prod.example.com. The scan occurred between 2023-10-26 14:32:18 and 2023-10-26 14:32:48, involving multiple ports (80,443,22,3389,8080) and IP addresses (192.168.1.10,10.0.0.5,172.16.254.3). The activity included HTTP GET requests to /index.php with parameters indicative of a login attempt and service probe. The request used a User-Agent associated with the Nmap Scripting Engine. The target server responded with HTTP 200 OK. This event was detected by Cisco Firepower Threat Defense device FW-PROD-IPS-01 (192.168.100.1)."
    },
    "collectorReceiptTime": {
      "example": "2023-10-26 14:33:05"
    },
    "catOutcome": {
      "example": "Attempt"
    },
    "logType": {
      "example": "traffic"
    },
    "opType": {
      "example": "connect"
    },
    "XFF": {
      "example": "192.168.1.10"
    },
    "srcMacAddress": {
      "example": "00:1A:2B:3C:4D:5E"
    },
    "destMacAddress": {
      "example": "00:0C:29:8F:1A:2B"
    },
    "srcGeoCountry": {
      "example": "United States"
    },
    "srcGeoRegion": {
      "example": "California"
    },
    "srcGeoCity": {
      "example": "San Jose"
    },
    "srcGeoAddress": {
      "example": "95113, 1735 North 1st Street, San Jose, California, United States"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "San Jose"
    },
    "destGeoAddress": {
      "example": "95113, 170 West Tasman Drive, San Jose, California, United States"
    },
    "dataSourceAddress": {
      "example": "192.168.100.1"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "http"
    },
    "dvcAction": {
      "example": "Blocked"
    },
    "direction": {
      "example": "01"
    },
    "deviceVersion": {
      "example": "7.2.1"
    },
    "srcAddress": {
      "example": "192.168.1.10"
    },
    "destAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueId": {
      "example": "T1046"
    },
    "techniqueName": {
      "example": "Network Discovery"
    },
    "techniqueId": {
      "example": "T1046"
    },
    "tacticName": {
      "example": "Reconnaissance"
    },
    "tacticId": {
      "example": "TA0007"
    },
    "killChain": {
      "example": "KC_Reconnaissance"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "IPS-ALERT-0001-SCAN-PROBE-20231026"
    },
    "ruleType": {
      "example": "/Scan/PortScan"
    },
    "ruleName": {
      "example": "IPS-ALERT-0001-SCAN-PROBE-20231026: Network Port Scan and Service Probe via HTTP"
    },
    "attackerAddress": {
      "example": "192.168.1.10"
    },
    "victimAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueName": {
      "example": "Network Service Discovery"
    },
    "suggestion": {
      "example": "Isolate the source IP 192.168.1.10 in the firewall, review and harden exposed services on ports 80, 443, 22, 3389, 8080 on the target host webserver-01.prod.example.com, and implement rate limiting or temporary blocking for repeated scanning patterns. Consider deploying deception technologies like honeypots."
    },
    "hostAddress": {
      "example": "192.168.1.100"
    },
    "hostName": {
      "example": "scanner-tool.example.net"
    },
    "httpVersion": {
      "example": "HTTP/1.1"
    }
  }
}