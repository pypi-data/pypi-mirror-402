{
  "group": "alert",
  "category": "malware",
  "title": "malicious_code_embedded_webpage",
  "label": "Malicious Code Embedded Webpage",
  "description": "Alerts indicating detection of malicious code embedded within a webpage, typically used to deliver malware or exploit vulnerabilities.",
  "dataSource": [
    "Network Detection and Response",
    "Web Application Firewall"
  ],
  "definitions": {
    "startTime": {
      "example": "2023-10-26 14:32:18"
    },
    "endTime": {
      "example": "2023-10-26 14:32:48"
    },
    "deviceReceiptTime": {
      "example": "2023-10-26 14:32:20"
    },
    "fileName": {
      "example": "malware_delivery.html"
    },
    "virusName": {
      "example": "Trojan.JS.Downloader.gen"
    },
    "payload": {
      "example": "<iframe src="
    },
    "destHostName": {
      "example": "www.malicious-downloads.com"
    },
    "requestUrlQuery": {
      "example": "/index.php?action=download&file=malware_delivery.html&id=12345"
    },
    "requestUrl": {
      "example": "/index.php"
    },
    "machineCode": {
      "example": "PC-7F3A9B2C"
    },
    "productVendorName": {
      "example": "CrowdStrike"
    },
    "deviceSendProductName": {
      "example": "CrowdStrike Falcon"
    },
    "deviceName": {
      "example": "WIN-PC-7F3A9B2C"
    },
    "deviceAddress": {
      "example": "192.168.1.105"
    },
    "eventId": {
      "example": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
    },
    "name": {
      "example": "Malicious Code Embedded in Webpage Detected: Trojan.JS.Downloader.gen on www.malicious-downloads.com"
    },
    "message": {
      "example": "malware_delivery.html"
    },
    "collectorReceiptTime": {
      "example": "2023-10-26 14:32:21"
    },
    "catOutcome": {
      "example": "Attempt"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "load"
    },
    "srcMacAddress": {
      "example": "00:1B:44:11:3A:E7"
    },
    "destMacAddress": {
      "example": "00:0C:29:5F:8B:13"
    },
    "srcGeoCountry": {
      "example": "Russia"
    },
    "srcGeoRegion": {
      "example": "Moscow Oblast"
    },
    "srcGeoCity": {
      "example": "Moscow"
    },
    "srcGeoAddress": {
      "example": "Moscow, Moscow Oblast, Russia"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "Los Angeles"
    },
    "destGeoAddress": {
      "example": "Los Angeles, California, United States"
    },
    "dataSourceAddress": {
      "example": "192.168.1.105"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "https"
    },
    "dvcAction": {
      "example": "blocked"
    },
    "direction": {
      "example": "01"
    },
    "deviceVersion": {
      "example": "Windows 10 Enterprise 10.0.19045 Build 19045"
    },
    "srcAddress": {
      "example": "192.168.1.105"
    },
    "destAddress": {
      "example": "203.0.113.45"
    },
    "subTechniqueId": {
      "example": "T1547.001"
    },
    "techniqueName": {
      "example": "Boot or Logon Autostart Execution"
    },
    "techniqueId": {
      "example": "T1547"
    },
    "tacticName": {
      "example": "Initial Access"
    },
    "tacticId": {
      "example": "TA0001"
    },
    "killChain": {
      "example": "KC_Delivery"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "CS-MALCODE-WEB-20231026-001"
    },
    "ruleType": {
      "example": "/WebAttack/XSS"
    },
    "ruleName": {
      "example": "CS-MALCODE-WEB-20231026-001: Drive-by Compromise via Malicious Webpage"
    },
    "attackerAddress": {
      "example": "203.0.113.45"
    },
    "victimAddress": {
      "example": "192.168.1.105"
    },
    "subTechniqueName": {
      "example": "Drive-by Compromise via Malicious Webpage"
    },
    "suggestion": {
      "example": "Isolate the infected host WIN-PC-7F3A9B2C (192.168.1.105) from the network. Scan the host for malware using updated antivirus definitions. Block the malicious domain www.malicious-downloads.com and IP address 203.0.113.45 at the perimeter firewall and DNS level. Clear the browser cache and temporary files on the affected host. Educate the user on safe browsing practices and phishing awareness."
    },
    "requestHeader": {
      "example": "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9,ru;q=0.8\nCache-Control: max-age=0\nConnection: keep-alive\nHost: www.malicious-downloads.com\nReferer: https://www.example.com/redirect.php\nUpgrade-Insecure-Requests: 1"
    },
    "requestMethod": {
      "example": "GET"
    },
    "userAgent": {
      "example": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36"
    }
  }
}