{
  "group": "alert",
  "category": "malware",
  "title": "trojan_horse",
  "label": "Trojan Horse",
  "description": "Alerts indicating the detection of Trojan malware, which disguises itself as legitimate software to perform malicious activities.",
  "dataSource": [
    "Antivirus",
    "Endpoint Detection And Response System",
    "Firewall",
    "Network Detection and Response"
  ],
  "definitions": {
    "filePath": {
      "example": "C:\\Program Files\\ImportantApp\\config\\secure_settings.ini"
    },
    "targetFilename": {
      "example": "secure_settings.ini"
    },
    "startTime": {
      "example": "2023-08-15 14:30:22"
    },
    "endTime": {
      "example": "2023-08-15 14:30:28"
    },
    "deviceReceiptTime": {
      "example": "2023-08-15 14:30:25"
    },
    "processUserName": {
      "example": "SYSTEM"
    },
    "parentProcessUserName": {
      "example": "Administrator"
    },
    "processStartTime": {
      "example": "2023-08-15 14:30:22"
    },
    "parentProcessStartTime": {
      "example": "2023-08-15 14:29:55"
    },
    "image": {
      "example": "C:\\Windows\\System32\\cmd.exe"
    },
    "parentImage": {
      "example": "C:\\Windows\\System32\\svchost.exe"
    },
    "fileName": {
      "example": "secure_settings.ini"
    },
    "processName": {
      "example": "cmd.exe"
    },
    "parentProcessName": {
      "example": "svchost.exe"
    },
    "md5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "sha256": {
      "example": "a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890"
    },
    "sm3": {
      "example": "6d6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a"
    },
    "virusName": {
      "example": "Trojan.Win32.Generic"
    },
    "virusFamily": {
      "example": "WannaCry"
    },
    "threatActorOrg": {
      "example": "APT28"
    },
    "requestDomain": {
      "example": "malware.suspicious-domain.cn"
    },
    "attackerAddress": {
      "example": "192.168.1.105"
    },
    "machineCode": {
      "example": "WS-SRV-001"
    },
    "productVendorName": {
      "example": "Microsoft"
    },
    "deviceSendProductName": {
      "example": "Windows Security Center"
    },
    "deviceName": {
      "example": "WIN-SRV-001"
    },
    "deviceAddress": {
      "example": "192.168.1.105"
    },
    "eventId": {
      "example": "e6a5b3d4-8f2c-4a7e-9b1d-3c8f9a2b1c5d"
    },
    "name": {
      "example": "Trojan.Win32.Generic Detected on WIN-SRV-001"
    },
    "message": {
      "example": "Trojan.Win32.Generic malware detected on WIN-SRV-001 (192.168.1.105). The process cmd.exe (as SYSTEM) was started by svchost.exe (as Administrator) and attempted to access/modify the file C:\\Program Files\\ImportantApp\\config\\secure_settings.ini. The file hash matches known malware signatures associated with the WannaCry family. The activity involved a suspicious DNS request to malware.suspicious-domain.cn. The detection was made by Windows Security Center."
    },
    "collectorReceiptTime": {
      "example": "2023-08-15 14:30:26"
    },
    "severity": {
      "example": "high"
    },
    "catOutcome": {
      "example": "Attempt"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "modify"
    },
    "srcMacAddress": {
      "example": "00:1A:2B:3C:4D:5E"
    },
    "destMacAddress": {
      "example": "00:0C:29:8F:1A:3B"
    },
    "srcGeoCountry": {
      "example": "China"
    },
    "srcGeoRegion": {
      "example": "Guangdong"
    },
    "srcGeoCity": {
      "example": "Guangzhou"
    },
    "srcGeoAddress": {
      "example": "广州市天河区黄埔大道西118号"
    },
    "destGeoCountry": {
      "example": "China"
    },
    "destGeoRegion": {
      "example": "Beijing"
    },
    "destGeoCity": {
      "example": "Beijing"
    },
    "destGeoAddress": {
      "example": "北京市海淀区中关村南大街5号"
    },
    "dataSourceAddress": {
      "example": "192.168.1.105"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "ftp"
    },
    "dvcAction": {
      "example": "quarantined"
    },
    "deviceVersion": {
      "example": "Windows 10 Pro 22H2 Build 19045.4529"
    },
    "srcAddress": {
      "example": "192.168.1.105"
    },
    "destAddress": {
      "example": "103.21.244.1"
    },
    "subTechniqueId": {
      "example": "T1547.001"
    },
    "techniqueName": {
      "example": "Boot or Logon Autostart Execution"
    },
    "techniqueId": {
      "example": "T1547"
    },
    "tacticName": {
      "example": "Persistence"
    },
    "tacticId": {
      "example": "TA0005"
    },
    "killChain": {
      "example": "KC_Exploitation"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "T1003.008"
    },
    "ruleType": {
      "example": "/Malware/Trojan"
    },
    "ruleName": {
      "example": "Trojan.Win32.Generic Detection via Suspicious File Modification"
    },
    "victimAddress": {
      "example": "192.168.1.105"
    },
    "subTechniqueName": {
      "example": "Registry Run Keys / Startup Folder"
    },
    "suggestion": {
      "example": "Isolate the infected host WIN-SRV-001 (192.168.1.105) from the network immediately. Terminate the malicious process cmd.exe (PID: 5678) and its parent svchost.exe (PID: 1234). Quarantine the malicious file C:\\Program Files\\ImportantApp\\config\\secure_settings.ini and delete its associated registry run key entries. Block all outbound connections to the malicious domain malware.suspicious-domain.cn and IP 103.21.244.1 at the firewall. Scan all systems for the WannaCry malware family using updated antivirus signatures. Reset credentials for the Administrator and SYSTEM accounts. Apply security patches for the relevant MITRE ATT&CK technique (T1547.001). Initiate a forensic investigation to determine the initial infection vector and scope of compromise."
    },
    "IoC": {
      "example": "md5:d41d8cd98f00b204e9800998ecf8427e;sha256:a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890;domain:malware.suspicious-domain.cn;ip:103.21.244.1"
    },
    "IoCType": {
      "example": "file"
    },
    "tiCategory": {
      "example": "/Malware"
    },
    "IoCLevel": {
      "example": "High"
    },
    "tiSubcategory": {
      "example": "/C2/Trojan"
    },
    "processMd5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "parentProcessMd5": {
      "example": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
    },
    "processChain": {
      "example": "System -> smss.exe -> csrss.exe -> wininit.exe -> services.exe -> svchost.exe -> cmd.exe"
    },
    "processGuid": {
      "example": "6a5b3d4-8f2c-4a7e-9b1d-3c8f9a2b1c5d"
    },
    "parentProcessGuid": {
      "example": "8f2c-4a7e-9b1d-3c8f9a2b1c5d"
    },
    "commandLine": {
      "example": "C:\\Program Files\\ImportantApp\\config\\secure_settings.ini"
    },
    "parentCommandLine": {
      "example": "svchost.exe -k netsvcs -p -s gpsvc"
    },
    "hostName": {
      "example": "WIN-SRV-001"
    },
    "hostAddress": {
      "example": "192.168.1.105"
    },
    "integrityLevel": {
      "example": "System"
    }
  }
}