{
  "group": "alert",
  "category": "malware",
  "title": "computer_virus",
  "label": "Computer Virus",
  "description": "This alert category monitors and records activities related to computer viruses, which are malicious programs designed to infect and damage systems or steal sensitive data.",
  "dataSource": [
    "Antivirus",
    "Endpoint Detection And Response System",
    "Firewall",
    "Network Detection and Response"
  ],
  "definitions": {
    "filePath": {
      "example": "C:\\Program Files\\ImportantApp\\config\\secure_settings.ini"
    },
    "targetFilename": {
      "example": "secure_settings.ini"
    },
    "startTime": {
      "example": "2023-08-15 14:30:22"
    },
    "endTime": {
      "example": "2023-08-15 14:30:28"
    },
    "deviceReceiptTime": {
      "example": "2023-08-15 14:30:25"
    },
    "processUserName": {
      "example": "SYSTEM"
    },
    "parentProcessUserName": {
      "example": "Administrator"
    },
    "processStartTime": {
      "example": "2023-08-15 14:30:22"
    },
    "parentProcessStartTime": {
      "example": "2023-08-15 14:29:55"
    },
    "image": {
      "example": "C:\\Windows\\System32\\cmd.exe"
    },
    "parentImage": {
      "example": "C:\\Windows\\System32\\svchost.exe"
    },
    "fileName": {
      "example": "secure_settings.ini"
    },
    "processName": {
      "example": "cmd.exe"
    },
    "parentProcessName": {
      "example": "svchost.exe"
    },
    "md5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "sha256": {
      "example": "a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890"
    },
    "sm3": {
      "example": "6d6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a"
    },
    "virusName": {
      "example": "Trojan.Win32.Generic"
    },
    "virusFamily": {
      "example": "WannaCry"
    },
    "threatActorOrg": {
      "example": "APT28"
    },
    "machineCode": {
      "example": "DESKTOP-7A8B9C3F"
    },
    "productVendorName": {
      "example": "Microsoft"
    },
    "deviceSendProductName": {
      "example": "Windows Defender"
    },
    "deviceName": {
      "example": "DESKTOP-7A8B9C3F"
    },
    "deviceAddress": {
      "example": "192.168.1.100"
    },
    "eventId": {
      "example": "f6e8d9c4-7a2b-4c3d-9e1f-0a5b6c7d8e9f"
    },
    "name": {
      "example": "Malware Alert: Trojan.Win32.Generic Detected on DESKTOP-7A8B9C3F"
    },
    "message": {
      "example": "Detected malicious file secure_settings.ini with hash d41d8cd98f00b204e9800998ecf8427e on device DESKTOP-7A8B9C3F (192.168.1.100). Process cmd.exe (started by svchost.exe) attempted to modify the file. Virus identified as Trojan.Win32.Generic (WannaCry family). Threat actor APT28 suspected. Windows Defender blocked the activity."
    },
    "collectorReceiptTime": {
      "example": "2023-08-15 14:30:30"
    },
    "catOutcome": {
      "example": "FAIL"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "modify"
    },
    "srcMacAddress": {
      "example": "00:15:5D:01:23:45"
    },
    "destMacAddress": {
      "example": "00:15:5D:01:23:46"
    },
    "srcGeoCountry": {
      "example": "Russia"
    },
    "srcGeoRegion": {
      "example": "Moscow Oblast"
    },
    "srcGeoCity": {
      "example": "Moscow"
    },
    "srcGeoAddress": {
      "example": "Moscow, Moscow Oblast, Russia"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "Los Angeles"
    },
    "destGeoAddress": {
      "example": "Los Angeles, California, United States"
    },
    "dataSourceAddress": {
      "example": "192.168.1.100"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "http"
    },
    "dvcAction": {
      "example": "blocked"
    },
    "deviceVersion": {
      "example": "Windows 10 Pro 10.0.19044 Build 19044"
    },
    "srcAddress": {
      "example": "192.168.1.100"
    },
    "destAddress": {
      "example": "45.33.32.156"
    },
    "subTechniqueId": {
      "example": "T1560.001"
    },
    "techniqueName": {
      "example": "Archive Collected Data"
    },
    "techniqueId": {
      "example": "T1055"
    },
    "tacticName": {
      "example": "Defense Evasion"
    },
    "tacticId": {
      "example": "T1560"
    },
    "killChain": {
      "example": "KC_Exploitation"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "AV-2023-0815-001"
    },
    "ruleType": {
      "example": "/Malware/Virus"
    },
    "ruleName": {
      "example": "Windows Defender: Trojan.Win32.Generic (WannaCry) Blocked - Archive Data Evasion T1560.001"
    },
    "attackerAddress": {
      "example": "192.168.1.100"
    },
    "victimAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueName": {
      "example": "Archive via Utility"
    },
    "suggestion": {
      "example": "Immediately isolate the infected device DESKTOP-7A8B9C3F (192.168.1.100) from the network. Quarantine the malicious file secure_settings.ini and delete it. Terminate the associated cmd.exe process (PID: N/A) and its parent svchost.exe process if suspicious. Run a full system antivirus scan using Windows Defender and update virus definitions. Investigate the system for further persistence mechanisms related to WannaCry ransomware and APT28 TTPs. Block outbound traffic to the command and control IP 45.33.32.156. Review and restore the secure_settings.ini file from a known clean backup. Apply relevant security patches for defense evasion technique T1055 (T1560.001)."
    },
    "IoC": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "IoCType": {
      "example": "file"
    },
    "tiCategory": {
      "example": "/Malware"
    },
    "IoCLevel": {
      "example": "High"
    },
    "tiSubcategory": {
      "example": "/C2/Trojan"
    },
    "processMd5": {
      "example": "f3c3a2b1e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1f0"
    },
    "parentProcessMd5": {
      "example": "a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1f0e9d8c7b6a5"
    },
    "processChain": {
      "example": "C:\\Windows\\System32\\wininit.exe -> C:\\Windows\\System32\\services.exe -> C:\\Windows\\System32\\svchost.exe -> C:\\Windows\\System32\\cmd.exe"
    },
    "processGuid": {
      "example": "{123e4567-e89b-12d3-a456-426614174000}"
    },
    "parentProcessGuid": {
      "example": "{123e4567-e89b-12d3-a456-426614174001}"
    },
    "commandLine": {
      "example": "cmd.exe /c copy secure_settings.ini secure_settings.bak && powershell -EncodedCommand UwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAC0ARgBpAGwAZQBQAGEAdABoACAAQwA6AFwAVABlAG0AcABcAHMAZQBjAHUAcgBlAF8AcwBlAHQAdABpAG4AZwBzAC4AaQBuAGkA"
    },
    "parentCommandLine": {
      "example": "C:\\Windows\\System32\\svchost.exe -k netsvcs -p -s gpsvc"
    },
    "hostName": {
      "example": "DESKTOP-7A8B9C3F"
    },
    "hostAddress": {
      "example": "192.168.1.100"
    },
    "integrityLevel": {
      "example": "High"
    }
  }
}