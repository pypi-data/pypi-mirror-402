{
  "group": "alert",
  "category": "malware",
  "title": "ransomware",
  "label": "Ransomware",
  "description": "Alerts indicating the detection of ransomware, a type of malware that encrypts files and demands payment for decryption.",
  "dataSource": [
    "Antivirus",
    "Endpoint Detection And Response System",
    "Firewall",
    "Network Detection and Response"
  ],
  "definitions": {
    "filePath": {
      "example": "C:\\Program Files\\ImportantApp\\config\\secure_settings.ini"
    },
    "targetFilename": {
      "example": "secure_settings.ini"
    },
    "startTime": {
      "example": "2023-08-15 14:30:22"
    },
    "endTime": {
      "example": "2023-08-15 14:30:28"
    },
    "deviceReceiptTime": {
      "example": "2023-08-15 14:30:25"
    },
    "processUserName": {
      "example": "SYSTEM"
    },
    "parentProcessUserName": {
      "example": "Administrator"
    },
    "processStartTime": {
      "example": "2023-08-15 14:30:22"
    },
    "parentProcessStartTime": {
      "example": "2023-08-15 14:29:55"
    },
    "image": {
      "example": "C:\\Windows\\System32\\cmd.exe"
    },
    "parentImage": {
      "example": "C:\\Windows\\System32\\svchost.exe"
    },
    "fileName": {
      "example": "secure_settings.ini"
    },
    "processName": {
      "example": "cmd.exe"
    },
    "parentProcessName": {
      "example": "svchost.exe"
    },
    "md5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "sha256": {
      "example": "a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890"
    },
    "sm3": {
      "example": "6d6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a"
    },
    "virusName": {
      "example": "Trojan.Win32.Generic"
    },
    "virusFamily": {
      "example": "WannaCry"
    },
    "threatActorOrg": {
      "example": "APT28"
    },
    "algorithm": {
      "example": "AES-256"
    },
    "machineCode": {
      "example": "WIN-7H39S8F2A1L"
    },
    "productVendorName": {
      "example": "CrowdStrike"
    },
    "deviceSendProductName": {
      "example": "CrowdStrike Falcon Agent"
    },
    "deviceName": {
      "example": "WIN-7H39S8F2A1L"
    },
    "deviceAddress": {
      "example": "192.168.1.100"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "Ransomware Alert: WannaCry variant detected on WIN-7H39S8F2A1L"
    },
    "message": {
      "example": "Ransomware Alert: WannaCry variant (Trojan.Win32.Generic) detected on host WIN-7H39S8F2A1L (192.168.1.100). The process cmd.exe (running as SYSTEM, parent svchost.exe) was observed encrypting the file C:\\Program Files\\ImportantApp\\config\\secure_settings.ini using AES-256 algorithm. Alert generated by CrowdStrike Falcon Agent."
    },
    "collectorReceiptTime": {
      "example": "2023-08-15 14:30:26"
    },
    "catOutcome": {
      "example": "Attempt"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "encrypt"
    },
    "srcMacAddress": {
      "example": "00:1B:44:11:3A:E7"
    },
    "destMacAddress": {
      "example": "00:0C:29:5B:78:9A"
    },
    "srcGeoCountry": {
      "example": "United States"
    },
    "srcGeoRegion": {
      "example": "California"
    },
    "srcGeoCity": {
      "example": "San Francisco"
    },
    "srcGeoAddress": {
      "example": "123 Main Street, San Francisco, CA 94105"
    },
    "destGeoCountry": {
      "example": "Russia"
    },
    "destGeoRegion": {
      "example": "Moscow Oblast"
    },
    "destGeoCity": {
      "example": "Moscow"
    },
    "destGeoAddress": {
      "example": "Moscow, Moscow Oblast, Russia"
    },
    "dataSourceAddress": {
      "example": "192.168.1.100"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "smb"
    },
    "dvcAction": {
      "example": "Blocked"
    },
    "direction": {
      "example": "01"
    },
    "deviceVersion": {
      "example": "Windows 10 Pro 10.0.19045 Build 19045"
    },
    "srcAddress": {
      "example": "192.168.1.105"
    },
    "destAddress": {
      "example": "93.184.215.14"
    },
    "subTechniqueId": {
      "example": "T1486"
    },
    "techniqueName": {
      "example": "Data Encrypted for Impact"
    },
    "techniqueId": {
      "example": "T1486"
    },
    "tacticName": {
      "example": "Impact"
    },
    "tacticId": {
      "example": "TA0040"
    },
    "killChain": {
      "example": "KC_Exploitation"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "CS-RANSOMWARE-WANNACRY-20230815"
    },
    "ruleType": {
      "example": "/Malware/Ransomware"
    },
    "ruleName": {
      "example": "CS-RANSOMWARE-WANNACRY-DATA-ENCRYPTION"
    },
    "attackerAddress": {
      "example": "192.168.1.105"
    },
    "victimAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueName": {
      "example": "Data Encrypted for Impact"
    },
    "suggestion": {
      "example": "Isolate the infected host WIN-7H39S8F2A1L (192.168.1.100) from the network immediately. Terminate the malicious process cmd.exe (PID to be determined) and its parent process svchost.exe. Restore the encrypted file secure_settings.ini from a known good backup. Investigate the initial infection vector, focusing on the SMB connection from 192.168.1.105 to 93.184.215.14. Apply relevant security patches for the vulnerability associated with technique T1486 (CVE-2017-0144). Scan the host with CrowdStrike Falcon Agent for any remaining threats. Update antivirus signatures and review firewall rules to block communication with the malicious IP 93.184.215.14."
    },
    "IoC": {
      "example": "93.184.215.14"
    },
    "IoCType": {
      "example": "file"
    },
    "tiCategory": {
      "example": "/Malware"
    },
    "IoCLevel": {
      "example": "Critical"
    },
    "tiSubcategory": {
      "example": "/C2/Ransomware"
    },
    "requestDomain": {
      "example": "example.com"
    },
    "processMd5": {
      "example": "e6a2f4c9e7b8d1a0c3f5b9d2e8a7f6c1"
    },
    "parentProcessMd5": {
      "example": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
    },
    "processChain": {
      "example": "C:\\Windows\\System32\\svchost.exe -> C:\\Windows\\System32\\cmd.exe"
    },
    "processGuid": {
      "example": "{123e4567-e89b-12d3-a456-426614174000}"
    },
    "parentProcessGuid": {
      "example": "{123e4567-e89b-12d3-a456-426614174001}"
    },
    "commandLine": {
      "example": "C:\\temp\\encryptor.exe -file C:\\Program Files\\ImportantApp\\config\\secure_settings.ini -key a1b2c3d4e5f6 -mode encrypt -silent"
    },
    "parentCommandLine": {
      "example": "C:\\Windows\\System32\\svchost.exe -k netsvcs"
    },
    "hostName": {
      "example": "WIN-7H39S8F2A1L"
    },
    "hostAddress": {
      "example": "192.168.1.100"
    },
    "integrityLevel": {
      "example": "System"
    }
  }
}