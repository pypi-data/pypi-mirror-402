{
  "group": "log",
  "category": "data_security_audit",
  "title": "file_communication_audit",
  "label": "File Communication Audit",
  "description": "Logs and audits file transfer activities to monitor data security compliance and detect unauthorized communications.",
  "dataSource": [
    "Network DLP System",
    "Network Detection and Response"
  ],
  "tag": [
    "Data Leakage"
  ],
  "definitions": {
    "startTime": {
      "example": "2023-10-26 14:32:18"
    },
    "endTime": {
      "example": "2023-10-26 14:32:48"
    },
    "deviceReceiptTime": {
      "example": "2023-10-26 14:32:20"
    },
    "srcUserName": {
      "example": "administrator"
    },
    "destUserName": {
      "example": "administrator"
    },
    "fileName": {
      "example": "financial_report_Q3_2023.xlsx"
    },
    "machineCode": {
      "example": "DEV-2023-SRV-001"
    },
    "productVendorName": {
      "example": "Microsoft"
    },
    "deviceSendProductName": {
      "example": "Microsoft Windows Security Auditing"
    },
    "deviceName": {
      "example": "DEV-2023-SRV-001"
    },
    "deviceAddress": {
      "example": "192.168.1.100"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "File Transfer Audit - Financial Report Q3 2023"
    },
    "message": {
      "example": "User administrator initiated file transfer of financial_report_Q3_2023.xlsx from host DEV-2023-SRV-001 (192.168.1.100) to an external destination. Transfer completed successfully. Data security policy: CONFIDENTIAL."
    },
    "collectorReceiptTime": {
      "example": "2023-10-26 14:32:22"
    },
    "catOutcome": {
      "example": "OK"
    },
    "logType": {
      "example": "file"
    },
    "opType": {
      "example": "send"
    },
    "dataSourceAddress": {
      "example": "192.168.1.100"
    },
    "XFF": {
      "example": "203.0.113.5, 198.51.100.23"
    },
    "srcMacAddress": {
      "example": "00:1B:44:11:3A:E7"
    },
    "destMacAddress": {
      "example": "00:50:56:6A:1B:2C"
    },
    "srcGeoCountry": {
      "example": "United States"
    },
    "srcGeoRegion": {
      "example": "California"
    },
    "srcGeoCity": {
      "example": "San Francisco"
    },
    "srcGeoAddress": {
      "example": "123 Main Street, San Francisco, CA 94105, United States"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "San Francisco"
    },
    "destGeoAddress": {
      "example": "456 Market Street, San Francisco, CA 94104, United States"
    },
    "srcAddress": {
      "example": "192.168.1.100"
    },
    "destAddress": {
      "example": "203.0.113.5"
    },
    "direction": {
      "example": "01"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "ftp"
    },
    "md5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "destHostName": {
      "example": "external-server-01.company.com"
    },
    "requestMethod": {
      "example": "PUT"
    },
    "httpVersion": {
      "example": "HTTP/1.1"
    },
    "requestUrlQuery": {
      "example": "/file_transfer/upload?file=financial_report_Q3_2023.xlsx&user=administrator&dest=external-server-01.company.com&protocol=ftp"
    },
    "requestUrl": {
      "example": "/file_transfer/upload"
    },
    "userAgent": {
      "example": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"
    },
    "shareName": {
      "example": "Financial_Reports_Share"
    },
    "smbServerVersion": {
      "example": "SMB 3.1.1"
    },
    "httpReferer": {
      "example": "https://internal.company.com/share/Financial_Reports_Share/financial_report_Q3_2023.xlsx"
    },
    "requestBody": {
      "example": "file=financial_report_Q3_2023.xlsx&user=administrator&dest=external-server-01.company.com&protocol=ftp&policy=CONFIDENTIAL&checksum=d41d8cd98f00b204e9800998ecf8427e"
    },
    "requestHeader": {
      "example": "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36\nHost: external-server-01.company.com\nAccept: */*\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 153\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbmlzdHJhdG9yIiwiaWF0IjoxNjk4MzQ1NTM4LCJleHAiOjE2OTgzNDkxMzh9.dummy_signature_for_example\nX-Request-ID: 550e8400-e29b-41d4-a716-446655440000\nX-Forwarded-For: 203.0.113.5, 198.51.100.23\nX-Client-IP: 192.168.1.100\nX-File-Name: financial_report_Q3_2023.xlsx\nX-Data-Policy: CONFIDENTIAL\nX-Transfer-Protocol: ftp\nX-Source-Host: DEV-2023-SRV-001\nConnection: keep-alive"
    },
    "requestOs": {
      "example": "Windows NT 10.0; Win64; x64"
    },
    "requestParameters": {
      "example": "file=financial_report_Q3_2023.xlsx&user=administrator&dest=external-server-01.company.com&protocol=ftp&policy=CONFIDENTIAL&checksum=d41d8cd98f00b204e9800998ecf8427e&source_host=DEV-2023-SRV-001&client_ip=192.168.1.100&request_id=550e8400-e29b-41d4-a716-446655440000"
    },
    "responseContentType": {
      "example": "application/octet-stream"
    },
    "responseHeader": {
      "example": "HTTP/1.1 200 OK\nDate: Thu, 26 Oct 2023 14:32:48 GMT\nServer: Apache/2.4.56 (Unix) OpenSSL/1.1.1t\nContent-Type: application/octet-stream\nContent-Length: 1048576\nConnection: close\nX-Request-ID: 550e8400-e29b-41d4-a716-446655440000\nX-File-Name: financial_report_Q3_2023.xlsx\nX-Data-Policy-Applied: CONFIDENTIAL\nX-Transfer-Status: COMPLETED\nX-MD5-Checksum: d41d8cd98f00b204e9800998ecf8427e\nX-Destination-Host: external-server-01.company.com\nX-Source-Host: DEV-2023-SRV-001\nX-Forwarded-For: 203.0.113.5, 198.51.100.23\nX-Client-IP: 192.168.1.100"
    },
    "responseOs": {
      "example": "Apache/2.4.56 (Unix) OpenSSL/1.1.1t"
    },
    "responseBody": {
      "example": "success"
    },
    "smbClientVersion": {
      "example": "SMB 2.1"
    },
    "transMode": {
      "example": "passive"
    },
    "deviceVersion": {
      "example": "Windows 10 Pro 10.0.19045 Build 19045"
    }
  }
}