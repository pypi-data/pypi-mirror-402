{
  "group": "alert",
  "category": "malware",
  "title": "mining_software",
  "label": "Mining Software",
  "description": "Alerts related to malware specifically designed for cryptocurrency mining activities, indicating unauthorized computational resource usage.",
  "dataSource": [
    "Antivirus",
    "Endpoint Detection And Response System",
    "Firewall",
    "Network Detection and Response"
  ],
  "definitions": {
    "filePath": {
      "example": "C:\\Program Files\\ImportantApp\\config\\secure_settings.ini"
    },
    "targetFilename": {
      "example": "secure_settings.ini"
    },
    "startTime": {
      "example": "2023-08-15 14:30:22"
    },
    "endTime": {
      "example": "2023-08-15 14:30:28"
    },
    "deviceReceiptTime": {
      "example": "2023-08-15 14:30:25"
    },
    "processUserName": {
      "example": "SYSTEM"
    },
    "parentProcessUserName": {
      "example": "Administrator"
    },
    "processStartTime": {
      "example": "2023-08-15 14:30:22"
    },
    "parentProcessStartTime": {
      "example": "2023-08-15 14:29:55"
    },
    "image": {
      "example": "C:\\Windows\\System32\\cmd.exe"
    },
    "parentImage": {
      "example": "C:\\Windows\\System32\\svchost.exe"
    },
    "fileName": {
      "example": "secure_settings.ini"
    },
    "processName": {
      "example": "cmd.exe"
    },
    "parentProcessName": {
      "example": "svchost.exe"
    },
    "md5": {
      "example": "d41d8cd98f00b204e9800998ecf8427e"
    },
    "sha256": {
      "example": "a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890"
    },
    "sm3": {
      "example": "6d6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a6f6e4f4d5a"
    },
    "virusName": {
      "example": "Trojan.Win32.Generic"
    },
    "virusFamily": {
      "example": "WannaCry"
    },
    "threatActorOrg": {
      "example": "APT28"
    },
    "attackerAddress": {
      "example": "192.168.1.100"
    },
    "requestDomain": {
      "example": "pool.monero-mining.org"
    },
    "machineCode": {
      "example": "WIN-PC-01-ABC123"
    },
    "productVendorName": {
      "example": "Microsoft"
    },
    "deviceSendProductName": {
      "example": "Windows Defender"
    },
    "deviceName": {
      "example": "WIN-PC-01-ABC123"
    },
    "deviceAddress": {
      "example": "192.168.1.150"
    },
    "eventId": {
      "example": "550e8400-e29b-41d4-a716-446655440000"
    },
    "name": {
      "example": "Malware Alert: Unauthorized Cryptocurrency Mining Activity Detected"
    },
    "message": {
      "example": "Detection of unauthorized cryptocurrency mining activity on host WIN-PC-01-ABC123 (192.168.1.150). Process cmd.exe (PID: 4532) spawned from svchost.exe attempted to contact known mining pool pool.monero-mining.org from IP 192.168.1.100. Associated file secure_settings.ini was modified. Malware identified as Trojan.Win32.Generic (WannaCry family)."
    },
    "collectorReceiptTime": {
      "example": "2023-08-15 14:30:26"
    },
    "catOutcome": {
      "example": "FAIL"
    },
    "logType": {
      "example": "alert"
    },
    "opType": {
      "example": "execute"
    },
    "srcMacAddress": {
      "example": "00:1B:44:11:3A:E7"
    },
    "destMacAddress": {
      "example": "00:50:56:C0:00:08"
    },
    "srcGeoCountry": {
      "example": "United States"
    },
    "srcGeoRegion": {
      "example": "California"
    },
    "srcGeoCity": {
      "example": "San Francisco"
    },
    "srcGeoAddress": {
      "example": "123 Main Street, San Francisco, CA 94105, United States"
    },
    "destGeoCountry": {
      "example": "United States"
    },
    "destGeoRegion": {
      "example": "California"
    },
    "destGeoCity": {
      "example": "San Jose"
    },
    "destGeoAddress": {
      "example": "456 Park Avenue, San Jose, CA 95113, United States"
    },
    "dataSourceAddress": {
      "example": "192.168.1.150"
    },
    "transProtocol": {
      "example": "TCP"
    },
    "appProtocol": {
      "example": "http"
    },
    "dvcAction": {
      "example": "Terminated Process"
    },
    "direction": {
      "example": "01"
    },
    "deviceVersion": {
      "example": "Windows 10 Enterprise, Version 21H2 (OS Build 19044.1766)"
    },
    "srcAddress": {
      "example": "192.168.1.100"
    },
    "destAddress": {
      "example": "pool.monero-mining.org"
    },
    "subTechniqueId": {
      "example": "T1496"
    },
    "techniqueName": {
      "example": "Resource Hijacking"
    },
    "techniqueId": {
      "example": "T1496"
    },
    "tacticName": {
      "example": "Resource Hijacking"
    },
    "tacticId": {
      "example": "TA0040"
    },
    "killChain": {
      "example": "KC_Exploitation"
    },
    "confidence": {
      "example": "High"
    },
    "ruleId": {
      "example": "MINING-ALERT-2023-08-15-001"
    },
    "ruleType": {
      "example": "/Malware/Miner"
    },
    "ruleName": {
      "example": "Detection of Unauthorized Cryptocurrency Mining Activity via Monero Pool Connection"
    },
    "victimAddress": {
      "example": "192.168.1.150"
    },
    "subTechniqueName": {
      "example": "Resource Hijacking"
    },
    "suggestion": {
      "example": "Isolate the infected host WIN-PC-01-ABC123 from the network immediately. Terminate the malicious process cmd.exe (PID: 4532) and its parent process svchost.exe if suspicious. Block all outbound connections to the domain pool.monero-mining.org and IP 192.168.1.100 at the firewall. Remove or quarantine the malicious file secure_settings.ini located at C:\\Program Files\\ImportantApp\\config\\. Perform a full system scan using Windows Defender or an updated antivirus solution to identify and remove the Trojan.Win32.Generic (WannaCry) malware. Investigate the initial infection vector, such as the execution of the parent svchost.exe process, and review system logs for suspicious activity around 2023-08-15 14:29:55. Apply relevant security patches to prevent exploitation."
    },
    "IoC": {
      "example": "pool.monero-mining.org"
    },
    "IoCType": {
      "example": "domain"
    },
    "tiCategory": {
      "example": "/Malware"
    },
    "IoCLevel": {
      "example": "High"
    },
    "tiSubcategory": {
      "example": "/Malware/Miner"
    },
    "processMd5": {
      "example": "e3d4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9"
    },
    "parentProcessMd5": {
      "example": "e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3"
    },
    "processChain": {
      "example": "C:\\Windows\\System32\\wininit.exe -> C:\\Windows\\System32\\services.exe -> C:\\Windows\\System32\\svchost.exe -> C:\\Windows\\System32\\cmd.exe"
    },
    "processGuid": {
      "example": "{550e8400-e29b-41d4-a716-446655440001}"
    },
    "parentProcessGuid": {
      "example": "{550e8400-e29b-41d4-a716-446655440000}"
    },
    "commandLine": {
      "example": "Invoke-WebRequest -Uri http://pool.monero-mining.org/getwork -Method POST -Body"
    },
    "parentCommandLine": {
      "example": "svchost.exe -k netsvcs -p -s Dnscache"
    },
    "hostName": {
      "example": "WIN-PC-01-ABC123"
    },
    "hostAddress": {
      "example": "192.168.1.150"
    },
    "integrityLevel": {
      "example": "System"
    }
  }
}