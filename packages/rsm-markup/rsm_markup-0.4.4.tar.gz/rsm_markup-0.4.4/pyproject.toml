# Project metadata

[project]
name = "rsm-markup"
version = "0.4.4"
description = "ReStructured Manuscripts (RSM) markup language"
readme = "README.md"
authors = [{ name = "Leo Torres", email = "leo@leotrs.com" }]
license = { file = "LICENSE.md" }
classifiers = [
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python",
    "Programming Language :: Python :: 3",
]
keywords = ["markup", "science", "publishing", "static site generator"]

# Production dependencies
dependencies = [
    "fs >= 2.4.15",
    "icecream >= 2.1.2",
    "livereload >= 2.6.3",
    "pygments >= 2.14.0",
    "tree-sitter >= 0.23.2",
    "tree-sitter-rsm>=0.6.1",
    "ujson >= 5.10.0",
]
requires-python = ">=3.10"

[project.optional-dependencies]
# Development dependencies
dev = [
    "mypy >= 1.16.1",
    "mypy-extensions >= 1.0.0",
    "pre-commit >= 2.20.0",
    "pytest >= 7.1.1",
    "pytest-sugar >= 0.9.6",
    "ruff >= 0.1.0",
    "types-pygments >= 2.19.0",
    "types-ujson >= 5.6.0",
]

# Documentation dependencies
doc = [
    "Sphinx >= 6.2.0",
    "sphinx-autobuild >= 2021.3.14",
    "sphinx-copybutton >= 0.5.1",
    "sphinx-design >= 0.5.0",
    "sphinx-autodoc-typehints >= 1.19.5",
    "pydata-sphinx-theme >= 0.12.0",
]

[project.urls]
Homepage = "https://write-rsm.org/"

[project.scripts]
rsm = "rsm.cli:main"


# Build system

[build-system]
requires = ["setuptools >= 61.0", "wheel"]
build-backend = "setuptools.build_meta"

[tool.setuptools.packages.find]
where = ["."]
include = ["rsm*"]
exclude = ["tests*"]

[tool.setuptools.package-data]
rsm = ["*.so", "*.dll", "static/**/*"]


# Tool configurations

[tool.ruff]
line-length = 88
target-version = "py310"

[tool.ruff.lint]
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "B",   # flake8-bugbear
    "C4",  # flake8-comprehensions
    "UP",  # pyupgrade
]
ignore = [
    "E501",  # line too long (handled by formatter)
    "B008",  # do not perform function calls in argument defaults
    "B904",  # use 'raise ... from err'
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]  # unused imports in __init__.py

[tool.mypy]
disallow_untyped_defs = true
disallow_incomplete_defs = true
check_untyped_defs = true
disallow_untyped_decorators = true
warn_unused_ignores = true
warn_return_any = true
warn_redundant_casts = true

[[tool.mypy.overrides]]
module = ["icecream.*", "livereload.*"]
ignore_missing_imports = true

[tool.pytest.ini_options]
markers = [
    'slow: marks tests as slow (deselect with "-m \"not slow\"")',
    "serial",
]
filterwarnings = [
    "ignore:.*pkg_resources.*:DeprecationWarning",
]

[tool.uv.sources]
tree-sitter-rsm = { path = "tree-sitter-rsm", editable = true }
