[build-system]
requires = ["setuptools>=68", "wheel", "build"]
build-backend = "setuptools.build_meta"

[project]
name = "aethergraph"
version = "0.1.0a3"
description = "Python-first agentic DAG execution framework"
readme = "README.md"
license = { file = "LICENSE" }
authors = [{ name = "Zhaocheng Liu", email = "zhaocheng@aiperture.io" }]
requires-python = ">=3.10"

# Conservative lower bounds; tighten as stabilize.
dependencies = [
  "fastapi>=0.110,<1.0",
  "uvicorn[standard]>=0.31",
  "pydantic>=2.6",
  "pydantic-settings>=2.2",
  "numpy>=1.24",
  "networkx>=3.1",
  "python-multipart>=0.0.9",
  "jsonschema>=4.18",
  "httpx>=0.27",
  "aiohttp>=3.9"
]

keywords = [
  "agents", "workflow", "DAG", "LLM", "orchestration", "research", "aethergraph"
]

classifiers = [
  "Development Status :: 3 - Alpha",
  "Intended Audience :: Science/Research",
  "Intended Audience :: Developers",
  "License :: OSI Approved :: Apache Software License",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3 :: Only",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Topic :: Scientific/Engineering",
  "Topic :: Software Development :: Libraries",
]

[project.urls]
Homepage = "https://github.com/AIperture/aethergraph"
Repository = "https://github.com/AIperture/aethergraph"
Documentation = "https://aiperture.github.io/aethergraph-docs/"
Issues = "https://github.com/AIperture/aethergraph/issues"

[project.scripts]
aethergraph = "aethergraph.__main__:main"
aethergraph-server = "aethergraph.server.server:main"


[project.optional-dependencies]
# Keep extras small and purposeful; add more as modularize features.
slack    = ["slack_sdk>=3.27.0", "aiohttp>=3.9"]
telegram = ["aiohttp>=3.9"]
webhook  = ["aiohttp>=3.9"]
discord  = ["aiohttp>=3.9"]
channels = [
  "aethergraph[slack]",
  "aethergraph[telegram]",
  "aethergraph[webhook]"
]
faiss    = ["faiss-cpu>=1.7.4"]      # optional vector index accel

dev = [
  "ruff>=0.5",
  "black>=24.1.0",
  "mypy>=1.8.0",
  "pytest>=8.0.0",
  "pytest-asyncio>=0.23",
  "types-requests>=2.31.0.10"
]
docs = [
  "mkdocs>=1.5",
  "mkdocs-material>=9.5",
  "mkdocstrings[python]>=0.24"
]
test = [
  "pytest>=8.0.0",
  "pytest-asyncio>=0.23",
  "coverage>=7.4",
  "trio"
]

[tool.setuptools]
package-dir = { "" = "src" }
include-package-data = false  # specify in later
license-files = ["LICENSE*", "NOTICE*", "COPYING*"]

[tool.setuptools.packages.find]
where = ["src"]
exclude = [
  "tests*", 
  "examples*",
  "aethergraph.demos*",
  "aethergraph.demos.*"
]

[tool.setuptools.exclude-package-data]
aethergraph = ["demos/**"]

[tool.setuptools.package-data]
# Ship non-Python assets bundled with the package (adjust as needed)
aethergraph = [
  "**/*.json",
  "**/*.yaml",
  "**/*.yml",
  "**/*.txt",
  "v*/**/templates/**/*",
  "server/ui_static/**",
]

# -------------------------
# Quality & tooling (optional)
# -------------------------

[tool.ruff]
line-length = 100
target-version = "py310"
lint.select = ["E","F","I","B","UP","SIM"]
lint.ignore = ["E203", "E266", "E501"]  # E501 handled by formatter
extend-exclude = ["docs", "scripts", "examples"]

[tool.ruff.lint.isort]
known-first-party = ["aethergraph"]
combine-as-imports = true
force-sort-within-sections = true

[tool.black]
line-length = 100
target-version = ["py310"]

[tool.mypy]
python_version = "3.10"
ignore_missing_imports = true
warn_redundant_casts = true

# Relax for now:
warn_return_any = false
strict_optional = false
no_implicit_optional = false
disallow_untyped_defs = false
check_untyped_defs = false
warn_unused_ignores = false

exclude = [
  "^docs/",
  "^examples/",
  "^scripts/",
  "^tests/",
]

[tool.pytest.ini_options]
addopts = "-q"
testpaths = ["tests"]
asyncio_mode = "auto"
