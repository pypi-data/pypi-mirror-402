[tox]
envlist = py312
skipsdist = True

[testenv]
description = Use uv to install libzapi[test] into the tox env, then run pytest
# Skip tox packaging if you don't need to test the built wheel
package = skip
skip_install = true

allowlist_externals = uv
passenv = UV_*, PIP_*, http_proxy, https_proxy, no_proxy, ZENDESK_URL, ZENDESK_EMAIL, ZENDESK_TOKEN

commands_pre =
    uv pip install --python {envpython} -e .[test]
commands =
    pytest --cov=./libzapi tests --cov-report=xml:coverage-reports/coverage-report.xml --cov-config=tox.ini --cov-branch

[testenv:lint]
description = Run Ruff linting
skip_install = true
allowlist_externals = uv
# (optional) pass proxies or envs if needed
passenv = UV_*, PIP_*, http_proxy, https_proxy, no_proxy

commands_pre =
    # Fast install via uv directly into tox's env
    uv pip install --python {envpython} ruff
commands =
    uv run ruff check .

[coverage:run]
relative_files = False
