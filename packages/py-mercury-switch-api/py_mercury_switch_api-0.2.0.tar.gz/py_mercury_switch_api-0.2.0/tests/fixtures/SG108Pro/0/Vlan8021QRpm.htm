<!DOCTYPE html>
<script>
    var qvlan_ds = {
        state: 1,
        portNum: 8,
        vids: [1, 10, 20, 30, 40, 50, 100],
        count: 7,
        maxVids: 32,
        names: ['Default', 'VLAN10', 'VLAN20', 'VLAN30', 'VLAN40', 'VLAN50', 'VLAN100'],
        tagMbrs: [0x0, 0x41, 0x41, 0x1, 0x41, 0x41, 0x41],
        untagMbrs: [0xFF, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0],
        lagIds: [0, 0, 0, 0, 0, 0, 0, 0],
        lagMbrs: [0, 0x0, 0x0]
    };
    var tip = "";
</script>

<head>
    <meta http-equiv=Content-Type content="text/html; charset=utf-8">
    <script>
        document.write(top.Abbrev)
    </script>
    <script type=text/javascript>
        incMeta(),
        incCss("main.css"),
        incCss("help.css"),
        incJs("tips.js"),
        incJs("ui.js"),
        incJs("help.js"),
        incJs("qvlan.js");
        var qvCnt = qvlan_ds.count
          , qvState = qvlan_ds.state
          , portNum = qvlan_ds.portNum
          , qvVids = qvlan_ds.vids
          , qvTagMbrs = qvlan_ds.tagMbrs
          , qvUntagMbrs = qvlan_ds.untagMbrs
          , qvNames = qvlan_ds.names
          , qvMax = qvlan_ds.maxVids
          , qvLagIds = qvlan_ds.lagIds
          , qvLagMbrs = qvlan_ds.lagMbrs
    </script>
</head>

<body>
    <div id=div_tip_mask class=TIP_MASK>
        <div id=div_tip_svr class=TIP>
            <span id=sp_tip_svr class=TIP_CONTENT></span>
        </div>
    </div>
    <fieldset>
        <legend>802.1Q VLAN设置</legend>
        <form action=qvlanSet.cgi>
            <div id=div_sec_title>
                <table width=100%>
                    <tr>
                        <td>
                            <table class=FRAMEWORK>
                                <tr>
                                    <td class=SBLANK></td>
                                    <td align=left>
                                        <span class=NORMAL>802.1Q VLAN使能：</span>
                                    </td>
                                    <td class=SBLANK></td>
                                    <td>
                                        <input name=qvlan_en id=qvlan_en type=radio value=1 class=NORMAL>
                                        <span class=NORMAL>启用</span>
                                    </td>
                                    <td class=SBLANK></td>
                                    <td>
                                        <input name=qvlan_en id=qvlan_dis type=radio value=0 class=NORMAL checked>
                                        <span class=NORMAL>禁用</span>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table class=BTN_WRAPPER align=left>
                                <tr>
                                    <td>
                                        <a class=BTN>
                                            <input class=BTN_NORMAL_BTN type=submit value=应用 name=qvlan_mode
                                                onclick="return enable1QVlan()">
                                        </a>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <script type=text/javascript>
                    qvlanStateInit()
                </script>
            </div>
        </form>
        <form action=qvlanSet.cgi>
            <table class=BORDER>
                <tr class=TABLE_HEAD>
                    <td class=TD_FIRST_COL width=200px>VLAN</td>
                    <td class=TD_FIRST_COL width=200px>
                        <input id=t_vid size=4 maxlength=4 name=vid onkeyup=selMbrPorts() autocomplete=off>(1-4094)
                    </td>
                    <td class=TD_FIRST_COL width=200px>VLAN描述</td>
                    <td class=TD_FIRST_COL width=200px>
                        <input size=10 maxlength=10 id=t_vname name=vname>
                    </td>
                </tr>
                <tr class=TABLE_HEAD>
                    <td>端口</td>
                    <td>Untagged端口</td>
                    <td>Tagged端口</td>
                    <td>非成员端口</td>
                </tr>
                <tr class=TABLE_HEAD>
                    <td>全选</td>
                    <td>
                        <input type=checkbox id=selAllUntag name=selAllType onclick=selAllByType(0)>
                    </td>
                    <td>
                        <input type=checkbox id=selAllTag name=selAllType onclick=selAllByType(1)>
                    </td>
                    <td>
                        <input type=checkbox id=selAllNon name=selAllType onclick=selAllByType(2)>
                    </td>
                </tr>
                <script type=text/javascript>
                    for (var lagPort, i = 1; i <= portNum; i++)
                        lagPort = "端口 " + i,
                        qvLagIds[i - 1] && (lagPort += " (LAG" + qvLagIds[i - 1] + ")"),
                        docW("<tr>"),
                        docW("<td class=TABLE_HEAD_BOTTOM>" + lagPort + "</td>"),
                        docW("<td class=TABLE_HEAD_BOTTOM><input class=BTN_NORMAL type=radio value=0 id=untagSel_" + i + " name=selType_" + i + " onClick='chkLagMbrs(" + i + ",0);'></td>"),
                        docW("<td class=TABLE_HEAD_BOTTOM><input class=BTN_NORMAL type=radio value=1 id=tagSel_" + i + " name=selType_" + i + " onClick='chkLagMbrs(" + i + ",1);'></td>"),
                        docW("<td class=TABLE_HEAD_BOTTOM><input class=BTN_NORMAL type=radio value=2 id=nonSel_" + i + " name=selType_" + i + " onClick='chkLagMbrs(" + i + ",2);' checked></td>"),
                        docW("</tr>")
                </script>
            </table>
            <table align=center>
                <tr>
                    <td>
                        <a class=BTN>
                            <input type=submit value=添加/编辑 name=qvlan_add class=BTN_NORMAL_BTN
                                onclick="return addModQvlan()" style=width:65px>
                        </a>
                    </td>
                    <td class=SBLANK></td>
                    <td>
                        <a class=BTN>
                            <input type=button class=BTN_NORMAL_BTN value=帮助 name=help
                                onclick='doShowHelp("div_sec_title","div_help_lan_svr","Vlan8021QHelpRpm.htm")'>
                        </a>
                    </td>
                </tr>
            </table>
        </form>
        <form action=qvlanSet.cgi>
            <table class=BORDER>
                <tr class=TABLE_HEAD>
                    <td class=TD_FIRST_COL width=100px>VLAN</td>
                    <td class=TD_FIRST_COL width=150px>VLAN描述</td>
                    <td class=TD_FIRST_COL width=150px>成员端口</td>
                    <td class=TD_FIRST_COL width=150px>Tagged端口</td>
                    <td class=TD_FIRST_COL width=150px>Untagged端口</td>
                    <td class=TD_FIRST_COL width=100px>删除</td>
                </tr>
                <script type=text/javascript>
                    for (var i = 0; i < qvCnt; i++)
                        docW("<tr>"),
                        docW("<td>" + qvVids[i] + "</td>"),
                        docW("<td>" + qvNames[i] + "</td>"),
                        docW("<td>" + pbmToStr(qvTagMbrs[i] | qvUntagMbrs[i]) + "</td>"),
                        docW("<td>" + pbmToStr(qvTagMbrs[i]) + "</td>"),
                        docW("<td>" + pbmToStr(qvUntagMbrs[i]) + "</td>"),
                        docW("<td><input type=checkbox name=selVlans id=vlan_" + qvVids[i] + " value=" + qvVids[i] + "></td>"),
                        docW("</tr>")
                </script>
            </table>
            <script type=text/javascript>
                vlanShowSet()
            </script>
            <table align=center>
                <tr>
                    <td>
                        <a class=BTN>
                            <input type=button value=全选 name=selAll class=BTN_NORMAL_BTN onclick=selAllVlan()>
                        </a>
                    </td>
                    <td class=SBLANK></td>
                    <td>
                        <a class=BTN>
                            <input type=submit value=删除 name=qvlan_del class=BTN_NORMAL_BTN onclick="return delVlan()">
                        </a>
                    </td>
                </tr>
            </table>
        </form>
    </fieldset>
    <script>
        ShowHelp('<span class="HELP_TITLE" id="t_help_title">802.1Q VLAN</span> ')
    </script>
    <script>
        window.onload = function () {
            new Drag("div_help_lan_svr", "div_help_lan_svr")
        }
            ,
            "" != tip && (ShowTips("sp_tip_svr", tip),
                startDownScroll("div_tip_svr"))
    </script>