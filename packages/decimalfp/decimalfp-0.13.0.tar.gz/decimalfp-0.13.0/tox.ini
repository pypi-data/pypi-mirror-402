[tox]
envlist = {py311,py312,py313,py314,pypy3}-{test, perf}, cvrg, doc
isolated_build = True
recreate=true

[testenv]
deps =
    pytest
    pytest-benchmark
commands =
    test: pytest {posargs} test/func
    perf: pytest {posargs} test/perf
setenv =
    test: DEBUG=1
    perf: DEBUG=0

[testenv:cvrg]
deps =
    pytest
    pytest-cov
setenv =
    DECIMALFP_FORCE_PYTHON_IMPL=True
commands =
    pytest --cov=decimalfp --cov-report term-missing test/func


[testenv:doc]
allowlist_externals = make
deps =
    sphinx >= 4.0
    sphinx_py3doc_enhanced_theme >= 2.4
    typing_extensions
commands =
    make -C doc clean
    make -C doc html
