{"version":3,"file":"8547.a306b232cce0fcc3.js","sources":["webpack://insteon-frontend/./homeassistant-frontend/src/panels/config/cloud/dialog-cloud-already-connected/dialog-cloud-already-connected.ts","webpack://insteon-frontend/./homeassistant-frontend/src/util/url.ts"],"sourcesContent":["import { mdiEye, mdiEyeOff } from \"@mdi/js\";\nimport type { CSSResultGroup } from \"lit\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, state } from \"lit/decorators\";\nimport { formatDateTime } from \"../../../../common/datetime/format_date_time\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-button\";\nimport { createCloseHeading } from \"../../../../components/ha-dialog\";\nimport \"../../../../components/ha-icon-button\";\nimport { haStyleDialog } from \"../../../../resources/styles\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport { obfuscateUrl } from \"../../../../util/url\";\nimport type { CloudAlreadyConnectedParams as CloudAlreadyConnectedDialogParams } from \"./show-dialog-cloud-already-connected\";\n\n@customElement(\"dialog-cloud-already-connected\")\nclass DialogCloudAlreadyConnected extends LitElement {\n  public hass!: HomeAssistant;\n\n  @state() private _params?: CloudAlreadyConnectedDialogParams;\n\n  @state() private _obfuscateIp = true;\n\n  public showDialog(params: CloudAlreadyConnectedDialogParams) {\n    this._params = params;\n  }\n\n  public closeDialog() {\n    this._params?.closeDialog?.();\n    this._params = undefined;\n    this._obfuscateIp = true;\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  protected render() {\n    if (!this._params) {\n      return nothing;\n    }\n    const { details } = this._params;\n\n    return html`\n      <ha-dialog\n        open\n        @closed=${this.closeDialog}\n        .heading=${createCloseHeading(\n          this.hass,\n          this.hass.localize(\n            \"ui.panel.config.cloud.dialog_already_connected.heading\"\n          )\n        )}\n      >\n        <div class=\"intro\">\n          <span>\n            ${this.hass.localize(\n              \"ui.panel.config.cloud.dialog_already_connected.description\"\n            )}\n          </span>\n          <b>\n            ${this.hass.localize(\n              \"ui.panel.config.cloud.dialog_already_connected.other_home_assistant\"\n            )}\n          </b>\n        </div>\n        <div class=\"instance-details\">\n          ${details.name\n            ? html`<div class=\"instance-detail\">\n                <span>\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.dialog_already_connected.instance_name\"\n                  )}:\n                </span>\n                <span>${details.name}</span>\n              </div>`\n            : nothing}\n          ${details.version\n            ? html`<div class=\"instance-detail\">\n                <span>\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.dialog_already_connected.instance_version\"\n                  )}:\n                </span>\n                <span>${details.version}</span>\n              </div>`\n            : nothing}\n          <div class=\"instance-detail\">\n            <span>\n              ${this.hass.localize(\n                \"ui.panel.config.cloud.dialog_already_connected.ip_address\"\n              )}:\n            </span>\n            <div class=\"obfuscated\">\n              <span>\n                ${this._obfuscateIp\n                  ? obfuscateUrl(details.remote_ip_address)\n                  : details.remote_ip_address}\n              </span>\n\n              <ha-icon-button\n                class=\"toggle-unmasked-url\"\n                .label=${this.hass.localize(\n                  `ui.panel.config.cloud.dialog_already_connected.obfuscated_ip.${this._obfuscateIp ? \"hide\" : \"show\"}`\n                )}\n                @click=${this._toggleObfuscateIp}\n                .path=${this._obfuscateIp ? mdiEye : mdiEyeOff}\n              ></ha-icon-button>\n            </div>\n          </div>\n          <div class=\"instance-detail\">\n            <span>\n              ${this.hass.localize(\n                \"ui.panel.config.cloud.dialog_already_connected.connected_at\"\n              )}:\n            </span>\n            <span>\n              ${formatDateTime(\n                new Date(details.connected_at),\n                this.hass.locale,\n                this.hass.config\n              )}\n            </span>\n          </div>\n        </div>\n        <ha-alert\n          alert-type=\"info\"\n          .title=${this.hass.localize(\n            \"ui.panel.config.cloud.dialog_already_connected.info_backups.title\"\n          )}\n        >\n          ${this.hass.localize(\n            \"ui.panel.config.cloud.dialog_already_connected.info_backups.description\"\n          )}\n        </ha-alert>\n\n        <ha-button\n          appearance=\"plain\"\n          @click=${this.closeDialog}\n          slot=\"secondaryAction\"\n        >\n          ${this.hass!.localize(\"ui.common.cancel\")}\n        </ha-button>\n        <ha-button @click=${this._logInHere} slot=\"primaryAction\">\n          ${this.hass!.localize(\n            \"ui.panel.config.cloud.dialog_already_connected.login_here\"\n          )}\n        </ha-button>\n      </ha-dialog>\n    `;\n  }\n\n  private _toggleObfuscateIp() {\n    this._obfuscateIp = !this._obfuscateIp;\n  }\n\n  private _logInHere() {\n    this._params?.logInHereAction?.();\n    this.closeDialog();\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyleDialog,\n      css`\n        ha-dialog {\n          --mdc-dialog-max-width: 535px;\n        }\n        .intro b {\n          display: block;\n          margin-top: 16px;\n        }\n        .instance-details {\n          display: flex;\n          flex-direction: column;\n          margin-bottom: 16px;\n        }\n        .instance-detail {\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          align-items: center;\n        }\n        .obfuscated {\n          align-items: center;\n          display: flex;\n          flex-direction: row;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-cloud-already-connected\": DialogCloudAlreadyConnected;\n  }\n}\n","export function obfuscateUrl(url: string) {\n  if (url.endsWith(\".ui.nabu.casa\")) {\n    return \"https://•••••••••••••••••.ui.nabu.casa\";\n  }\n  // hide any words that look like they might be a hostname or IP address\n  return url.replace(/(?<=:\\/\\/)[\\w-]+|(?<=\\.)[\\w-]+/g, (match) =>\n    \"•\".repeat(match.length)\n  );\n}\n"],"names":["DialogCloudAlreadyConnected","LitElement","showDialog","params","this","_params","closeDialog","undefined","_obfuscateIp","fireEvent","dialog","localName","render","nothing","details","html","createCloseHeading","hass","localize","name","version","obfuscateUrl","remote_ip_address","_toggleObfuscateIp","mdiEye","mdiEyeOff","formatDateTime","Date","connected_at","locale","config","_logInHere","logInHereAction","styles","haStyleDialog","css","args","url","endsWith","replace","match","repeat","length"],"mappings":"yoCAeA,MAAAA,UAAAC,EAAAA,GAQSC,UAAAA,CAAAC,GACLC,KAAAC,QAAAF,CACF,CAEOG,WAAAA,GACLF,KAAAC,SAAAC,gBACAF,KAAAC,aAAAE,EACAH,KAAAI,cAAA,GACAC,EAAAA,EAAAA,GAAA,sBAAmCC,OAAA,KAAAC,WACrC,CAEUC,MAAAA,GACR,IAAKR,KAALC,QACE,OAAAQ,EAAAA,GAEF,MAAM,QAANC,GAAA,KAAAT,QAEA,OAAAU,EAAAA,EAAA;;;kBAGY,KAAAT;oBACCU,EAAAA,EAAAA,GAAA,KAAAC,KAAA,KAAAA,KAAAC,SAAA;;;;cASL,KAAAD,KAAAC,SAAA;;;cAKA,KAAAD,KAAAC,SAAA;;;;YAMFJ,EAAAK,KAAAJ,EAAAA,EAAA;;oBAGQ,KAAAE,KAAAC,SAAA;;wBAIIJ,EAAAK;sBACFN,EAAAA;YAEVC,EAAAM,QAAAL,EAAAA,EAAA;;oBAGQ,KAAAE,KAAAC,SAAA;;wBAIIJ,EAAAM;sBACFP,EAAAA;;;gBAIN,KAAAI,KAAAC,SAAA;;;;kBAME,KAAAV,cAAAa,EAAAA,EAAAA,GAAAP,EAAAQ,mBAAAR,EAAAQ;;;;;yBAOO,KAAAL,KAAAC,SAAA,sEAAAV,aAAA;yBAGA,KAAAe;wBACD,KAAAf,aAAAgB,EAAAC;;;;;;gBAMR,KAAAR,KAAAC,SAAA;;;iBAKAQ,EAAAA,EAAAA,IAAA,IAAAC,KAAAb,EAAAc,cAAA,KAAAX,KAAAY,OAAA,KAAAZ,KAAAa;;;;;;mBAUG,KAAAb,KAAAC,SAAA;;YAIP,KAAAD,KAAAC,SAAA;;;;;mBAOO,KAAAZ;;;YAGP,KAAAW,KAAAC,SAAA;;4BAEgB,KAAAa;YAChB,KAAAd,KAAAC,SAAA;;;KAMR,CAEQK,kBAAAA,GACNnB,KAAAI,cAAAJ,KAAAI,YACF,CAEQuB,UAAAA,GACN3B,KAAAC,SAAA2B,oBACA5B,KAAAE,aACF,CAEA,iBAAA2B,GACE,MAAO,CACLC,EAAAA,GACAC,EAAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;QA0BJ,C,kBA5KF,SAAAC,GAAA,KAAA5B,cAAA,C,8OCfO,SAAPa,EAAAgB,GACE,OAAAA,EAAAC,SAAA,iBACS,yCAGTD,EAAAE,QAAA,kCAAAC,GAAA,IAAAC,OAAAD,EAAAE,QAGF,C"}