{"version":3,"file":"1557.71c6e74514a01c6f.js","sources":["webpack://insteon-frontend/./homeassistant-frontend/src/common/util/copy-clipboard.ts","webpack://insteon-frontend/./homeassistant-frontend/src/components/ha-code-editor-completion-items.ts","webpack://insteon-frontend/./homeassistant-frontend/src/components/ha-code-editor.ts","webpack://insteon-frontend/./homeassistant-frontend/src/components/ha-icon-button-group.ts","webpack://insteon-frontend/./homeassistant-frontend/src/components/ha-icon-button-toolbar.ts"],"sourcesContent":["export const copyToClipboard = async (str, rootEl?: HTMLElement) => {\n  if (navigator.clipboard) {\n    try {\n      await navigator.clipboard.writeText(str);\n      return;\n    } catch {\n      // just continue with the fallback coding below\n    }\n  }\n\n  const root = rootEl ?? document.body;\n\n  const el = document.createElement(\"textarea\");\n  el.value = str;\n  root.appendChild(el);\n  el.select();\n  document.execCommand(\"copy\");\n  root.removeChild(el);\n};\n","import { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\n\nexport interface CompletionItem {\n  label: string;\n  value: string;\n  subValue?: string;\n}\n\n@customElement(\"ha-code-editor-completion-items\")\nexport class HaCodeEditorCompletionItems extends LitElement {\n  @property({ attribute: false }) public items: CompletionItem[] = [];\n\n  render() {\n    return this.items.map(\n      (item) => html`\n        <span><strong>${item.label}</strong>:</span>\n        <span\n          >${item.value}${item.subValue && item.subValue.length > 0\n            ? // prettier-ignore\n              html` (<pre>${item.subValue}</pre>)`\n            : nothing}</span\n        >\n      `\n    );\n  }\n\n  static styles = css`\n    :host {\n      display: grid;\n      grid-template-columns: auto 1fr;\n      gap: 6px;\n      white-space: pre-wrap;\n      flex-wrap: nowrap;\n    }\n\n    span {\n      display: flex;\n      align-items: center;\n      flex-flow: wrap;\n      word-wrap: break-word;\n    }\n\n    pre {\n      margin: 0 3px;\n      padding: 3px;\n      background-color: var(--markdown-code-background-color, none);\n      border-radius: var(--ha-border-radius-sm);\n      line-height: var(--ha-line-height-condensed);\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-code-editor-completion-items\": HaCodeEditorCompletionItems;\n  }\n}\n","import type {\n  Completion,\n  CompletionContext,\n  CompletionInfo,\n  CompletionResult,\n  CompletionSource,\n} from \"@codemirror/autocomplete\";\nimport { redo, redoDepth, undo, undoDepth } from \"@codemirror/commands\";\nimport type { Extension, TransactionSpec } from \"@codemirror/state\";\nimport type { EditorView, KeyBinding, ViewUpdate } from \"@codemirror/view\";\nimport { placeholder } from \"@codemirror/view\";\nimport {\n  mdiArrowCollapse,\n  mdiArrowExpand,\n  mdiContentCopy,\n  mdiRedo,\n  mdiUndo,\n} from \"@mdi/js\";\nimport type { HassEntities } from \"home-assistant-js-websocket\";\nimport type { PropertyValues } from \"lit\";\nimport { css, html, ReactiveElement, render } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { stopPropagation } from \"../common/dom/stop_propagation\";\nimport { getEntityContext } from \"../common/entity/context/get_entity_context\";\nimport { copyToClipboard } from \"../common/util/copy-clipboard\";\nimport type { HomeAssistant } from \"../types\";\nimport { showToast } from \"../util/toast\";\nimport \"./ha-code-editor-completion-items\";\nimport type { CompletionItem } from \"./ha-code-editor-completion-items\";\nimport \"./ha-icon\";\nimport \"./ha-icon-button-toolbar\";\nimport type { HaIconButtonToolbar } from \"./ha-icon-button-toolbar\";\n\ndeclare global {\n  interface HASSDomEvents {\n    \"editor-save\": undefined;\n  }\n}\n\nconst saveKeyBinding: KeyBinding = {\n  key: \"Mod-s\",\n  run: (view: EditorView) => {\n    fireEvent(view.dom, \"editor-save\");\n    return true;\n  },\n};\n\nconst renderIcon = (completion: Completion) => {\n  const icon = document.createElement(\"ha-icon\");\n  icon.icon = completion.label;\n  return icon;\n};\n\n@customElement(\"ha-code-editor\")\nexport class HaCodeEditor extends ReactiveElement {\n  public codemirror?: EditorView;\n\n  @property() public mode = \"yaml\";\n\n  public hass?: HomeAssistant;\n\n  // eslint-disable-next-line lit/no-native-attributes\n  @property({ type: Boolean }) public autofocus = false;\n\n  @property({ attribute: \"read-only\", type: Boolean }) public readOnly = false;\n\n  @property({ type: Boolean }) public linewrap = false;\n\n  @property({ type: Boolean, attribute: \"autocomplete-entities\" })\n  public autocompleteEntities = false;\n\n  @property({ type: Boolean, attribute: \"autocomplete-icons\" })\n  public autocompleteIcons = false;\n\n  @property({ type: Boolean }) public error = false;\n\n  @property({ type: Boolean, attribute: \"disable-fullscreen\" })\n  public disableFullscreen = false;\n\n  @property({ type: Boolean, attribute: \"has-toolbar\" })\n  public hasToolbar = true;\n\n  @property({ type: String }) public placeholder?: string;\n\n  @state() private _value = \"\";\n\n  @state() private _isFullscreen = false;\n\n  @state() private _canUndo = false;\n\n  @state() private _canRedo = false;\n\n  @state() private _canCopy = false;\n\n  // eslint-disable-next-line @typescript-eslint/consistent-type-imports\n  private _loadedCodeMirror?: typeof import(\"../resources/codemirror\");\n\n  private _editorToolbar?: HaIconButtonToolbar;\n\n  private _iconList?: Completion[];\n\n  public set value(value: string) {\n    this._value = value;\n  }\n\n  public get value(): string {\n    return this.codemirror ? this.codemirror.state.doc.toString() : this._value;\n  }\n\n  public get hasComments(): boolean {\n    if (!this.codemirror || !this._loadedCodeMirror) {\n      return false;\n    }\n    const className = this._loadedCodeMirror.highlightingFor(\n      this.codemirror.state,\n      [this._loadedCodeMirror.tags.comment]\n    );\n    return !!this.renderRoot.querySelector(`span.${className}`);\n  }\n\n  public connectedCallback() {\n    super.connectedCallback();\n    // Force update on reconnection so editor is recreated\n    if (this.hasUpdated) {\n      this.requestUpdate();\n    }\n    this.addEventListener(\"keydown\", stopPropagation);\n    this.addEventListener(\"keydown\", this._handleKeyDown);\n    // This is unreachable as editor will not exist yet,\n    // but focus should not behave like this for good a11y.\n    // (@steverep to fix in autofocus PR)\n    if (!this.codemirror) {\n      return;\n    }\n    if (this.autofocus !== false) {\n      this.codemirror.focus();\n    }\n  }\n\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeEventListener(\"keydown\", stopPropagation);\n    this.removeEventListener(\"keydown\", this._handleKeyDown);\n    this._updateFullscreenState(false);\n    this.updateComplete.then(() => {\n      this.codemirror!.destroy();\n      delete this.codemirror;\n    });\n  }\n\n  // Ensure CodeMirror module is loaded before any update\n  protected override async scheduleUpdate() {\n    this._loadedCodeMirror ??= await import(\"../resources/codemirror\");\n    super.scheduleUpdate();\n  }\n\n  protected update(changedProps: PropertyValues): void {\n    super.update(changedProps);\n    if (!this.codemirror) {\n      this._createCodeMirror();\n      return;\n    }\n    const transactions: TransactionSpec[] = [];\n    if (changedProps.has(\"mode\")) {\n      transactions.push({\n        effects: [\n          this._loadedCodeMirror!.langCompartment!.reconfigure(this._mode),\n          this._loadedCodeMirror!.foldingCompartment.reconfigure(\n            this._getFoldingExtensions()\n          ),\n        ],\n      });\n    }\n    if (changedProps.has(\"readOnly\")) {\n      transactions.push({\n        effects: this._loadedCodeMirror!.readonlyCompartment!.reconfigure(\n          this._loadedCodeMirror!.EditorView!.editable.of(!this.readOnly)\n        ),\n      });\n      this._updateToolbarButtons();\n    }\n    if (changedProps.has(\"linewrap\")) {\n      transactions.push({\n        effects: this._loadedCodeMirror!.linewrapCompartment!.reconfigure(\n          this.linewrap ? this._loadedCodeMirror!.EditorView.lineWrapping : []\n        ),\n      });\n    }\n    if (changedProps.has(\"_value\") && this._value !== this.value) {\n      transactions.push({\n        changes: {\n          from: 0,\n          to: this.codemirror.state.doc.length,\n          insert: this._value,\n        },\n      });\n    }\n    if (transactions.length > 0) {\n      this.codemirror.dispatch(...transactions);\n    }\n    if (changedProps.has(\"hasToolbar\")) {\n      this._updateToolbar();\n    }\n    if (changedProps.has(\"error\")) {\n      this.classList.toggle(\"error-state\", this.error);\n    }\n    if (changedProps.has(\"_isFullscreen\")) {\n      this.classList.toggle(\"fullscreen\", this._isFullscreen);\n      this._updateToolbarButtons();\n    }\n    if (\n      changedProps.has(\"_canCopy\") ||\n      changedProps.has(\"_canUndo\") ||\n      changedProps.has(\"_canRedo\")\n    ) {\n      this._updateToolbarButtons();\n    }\n    if (changedProps.has(\"disableFullscreen\")) {\n      this._updateFullscreenState();\n    }\n  }\n\n  private get _mode() {\n    return this._loadedCodeMirror!.langs[this.mode];\n  }\n\n  private _createCodeMirror() {\n    if (!this._loadedCodeMirror) {\n      throw new Error(\"Cannot create editor before CodeMirror is loaded\");\n    }\n    const extensions: Extension[] = [\n      this._loadedCodeMirror.lineNumbers(),\n      this._loadedCodeMirror.history(),\n      this._loadedCodeMirror.drawSelection(),\n      this._loadedCodeMirror.EditorState.allowMultipleSelections.of(true),\n      this._loadedCodeMirror.rectangularSelection(),\n      this._loadedCodeMirror.crosshairCursor(),\n      this._loadedCodeMirror.highlightSelectionMatches(),\n      this._loadedCodeMirror.highlightActiveLine(),\n      this._loadedCodeMirror.dropCursor(),\n      this._loadedCodeMirror.indentationMarkers({\n        thickness: 0,\n        activeThickness: 1,\n        colors: {\n          activeLight: \"var(--secondary-text-color)\",\n          activeDark: \"var(--secondary-text-color)\",\n        },\n      }),\n      this._loadedCodeMirror.keymap.of([\n        ...this._loadedCodeMirror.defaultKeymap,\n        ...this._loadedCodeMirror.searchKeymap,\n        ...this._loadedCodeMirror.historyKeymap,\n        ...this._loadedCodeMirror.tabKeyBindings,\n        saveKeyBinding,\n      ]),\n      this._loadedCodeMirror.langCompartment.of(this._mode),\n      this._loadedCodeMirror.haTheme,\n      this._loadedCodeMirror.haSyntaxHighlighting,\n      this._loadedCodeMirror.readonlyCompartment.of(\n        this._loadedCodeMirror.EditorView.editable.of(!this.readOnly)\n      ),\n      this._loadedCodeMirror.linewrapCompartment.of(\n        this.linewrap ? this._loadedCodeMirror.EditorView.lineWrapping : []\n      ),\n      this._loadedCodeMirror.EditorView.updateListener.of(this._onUpdate),\n      this._loadedCodeMirror.foldingCompartment.of(\n        this._getFoldingExtensions()\n      ),\n      ...(this.placeholder ? [placeholder(this.placeholder)] : []),\n    ];\n\n    if (!this.readOnly) {\n      const completionSources: CompletionSource[] = [];\n      if (this.autocompleteEntities && this.hass) {\n        completionSources.push(this._entityCompletions.bind(this));\n      }\n      if (this.autocompleteIcons) {\n        completionSources.push(this._mdiCompletions.bind(this));\n      }\n      if (completionSources.length > 0) {\n        extensions.push(\n          this._loadedCodeMirror.autocompletion({\n            override: completionSources,\n            maxRenderedOptions: 10,\n          })\n        );\n      }\n    }\n\n    // Create the code editor\n    this.codemirror = new this._loadedCodeMirror.EditorView({\n      state: this._loadedCodeMirror.EditorState.create({\n        doc: this._value,\n        extensions,\n      }),\n      parent: this.renderRoot,\n    });\n    this._canCopy = this._value?.length > 0;\n\n    // Update the toolbar. Creating it if required\n    this._updateToolbar();\n  }\n\n  private _fullscreenLabel(): string {\n    if (this._isFullscreen)\n      return (\n        this.hass?.localize(\"ui.components.yaml-editor.exit_fullscreen\") ||\n        \"Exit fullscreen\"\n      );\n    return (\n      this.hass?.localize(\"ui.components.yaml-editor.enter_fullscreen\") ||\n      \"Enter fullscreen\"\n    );\n  }\n\n  private _fullscreenIcon(): string {\n    return this._isFullscreen ? mdiArrowCollapse : mdiArrowExpand;\n  }\n\n  private _createEditorToolbar(): HaIconButtonToolbar {\n    // Create the editor toolbar element\n    const editorToolbar = document.createElement(\"ha-icon-button-toolbar\");\n    editorToolbar.classList.add(\"code-editor-toolbar\");\n    editorToolbar.items = [];\n    return editorToolbar;\n  }\n\n  private _updateToolbar() {\n    // Show/Hide the toolbar if we have one.\n    this.classList.toggle(\"hasToolbar\", this.hasToolbar);\n\n    // Update fullscreen state. Handles toolbar and fullscreen mode being disabled.\n    this._updateFullscreenState();\n\n    // If we don't have a toolbar, nothing to update\n    if (!this.hasToolbar) {\n      return;\n    }\n\n    // If we don't yet have the toolbar, create it.\n    if (!this._editorToolbar) {\n      this._editorToolbar = this._createEditorToolbar();\n    }\n\n    // Ensure all toolbar buttons are correctly configured.\n    this._updateToolbarButtons();\n\n    // Render the toolbar. This must be placed as a child of the code\n    // mirror element to ensure it doesn't affect the positioning and\n    // size of codemirror.\n    this.codemirror?.dom.appendChild(this._editorToolbar);\n  }\n\n  private _updateToolbarButtons() {\n    // Re-render all toolbar items.\n    if (!this._editorToolbar) {\n      return;\n    }\n\n    this._editorToolbar.items = [\n      {\n        id: \"undo\",\n        disabled: !this._canUndo,\n        label: this.hass?.localize(\"ui.common.undo\") || \"Undo\",\n        path: mdiUndo,\n        action: (e: Event) => this._handleUndoClick(e),\n      },\n      {\n        id: \"redo\",\n        disabled: !this._canRedo,\n        label: this.hass?.localize(\"ui.common.redo\") || \"Redo\",\n        path: mdiRedo,\n        action: (e: Event) => this._handleRedoClick(e),\n      },\n      {\n        id: \"copy\",\n        disabled: !this._canCopy,\n        label:\n          this.hass?.localize(\"ui.components.yaml-editor.copy_to_clipboard\") ||\n          \"Copy to Clipboard\",\n        path: mdiContentCopy,\n        action: (e: Event) => this._handleClipboardClick(e),\n      },\n      {\n        id: \"fullscreen\",\n        disabled: this.disableFullscreen,\n        label: this._fullscreenLabel(),\n        path: this._fullscreenIcon(),\n        action: (e: Event) => this._handleFullscreenClick(e),\n      },\n    ];\n  }\n\n  private _updateFullscreenState(\n    fullscreen: boolean = this._isFullscreen\n  ): boolean {\n    // Update the current fullscreen state based on selected value. If fullscreen\n    // is disabled, or we have no toolbar, ensure we are not in fullscreen mode.\n    this._isFullscreen =\n      fullscreen && !this.disableFullscreen && this.hasToolbar;\n    // Return whether successfully in requested state\n    return this._isFullscreen === fullscreen;\n  }\n\n  private _handleClipboardClick = async (e: Event) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.value) {\n      await copyToClipboard(this.value);\n      showToast(this, {\n        message:\n          this.hass?.localize(\"ui.common.copied_clipboard\") ||\n          \"Copied to clipboard\",\n      });\n    }\n  };\n\n  private _handleUndoClick = (e: Event) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!this.codemirror) {\n      return;\n    }\n    undo(this.codemirror);\n  };\n\n  private _handleRedoClick = (e: Event) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!this.codemirror) {\n      return;\n    }\n    redo(this.codemirror);\n  };\n\n  private _handleFullscreenClick = (e: Event) => {\n    e.preventDefault();\n    e.stopPropagation();\n    this._updateFullscreenState(!this._isFullscreen);\n  };\n\n  private _handleKeyDown = (e: KeyboardEvent) => {\n    if (\n      (e.key === \"Escape\" &&\n        this._isFullscreen &&\n        this._updateFullscreenState(false)) ||\n      (e.key === \"F11\" && this._updateFullscreenState(true))\n    ) {\n      // If we successfully performed the action, stop it propagating further.\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  private _renderInfo = (completion: Completion): CompletionInfo => {\n    const key = completion.label;\n    const context = getEntityContext(\n      this.hass!.states[key],\n      this.hass!.entities,\n      this.hass!.devices,\n      this.hass!.areas,\n      this.hass!.floors\n    );\n\n    const completionInfo = document.createElement(\"div\");\n    completionInfo.classList.add(\"completion-info\");\n\n    const formattedState = this.hass!.formatEntityState(this.hass!.states[key]);\n\n    const completionItems: CompletionItem[] = [\n      {\n        label: this.hass!.localize(\n          \"ui.components.entity.entity-state-picker.state\"\n        ),\n        value: formattedState,\n        subValue:\n          // If the state exactly matches the formatted state, don't show the raw state\n          this.hass!.states[key].state === formattedState\n            ? undefined\n            : this.hass!.states[key].state,\n      },\n    ];\n\n    if (context.device && context.device.name) {\n      completionItems.push({\n        label: this.hass!.localize(\"ui.components.device-picker.device\"),\n        value: context.device.name,\n      });\n    }\n\n    if (context.area && context.area.name) {\n      completionItems.push({\n        label: this.hass!.localize(\"ui.components.area-picker.area\"),\n        value: context.area.name,\n      });\n    }\n\n    if (context.floor && context.floor.name) {\n      completionItems.push({\n        label: this.hass!.localize(\"ui.components.floor-picker.floor\"),\n        value: context.floor.name,\n      });\n    }\n\n    render(\n      html`\n        <ha-code-editor-completion-items\n          .items=${completionItems}\n        ></ha-code-editor-completion-items>\n      `,\n      completionInfo\n    );\n\n    return completionInfo;\n  };\n\n  private _getStates = memoizeOne((states: HassEntities): Completion[] => {\n    if (!states) {\n      return [];\n    }\n\n    const options = Object.keys(states).map((key) => ({\n      type: \"variable\",\n      label: key,\n      detail: states[key].attributes.friendly_name,\n      info: this._renderInfo,\n    }));\n\n    return options;\n  });\n\n  private _entityCompletions(\n    context: CompletionContext\n  ): CompletionResult | null | Promise<CompletionResult | null> {\n    // Check for YAML mode and entity-related fields\n    if (this.mode === \"yaml\") {\n      const currentLine = context.state.doc.lineAt(context.pos);\n      const lineText = currentLine.text;\n\n      // Properties that commonly contain entity IDs\n      const entityProperties = [\n        \"entity_id\",\n        \"entity\",\n        \"entities\",\n        \"badges\",\n        \"devices\",\n        \"lights\",\n        \"light\",\n        \"group_members\",\n        \"scene\",\n        \"zone\",\n        \"zones\",\n      ];\n\n      // Create regex pattern for all entity properties\n      const propertyPattern = entityProperties.join(\"|\");\n      const entityFieldRegex = new RegExp(\n        `^\\\\s*(-\\\\s+)?(${propertyPattern}):\\\\s*`\n      );\n\n      // Check if we're in an entity field (single entity or list item)\n      const entityFieldMatch = lineText.match(entityFieldRegex);\n      const listItemMatch = lineText.match(/^\\s*-\\s+/);\n\n      if (entityFieldMatch) {\n        // Calculate the position after the entity field\n        const afterField = currentLine.from + entityFieldMatch[0].length;\n\n        // If cursor is after the entity field, show all entities\n        if (context.pos >= afterField) {\n          const states = this._getStates(this.hass!.states);\n\n          if (!states || !states.length) {\n            return null;\n          }\n\n          // Find what's already typed after the field\n          const typedText = context.state.sliceDoc(afterField, context.pos);\n\n          // Filter states based on what's typed\n          const filteredStates = typedText\n            ? states.filter((entityState) =>\n                entityState.label\n                  .toLowerCase()\n                  .startsWith(typedText.toLowerCase())\n              )\n            : states;\n\n          return {\n            from: afterField,\n            options: filteredStates,\n            validFor: /^[a-z_]*\\.?\\w*$/,\n          };\n        }\n      } else if (listItemMatch) {\n        // Check if this is a list item under an entity_id field\n        const lineNumber = currentLine.number;\n\n        // Look at previous lines to check if we're under an entity_id field\n        for (let i = lineNumber - 1; i > 0 && i >= lineNumber - 10; i--) {\n          const prevLine = context.state.doc.line(i);\n          const prevText = prevLine.text;\n\n          // Stop if we hit a non-indented line (new field)\n          if (\n            prevText.trim() &&\n            !prevText.startsWith(\" \") &&\n            !prevText.startsWith(\"\\t\")\n          ) {\n            break;\n          }\n\n          // Check if we found an entity property field\n          const entityListFieldRegex = new RegExp(\n            `^\\\\s*(${propertyPattern}):\\\\s*$`\n          );\n          if (prevText.match(entityListFieldRegex)) {\n            // We're in a list under an entity field\n            const afterListMarker = currentLine.from + listItemMatch[0].length;\n\n            if (context.pos >= afterListMarker) {\n              const states = this._getStates(this.hass!.states);\n\n              if (!states || !states.length) {\n                return null;\n              }\n\n              // Find what's already typed after the list marker\n              const typedText = context.state.sliceDoc(\n                afterListMarker,\n                context.pos\n              );\n\n              // Filter states based on what's typed\n              const filteredStates = typedText\n                ? states.filter((entityState) =>\n                    entityState.label\n                      .toLowerCase()\n                      .startsWith(typedText.toLowerCase())\n                  )\n                : states;\n\n              return {\n                from: afterListMarker,\n                options: filteredStates,\n                validFor: /^[a-z_]*\\.?\\w*$/,\n              };\n            }\n          }\n        }\n      }\n\n      // Properties that should never suggest entities\n      const negativeProperties = [\"action\"];\n\n      // Create regex pattern for negative properties\n      const negativePropertyPattern = negativeProperties.join(\"|\");\n      const negativeEntityFieldRegex = new RegExp(\n        `^\\\\s*(-\\\\s+)?(${negativePropertyPattern}):\\\\s*`\n      );\n      if (lineText.match(negativeEntityFieldRegex)) {\n        return null;\n      }\n    }\n\n    // Original entity completion logic for non-YAML or when not in entity_id field\n    const entityWord = context.matchBefore(/[a-z_]{3,}\\.\\w*/);\n\n    if (\n      !entityWord ||\n      (entityWord.from === entityWord.to && !context.explicit)\n    ) {\n      return null;\n    }\n\n    const states = this._getStates(this.hass!.states);\n\n    if (!states || !states.length) {\n      return null;\n    }\n\n    return {\n      from: Number(entityWord.from),\n      options: states,\n      validFor: /^[a-z_]{3,}\\.\\w*$/,\n    };\n  }\n\n  private _getIconItems = async (): Promise<Completion[]> => {\n    if (!this._iconList) {\n      let iconList: {\n        name: string;\n        keywords: string[];\n      }[];\n      if (__SUPERVISOR__) {\n        iconList = [];\n      } else {\n        iconList = (await import(\"../../build/mdi/iconList.json\")).default;\n      }\n\n      this._iconList = iconList.map((icon) => ({\n        type: \"variable\",\n        label: `mdi:${icon.name}`,\n        detail: icon.keywords.join(\", \"),\n        info: renderIcon,\n      }));\n    }\n\n    return this._iconList;\n  };\n\n  private async _mdiCompletions(\n    context: CompletionContext\n  ): Promise<CompletionResult | null> {\n    const match = context.matchBefore(/mdi:\\S*/);\n\n    if (!match || (match.from === match.to && !context.explicit)) {\n      return null;\n    }\n\n    const iconItems = await this._getIconItems();\n\n    return {\n      from: Number(match.from),\n      options: iconItems,\n      validFor: /^mdi:\\S*$/,\n    };\n  }\n\n  private _onUpdate = (update: ViewUpdate): void => {\n    this._canUndo = !this.readOnly && undoDepth(update.state) > 0;\n    this._canRedo = !this.readOnly && redoDepth(update.state) > 0;\n    if (!update.docChanged) {\n      return;\n    }\n    this._value = update.state.doc.toString();\n    this._canCopy = this._value?.length > 0;\n    fireEvent(this, \"value-changed\", { value: this._value });\n  };\n\n  private _getFoldingExtensions = (): Extension => {\n    if (this.mode === \"yaml\") {\n      return [\n        this._loadedCodeMirror!.foldGutter(),\n        this._loadedCodeMirror!.foldingOnIndent,\n      ];\n    }\n\n    return [];\n  };\n\n  static styles = css`\n    :host {\n      position: relative;\n      display: block;\n      --code-editor-toolbar-height: 28px;\n    }\n\n    :host(.error-state) .cm-gutters {\n      border-color: var(--error-state-color, var(--error-color)) !important;\n    }\n\n    :host(.hasToolbar) .cm-gutters {\n      padding-top: 0;\n    }\n\n    :host(.hasToolbar) .cm-focused .cm-gutters {\n      padding-top: 1px;\n    }\n\n    :host(.error-state) .cm-content {\n      border-color: var(--error-state-color, var(--error-color)) !important;\n    }\n\n    :host(.hasToolbar) .cm-content {\n      border: none;\n      border-top: 1px solid var(--secondary-text-color);\n    }\n\n    :host(.hasToolbar) .cm-focused .cm-content {\n      border-top: 2px solid var(--primary-color);\n      padding-top: 15px;\n    }\n\n    :host(.fullscreen) {\n      position: fixed !important;\n      top: calc(var(--header-height, 56px) + 8px) !important;\n      left: 8px !important;\n      right: 8px !important;\n      bottom: 8px !important;\n      z-index: 6;\n      border-radius: var(--ha-border-radius-lg) !important;\n      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3) !important;\n      overflow: hidden !important;\n      background-color: var(\n        --code-editor-background-color,\n        var(--card-background-color)\n      ) !important;\n      margin: 0 !important;\n      padding-top: var(--safe-area-inset-top) !important;\n      padding-left: var(--safe-area-inset-left) !important;\n      padding-right: var(--safe-area-inset-right) !important;\n      padding-bottom: var(--safe-area-inset-bottom) !important;\n      box-sizing: border-box !important;\n      display: block !important;\n    }\n\n    :host(.hasToolbar) .cm-editor {\n      padding-top: var(--code-editor-toolbar-height);\n    }\n\n    :host(.fullscreen) .cm-editor {\n      height: 100% !important;\n      max-height: 100% !important;\n      border-radius: var(--ha-border-radius-square) !important;\n    }\n\n    :host(:not(.hasToolbar)) .code-editor-toolbar {\n      display: none !important;\n    }\n\n    .code-editor-toolbar {\n      --icon-button-toolbar-height: var(--code-editor-toolbar-height);\n      --icon-button-toolbar-color: var(\n        --code-editor-gutter-color,\n        var(--secondary-background-color, whitesmoke)\n      );\n      border-top-left-radius: var(--ha-border-radius-sm);\n      border-top-right-radius: var(--ha-border-radius-sm);\n    }\n\n    .completion-info {\n      display: grid;\n      gap: 3px;\n      padding: 8px;\n    }\n\n    /* Hide completion info on narrow screens */\n    @media (max-width: 600px) {\n      .cm-completionInfo,\n      .completion-info {\n        display: none;\n      }\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-code-editor\": HaCodeEditor;\n  }\n}\n","import type { TemplateResult } from \"lit\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement } from \"lit/decorators\";\n\n@customElement(\"ha-icon-button-group\")\nexport class HaIconButtonGroup extends LitElement {\n  protected render(): TemplateResult {\n    return html`<slot></slot>`;\n  }\n\n  static styles = css`\n    :host {\n      position: relative;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      height: 48px;\n      border-radius: var(--ha-border-radius-4xl);\n      background-color: rgba(139, 145, 151, 0.1);\n      box-sizing: border-box;\n      width: auto;\n      padding: 0;\n    }\n    ::slotted(.separator) {\n      background-color: rgba(var(--rgb-primary-text-color), 0.15);\n      width: 1px;\n      margin: 0 1px;\n      height: 40px;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon-button-group\": HaIconButtonGroup;\n  }\n}\n","import type { TemplateResult } from \"lit\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, queryAll } from \"lit/decorators\";\nimport \"./ha-icon\";\nimport \"./ha-icon-button\";\nimport type { HaIconButton } from \"./ha-icon-button\";\nimport \"./ha-icon-button-group\";\nimport \"./ha-tooltip\";\n\nexport interface HaIconButtonToolbarItem {\n  [key: string]: any;\n  path: string;\n  label: string;\n  id?: string;\n  disabled?: boolean;\n  tooltip?: string;\n  action?: (e: Event) => any;\n}\n\n@customElement(\"ha-icon-button-toolbar\")\nexport class HaIconButtonToolbar extends LitElement {\n  @property({ type: Array, attribute: false })\n  public items: (HaIconButtonToolbarItem | string)[] = [];\n\n  @queryAll(\"ha-icon-button\") private _buttons?: HaIconButton[];\n\n  // Returns all toolbar buttons, or undefined if there are none.\n  // Optionally returns only those with matching selector.\n  public findToolbarButtons(selector = \"\"): HaIconButton[] | undefined {\n    // Search for all toolbar buttons\n    const toolbarButtons = this._buttons?.filter((button) =>\n      button.classList.contains(\"icon-toolbar-button\")\n    );\n    if (!toolbarButtons || !toolbarButtons.length) return undefined;\n    if (!selector.length) return toolbarButtons;\n    // Filter by user class if provided\n    const classButtons = toolbarButtons.filter((button) =>\n      button.querySelector(selector)\n    );\n    return classButtons.length ? classButtons : undefined;\n  }\n\n  // Returns a toolbar button based on the provided id.\n  // Will return undefined if not found.\n  public findToolbarButtonById(id): HaIconButton | undefined {\n    // Find the specified id\n    const element = this.shadowRoot?.getElementById(id);\n    if (!element || element.localName !== \"ha-icon-button\") return undefined;\n    return element as HaIconButton;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <ha-icon-button-group class=\"icon-toolbar-buttongroup\">\n        ${this.items.map((item) =>\n          typeof item === \"string\"\n            ? html`<div class=\"icon-toolbar-divider\" role=\"separator\"></div>`\n            : html`<ha-tooltip\n                  .disabled=${!item.tooltip}\n                  .for=${item.id ?? \"icon-button-\" + item.label}\n                  >${item.tooltip ?? \"\"}</ha-tooltip\n                >\n                <ha-icon-button\n                  class=\"icon-toolbar-button\"\n                  .id=${item.id ?? \"icon-button-\" + item.label}\n                  @click=${item.action}\n                  .label=${item.label}\n                  .path=${item.path}\n                  .disabled=${item.disabled ?? false}\n                ></ha-icon-button>`\n        )}\n      </ha-icon-button-group>\n    `;\n  }\n\n  static styles = css`\n    :host {\n      position: absolute;\n      top: 0px;\n      width: 100%;\n      display: flex;\n      flex-direction: row-reverse;\n      background-color: var(\n        --icon-button-toolbar-color,\n        var(--secondary-background-color, whitesmoke)\n      );\n      --icon-button-toolbar-height: 32px;\n      --icon-button-toolbar-button: calc(\n        var(--icon-button-toolbar-height) - 4px\n      );\n      --icon-button-toolbar-icon: calc(\n        var(--icon-button-toolbar-height) - 10px\n      );\n    }\n\n    .icon-toolbar-divider {\n      height: var(--icon-button-toolbar-icon);\n      margin: 0px 4px;\n      border: 0.5px solid\n        var(--divider-color, var(--secondary-text-color, transparent));\n    }\n\n    .icon-toolbar-buttongroup {\n      background-color: transparent;\n      padding-right: 4px;\n      height: var(--icon-button-toolbar-height);\n      gap: var(--ha-space-2);\n    }\n\n    .icon-toolbar-button {\n      color: var(--secondary-text-color);\n      --mdc-icon-button-size: var(--icon-button-toolbar-button);\n      --mdc-icon-size: var(--icon-button-toolbar-icon);\n      /* Ensure button is clickable on iOS */\n      cursor: pointer;\n      -webkit-tap-highlight-color: transparent;\n      touch-action: manipulation;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon-button-toolbar\": HaIconButtonToolbar;\n  }\n}\n"],"names":["copyToClipboard","str","rootEl","navigator","clipboard","writeText","root","document","body","el","createElement","value","appendChild","select","execCommand","removeChild","HaCodeEditorCompletionItems","LitElement","render","this","items","map","item","html","label","subValue","length","nothing","args","styles","css","attribute","mdiArrowCollapse","mdiArrowExpand","mdiContentCopy","mdiRedo","mdiUndo","saveKeyBinding","key","run","view","fireEvent","dom","renderIcon","completion","icon","HaCodeEditor","ReactiveElement","_value","codemirror","state","doc","toString","hasComments","_loadedCodeMirror","className","highlightingFor","tags","comment","renderRoot","querySelector","connectedCallback","super","hasUpdated","requestUpdate","addEventListener","stopPropagation","_handleKeyDown","autofocus","focus","disconnectedCallback","removeEventListener","_updateFullscreenState","updateComplete","then","destroy","scheduleUpdate","update","changedProps","_createCodeMirror","transactions","has","push","effects","langCompartment","reconfigure","_mode","foldingCompartment","_getFoldingExtensions","readonlyCompartment","EditorView","editable","of","readOnly","_updateToolbarButtons","linewrapCompartment","linewrap","lineWrapping","changes","from","to","insert","dispatch","_updateToolbar","classList","toggle","error","_isFullscreen","langs","mode","Error","extensions","lineNumbers","history","drawSelection","EditorState","allowMultipleSelections","rectangularSelection","crosshairCursor","highlightSelectionMatches","highlightActiveLine","dropCursor","indentationMarkers","thickness","activeThickness","colors","activeLight","activeDark","keymap","defaultKeymap","searchKeymap","historyKeymap","tabKeyBindings","haTheme","haSyntaxHighlighting","updateListener","_onUpdate","placeholder","completionSources","autocompleteEntities","hass","_entityCompletions","bind","autocompleteIcons","_mdiCompletions","autocompletion","override","maxRenderedOptions","create","parent","_canCopy","_fullscreenLabel","localize","_fullscreenIcon","_createEditorToolbar","editorToolbar","add","hasToolbar","_editorToolbar","id","disabled","_canUndo","path","action","e","_handleUndoClick","_canRedo","_handleRedoClick","_handleClipboardClick","disableFullscreen","_handleFullscreenClick","fullscreen","context","currentLine","lineAt","pos","lineText","text","propertyPattern","join","entityFieldRegex","RegExp","entityFieldMatch","match","listItemMatch","afterField","states","_getStates","typedText","sliceDoc","options","filter","entityState","toLowerCase","startsWith","validFor","lineNumber","number","i","prevText","line","trim","entityListFieldRegex","afterListMarker","negativePropertyPattern","negativeEntityFieldRegex","entityWord","matchBefore","explicit","Number","iconItems","_getIconItems","preventDefault","showToast","message","undo","redo","_renderInfo","getEntityContext","entities","devices","areas","floors","completionInfo","formattedState","formatEntityState","completionItems","undefined","device","name","area","floor","memoizeOne","Object","keys","type","detail","attributes","friendly_name","info","_iconList","iconList","default","keywords","undoDepth","redoDepth","docChanged","foldGutter","foldingOnIndent","Boolean","String","HaIconButtonGroup","HaIconButtonToolbar","findToolbarButtons","selector","toolbarButtons","_buttons","button","contains","classButtons","findToolbarButtonById","element","shadowRoot","getElementById","localName","tooltip","Array"],"mappings":"iJAAO,MAAPA,EAAA,MAAAC,EAAAC,KACE,GAAAC,UAAAC,UACE,IAEE,kBADAD,UAAAC,UAAAC,UAAAJ,GAEF,CAAE,MACA,CAIJ,MAAAK,EAAAJ,GAAAK,SAAAC,KAEAC,EAAAF,SAAAG,cAAA,YACAD,EAAAE,MAAAV,EACAK,EAAAM,YAAAH,GACAA,EAAAI,SACAN,SAAAO,YAAA,QACAR,EAAAS,YAAAN,G,6DCPK,MAAPO,UAAAC,EAAAA,GAGEC,MAAAA,GACE,OAAOC,KAAPC,MAAAC,IAAAC,GAAAC,EAAAA,EAAA;wBAEkBD,EAAAE;;aAEXF,EAAAX,QAAAW,EAAAG,UAAAH,EAAAG,SAAAC,OAAA,EAAAH,EAAAA,EAAA,UAAAD,EAAAG,kBAAAE,EAAAA;;QAOT,C,kBAfK,SAAAC,GAAA,KAAAR,MAAA,E,EAAMJ,EAAAa,OAAAC,EAAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;gCACCC,WAAA,K,mVCDd,MAAAC,EAAA,iHAAAC,EAAA,qHAAAC,EAAA,6HAAAC,EAAA,gKAAAC,EAAA,6JA+BAC,EAAA,CACEC,IAAA,QACAC,IAAAC,KACEC,EAAAA,EAAAA,GAAAD,EAAAE,IAAA,gBACO,IAIXC,EAAAC,IACE,MAAAC,EAAAtC,SAAAG,cAAA,WAEA,OADAmC,EAAAA,KAAAD,EAAApB,MACAqB,GAIK,MAAPC,UAAAC,EAAAA,GA+CE,SAAApC,CAAAA,GACEQ,KAAA6B,OAAArC,CACF,CAEA,SAAAA,GACE,OAAOQ,KAAP8B,WAAA,KAAAA,WAAAC,MAAAC,IAAAC,WAAA,KAAAJ,MACF,CAEA,eAAAK,GACE,IAAKlC,KAAL8B,aAAA,KAAAK,kBACE,OAAO,EAET,MAAAC,EAAA,KAAAD,kBAAAE,gBAAA,KAAAP,WAAAC,MAAA,CAEG/B,KAAAmC,kBAAAG,KAAAC,UAEH,QAASvC,KAATwC,WAAAC,cAAA,QAAAL,IACF,CAEOM,iBAAAA,GACLC,MAAAD,oBAEI1C,KAAJ4C,YACE5C,KAAA6C,gBAEF7C,KAAA8C,iBAAA,UAAAC,EAAAA,GACA/C,KAAA8C,iBAAA,UAAA9C,KAAAgD,gBAIKhD,KAAL8B,aAGA,IAAI9B,KAAJiD,WACEjD,KAAA8B,WAAAoB,OAEJ,CAEOC,oBAAAA,GACLR,MAAAQ,uBACAnD,KAAAoD,oBAAA,UAAAL,EAAAA,GACA/C,KAAAoD,oBAAA,UAAApD,KAAAgD,gBACAhD,KAAAqD,wBAAA,GACArD,KAAAsD,eAAAC,KAAA,KACEvD,KAAA8B,WAAA0B,iBACOxD,KAAP8B,YAEJ,CAGA,oBAAA2B,GACEzD,KAAAmC,0BAAA,6DACAQ,MAAAc,gBACF,CAEUC,MAAAA,CAAAC,GAER,GADAhB,MAAAe,OAAAC,IACK3D,KAAL8B,WAEE,YADA9B,KAAA4D,oBAGF,MAAAC,EAAA,GACAF,EAAAG,IAAA,SACED,EAAAE,KAAA,CACEC,QAAA,CACEhE,KAAAmC,kBAAA8B,gBAAAC,YAAAlE,KAAAmE,OACAnE,KAAAmC,kBAAAiC,mBAAAF,YAAAlE,KAAAqE,4BAMNV,EAAAG,IAAA,cACED,EAAAE,KAAA,CACEC,QAAA,KAAA7B,kBAAAmC,oBAAAJ,YAAA,KAAA/B,kBAAAoC,WAAAC,SAAAC,IAAA,KAAAC,aAIF1E,KAAA2E,yBAEFhB,EAAAG,IAAA,aACED,EAAAE,KAAA,CACEC,QAAA,KAAA7B,kBAAAyC,oBAAAV,YAAA,KAAAW,SAAA,KAAA1C,kBAAAoC,WAAAO,aAAA,MAKJnB,EAAAG,IAAA,gBAAAjC,SAAA,KAAArC,OACEqE,EAAAE,KAAA,CACEgB,QAAA,CACEC,KAAA,EACAC,GAAA,KAAAnD,WAAAC,MAAAC,IAAAzB,OACA2E,OAAA,KAAArD,UAINgC,EAAAtD,OAAA,GACEP,KAAA8B,WAAAqD,YAAAtB,GAEFF,EAAAG,IAAA,eACE9D,KAAAoF,iBAEFzB,EAAAG,IAAA,UACE9D,KAAAqF,UAAAC,OAAA,cAAAtF,KAAAuF,OAEF5B,EAAAG,IAAA,mBACE9D,KAAAqF,UAAAC,OAAA,aAAAtF,KAAAwF,eACAxF,KAAA2E,0BAEFhB,EAAAG,IAAA,aAAAH,EAAAG,IAAA,aAAAH,EAAAG,IAAA,cAKE9D,KAAA2E,wBAEFhB,EAAAG,IAAA,sBACE9D,KAAAqD,wBAEJ,CAEA,SAAAc,GACE,OAAOnE,KAAPmC,kBAAAsD,MAAA,KAAAC,KACF,CAEQ9B,iBAAAA,GACN,IAAK5D,KAALmC,kBACE,MAAM,IAANwD,MAAA,oDAEF,MAAAC,EAAA,CACE5F,KAAAmC,kBAAA0D,cACA7F,KAAAmC,kBAAA2D,UACA9F,KAAAmC,kBAAA4D,gBACA/F,KAAAmC,kBAAA6D,YAAAC,wBAAAxB,IAAA,GACAzE,KAAAmC,kBAAA+D,uBACAlG,KAAAmC,kBAAAgE,kBACAnG,KAAAmC,kBAAAiE,4BACApG,KAAAmC,kBAAAkE,sBACArG,KAAAmC,kBAAAmE,aACAtG,KAAAmC,kBAAAoE,mBAAA,CACEC,UAAA,EACAC,gBAAA,EACAC,OAAA,CACEC,YAAA,8BACAC,WAAA,iCAGJ5G,KAAAmC,kBAAA0E,OAAApC,GAAA,IACKzE,KAAAmC,kBAAA2E,iBACA9G,KAAAmC,kBAAA4E,gBACA/G,KAAAmC,kBAAA6E,iBACAhH,KAAAmC,kBAAA8E,eACH/F,IAEFlB,KAAAmC,kBAAA8B,gBAAAQ,GAAAzE,KAAAmE,OACAnE,KAAAmC,kBAAA+E,QACAlH,KAAAmC,kBAAAgF,qBACAnH,KAAAmC,kBAAAmC,oBAAAG,GAAAzE,KAAAmC,kBAAAoC,WAAAC,SAAAC,IAAAzE,KAAA0E,WAGA1E,KAAAmC,kBAAAyC,oBAAAH,GAAAzE,KAAA6E,SAAA7E,KAAAmC,kBAAAoC,WAAAO,aAAA,IAGA9E,KAAAmC,kBAAAoC,WAAA6C,eAAA3C,GAAAzE,KAAAqH,WACArH,KAAAmC,kBAAAiC,mBAAAK,GAAAzE,KAAAqE,4BAGIrE,KAAAsH,YAAA,EAAoBA,EAAAA,EAAAA,IAAA,KAAAA,cAAiC,IAG3D,IAAKtH,KAAL0E,SAAA,CACE,MAAA6C,EAAA,GACIvH,KAAJwH,sBAAA,KAAAC,MACEF,EAAAxD,KAAA,KAAA2D,mBAAAC,KAAA,OAEE3H,KAAJ4H,mBACEL,EAAAxD,KAAA,KAAA8D,gBAAAF,KAAA,OAEFJ,EAAAhH,OAAA,GACEqF,EAAA7B,KAAA,KAAA5B,kBAAA2F,eAAA,CAEIC,SAAAR,EACAS,mBAAA,KAIR,CAGAhI,KAAA8B,WAAA,IAAA9B,KAAAmC,kBAAAoC,WAAA,CACExC,MAAA,KAAAI,kBAAA6D,YAAAiC,OAAA,CACEjG,IAAA,KAAAH,OACA+D,eAEFsC,OAAA,KAAA1F,aAEFxC,KAAAmI,SAAAnI,KAAA6B,QAAAtB,OAAA,EAGAP,KAAAoF,gBACF,CAEQgD,gBAAAA,GACN,OAAIpI,KAAJwF,cAAA,KAAAiC,MAAAY,SAAA,gEAKO,KAAPZ,MAAAY,SAAA,iEAIF,CAEQC,eAAAA,GACN,OAAOtI,KAAPwF,cAAA3E,EAAAC,CACF,CAEQyH,oBAAAA,GAEN,MAAAC,EAAApJ,SAAAG,cAAA,0BAGA,OAFAiJ,EAAAnD,UAAAoD,IAAA,uBACAD,EAAAvI,MAAA,GACAuI,CACF,CAEQpD,cAAAA,GAENpF,KAAAqF,UAAAC,OAAA,aAAAtF,KAAA0I,YAGA1I,KAAAqD,yBAGKrD,KAAL0I,aAKK1I,KAAL2I,iBACE3I,KAAA2I,eAAA3I,KAAAuI,wBAIFvI,KAAA2E,wBAKA3E,KAAA8B,YAAAP,IAAA9B,YAAAO,KAAA2I,gBACF,CAEQhE,qBAAAA,GAED3E,KAAL2I,iBAIA3I,KAAA2I,eAAA1I,MAAA,CACE,CACE2I,GAAA,OACAC,UAAA,KAAAC,SACAzI,MAAA,KAAAoH,MAAAY,SAAA,0BACAU,KAAA9H,EACA+H,OAAAC,GAAA,KAAAC,iBAAAD,IAEF,CACEL,GAAA,OACAC,UAAA,KAAAM,SACA9I,MAAA,KAAAoH,MAAAY,SAAA,0BACAU,KAAA/H,EACAgI,OAAAC,GAAA,KAAAG,iBAAAH,IAEF,CACEL,GAAA,OACAC,UAAA,KAAAV,SACA9H,MAAA,KAAAoH,MAAAY,SAAA,oEAGAU,KAAAhI,EACAiI,OAAAC,GAAA,KAAAI,sBAAAJ,IAEF,CACEL,GAAA,aACAC,SAAA,KAAAS,kBACAjJ,MAAA,KAAA+H,mBACAW,KAAA,KAAAT,kBACAU,OAAAC,GAAA,KAAAM,uBAAAN,KAGN,CAEQ5F,sBAAAA,CAAAmG,EAAA,KAAAhE,eAQN,OAHAxF,KAAAwF,cAAAgE,IAAAxJ,KAAAsJ,mBAAAtJ,KAAA0I,WAGO1I,KAAPwF,gBAAAgE,CACF,CAiIQ9B,kBAAAA,CAAA+B,GAIN,YAAIzJ,KAAJ0F,KAAA,CACE,MAAAgE,EAAAD,EAAA1H,MAAAC,IAAA2H,OAAAF,EAAAG,KACAC,EAAAH,EAAAI,KAkBAC,EAfA,CACE,YACA,SACA,WACA,SACA,UACA,SACA,QACA,gBACA,QACA,OACA,SAIFC,KAAA,KACAC,EAAA,IAAAC,OAAA,iBAAAH,WAKAI,EAAAN,EAAAO,MAAAH,GACAI,EAAAR,EAAAO,MAAA,YAEA,GAAAD,EAAA,CAEE,MAAAG,EAAAZ,EAAA1E,KAAAmF,EAAA,GAAA5J,OAGA,GAAAkJ,EAAAG,KAAAU,EAAA,CACE,MAAAC,EAAA,KAAAC,WAAA,KAAA/C,KAAA8C,QAEA,IAAAA,IAAAA,EAAAhK,OACE,OAAO,KAIT,MAAAkK,EAAAhB,EAAA1H,MAAA2I,SAAAJ,EAAAb,EAAAG,KAWA,MAAO,CACL5E,KAAAsF,EACAK,QAVFF,EAAAF,EAAAK,OAAAC,GAAAA,EAAAxK,MAAAyK,cAAAC,WAAAN,EAAAK,gBAAAP,EAWES,SAAA,kBAEJ,CACF,MAAO,GAAPX,EAAA,CAEE,MAAAY,EAAAvB,EAAAwB,OAGA,IAAK,IAALC,EAAAF,EAAA,EAAAE,EAAA,GAAAA,GAAAF,EAAA,GAAAE,IAAA,CACE,MACAC,EADA3B,EAAA1H,MAAAC,IAAAqJ,KAAAF,GACArB,KAGA,GAAAsB,EAAAE,SAAAF,EAAAL,WAAA,OAAAK,EAAAL,WAAA,MAKE,MAIF,MAAAQ,EAAA,IAAArB,OAAA,SAAAH,YAGA,GAAAqB,EAAAhB,MAAAmB,GAAA,CAEE,MAAAC,EAAA9B,EAAA1E,KAAAqF,EAAA,GAAA9J,OAEA,GAAAkJ,EAAAG,KAAA4B,EAAA,CACE,MAAAjB,EAAA,KAAAC,WAAA,KAAA/C,KAAA8C,QAEA,IAAAA,IAAAA,EAAAhK,OACE,OAAO,KAIT,MAAAkK,EAAAhB,EAAA1H,MAAA2I,SAAAc,EAAA/B,EAAAG,KAcA,MAAO,CACL5E,KAAAwG,EACAb,QAVFF,EAAAF,EAAAK,OAAAC,GAAAA,EAAAxK,MAAAyK,cAAAC,WAAAN,EAAAK,gBAAAP,EAWES,SAAA,kBAEJ,CACF,CACF,CACF,CAGA,MAGAS,EAHA,CAA4B,UAG5BzB,KAAA,KACA0B,EAAA,IAAAxB,OAAA,iBAAAuB,WAGA,GAAA5B,EAAAO,MAAAsB,GACE,OAAO,IAEX,CAGA,MAAAC,EAAAlC,EAAAmC,YAAA,mBAEA,IAAAD,GAAAA,EAAA3G,OAAA2G,EAAA1G,KAAAwE,EAAAoC,SAIE,OAAO,KAGT,MAAAtB,EAAA,KAAAC,WAAA,KAAA/C,KAAA8C,QAEA,OAAAA,GAAAA,EAAAhK,OAIO,CACLyE,KAAA8G,OAAAH,EAAA3G,MACA2F,QAAAJ,EACAS,SAAA,qBANO,IAQX,CAyBA,qBAAAnD,CAAA4B,GAGE,MAAAW,EAAAX,EAAAmC,YAAA,WAEA,IAAAxB,GAAAA,EAAApF,OAAAoF,EAAAnF,KAAAwE,EAAAoC,SACE,OAAO,KAGT,MAAAE,QAAA,KAAAC,gBAEA,MAAO,CACLhH,KAAA8G,OAAA1B,EAAApF,MACA2F,QAAAoB,EACAf,SAAA,YAEJ,C,kBAjqBK,SAAAvK,GAAA,KAAAiF,KAAA,O,KAQ+BzC,WAAA,OAAAyB,UAAA,OAAAG,UAAA,OAAA2C,sBAAA,OAAAI,mBAAA,OAAArC,OAAA,OAAA+D,mBAAA,OAAAZ,YAAA,OAAA7G,OAAA,QAAA2D,eAAA,OAAAsD,UAAA,OAAAK,UAAA,OAAAhB,UAAA,OAAAkB,sBAAA,UAuVlCJ,EAAAgD,iBACAhD,EAAAlG,kBACI/C,KAAJR,cACEX,EAAAA,EAAAA,GAAA,KAAAW,QACA0M,EAAAA,EAAAA,GAAA,MACEC,QAAA,KAAA1E,MAAAY,SAAA,yDAKN,KAAAa,iBAAAD,IAGEA,EAAAgD,iBACAhD,EAAAlG,kBACK/C,KAAL8B,aAGAsK,EAAAA,EAAAA,IAAA,KAAAtK,aACF,KAAAsH,iBAAAH,IAGEA,EAAAgD,iBACAhD,EAAAlG,kBACK/C,KAAL8B,aAGAuK,EAAAA,EAAAA,IAAA,KAAAvK,aACF,KAAAyH,uBAAAN,IAGEA,EAAAgD,iBACAhD,EAAAlG,kBACA/C,KAAAqD,wBAAArD,KAAAwF,gBACF,KAAAxC,eAAAiG,KAGE,WAAAA,EAAA9H,KAAA,KAAAqE,eAAA,KAAAnC,wBAAA,YAAA4F,EAAA9H,KAAA,KAAAkC,wBAAA,MAOE4F,EAAAgD,iBACAhD,EAAAlG,oBAEJ,KAAAuJ,YAAA7K,IAGE,MAAAN,EAAAM,EAAApB,MACAoJ,GAAA8C,EAAAA,EAAAA,GAAA,KAAA9E,KAAA8C,OAAApJ,GAAA,KAAAsG,KAAA+E,SAAA,KAAA/E,KAAAgF,QAAA,KAAAhF,KAAAiF,MAAA,KAAAjF,KAAAkF,QAQAC,EAAAxN,SAAAG,cAAA,OACAqN,EAAAvH,UAAAoD,IAAA,mBAEA,MAAAoE,EAAA,KAAApF,KAAAqF,kBAAA,KAAArF,KAAA8C,OAAApJ,IAEA4L,EAAA,CACE,CACE1M,MAAA,KAAAoH,KAAAY,SAAA,kDAGA7I,MAAAqN,EACAvM,SAEEN,KAAAyH,KAAA8C,OAAApJ,GAAAY,QAAA8K,OAAAG,EAAAhN,KAAAyH,KAAA8C,OAAApJ,GAAAY,QAoCN,OA9BA0H,EAAAwD,QAAAxD,EAAAwD,OAAAC,MACEH,EAAAhJ,KAAA,CACE1D,MAAA,KAAAoH,KAAAY,SAAA,sCACA7I,MAAAiK,EAAAwD,OAAAC,OAIJzD,EAAA0D,MAAA1D,EAAA0D,KAAAD,MACEH,EAAAhJ,KAAA,CACE1D,MAAA,KAAAoH,KAAAY,SAAA,kCACA7I,MAAAiK,EAAA0D,KAAAD,OAIJzD,EAAA2D,OAAA3D,EAAA2D,MAAAF,MACEH,EAAAhJ,KAAA,CACE1D,MAAA,KAAAoH,KAAAY,SAAA,oCACA7I,MAAAiK,EAAA2D,MAAAF,QAIJnN,EAAAA,EAAAA,IAAAK,EAAAA,EAAA;;mBAGa2M;;QAEXH,GAIFA,GACF,KAAApC,YAAA6C,EAAAA,EAAAA,GAAA9C,IAGE,IAAAA,EACE,MAAO,GAUT,OAPA+C,OAAAC,KAAAhD,GAAArK,IAAAiB,IAAA,CACEqM,KAAA,WACAnN,MAAAc,EACAsM,OAAAlD,EAAApJ,GAAAuM,WAAAC,cACAC,KAAA,KAAAtB,iBAIJ,KAAAN,cAAA,UAgKE,IAAKhM,KAAL6N,UAAA,CACE,IAAAC,EAOEA,SAAA,wCAAAC,QAGF/N,KAAA6N,UAAAC,EAAA5N,IAAAwB,IAAA,CACE8L,KAAA,WACAnN,MAAA,OAAAqB,EAAAwL,OACAO,OAAA/L,EAAAsM,SAAAhE,KAAA,MACA4D,KAAApM,IAEJ,CAEA,OAAOxB,KAAP6N,WACF,KAAAxG,UAAA3D,IAqBE1D,KAAA8I,UAAA9I,KAAA0E,WAAAuJ,EAAAA,EAAAA,IAAAvK,EAAA3B,OAAA,EACA/B,KAAAmJ,UAAAnJ,KAAA0E,WAAAwJ,EAAAA,EAAAA,IAAAxK,EAAA3B,OAAA,EACA2B,EAAAyK,aAGAnO,KAAA6B,OAAA6B,EAAA3B,MAAAC,IAAAC,WACAjC,KAAAmI,SAAAnI,KAAA6B,QAAAtB,OAAA,GACAe,EAAAA,EAAAA,GAAA,sBAAmC9B,MAAA,KAAAqC,WACrC,KAAAwC,sBAAA,IAGE,SAAIrE,KAAJ0F,KACS,CACL1F,KAAAmC,kBAAAiM,aACApO,KAAAmC,kBAAAkM,iBAIG,E,EAtrBE1M,EAAAjB,OAAAC,EAAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yFAQC6M,KAAAc,W,4DAEA1N,UAAA,YAAwB4M,KAAAc,W,2DAExBd,KAAAc,W,2DAEAd,KAAAc,QAAe1N,UAAA,2B,uEAGf4M,KAAAc,QAAe1N,UAAA,wB,oEAGf4M,KAAAc,W,wDAEAd,KAAAc,QAAe1N,UAAA,wB,oEAGf4M,KAAAc,QAAe1N,UAAA,iB,6DAGf4M,KAAAe,U,kgBC/EP,MAAPC,UAAA1O,EAAAA,GACYC,MAAAA,GACR,OAAAK,EAAAA,EAAA,eACF,EAHWoO,EAAA9N,OAAAC,EAAAA,EAAA;;;;;;;;;;;;;;;;;;;8QCeN,MAAP8N,UAAA3O,EAAAA,GAQS4O,kBAAAA,CAAAC,EAAA,IAEL,MAAAC,EAAA,KAAAC,UAAAjE,OAAAkE,GAAAA,EAAAzJ,UAAA0J,SAAA,wBAGA,IAAAH,IAAAA,EAAArO,OAAA,OACA,IAAAoO,EAAApO,OAAA,OAAAqO,EAEA,MAAAI,EAAAJ,EAAAhE,OAAAkE,GAAAA,EAAArM,cAAAkM,IAGA,OAAAK,EAAAzO,OAAAyO,OAAAhC,CACF,CAIOiC,qBAAAA,CAAArG,GAEL,MAAAsG,EAAA,KAAAC,YAAAC,eAAAxG,GACA,GAAAsG,GAAA,mBAAAA,EAAAG,UACA,OAAAH,CACF,CAEUnP,MAAAA,GACR,OAAAK,EAAAA,EAAA;;UAEI,KAAAH,MAAAC,IAAAC,GAAA,iBAAAA,EAAAC,EAAAA,EAAA,4DAAAA,EAAAA,EAAA;+BAIoBD,EAAAmP;yBACLnP,EAAAyI,IAAA,eAAAzI,EAAAE;qBACJF,EAAAmP,SAAA;;;;wBAIGnP,EAAAyI,IAAA,eAAAzI,EAAAE;2BACGF,EAAA6I;2BACA7I,EAAAE;0BACDF,EAAA4I;8BACI5I,EAAA0I,WAAA;;;KAK1B,C,kBArDK,SAAApI,GAAA,KAAAR,MAAA,E,EAAMwO,EAAA/N,OAAAC,EAAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gCACC6M,KAAA+B,MAAa3O,WAAA,K"}