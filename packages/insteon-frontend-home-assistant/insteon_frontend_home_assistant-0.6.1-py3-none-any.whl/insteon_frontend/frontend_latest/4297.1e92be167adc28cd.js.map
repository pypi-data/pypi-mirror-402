{"version":3,"file":"4297.1e92be167adc28cd.js","sources":["webpack://insteon-frontend/./homeassistant-frontend/src/panels/config/helpers/forms/dialog-schedule-block-info.ts"],"sourcesContent":["import type { CSSResultGroup } from \"lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport memoizeOne from \"memoize-one\";\nimport { property, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { createCloseHeading } from \"../../../../components/ha-dialog\";\nimport \"../../../../components/ha-form/ha-form\";\nimport \"../../../../components/ha-button\";\nimport { haStyleDialog } from \"../../../../resources/styles\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport type {\n  ScheduleBlockInfo,\n  ScheduleBlockInfoDialogParams,\n} from \"./show-dialog-schedule-block-info\";\nimport type { SchemaUnion } from \"../../../../components/ha-form/types\";\n\nclass DialogScheduleBlockInfo extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _error?: Record<string, string>;\n\n  @state() private _data?: ScheduleBlockInfo;\n\n  @state() private _params?: ScheduleBlockInfoDialogParams;\n\n  private _expand = false;\n\n  private _schema = memoizeOne((expand: boolean) => [\n    {\n      name: \"from\",\n      required: true,\n      selector: { time: { no_second: true } },\n    },\n    {\n      name: \"to\",\n      required: true,\n      selector: { time: { no_second: true } },\n    },\n    {\n      name: \"advanced_settings\",\n      type: \"expandable\" as const,\n      flatten: true,\n      expanded: expand,\n      schema: [\n        {\n          name: \"data\",\n          required: false,\n          selector: { object: {} },\n        },\n      ],\n    },\n  ]);\n\n  public showDialog(params: ScheduleBlockInfoDialogParams): void {\n    this._params = params;\n    this._error = undefined;\n    this._data = params.block;\n    this._expand = !!params.block?.data;\n  }\n\n  public closeDialog(): void {\n    this._params = undefined;\n    this._data = undefined;\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  protected render() {\n    if (!this._params || !this._data) {\n      return nothing;\n    }\n\n    return html`\n      <ha-dialog\n        open\n        @closed=${this.closeDialog}\n        .heading=${createCloseHeading(\n          this.hass,\n          this.hass!.localize(\n            \"ui.dialogs.helper_settings.schedule.edit_schedule_block\"\n          )\n        )}\n      >\n        <div>\n          <ha-form\n            .hass=${this.hass}\n            .schema=${this._schema(this._expand)}\n            .data=${this._data}\n            .error=${this._error}\n            .computeLabel=${this._computeLabelCallback}\n            @value-changed=${this._valueChanged}\n          ></ha-form>\n        </div>\n        <ha-button\n          slot=\"secondaryAction\"\n          @click=${this._deleteBlock}\n          appearance=\"plain\"\n          variant=\"danger\"\n        >\n          ${this.hass!.localize(\"ui.common.delete\")}\n        </ha-button>\n        <ha-button slot=\"primaryAction\" @click=${this._updateBlock}>\n          ${this.hass!.localize(\"ui.common.save\")}\n        </ha-button>\n      </ha-dialog>\n    `;\n  }\n\n  private _valueChanged(ev: CustomEvent) {\n    this._error = undefined;\n    this._data = ev.detail.value;\n  }\n\n  private _updateBlock() {\n    try {\n      this._params!.updateBlock!(this._data!);\n      this.closeDialog();\n    } catch (err: any) {\n      this._error = { base: err ? err.message : \"Unknown error\" };\n    }\n  }\n\n  private _deleteBlock() {\n    try {\n      this._params!.deleteBlock!();\n      this.closeDialog();\n    } catch (err: any) {\n      this._error = { base: err ? err.message : \"Unknown error\" };\n    }\n  }\n\n  private _computeLabelCallback = (\n    schema: SchemaUnion<ReturnType<typeof this._schema>>\n  ) => {\n    switch (schema.name) {\n      case \"from\":\n        return this.hass!.localize(\"ui.dialogs.helper_settings.schedule.start\");\n      case \"to\":\n        return this.hass!.localize(\"ui.dialogs.helper_settings.schedule.end\");\n      case \"data\":\n        return this.hass!.localize(\"ui.dialogs.helper_settings.schedule.data\");\n      case \"advanced_settings\":\n        return this.hass!.localize(\n          \"ui.dialogs.helper_settings.generic.advanced_settings\"\n        );\n    }\n    return \"\";\n  };\n\n  static get styles(): CSSResultGroup {\n    return [haStyleDialog];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-schedule-block-info\": DialogScheduleBlockInfo;\n  }\n}\n\ncustomElements.define(\"dialog-schedule-block-info\", DialogScheduleBlockInfo);\n"],"names":["DialogScheduleBlockInfo","LitElement","showDialog","params","this","_params","_error","undefined","_data","block","_expand","data","closeDialog","fireEvent","dialog","localName","render","html","createCloseHeading","hass","localize","_schema","_computeLabelCallback","_valueChanged","_deleteBlock","_updateBlock","nothing","ev","detail","value","updateBlock","err","base","message","deleteBlock","styles","haStyleDialog","args","memoizeOne","expand","name","required","selector","time","no_second","type","flatten","expanded","schema","object","attribute","customElements","define"],"mappings":"kTAgBA,MAAAA,UAAAC,EAAAA,GAqCSC,UAAAA,CAAAC,GACLC,KAAAC,QAAAF,EACAC,KAAAE,YAAAC,EACAH,KAAAI,MAAAL,EAAAM,MACAL,KAAAM,UAAAP,EAAAM,OAAAE,IACF,CAEOC,WAAAA,GACLR,KAAAC,aAAAE,EACAH,KAAAI,WAAAD,GACAM,EAAAA,EAAAA,GAAA,sBAAmCC,OAAA,KAAAC,WACrC,CAEUC,MAAAA,GACR,OAAKZ,KAALC,SAAA,KAAAG,MAIAS,EAAAA,EAAA;;;kBAGY,KAAAL;oBACCM,EAAAA,EAAAA,GAAA,KAAAC,KAAA,KAAAA,KAAAC,SAAA;;;;oBASC,KAAAD;sBACE,KAAAE,QAAA,KAAAX;oBACF,KAAAF;qBACC,KAAAF;4BACO,KAAAgB;6BACC,KAAAC;;;;;mBAKV,KAAAC;;;;YAIP,KAAAL,KAAAC,SAAA;;iDAEqC,KAAAK;YACrC,KAAAN,KAAAC,SAAA;;;MAjCJM,EAAAA,EAqCJ,CAEQH,aAAAA,CAAAI,GACNvB,KAAAE,YAAAC,EACAH,KAAAI,MAAAmB,EAAAC,OAAAC,KACF,CAEQJ,YAAAA,GACN,IACErB,KAAAC,QAAAyB,YAAA1B,KAAAI,OACAJ,KAAAQ,aACF,CAAE,MAAFmB,GACE3B,KAAAE,OAAA,CAAgB0B,KAAAD,EAAAA,EAAAE,QAAA,gBAClB,CACF,CAEQT,YAAAA,GACN,IACEpB,KAAAC,QAAA6B,cACA9B,KAAAQ,aACF,CAAE,MAAFmB,GACE3B,KAAAE,OAAA,CAAgB0B,KAAAD,EAAAA,EAAAE,QAAA,gBAClB,CACF,CAoBA,iBAAAE,GACE,MAAO,CAACC,EAAAA,GACV,C,kBAtIF,SAAAC,GAAA,KAAA3B,SAAA,OAAAW,SAAAiB,EAAAA,EAAAA,GAAAC,GAAA,CAYI,CACEC,KAAA,OACAC,UAAA,EACAC,SAAA,CAAYC,KAAA,CAAQC,WAAA,KAEtB,CACEJ,KAAA,KACAC,UAAA,EACAC,SAAA,CAAYC,KAAA,CAAQC,WAAA,KAEtB,CACEJ,KAAA,oBACAK,KAAA,aACAC,SAAA,EACAC,SAAAR,EACAS,OAAA,CACE,CACER,KAAA,OACAC,UAAA,EACAC,SAAA,CAAYO,OAAA,SAInB,KAAA3B,sBAAA0B,IAkFC,OAAAA,EAAAR,MACE,IAAK,OACH,OAAOpC,KAAPe,KAAAC,SAAA,6CACF,IAAK,KACH,OAAOhB,KAAPe,KAAAC,SAAA,2CACF,IAAK,OACH,OAAOhB,KAAPe,KAAAC,SAAA,4CACF,IAAK,oBACH,OAAOhB,KAAPe,KAAAC,SAAA,wDAIJ,MAAO,G,8BAhIG8B,WAAA,K,4MA8IdC,eAAAC,OAAA,6BAAApD,G"}