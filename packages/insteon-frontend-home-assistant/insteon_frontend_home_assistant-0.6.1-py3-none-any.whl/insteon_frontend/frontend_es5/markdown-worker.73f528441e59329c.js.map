{"version":3,"file":"markdown-worker.73f528441e59329c.js","sources":["webpack://insteon-frontend/webpack/runtime/on_chunk_loaded","webpack://insteon-frontend/webpack/runtime/startup_chunk_dependencies","webpack://insteon-frontend/./homeassistant-frontend/src/resources/markdown-worker.ts","webpack://insteon-frontend/webpack/runtime/compat_get_default_export","webpack://insteon-frontend/webpack/runtime/define_property_getters","webpack://insteon-frontend/webpack/runtime/ensure_chunk","webpack://insteon-frontend/webpack/runtime/get javascript chunk filename","webpack://insteon-frontend/webpack/runtime/has_own_property","webpack://insteon-frontend/webpack/runtime/public_path","webpack://insteon-frontend/webpack/runtime/rspack_version","webpack://insteon-frontend/webpack/runtime/import_scripts_chunk_loading","webpack://insteon-frontend/webpack/runtime/rspack_unique_id"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif (chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor (var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--)\n\t\t\tdeferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\nvar fn = deferred[i][1];\nvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif (\n\t\t\t\t(priority & (1 === 0) || notFulfilled >= priority) &&\n\t\t\t\tObject.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })\n\t\t\t) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif (priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif (fulfilled) {\n\t\t\tdeferred.splice(i--, 1);\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};\n","var next = __webpack_require__.x\n__webpack_require__.x = function() {\n  return Promise.all([__webpack_require__.e(\"8589\"),\n__webpack_require__.e(\"259\")]).then(next);\n}","import { expose } from \"comlink\";\nimport type { MarkedOptions } from \"marked\";\nimport { marked } from \"marked\";\nimport type { IWhiteList } from \"xss\";\nimport { filterXSS, getDefaultWhiteList } from \"xss\";\n\nlet whiteListNormal: IWhiteList | undefined;\nlet whiteListSvg: IWhiteList | undefined;\n\nconst renderMarkdown = async (\n  content: string,\n  markedOptions: MarkedOptions,\n  hassOptions: {\n    // Do not allow SVG on untrusted content, it allows XSS.\n    allowSvg?: boolean;\n    allowDataUrl?: boolean;\n  } = {}\n): Promise<string[]> => {\n  if (!whiteListNormal) {\n    whiteListNormal = {\n      ...getDefaultWhiteList(),\n      input: [\"type\", \"disabled\", \"checked\"],\n      \"ha-icon\": [\"icon\"],\n      \"ha-svg-icon\": [\"path\"],\n      \"ha-alert\": [\"alert-type\", \"title\"],\n      \"ha-qr-code\": [\n        \"data\",\n        \"scale\",\n        \"width\",\n        \"margin\",\n        \"error-correction-level\",\n        \"center-image\",\n      ],\n    };\n  }\n\n  let whiteList: IWhiteList | undefined;\n\n  if (hassOptions.allowSvg) {\n    if (!whiteListSvg) {\n      whiteListSvg = {\n        ...whiteListNormal,\n        svg: [\"xmlns\", \"height\", \"width\"],\n        path: [\"transform\", \"stroke\", \"d\"],\n        img: [\"src\"],\n      };\n    }\n    whiteList = whiteListSvg;\n  } else {\n    whiteList = whiteListNormal;\n  }\n  if (hassOptions.allowDataUrl && whiteList.a) {\n    whiteList.a.push(\"download\");\n  }\n\n  marked.setOptions(markedOptions);\n\n  marked.use({\n    renderer: {\n      table(...args) {\n        const defaultRenderer = new marked.Renderer();\n        // Wrap the table with block element because the property 'overflow'\n        // cannot be applied to elements of display type 'table'.\n        // https://www.w3.org/TR/css-overflow-3/#overflow-control\n        return `<div>${defaultRenderer.table.apply(this, args)}</div>`;\n      },\n    },\n  });\n\n  const tokens = marked.lexer(content);\n  return tokens.map((token) =>\n    filterXSS(marked.parser([token]), {\n      whiteList,\n      onTagAttr: (\n        tag: string,\n        name: string,\n        value: string\n      ): string | undefined => {\n        // Override the default `onTagAttr` behavior to only render\n        // our markdown checkboxes.\n        // Returning undefined causes the default measure to be taken\n        // in the xss library.\n        if (tag === \"input\") {\n          if (\n            (name === \"type\" && value === \"checkbox\") ||\n            name === \"checked\" ||\n            name === \"disabled\"\n          ) {\n            return undefined;\n          }\n          return \"\";\n        }\n        if (\n          hassOptions.allowDataUrl &&\n          tag === \"a\" &&\n          name === \"href\" &&\n          value.startsWith(\"data:\")\n        ) {\n          return `href=\"${value}\"`;\n        }\n        return undefined;\n      },\n    })\n  );\n};\n\nconst api = {\n  renderMarkdown,\n};\n\nexport type Api = typeof api;\n\nexpose(api);\n","// getDefaultExport function for compatibility with non-ESM modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};\n","__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n        }\n    }\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(\n\t\tObject.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t\t__webpack_require__.f[key](chunkId, promises);\n\t\t\treturn promises;\n\t\t}, [])\n\t);\n};","// This function allow to reference chunks\n__webpack_require__.u = function(chunkId) {\n  // return url for filenames not based on template\n  \n  // return url for filenames based on template\n  return \"\" + chunkId + \".\" + {\"259\": \"4eaa0c66af6d28c8\",\"8589\": \"578951426466474f\",}[chunkId] + \".js\"\n}","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/insteon_static/frontend_es5/\";","__webpack_require__.rv = function() { return \"1.6.4\"; }","var installedChunks = {\"5640\": 1,};\n// importScripts chunk loading\nvar installChunk = function(data) {\n    var chunkIds = data[0];\nvar moreModules = data[1];\nvar runtime = data[2];\n    for (var moduleId in moreModules) {\n        if (__webpack_require__.o(moreModules, moduleId)) {\n            __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n    }\n    if (runtime) runtime(__webpack_require__);\n    while (chunkIds.length) installedChunks[chunkIds.pop()] = 1;\n    parentChunkLoadingFunction(data);\n};\n\n__webpack_require__.f.i = function(chunkId, promises) {\n    \n    // \"1\" is the signal for \"already loaded\n    if (!installedChunks[chunkId]) {\n        if (true) {\n            \n            importScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n            \n        }\n    }\n    \n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkinsteon_frontend\"] = self[\"webpackChunkinsteon_frontend\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;","__webpack_require__.ruid = \"bundler=rspack@1.6.4\";\n"],"names":["deferred","next","whiteListNormal","whiteListSvg","renderMarkdown","_ref","_asyncToGenerator","_regenerator","m","_callee","content","markedOptions","hassOptions","whiteList","tokens","_args","arguments","w","_context","n","length","undefined","Object","assign","getDefaultWhiteList","input","allowSvg","svg","path","img","allowDataUrl","a","push","marked","renderer","table","defaultRenderer","_len","args","Array","_key","concat","apply","map","token","filterXSS","onTagAttr","tag","name","value","startsWith","_x","_x2","api","expose","__webpack_require__","module","getter","__esModule","d","exports","definition","key","o","defineProperty","enumerable","get","f","e","chunkId","Promise","all","keys","reduce","promises","u","obj","prop","prototype","hasOwnProperty","call","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","every","splice","r","p","rv","x","then","installedChunks","importScripts","chunkLoadingGlobal","self","parentChunkLoadingFunction","bind","data","moreModules","runtime","moduleId","pop","ruid"],"mappings":"6BAAIA,ECAAC,E,6BCMJC,EACAC,E,uHAEAC,EAAA,eAAAC,GAAAC,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,EAAA,SAAAC,EAAAC,EAAAC,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,UAAA,OAAAT,EAAAA,EAAAA,KAAAU,EAAA,SAAAC,GAAA,cAAAA,EAAAC,EA4DE,OA5DFP,EAAAG,EAAAK,OAAA,QAAAC,IAAAN,EAAA,GAAAA,EAAA,MASEb,IACEA,EAAAoB,OAAAC,OAAAD,OAAAC,OAAA,IACEC,EAAAA,EAAAA,wBAAA,IACAC,MAAA,CAAQ,OAAQ,WAAY,WAC5B,UAAW,CAAC,QACZ,cAAe,CAAC,QAChB,WAAY,CAAC,aAAc,SAC3B,aAAc,CACZ,OACA,QACA,QACA,SACA,yBACA,mBAONb,EAAAc,UACEvB,IACEA,EAAAmB,OAAAC,OAAAD,OAAAC,OAAA,GACErB,GAAA,IACAyB,IAAA,CAAM,QAAS,SAAU,SACzBC,KAAA,CAAO,YAAa,SAAU,KAC9BC,IAAA,CAAM,UAGVhB,EAAAV,GAEAU,EAAAX,EAEFU,EAAAkB,cAAAjB,EAAAkB,GACElB,EAAAkB,EAAAC,KAAA,YAGFC,EAAAA,GAAAA,WAAAtB,GAEAsB,EAAAA,GAAAA,IAAA,CACEC,SAAA,CACEC,MAAA,WAIE,IAHA,IAAAC,EAAA,IAAAH,EAAAA,GAAAA,SAGAI,EAAArB,UAAAI,OAJFkB,EAAA,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAAF,EAAAE,GAAAxB,UAAAwB,GAKE,MAAO,QAAPC,OAAAL,EAAAD,MAAAO,MAAA,KAAAJ,GAAA,SACF,KAIJxB,EAAAmB,EAAAA,GAAAA,MAAAvB,GAAAQ,EAAAa,EAAA,EACAjB,EAAA6B,IAAA,SAAAC,GAAA,OAAAC,EAAAA,EAAAA,WAAAZ,EAAAA,GAAAA,OAAA,CAC2BW,IAAS,CAChC/B,UAAAA,EACAiC,UAAA,SAAAC,EAAAC,EAAAC,GASE,aAAAF,EAAA,CACE,YAAAC,GAAA,aAAAC,GAAA,YAAAD,GAAA,aAAAA,EAKE,OAEF,MAAO,EACT,CACA,GAAApC,EAAAkB,cAAA,MAAAiB,GAAA,SAAAC,GAAAC,EAAAC,WAAA,SAME,MAAO,SAAPT,OAAAQ,EAAA,IAGJ,GACF,KAAAxC,EAAA,IAEJ,gBA/FA0C,EAAAC,GAAA,OAAA/C,EAAAqC,MAAA,KAAA1B,UAAA,KAiGAqC,EAAA,CACEjD,eAAAA,IAKFkD,EAAAA,EAAAA,GAAAD,E,+OC/GAE,EAAoBpC,EAAI,SAASqC,GAChC,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,WAAa,OAAOF,EAAgB,OAAG,EACvC,WAAa,OAAOA,CAAQ,EAE7B,OADAD,EAAoBI,EAAEF,EAAQ,CAAE1B,EAAG0B,IAC5BA,CACR,ECPAF,EAAoBI,EAAI,SAASC,EAASC,GACzC,IAAI,IAAIC,KAAOD,EACLN,EAAoBQ,EAAEF,EAAYC,KAASP,EAAoBQ,EAAEH,EAASE,IACzExC,OAAO0C,eAAeJ,EAASE,EAAK,CAAEG,YAAY,EAAMC,IAAKL,EAAWC,IAGpF,ECNAP,EAAoBY,EAAI,CAAC,EAGzBZ,EAAoBa,EAAI,SAASC,GAChC,OAAOC,QAAQC,IACdjD,OAAOkD,KAAKjB,EAAoBY,GAAGM,OAAO,SAASC,EAAUZ,GAE5D,OADAP,EAAoBY,EAAEL,GAAKO,EAASK,GAC7BA,CACR,EAAG,IAEL,ECTAnB,EAAoBoB,EAAI,SAASN,GAI/B,OAAYA,EAAU,IAAM,CAAC,IAAO,mBAAmB,KAAQ,oBAAqBA,GAAW,KACjG,ECNAd,EAAoBQ,EAAI,SAASa,EAAKC,GAAQ,OAAOvD,OAAOwD,UAAUC,eAAeC,KAAKJ,EAAKC,EAAO,EPAlG7E,EAAW,GACfuD,EAAoB0B,EAAI,SAASC,EAAQC,EAAUC,EAAIC,GACtD,IAAIF,EAAJ,CAOA,IAAIG,EAAeC,IACnB,IAASC,EAAI,EAAGA,EAAIxF,EAASoB,OAAQoE,IAAK,CACrCL,EAAWnF,EAASwF,GAAG,GACzBJ,EAAKpF,EAASwF,GAAG,GACjBH,EAAWrF,EAASwF,GAAG,GAEzB,IAJA,IAGIC,GAAY,EACPC,EAAI,EAAGA,EAAIP,EAAS/D,OAAQsE,MAEtB,EAAZL,GAAwBC,GAAgBD,IACzC/D,OAAOkD,KAAKjB,EAAoB0B,GAAGU,MAAM,SAAS7B,GAAO,OAAOP,EAAoB0B,EAAEnB,GAAKqB,EAASO,GAAK,GAEzGP,EAASS,OAAOF,IAAK,IAErBD,GAAY,EACRJ,EAAWC,IAAcA,EAAeD,IAG9C,GAAII,EAAW,CACdzF,EAAS4F,OAAOJ,IAAK,GACrB,IAAIK,EAAIT,SACE/D,IAANwE,IAAiBX,EAASW,EAC/B,CACD,CACA,OAAOX,CAxBP,CALCG,EAAWA,GAAY,EACvB,IAAK,IAAIG,EAAIxF,EAASoB,OAAQoE,EAAI,GAAKxF,EAASwF,EAAI,GAAG,GAAKH,EAAUG,IACrExF,EAASwF,GAAKxF,EAASwF,EAAI,GAC5BxF,EAASwF,GAAK,CAACL,EAAUC,EAAIC,EA2B/B,EQjCA9B,EAAoBuC,EAAI,gCCAxBvC,EAAoBwC,GAAK,WAAa,MAAO,OAAS,ERAlD9F,EAAOsD,EAAoByC,EAC/BzC,EAAoByC,EAAI,WACtB,OAAO1B,QAAQC,IAAI,CAAChB,EAAoBa,EAAE,QAC5Cb,EAAoBa,EAAE,SAAS6B,KAAKhG,EACpC,E,WSJA,IAAIiG,EAAkB,CAAC,KAAQ,GAgB/B3C,EAAoBY,EAAEqB,EAAI,SAASnB,EAASK,GAGnCwB,EAAgB7B,IAGb8B,cAAc5C,EAAoBuC,EAAIvC,EAAoBoB,EAAEN,GAKxE,EAEA,IAAI+B,EAAqBC,KAAmC,6BAAIA,KAAmC,8BAAK,GACpGC,EAA6BF,EAAmBpE,KAAKuE,KAAKH,GAC9DA,EAAmBpE,KA7BA,SAASwE,GACxB,IAAIrB,EAAWqB,EAAK,GACpBC,EAAcD,EAAK,GACnBE,EAAUF,EAAK,GACf,IAAK,IAAIG,KAAYF,EACblD,EAAoBQ,EAAE0C,EAAaE,KACnCpD,EAAoB/C,EAAEmG,GAAYF,EAAYE,IAItD,IADID,GAASA,EAAQnD,GACd4B,EAAS/D,QAAQ8E,EAAgBf,EAASyB,OAAS,EAC1DN,EAA2BE,EAC/B,C,ICdAjD,EAAoBsD,KAAO,uB"}