{"version":3,"file":"6678.a2be50959513a09d.js","sources":["webpack://insteon-frontend/./homeassistant-frontend/src/panels/config/helpers/forms/dialog-schedule-block-info.ts"],"sourcesContent":["import type { CSSResultGroup } from \"lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport memoizeOne from \"memoize-one\";\nimport { property, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { createCloseHeading } from \"../../../../components/ha-dialog\";\nimport \"../../../../components/ha-form/ha-form\";\nimport \"../../../../components/ha-button\";\nimport { haStyleDialog } from \"../../../../resources/styles\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport type {\n  ScheduleBlockInfo,\n  ScheduleBlockInfoDialogParams,\n} from \"./show-dialog-schedule-block-info\";\nimport type { SchemaUnion } from \"../../../../components/ha-form/types\";\n\nclass DialogScheduleBlockInfo extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _error?: Record<string, string>;\n\n  @state() private _data?: ScheduleBlockInfo;\n\n  @state() private _params?: ScheduleBlockInfoDialogParams;\n\n  private _expand = false;\n\n  private _schema = memoizeOne((expand: boolean) => [\n    {\n      name: \"from\",\n      required: true,\n      selector: { time: { no_second: true } },\n    },\n    {\n      name: \"to\",\n      required: true,\n      selector: { time: { no_second: true } },\n    },\n    {\n      name: \"advanced_settings\",\n      type: \"expandable\" as const,\n      flatten: true,\n      expanded: expand,\n      schema: [\n        {\n          name: \"data\",\n          required: false,\n          selector: { object: {} },\n        },\n      ],\n    },\n  ]);\n\n  public showDialog(params: ScheduleBlockInfoDialogParams): void {\n    this._params = params;\n    this._error = undefined;\n    this._data = params.block;\n    this._expand = !!params.block?.data;\n  }\n\n  public closeDialog(): void {\n    this._params = undefined;\n    this._data = undefined;\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  protected render() {\n    if (!this._params || !this._data) {\n      return nothing;\n    }\n\n    return html`\n      <ha-dialog\n        open\n        @closed=${this.closeDialog}\n        .heading=${createCloseHeading(\n          this.hass,\n          this.hass!.localize(\n            \"ui.dialogs.helper_settings.schedule.edit_schedule_block\"\n          )\n        )}\n      >\n        <div>\n          <ha-form\n            .hass=${this.hass}\n            .schema=${this._schema(this._expand)}\n            .data=${this._data}\n            .error=${this._error}\n            .computeLabel=${this._computeLabelCallback}\n            @value-changed=${this._valueChanged}\n          ></ha-form>\n        </div>\n        <ha-button\n          slot=\"secondaryAction\"\n          @click=${this._deleteBlock}\n          appearance=\"plain\"\n          variant=\"danger\"\n        >\n          ${this.hass!.localize(\"ui.common.delete\")}\n        </ha-button>\n        <ha-button slot=\"primaryAction\" @click=${this._updateBlock}>\n          ${this.hass!.localize(\"ui.common.save\")}\n        </ha-button>\n      </ha-dialog>\n    `;\n  }\n\n  private _valueChanged(ev: CustomEvent) {\n    this._error = undefined;\n    this._data = ev.detail.value;\n  }\n\n  private _updateBlock() {\n    try {\n      this._params!.updateBlock!(this._data!);\n      this.closeDialog();\n    } catch (err: any) {\n      this._error = { base: err ? err.message : \"Unknown error\" };\n    }\n  }\n\n  private _deleteBlock() {\n    try {\n      this._params!.deleteBlock!();\n      this.closeDialog();\n    } catch (err: any) {\n      this._error = { base: err ? err.message : \"Unknown error\" };\n    }\n  }\n\n  private _computeLabelCallback = (\n    schema: SchemaUnion<ReturnType<typeof this._schema>>\n  ) => {\n    switch (schema.name) {\n      case \"from\":\n        return this.hass!.localize(\"ui.dialogs.helper_settings.schedule.start\");\n      case \"to\":\n        return this.hass!.localize(\"ui.dialogs.helper_settings.schedule.end\");\n      case \"data\":\n        return this.hass!.localize(\"ui.dialogs.helper_settings.schedule.data\");\n      case \"advanced_settings\":\n        return this.hass!.localize(\n          \"ui.dialogs.helper_settings.generic.advanced_settings\"\n        );\n    }\n    return \"\";\n  };\n\n  static get styles(): CSSResultGroup {\n    return [haStyleDialog];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-schedule-block-info\": DialogScheduleBlockInfo;\n  }\n}\n\ncustomElements.define(\"dialog-schedule-block-info\", DialogScheduleBlockInfo);\n"],"names":["DialogScheduleBlockInfo","_LitElement","_this","_callSuper","concat","args","_expand","_schema","memoizeOne","expand","name","required","selector","time","no_second","type","flatten","expanded","schema","object","_computeLabelCallback","hass","localize","params","_params$block","this","_params","_error","undefined","_data","block","data","key","value","fireEvent","dialog","localName","html","_templateObject","_taggedTemplateLiteral","closeDialog","createCloseHeading","_valueChanged","_deleteBlock","_updateBlock","nothing","ev","detail","updateBlock","err","base","message","deleteBlock","get","haStyleDialog","LitElement","attribute","customElements","define"],"mappings":"iXAQA,IAQAA,EAAA,SAAAC,G,2GAkIE,OAlIFC,GAAAC,EAAAA,EAAAA,GAAA,KAAAH,EAAA,GAAAI,OAAAC,KAAAC,SAAA,EAAAJ,EAAAK,SAAAC,EAAAA,EAAAA,GAAA,SAAAC,GAAA,OAYI,CACEC,KAAA,OACAC,UAAA,EACAC,SAAA,CAAYC,KAAA,CAAQC,WAAA,KAEtB,CACEJ,KAAA,KACAC,UAAA,EACAC,SAAA,CAAYC,KAAA,CAAQC,WAAA,KAEtB,CACEJ,KAAA,oBACAK,KAAA,aACAC,SAAA,EACAC,SAAAR,EACAS,OAAA,CACE,CACER,KAAA,OACAC,UAAA,EACAC,SAAA,CAAYO,OAAA,OAInB,GAAAjB,EAAAkB,sBAAA,SAAAF,GAkFC,OAAAA,EAAAR,MACE,IAAK,OACH,OAAAR,EAAAmB,KAAAC,SAAA,6CACF,IAAK,KACH,OAAApB,EAAAmB,KAAAC,SAAA,2CACF,IAAK,OACH,OAAApB,EAAAmB,KAAAC,SAAA,4CACF,IAAK,oBACH,OAAApB,EAAAmB,KAAAC,SAAA,wDAIJ,MAAO,EACT,EAAApB,C,uDA7FO,SAAAqB,GAAA,IAAAC,EACLC,KAAAC,QAAAH,EACAE,KAAAE,YAAAC,EACAH,KAAAI,MAAAN,EAAAO,MACAL,KAAAnB,UAAA,QAAAkB,EAAAD,EAAAO,aAAA,IAAAN,IAAAA,EAAAO,KACF,IAAAC,IAAA,cAAAC,MAEO,WACLR,KAAAC,aAAAE,EACAH,KAAAI,WAAAD,GACAM,EAAAA,EAAAA,GAAA,sBAAmCC,OAAA,KAAAC,WACrC,IAAAJ,IAAA,SAAAC,MAEU,WACR,OAAKR,KAALC,SAAA,KAAAG,OAIAQ,EAAAA,EAAAA,IAAAC,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,6mBAGY,KAAAC,aACCC,EAAAA,EAAAA,GAAA,KAAApB,KAAA,KAAAA,KAAAC,SAAA,4DASC,KAAAD,KACE,KAAAd,QAAA,KAAAD,SACF,KAAAuB,MACC,KAAAF,OACO,KAAAP,sBACC,KAAAsB,cAKV,KAAAC,aAIP,KAAAtB,KAAAC,SAAA,oBAEqC,KAAAsB,aACrC,KAAAvB,KAAAC,SAAA,mBAjCJuB,EAAAA,EAqCJ,IAAAb,IAAA,gBAAAC,MAEQ,SAAAa,GACNrB,KAAAE,YAAAC,EACAH,KAAAI,MAAAiB,EAAAC,OAAAd,KACF,IAAAD,IAAA,eAAAC,MAEQ,WACN,IACER,KAAAC,QAAAsB,YAAAvB,KAAAI,OACAJ,KAAAe,aACF,CAAE,MAAFS,GACExB,KAAAE,OAAA,CAAgBuB,KAAAD,EAAAA,EAAAE,QAAA,gBAClB,CACF,IAAAnB,IAAA,eAAAC,MAEQ,WACN,IACER,KAAAC,QAAA0B,cACA3B,KAAAe,aACF,CAAE,MAAFS,GACExB,KAAAE,OAAA,CAAgBuB,KAAAD,EAAAA,EAAAE,QAAA,gBAClB,CACF,MAAAnB,IAAA,SAAAqB,IAoBA,WACE,MAAO,CAACC,EAAAA,GACV,KAtIF,CAAAC,EAAAA,K,2BACcC,WAAA,K,4MA8IdC,eAAAC,OAAA,6BAAA1D,G"}