# Task runner configuration for airbyte-connector-models

[tasks.test]
help = "Run all tests"
cmd = "pytest"

[tasks.test-fast]
help = "Run fast tests only"
cmd = "pytest -m 'not slow'"

[tasks.lint]
help = "Run linting checks"
cmd = "ruff check ."

[tasks.format]
help = "Format code"
cmd = "ruff format ."

[tasks.format-check]
help = "Check code formatting"
cmd = "ruff format --check ."

[tasks.typecheck]
help = "Run type checking"
cmd = "basedpyright"

[tasks.check]
help = "Run all checks (lint, format, typecheck)"
sequence = ["format-check", "lint", "typecheck"]

[tasks.fix]
help = "Auto-fix linting and formatting issues"
sequence = ["format", { cmd = "ruff check --fix ." }]

[tasks.generate]
help = "Generate all connector and metadata models"
cmd = "python -m src.generate.main --all"

[tasks.generate-connector]
help = "Generate models for a specific connector"
cmd = "python -m src.generate.main --connector ${connector}"

[tasks.generate-metadata]
help = "Generate metadata models only"
cmd = "python -m src.generate.main --metadata"

[tasks.generate-metadata-consolidated]
help = "Generate consolidated metadata model from bundled JSON"
cmd = "python -m src.generate.main --consolidated"

[tasks.bundle-metadata-schemas]
help = "Bundle metadata schemas into consolidated JSON"
cmd = "npm run bundle-schemas"

[tasks.generate-metadata-full]
help = "Bundle schemas and generate consolidated metadata model"
sequence = ["bundle-metadata-schemas", "generate-metadata-consolidated"]

[tasks.generate-registry]
help = "Generate consolidated registry model from bundled JSON"
cmd = "python -m src.generate.main --registry"

[tasks.generate-registry-full]
help = "Bundle schemas and generate consolidated registry model"
sequence = ["bundle-metadata-schemas", "generate-registry"]

[tasks.generate-all-consolidated]
help = "Bundle schemas and generate both metadata and registry models"
sequence = ["bundle-metadata-schemas", "generate-metadata-consolidated", "generate-registry"]
