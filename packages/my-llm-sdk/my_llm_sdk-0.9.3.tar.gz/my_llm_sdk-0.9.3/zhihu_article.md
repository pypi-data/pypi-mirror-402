
> ä»£ç å¼€æºåœ¨ GitHubï¼š[wenjie2024/my-llm-sdk](https://github.com/wenjie2024/my-llm-sdk)

æœ€è¿‘åœ¨åš AI åº”ç”¨ï¼Œé‡åˆ°ä¸€ä¸ªå¾ˆå®é™…çš„é—®é¢˜ï¼šé¡¹ç›®é‡ŒåŒæ—¶ç”¨ç€ Geminiã€é€šä¹‰åƒé—®ã€è±†åŒ…å¥½å‡ å®¶æ¨¡å‹ï¼Œæ¯å®¶ SDK çš„è°ƒç”¨æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œè®¡è´¹é€»è¾‘ä¹Ÿä¸åŒï¼Œä»£ç è€¦åˆåº¦é«˜ã€ç»´æŠ¤æˆæœ¬å¢åŠ ã€‚

äºæ˜¯èŠ±äº†ç‚¹æ—¶é—´å°è£…äº†ä¸€ä¸ªç»Ÿä¸€çš„ SDKï¼Œæ ¸å¿ƒç›®æ ‡å°±ä¸€ä¸ªï¼š**ä¸€å¥—ä»£ç è°ƒæ‰€æœ‰æ¨¡å‹ï¼Œé¡ºä¾¿æŠŠæˆæœ¬ç®¡ä½**ã€‚

## é€‚ç”¨åœºæ™¯

- **å¤šæ¨¡å‹å¯¹æ¯”æµ‹è¯• / A/B Test**
- **éœ€è¦æˆæœ¬ç®¡æ§çš„ AI åº”ç”¨**
- **å›¢é˜Ÿå…±ç”¨é…ç½®ï¼Œä¸ªäººç®¡ç† Key**
- **å¤šæ¨¡æ€åº”ç”¨ï¼ˆå›¾æ–‡æ··åˆã€è¯­éŸ³åˆæˆï¼‰**

## è§£å†³ä»€ä¹ˆé—®é¢˜

1. **æ¥å£ä¸ç»Ÿä¸€**ï¼šGemini ç”¨ `google-genai`ï¼Œé€šä¹‰åƒé—®ç”¨ `dashscope`ï¼Œè±†åŒ…ç”¨ `volcengine-sdk`ï¼Œä¸‰å¥—å†™æ³•
2. **æˆæœ¬å¤±æ§**ï¼šè°ƒç€è°ƒç€è´¦å•çˆ†äº†ï¼Œäº‹åæ‰å‘ç°
3. **é‡è¯•é€»è¾‘é‡å¤å†™**ï¼šæ¯ä¸ªæ¥å…¥ç‚¹éƒ½è¦å¤„ç† 429ã€è¶…æ—¶ã€é‡è¯•
4. **å¤šæ¨¡æ€æ”¯æŒé›¶æ•£**ï¼šå›¾ç‰‡ç”Ÿæˆã€TTSã€ASR å„å®¶èƒ½åŠ›ä¸åŒï¼Œé€‚é…éº»çƒ¦

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¿«é€ŸéªŒè¯ (CLI)

æœ€ç®€å•çš„éªŒè¯æ–¹å¼æ˜¯ä½¿ç”¨å†…ç½®çš„ CLI å·¥å…·ã€‚

```bash
# å®‰è£…
pip install my-llm-sdk

# åˆå§‹åŒ–é…ç½®æ¨¡æ¿
llm-sdk init

# ç¼–è¾‘ config.yaml å¡«å…¥ API Key åï¼Œç›´æ¥å¯¹æ¨¡å‹å‘é—®ï¼š
llm-sdk generate --model doubao-thinking --prompt "Hello World"
```

### 2. å¼€å‘æ¥å…¥ (SDK API)

åœ¨ä»£ç ä¸­é›†æˆä¹ŸåŒæ ·ç®€å•ï¼Œæ”¯æŒåŒæ­¥åŠå¼‚æ­¥æµå¼è°ƒç”¨ã€‚æ›´è¯¦ç»†çš„å‚æ•°è¯´æ˜è¯·å‚è€ƒ GitHub ä¸Šçš„ [è¯¦ç»†ç”¨æ³•æŒ‡å—](https://github.com/wenjie2024/my-llm-sdk#-%E8%AF%A6%E7%BB%86%E7%94%A8%E6%B3%95)ã€‚

```python
from my_llm_sdk.client import LLMClient

client = LLMClient()
response = client.generate("å†™ä¸€å¥ Slogan", model_alias="doubao-thinking")
print(response)
```

---

ä½“éªŒå®ŒåŸºæœ¬åŠŸèƒ½åï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆå®ç°çš„ã€‚

## æ ¸å¿ƒè®¾è®¡

æ¶æ„å¾ˆç®€å•ï¼Œä¸‰å±‚ï¼š

```
LLMClient
    â†“
Provider Layer (Gemini / Qwen / Volcengine)
    â†“
Cross-Cutting (Budget / RateLimit / Retry)
```

å…³é”®æŠ½è±¡æ˜¯ `ContentInput`ï¼Œæ”¯æŒçº¯æ–‡æœ¬å’Œå¤šæ¨¡æ€æ··åˆè¾“å…¥ï¼š

```python
# çº¯æ–‡æœ¬
client.generate("ä½ å¥½", model_alias="gemini-2.5-flash")

# å¤šæ¨¡æ€
from my_llm_sdk.schemas import ContentPart
client.generate(contents=[
    ContentPart(type="text", text="æè¿°è¿™å¼ å›¾"),
    ContentPart(type="image", inline_data=img_bytes, mime_type="image/png")
], model_alias="qwen-vl-max")
```

## å¤šæ¨¡æ€æ”¯æŒ

ç›®å‰æ”¯æŒçš„èƒ½åŠ›ï¼š

| å‚å•† | æ–‡æœ¬ | Vision | å›¾ç‰‡ç”Ÿæˆ | TTS | ASR |
|:---|:---:|:---:|:---:|:---:|:---:|
| Gemini | âœ“ | âœ“ | âœ“ | âœ“ | - |
| é€šä¹‰åƒé—® | âœ“ | âœ“ | âœ“ | âœ“ | âœ“ |
| è±†åŒ… | âœ“ | âœ“ | âœ“ | - | - |

å›¾ç‰‡ç”Ÿæˆç¤ºä¾‹ï¼š

```python
from my_llm_sdk.schemas import TaskType

resp = client.generate(
    "ä¸€åªæˆ´å¢¨é•œçš„æŸ¯åŸº",
    model_alias="qwen-image-plus",
    config={"task": TaskType.IMAGE_GENERATION, "image_size": "1K"},
    full_response=True
)

# resp.media_parts[0].inline_data å°±æ˜¯å›¾ç‰‡äºŒè¿›åˆ¶
# é»˜è®¤è‡ªåŠ¨ä¿å­˜åˆ° outputs/YYYYMMDD/
```

## é¢„ç®—æ§åˆ¶æ€ä¹ˆåšçš„

æ ¸å¿ƒäº®ç‚¹æ˜¯é¢„ç®—æ§åˆ¶ã€‚æ¯æ¬¡è¯·æ±‚å‰ä¼šï¼š

1. **é¢„ä¼°æˆæœ¬**ï¼šæ ¹æ®è¾“å…¥ token æ•°å’Œæ¨¡å‹å®šä»·ç®—ä¸€ä¸‹
2. **æ£€æŸ¥ä½™é¢**ï¼šæŸ¥å½“æ—¥å·²æ¶ˆè´¹ï¼ŒåŠ ä¸Šé¢„ä¼°å€¼æ˜¯å¦è¶…é™
3. **è¶…é¢æ‹¦æˆª**ï¼šè¶…äº†ç›´æ¥æŠ› `QuotaExceededError`ï¼Œè¯·æ±‚ä¸å‘å‡ºå»

```python
# config.yaml
daily_spend_limit: 5.0  # æ—¥é™é¢ 5 ç¾å…ƒ
```

æ‰€æœ‰è°ƒç”¨è®°å½•å†™å…¥æœ¬åœ° SQLiteï¼ˆ`~/.llm-sdk/ledger.db`ï¼‰ï¼Œç”¨ WAL æ¨¡å¼æ”¯æŒå¹¶å‘ã€‚CLI å¯ä»¥ç›´æ¥æŸ¥ï¼š

```bash
$ llm-sdk budget status

ğŸ“Š Today's Budget Status
------------------------
ğŸ’° Cost:       $0.0037 / $5.00
ğŸ”¢ Requests:   9
ğŸ”  Tokens:     108
âš ï¸  Errors:     3

Usage: [â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 0.1%
```

## é…ç½®åˆ†ç¦»

å€Ÿé‰´äº† `/etc/xxx.d/` çš„æ€è·¯ï¼Œé…ç½®åˆ†ä¸¤å±‚ï¼š

- `llm.project.yaml`ï¼šé¡¹ç›®çº§é…ç½®ï¼Œå®šä¹‰å…è®¸ç”¨å“ªäº›æ¨¡å‹ã€é¢„ç®—ç­–ç•¥ï¼Œ**æäº¤åˆ° Git**
- `config.yaml`ï¼šç”¨æˆ·çº§é…ç½®ï¼Œæ”¾ API Key å’Œä¸ªäººé™é¢ï¼Œ**ä¸æäº¤**

æ¨¡å‹å®šä¹‰æ”¯æŒæ¨¡å—åŒ–ï¼Œ`llm.project.d/` ä¸‹æŒ‰å‚å•†æ‹†åˆ†ï¼š

```
llm.project.d/
â”œâ”€â”€ google.yaml      # Gemini ç³»åˆ—
â”œâ”€â”€ qwen.yaml        # é€šä¹‰ç³»åˆ—
â””â”€â”€ volcengine.yaml  # è±†åŒ…/DeepSeek
```

å›¢é˜Ÿåä½œæ—¶ï¼Œé¡¹ç›®é…ç½®ç»Ÿä¸€ï¼Œä¸ªäºº Key å„è‡ªç®¡ç†ã€‚



## é‡è¯•å’Œé™æµ

å†…ç½®æŒ‡æ•°é€€é¿é‡è¯•ï¼Œ429 å’Œ 5xx è‡ªåŠ¨å¤„ç†ï¼š

```python
# llm.project.yaml
resilience:
  max_retries: 3
  base_delay_s: 1.0
  max_delay_s: 60.0
  wait_on_rate_limit: true
```

é™æµæ£€æŸ¥æ”¯æŒ RPMï¼ˆæ¯åˆ†é’Ÿè¯·æ±‚æ•°ï¼‰ã€TPMï¼ˆæ¯åˆ†é’Ÿ token æ•°ï¼‰ã€RPDï¼ˆæ¯æ—¥è¯·æ±‚æ•°ï¼‰ï¼Œåœ¨è¯·æ±‚å‰æ‹¦æˆªï¼Œä¸æµªè´¹å·²æœ‰çš„é™é¢ã€‚

---

æ¬¢è¿æ Issue å’Œ PRï¼Œå¦‚æœè§‰å¾—å¥½ç”¨ï¼Œç‚¹ä¸ª Star æ˜¯æå¤§çš„é¼“åŠ±ã€‚

å¦‚æœä½ ä¹Ÿåœ¨åšå¤šæ¨¡å‹é›†æˆï¼Œæˆ–è€…è¢«è´¦å•å‘è¿‡ï¼Œå¯ä»¥è¯•è¯•è¿™ä¸ªæ–¹æ¡ˆã€‚
