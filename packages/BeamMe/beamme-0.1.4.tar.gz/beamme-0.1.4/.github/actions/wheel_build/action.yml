name: wheel_build
description: Build a wheel

inputs:
  python-version:
    description: Python version to use
    required: true

  wheel-name:
    description: Artifact name containing wheels
    required: true

runs:
  using: "composite"
  steps:
    - name: Compute CIBW_BUILD
      shell: bash
      run: |
        PYTAG=$(echo "${{ inputs.python-version }}" | tr -d '.')
        echo "CIBW_BUILD=cp${PYTAG}-*" >> "$GITHUB_ENV"

    - name: Build wheels
      uses: pypa/cibuildwheel@v3.3.1
      env:
        CIBW_SKIP: "*musllinux*"
        CIBW_ARCHS_LINUX: "x86_64"
        CIBW_ARCHS_WINDOWS: "AMD64"
        CIBW_ARCHS_MACOS: "arm64"

    - name: Upload wheels
      uses: actions/upload-artifact@v6
      with:
        name: ${{ inputs.wheel-name }}
        path: wheelhouse/*.whl
