"use strict";(self["webpackChunksortinghat_ui"]=self["webpackChunksortinghat_ui"]||[]).push([[833],{59833:(e,a,t)=>{t.r(a),t.d(a,{default:()=>$});var n=t(20641),l=t(90033),s=t(53751),u=t(13892),i=t(40276),r=t(418),c=t(95272),o=t(22162),d=t(32421),f=t(1560),m=t(56756),k=t(35526),b=t(79669),p=t(19336),v=t(20552),h=t(49930),y=t(36554),_=t(80594),F=t(43948),x={class:"section"},g={key:0,class:"v-list-item__subtitle text-medium-emphasis"},V={key:0,class:"mt-3"},A={class:"v-list-item__subtitle text-medium-emphasis"};function w(e,a,t,w,E,L){return(0,n.uX)(),(0,n.CE)("section",x,[a[37]||(a[37]=(0,n.Lk)("header",{class:"header"},[(0,n.Lk)("h1",{class:"title"},"General settings")],-1)),E.isLoading?((0,n.uX)(),(0,n.Wv)(p.Z,{key:0,color:"primary",indeterminate:""})):((0,n.uX)(),(0,n.Wv)(r.$,{key:1,variant:"accordion"},{default:(0,n.k6)((function(){return[(0,n.bF)(c.c,null,{default:(0,n.k6)((function(){return[(0,n.bF)(o.w,{"aria-label":"Show advanced configuration"},{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 px-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"d-flex flex-column justify-center"},{default:(0,n.k6)((function(){return[a[24]||(a[24]=(0,n.Lk)("p",{class:"subheader mb-0"}," Affiliate to organizations automatically ",-1)),E.tasks.affiliate.lastExecution?((0,n.uX)(),(0,n.CE)("span",g,[E.tasks.affiliate.failed?((0,n.uX)(),(0,n.Wv)(b.w,{key:0,color:"error",left:"",small:""},{default:(0,n.k6)((function(){return a[22]||(a[22]=[(0,n.eW)(" mdi-alert ",-1)])})),_:1,__:[22]})):((0,n.uX)(),(0,n.Wv)(b.w,{key:1,color:"green",left:"",small:""},{default:(0,n.k6)((function(){return a[23]||(a[23]=[(0,n.eW)(" mdi-check ",-1)])})),_:1,__:[23]})),(0,n.eW)(" Last run "+(0,l.v_)(e.$formatDate(E.tasks.affiliate.lastExecution)),1)])):(0,n.Q3)("",!0)]})),_:1,__:[24]}),(0,n.bF)(k.B,{class:"d-flex justify-end"},{default:(0,n.k6)((function(){return[(0,n.bF)(_.N,{modelValue:E.tasks.affiliate.isActive,"onUpdate:modelValue":a[0]||(a[0]=function(e){return E.tasks.affiliate.isActive=e}),class:"mt-0",color:"primary",density:"comfortable",inset:"","hide-details":"",onChange:a[1]||(a[1]=function(e){return L.toggleTask("affiliate")}),onClick:a[2]||(a[2]=(0,s.D$)((function(){}),["stop"])),onMousedown:a[3]||(a[3]=(0,s.D$)((function(){}),["prevent"]))},{label:(0,n.k6)((function(){return a[25]||(a[25]=[(0,n.Lk)("label",{class:"d-sr-only"}," Affiliate to organizations ",-1)])})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(d.T,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pt-4 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return a[26]||(a[26]=[(0,n.Lk)("p",{class:"text-subtitle-2"},"Advanced configuration",-1)])})),_:1,__:[26]})]})),_:1}),(0,n.bF)(f.n,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{cols:"3",class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(h.$,{modelValue:E.tasks.affiliate.interval,"onUpdate:modelValue":a[4]||(a[4]=function(e){return E.tasks.affiliate.interval=e}),class:"mt-0",density:"comfortable"},{label:(0,n.k6)((function(){return a[27]||(a[27]=[(0,n.Lk)("h3",{class:"subheader"},"Interval",-1)])})),default:(0,n.k6)((function(){return[(0,n.bF)(v.i,{value:1440,label:"Every day"}),(0,n.bF)(v.i,{value:10080,label:"Every week"}),(0,n.bF)(v.i,{value:43800,label:"Every month"}),(0,n.bF)(v.i,{value:"custom",label:"Custom"})]})),_:1},8,["modelValue"]),(0,n.bF)(F.W,{modelValue:E.tasks.affiliate.customInterval,"onUpdate:modelValue":a[5]||(a[5]=function(e){return E.tasks.affiliate.customInterval=e}),label:"Every",type:"number",suffix:"minutes",class:"ml-8",density:"compact","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),E.tasks.affiliate.isActive?((0,n.uX)(),(0,n.Wv)(m.L,{key:0,class:"ma-0 pt-8 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(u.D,{color:"primary",variant:"flat",size:"small",onClick:a[6]||(a[6]=function(e){return L.updateScheduledTask("affiliate")})},{default:(0,n.k6)((function(){return a[28]||(a[28]=[(0,n.eW)(" Update ",-1)])})),_:1,__:[28]})]})),_:1})]})),_:1})):(0,n.Q3)("",!0)]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(c.c,null,{default:(0,n.k6)((function(){return[(0,n.bF)(o.w,{"aria-label":"Show advanced configuration"},{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 px-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"d-flex flex-column justify-center"},{default:(0,n.k6)((function(){return[a[31]||(a[31]=(0,n.Lk)("p",{class:"subheader mb-0"},"Unify profiles automatically",-1)),E.tasks.unify.lastExecution?((0,n.uX)(),(0,n.CE)("span",V,[E.tasks.unify.failed?((0,n.uX)(),(0,n.Wv)(b.w,{key:0,color:"error",left:"",small:""},{default:(0,n.k6)((function(){return a[29]||(a[29]=[(0,n.eW)(" mdi-alert ",-1)])})),_:1,__:[29]})):((0,n.uX)(),(0,n.Wv)(b.w,{key:1,color:"green",left:"",small:""},{default:(0,n.k6)((function(){return a[30]||(a[30]=[(0,n.eW)(" mdi-check ",-1)])})),_:1,__:[30]})),(0,n.Lk)("span",A," Last run "+(0,l.v_)(e.$formatDate(E.tasks.unify.lastExecution)),1)])):(0,n.Q3)("",!0)]})),_:1,__:[31]}),(0,n.bF)(k.B,{class:"d-flex justify-end"},{default:(0,n.k6)((function(){return[(0,n.bF)(_.N,{modelValue:E.tasks.unify.isActive,"onUpdate:modelValue":a[7]||(a[7]=function(e){return E.tasks.unify.isActive=e}),color:"primary",density:"comfortable",inset:"","hide-details":"",class:"mt-0",onChange:a[8]||(a[8]=function(e){return L.toggleTask("unify")}),onClick:a[9]||(a[9]=(0,s.D$)((function(){}),["stop"])),onMousedown:a[10]||(a[10]=(0,s.D$)((function(){}),["prevent"]))},{label:(0,n.k6)((function(){return a[32]||(a[32]=[(0,n.Lk)("label",{class:"d-sr-only"},"Unify profiles automatically",-1)])})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(d.T,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pt-4 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return a[33]||(a[33]=[(0,n.Lk)("p",{class:"text-subtitle-2"},"Advanced configuration",-1)])})),_:1,__:[33]})]})),_:1}),(0,n.bF)(f.n,null,{default:(0,n.k6)((function(){return[(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0 mb-3"},{default:(0,n.k6)((function(){return[(0,n.bF)(i.a,{modelValue:E.tasks.unify.params.exclude,"onUpdate:modelValue":a[11]||(a[11]=function(e){return E.tasks.unify.params.exclude=e}),label:"Exclude individuals in RecommenderExclusionTerm list",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:E.tasks.unify.params.strict,"onUpdate:modelValue":a[12]||(a[12]=function(e){return E.tasks.unify.params.strict=e}),label:"Exclude individuals with invalid email addresses and names",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:E.tasks.unify.params.guess_github_user,"onUpdate:modelValue":a[13]||(a[13]=function(e){return E.tasks.unify.params.guess_github_user=e}),label:"Match GitHub users to GitHub-generated emails",density:"comfortable","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{cols:"3",class:"pa-0 mb-2"},{default:(0,n.k6)((function(){return[a[34]||(a[34]=(0,n.Lk)("h3",{class:"subheader text-medium-emphasis"}," Unify profiles based on their ",-1)),(0,n.bF)(i.a,{modelValue:E.tasks.unify.params.criteria,"onUpdate:modelValue":a[14]||(a[14]=function(e){return E.tasks.unify.params.criteria=e}),label:"Name",value:"name",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:E.tasks.unify.params.criteria,"onUpdate:modelValue":a[15]||(a[15]=function(e){return E.tasks.unify.params.criteria=e}),label:"Email",value:"email",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{modelValue:E.tasks.unify.params.criteria,"onUpdate:modelValue":a[16]||(a[16]=function(e){return E.tasks.unify.params.criteria=e}),label:"Username",value:"username",density:"comfortable","hide-details":""},null,8,["modelValue"]),(0,n.bF)(i.a,{class:"ml-4",modelValue:E.tasks.unify.params.match_source,"onUpdate:modelValue":a[17]||(a[17]=function(e){return E.tasks.unify.params.match_source=e}),label:"Only unify identities that share the same source",density:"comfortable","hide-details":""},null,8,["modelValue"])]})),_:1,__:[34]})]})),_:1}),(0,n.bF)(m.L,{class:"ma-0 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{cols:"3",class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(h.$,{modelValue:E.tasks.unify.interval,"onUpdate:modelValue":a[18]||(a[18]=function(e){return E.tasks.unify.interval=e}),class:"mt-0",density:"comfortable"},{label:(0,n.k6)((function(){return a[35]||(a[35]=[(0,n.Lk)("h3",{class:"subheader"},"Interval",-1)])})),default:(0,n.k6)((function(){return[(0,n.bF)(v.i,{value:1440,label:"Every day"}),(0,n.bF)(v.i,{value:10080,label:"Every week"}),(0,n.bF)(v.i,{value:43800,label:"Every month"}),(0,n.bF)(v.i,{value:"custom",label:"Custom"})]})),_:1},8,["modelValue"]),(0,n.bF)(F.W,{modelValue:E.tasks.unify.customInterval,"onUpdate:modelValue":a[19]||(a[19]=function(e){return E.tasks.unify.customInterval=e}),label:"Every",type:"number",suffix:"minutes",class:"ml-8",density:"compact","hide-details":""},null,8,["modelValue"])]})),_:1})]})),_:1}),E.tasks.unify.isActive?((0,n.uX)(),(0,n.Wv)(m.L,{key:0,class:"ma-0 pt-8 pl-2"},{default:(0,n.k6)((function(){return[(0,n.bF)(k.B,{class:"pa-0"},{default:(0,n.k6)((function(){return[(0,n.bF)(u.D,{color:"primary",variant:"flat",size:"small",onClick:a[20]||(a[20]=function(e){return L.updateScheduledTask("unify")})},{default:(0,n.k6)((function(){return a[36]||(a[36]=[(0,n.eW)(" Update ",-1)])})),_:1,__:[36]})]})),_:1})]})),_:1})):(0,n.Q3)("",!0)]})),_:1})]})),_:1})]})),_:1})]})),_:1})),(0,n.bF)(y.K,{modelValue:E.snackbar.isActive,"onUpdate:modelValue":a[21]||(a[21]=function(e){return E.snackbar.isActive=e}),color:E.snackbar.color,timeout:"4000",text:""},{default:(0,n.k6)((function(){return[(0,n.eW)((0,l.v_)(E.snackbar.text),1)]})),_:1},8,["modelValue","color"])])}var E=t(14048),L=t(30388),T=(t(50113),t(60739),t(18111),t(20116),t(33110),t(2892),t(26099),t(58663)),S=t(20595);const U={name:"SettingsGeneral",data:function(){return{isLoading:!0,tasks:{affiliate:{isActive:!1,interval:10080,customInterval:"",failed:!1,lastExecution:null,id:null,params:{}},unify:{isActive:!1,interval:10080,failed:!1,lastExecution:null,id:null,params:{criteria:["name","email","username"],exclude:!0,strict:!0,match_source:!1,guess_github_user:!1}}},snackbar:{isActive:!1,text:"",color:"success"}}},methods:{fetchScheduledTasks:function(){var e=this;return(0,L.A)((0,E.A)().mark((function a(){var t,n,l,s;return(0,E.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.isLoading=!0,a.next=3,(0,T.GS)(e.$apollo);case 3:t=a.sent,n=t.data.scheduledTasks.entities,l=n.find((function(e){return"affiliate"===e.jobType})),s=n.find((function(e){return"unify"===e.jobType})),l&&e.buildForm(l),s&&e.buildForm(s),e.isLoading=!1;case 10:case"end":return a.stop()}}),a)})))()},buildForm:function(e){var a=[1440,10080,43800],t=a.find((function(a){return a===e.interval}))?e.interval:"custom";Object.assign(this.tasks[e.jobType],{isActive:!0,interval:t,failed:e.failed,lastExecution:e.lastExecution,id:e.id,customInterval:e.interval,params:e.args})},toggleTask:function(e){this.tasks[e].isActive?this.createTask(e):this.deleteScheduledTask(e)},createTask:function(e){var a=this;return(0,L.A)((0,E.A)().mark((function t(){var n,l;return(0,E.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="custom"===a.tasks[e].interval?a.tasks[e].customInterval:a.tasks[e].interval,t.next=3,(0,S.nD)(a.$apollo,e,Number(n),JSON.stringify(a.tasks[e].params))["catch"]((function(t){a.openSnackbar(t),a.tasks[e].isActive=!1}));case 3:l=t.sent,Object.assign(a.tasks[e],{isActive:!0,id:l.data.scheduleTask.task.id,lastExecution:l.data.scheduleTask.task.lastExecution,failed:l.data.scheduleTask.task.failed}),a.openSnackbar();case 6:case"end":return t.stop()}}),t)})))()},deleteScheduledTask:function(e){var a=this;return(0,L.A)((0,E.A)().mark((function t(){var n;return(0,E.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,S.vq)(a.$apollo,a.tasks[e].id)["catch"]((function(e){return a.openSnackbar(e)}));case 2:n=t.sent,n.data.deleteScheduledTask.deleted&&(Object.assign(a.tasks[e],{isActive:!1,id:null,lastExecution:null,failed:null}),a.openSnackbar());case 4:case"end":return t.stop()}}),t)})))()},updateScheduledTask:function(e){var a=this;return(0,L.A)((0,E.A)().mark((function t(){var n,l;return(0,E.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="custom"===a.tasks[e].interval?a.tasks[e].customInterval:a.tasks[e].interval,l={interval:Number(n),params:JSON.stringify(a.tasks[e].params)},t.next=4,(0,S.lC)(a.$apollo,a.tasks[e].id,l)["catch"]((function(e){return a.openSnackbar(e)}));case 4:a.openSnackbar();case 5:case"end":return t.stop()}}),t)})))()},openSnackbar:function(e){var a=e?"Error saving settings: ".concat(this.$getErrorMessage(e)):"Changes saved successfully";Object.assign(this.snackbar,{isActive:!0,text:a,color:e?"error":"success"})}},mounted:function(){var e=this;return(0,L.A)((0,E.A)().mark((function a(){return(0,E.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.fetchScheduledTasks();case 2:case"end":return a.stop()}}),a)})))()}};var W=t(64621);const C=(0,W.A)(U,[["render",w],["__scopeId","data-v-0124d1a1"]]),$=C}}]);
//# sourceMappingURL=833.8767e9de.js.map