import{Q as b}from"./QPage-Bsl3POGX.js";import{Q as p,a as v,b as u,T as Q}from"./QCardActions-CCNxgX-L.js";import{Q as x,a as L,b as C,s as T}from"./notify-l1rcF7nX.js";import{_ as S,k as $}from"./_plugin-vue_export-helper-InhTkpCe.js";import{c as P,k as O,h as E,D as q,O as m,Q as l,R as a,T as o,_ as d,V as i,W as h,Z as c,Y as g,X as _,a2 as I,a3 as N,aa as V}from"./index-CsBGwL4Q.js";const A=P({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(t,{slots:s}){const e=O(()=>{const n=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(r=>t[r]===!0).map(r=>`q-btn-group--${r}`).join(" ");return`q-btn-group row no-wrap${n.length!==0?" "+n:""}`+(t.spread===!0?" q-btn-group--spread":" inline")});return()=>E("div",{class:e.value},q(s.default))}}),D="/assets/sunshine-8uBg5lE1.jpg",G={name:"StationPanel",props:["station"],data(){return{}},methods:{toRouter(t){this.$router.push(t)}}},R={class:"text-h5 text-weight-light"},W={class:"text-red"},j={class:"text-weight-light"};function F(t,s,e,n,r,w){return l(),m(C,{class:"shadow-4 q-ma-xs"},{default:a(()=>[e.station.image?(l(),m(p,{key:0,src:this.$hostname+"/static/kunlun_scripts/"+e.station.image,height:50*e.station.row+"px"},null,8,["src","height"])):(l(),m(p,{key:1,src:D,height:50*e.station.row+"px"},null,8,["height"])),o(x,{style:{"margin-top":"-5px"}},{default:a(()=>[d("div",R,[i(h(t.$t("station.title"))+": ",1),d("span",W,h(e.station.name),1)]),d("div",j,h(e.station.description),1)]),_:1}),o($,{style:{"margin-top":"-10px"}}),o(v,null,{default:a(()=>[o(c,{color:"primary",tag:"a",href:"#/autotest/"+e.station.name.toLowerCase()},{default:a(()=>[i(h(t.$t("station.explore")),1)]),_:1},8,["href"]),o(L),o(A,{outline:""},{default:a(()=>[o(c,{color:"grey",label:e.station.idle},{default:a(()=>[o(u,{anchor:"top middle",self:"center middle"},{default:a(()=>s[0]||(s[0]=[i("IDLE")])),_:1})]),_:1},8,["label"]),o(c,{color:"orange",label:e.station.run},{default:a(()=>[o(u,{anchor:"top middle",self:"center middle"},{default:a(()=>s[1]||(s[1]=[i("RUN")])),_:1})]),_:1},8,["label"]),o(c,{color:"green",label:e.station.pass},{default:a(()=>[o(u,{anchor:"top middle",self:"center middle"},{default:a(()=>s[2]||(s[2]=[i("PASS")])),_:1})]),_:1},8,["label"]),o(c,{color:"red",label:e.station.fail},{default:a(()=>[o(u,{anchor:"top middle",self:"center middle"},{default:a(()=>s[3]||(s[3]=[i("FAIL")])),_:1})]),_:1},8,["label"])]),_:1})]),_:1})]),_:1})}const M=S(G,[["render",F],["__scopeId","data-v-0ec17e09"]]),U={name:"StationPage",components:{ToolBar:Q,Panel:M},setup(){return{notify:T()}},data:()=>({url:"",ws:null,timeOuter:null,stationList:[],version:"",host:""}),computed:{},mounted(){this.url=window.location.hash.substring(1).toUpperCase(),this.getPlatformInfo(),this.getStationList(),this.initSocket()},unmounted(){this.ws.close(),this.timeOuter&&clearTimeout(this.timeOuter)},methods:{async initSocket(){const t=this.$hostname.replace("http","ws")+"/ws"+this.url;this.ws=new WebSocket(t),this.ws.onmessage=this.onMessageSocket,this.ws.onerror=this.onErrorSocket,this.ws.onclose=this.onCloseSocket,this.timeOuter&&clearTimeout(this.timeOuter)},onErrorSocket(){this.notify("WS Connection Lost"),this.timeOuter=setTimeout(()=>{this.initSocket()},3e3)},onSendSocket(t){},onCloseSocket(){return!1},onMessageSocket(t){const s=JSON.parse(t.data);s.type==="station"&&this.stationList.forEach((e,n)=>{e.name===s.name&&this.stationList.splice(n,1,s.data)})},async getPlatformInfo(){this.$api.post("get-platform-info").then(t=>{this.version=t.data.version,this.host=t.data.host,document.title=this.host+" | "+this.version}).catch(t=>{console.log(t)})},async getStationList(){this.$api.post("get-station-list").then(t=>{this.stationList=t.data.data,this.notify(t.data.message)}).catch(t=>{console.log(t),this.notify("Get Station List meets Error")})}}},z={class:"row"},J={class:"col-12"};function X(t,s,e,n,r,w){const k=g("ToolBar"),y=g("Panel");return l(),m(b,null,{default:a(()=>[d("div",z,[d("div",J,[o(k)]),(l(!0),_(I,null,N(t.stationList,(f,B)=>(l(),_("div",{key:B,class:V("col-"+f.col)},[o(y,{station:f},null,8,["station"])],2))),128))])]),_:1})}const et=S(U,[["render",X]]);export{et as default};
