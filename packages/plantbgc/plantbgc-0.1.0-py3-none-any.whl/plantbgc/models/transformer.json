{
  "type": "KerasTransformer",
  "build_params": {
    "batch_size": 16,
    "d_model": 128,
    "num_heads": 4,
    "ff_dim": 512,
    "num_layers": 4,
    "dropout": 0.1,

    "stage": "stage1",
    "freeze_backbone": false,

    "mlm_eps": 1e-6,
    "mlm_weight_from_diff": true
  },
  "fit_params": {
    "timesteps": 256,
    "validation_size": 0,
    "verbose": 1,
    "num_epochs": 1000,

    "early_stopping": {
      "monitor": "val_auc_roc",
      "mode": "max",
      "min_delta": 0.01,
      "patience": 20
    },

    "shuffle": true,
    "optimizer": "adam",
    "learning_rate": 0.01,
    "weighted": true
  },
  "input_params": {
    "features": [
      { "type": "ProteinBorderTransformer" },
      { "type": "Pfam2VecTransformer", "vector_path": "#{PFAM2VEC}" }
    ]
  }
}
