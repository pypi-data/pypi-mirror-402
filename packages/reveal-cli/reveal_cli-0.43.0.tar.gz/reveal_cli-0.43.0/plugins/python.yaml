# Python Source File Plugin
# Provides 4-level progressive disclosure for .py files

extension: .py
name: Python Source
description: Python source files with AST-based analysis
icon: üêç

# Hierarchical levels - each level reveals more detail
levels:
  0:
    name: metadata
    description: File statistics and basic information
    breadcrumb: "File metadata (size, encoding, line count)"
    analyzer: null  # Built-in metadata analyzer
    outputs:
      - file_size
      - line_count
      - encoding
      - last_modified
      - file_type
    next_levels: [1, 2, 3]

  1:
    name: structure
    description: Code structure without implementations
    breadcrumb: "Imports, classes, functions (structure only)"
    analyzer: python_structure
    outputs:
      - imports
      - classes
      - functions
      - global_variables
      - decorators
    next_levels: [0, 2, 3]
    tips:
      - "Use --grep 'ClassName' to filter specific classes"
      - "Add --context 2 to see surrounding context"

  2:
    name: preview
    description: Signatures and docstrings without full code
    breadcrumb: "Function signatures, docstrings, type hints"
    analyzer: python_preview
    outputs:
      - function_signatures
      - class_signatures
      - docstrings
      - type_hints
      - decorators_with_args
    next_levels: [0, 1, 3]
    tips:
      - "See full implementation with --level 3"
      - "Filter by function name with --grep"

  3:
    name: full
    description: Complete source code with paging
    breadcrumb: "Complete file contents (paged)"
    analyzer: null  # Built-in full content reader
    outputs:
      - full_source
    next_levels: [0, 1, 2]
    paging: true
    page_size: 120
    tips:
      - "Use --grep to filter lines"
      - "Add --context N for surrounding lines"

# Features available at all levels
features:
  grep: true
  context: true
  paging: true
  line_numbers: true
  syntax_highlighting: true  # Future

# Analyzer configuration
analyzer_config:
  include_private: false
  include_magic: false
  parse_docstrings: true
  extract_type_hints: true

# Examples shown in help text
examples:
  - command: "reveal app.py"
    description: "Show file metadata (level 0)"
  - command: "reveal app.py -l 1"
    description: "Show code structure (imports, classes, functions)"
  - command: "reveal app.py -l 2 --grep 'UserManager'"
    description: "Preview UserManager class signatures"
  - command: "reveal app.py -l 3 --grep 'def process' -C 5"
    description: "Show process functions with 5 lines context"
