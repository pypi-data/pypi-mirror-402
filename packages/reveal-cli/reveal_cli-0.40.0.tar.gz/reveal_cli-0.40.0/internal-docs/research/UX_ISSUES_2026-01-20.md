# Reveal UX Issues Report

**Session**: mystic-knight-0120
**Date**: 2026-01-20
**Version**: v0.39.0

---

## Issues Found This Session

### 1. BUG: HTML Metadata Dict Not Displayed (FIXED)

**Symptom**: `reveal file.html --metadata` showed empty output, tests failing

**Cause**: `_render_text_categories()` in `structure.py` skipped dict-type items before reaching the metadata handler

**Fix**: Added special handling for `metadata` category before the `isinstance(items, list)` check

**Files**: `reveal/display/structure.py`

**Status**: ✅ FIXED

---

### 2. UX: Line Extraction Syntax Ambiguity (FIXED)

**Issue**: `reveal file.py:50` fails with "file.py:50 not found"

**Fix**: Added support for `file:line` and `file:line-line` syntax in `routing.py`

Now both work:
- `reveal file.py:50` ✅
- `reveal file.py :50` ✅
- `reveal file.py:50-60` ✅

**Files**: `reveal/cli/routing.py`

**Status**: ✅ FIXED

---

### 3. UX: Section Extraction with Line Numbers (FIXED)

**Issue**: `reveal file.md :15` didn't work for markdown sections

**Fix**: Added `_extract_markdown_section_at_line()` in `display/element.py` to find markdown sections by line number

Now works:
- `reveal file.md :11` ✅ - extracts section containing line 11
- `reveal file.md "Section Name"` ✅ - extracts by name

**Files**: `reveal/display/element.py`

**Status**: ✅ FIXED

---

### 4. INFO: Previous Session Work Not Committed

**Issue**: Previous session (lingering-tide-0119) modified PRIORITIES.md but it was already deleted in commit f2f01c9

**Impact**: None (file was intentionally removed for "clean project boundary")

**Learning**: Files marked "modified" in README may reference files that no longer exist in repo

---

## Previously Documented Issues (From Dogfooding Report)

### 5. UX: `:?` Shown for Missing Line Numbers (FIXED)

**Issue**: INI files showed `:?` in breadcrumbs where line info wasn't captured

**Fix**: Added line number tracking to INI analyzer by pre-scanning for `[section]` patterns

Now shows:
- `:1 database` ✅ instead of `:? database`

**Files**: `reveal/analyzers/ini_analyzer.py`

**Status**: ✅ FIXED

---

### 6. UX: `--languages` Output Had Duplicates (FIXED)

**Issue**: `--languages` showed 86 languages with some appearing in both "Explicit" and "Fallback" sections

**Fix**: Filter fallback languages to exclude those with explicit analyzers

Now shows:
- 64 explicit analyzers
- 16 fallback languages (down from 22)
- Total: 80 languages (no duplicates)

**Files**: `reveal/cli/languages.py`

**Status**: ✅ FIXED

---

### 7. UX: No `--adapters` Flag (FIXED)

**Issue**: Must use `reveal help://adapters` to see adapter list

**Fix**: Added `--adapters` flag that shows all URI adapters with descriptions and examples

Now works:
- `reveal --adapters` ✅

**Files**: `reveal/cli/parser.py`, `reveal/cli/handlers.py`, `reveal/cli/__init__.py`, `reveal/main.py`

**Status**: ✅ FIXED

---

## Improvement Suggestions from Dogfooding

### Future Work Items

1. **Adapter self-test capability**: `reveal ast://test` to verify adapter works
2. **Help sections for all adapters**: `reveal help://adapters/{name}` with full examples
3. **Better database error messages**: More helpful errors for sqlite://, mysql://

---

## Files Modified This Session

| File | Change |
|------|--------|
| `reveal/display/structure.py` | +7 lines: HTML metadata dict handling |
| `reveal/cli/routing.py` | +15 lines: Support `file:line` extraction syntax |
| `reveal/display/element.py` | +55 lines: Markdown section extraction by line |
| `reveal/analyzers/ini_analyzer.py` | +8 lines: Line number tracking for sections |
| `reveal/cli/languages.py` | +6 lines: Filter duplicate fallback languages |
| `reveal/cli/parser.py` | +2 lines: `--adapters` argument |
| `reveal/cli/handlers.py` | +35 lines: `handle_adapters()` function |
| `reveal/cli/__init__.py` | +2 lines: Export `handle_adapters` |
| `reveal/main.py` | +2 lines: Wire up adapters handler |

**Prior session changes (now committed)**:
| File | Change |
|------|--------|
| `reveal/analyzers/powershell.py` | +47 lines: `_get_signature()` override |
| `reveal/display/formatting.py` | +58 lines: CSV/XML formatters |

---

## Summary

**7 UX issues identified, 6 fixed this session:**

1. ✅ HTML metadata display
2. ✅ Line extraction syntax (`file:line`)
3. ✅ Markdown section extraction by line
4. ℹ️ Info only (no fix needed)
5. ✅ INI line numbers
6. ✅ `--languages` duplicates
7. ✅ `--adapters` flag

**All 2543 tests passing.**

---

**Full Path**: `/home/scottsen/src/projects/reveal/external-git/internal-docs/research/UX_ISSUES_2026-01-20.md`
