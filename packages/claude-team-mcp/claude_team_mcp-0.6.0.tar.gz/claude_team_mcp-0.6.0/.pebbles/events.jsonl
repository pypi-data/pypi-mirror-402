{"type":"create","timestamp":"2025-12-15T00:33:52.292079Z","issue_id":"cic-une","payload":{"description":"Currently send_message only works FROM coordinator TO workers. Workers have no way to message back to the coordinator because the coordinator doesn't have a session_id in the registry.\n\nProposed solution: Add a 'coordinator inbox' mechanism where:\n1. Workers can call something like send_to_coordinator(message)\n2. Coordinator can poll/read inbox via get_coordinator_messages()\n\nThis would enable async communication patterns without workers writing to temp files.","priority":"2","title":"Add coordinator messaging - allow workers to send messages back to coordinator","type":"feature"}}
{"type":"create","timestamp":"2025-12-15T01:56:09.65449Z","issue_id":"cic-h75","payload":{"description":"Add a Textual-based TUI companion app to claude-team for managing workers, viewing session state, and integrating with beads task tracking. Key features: dual transport (stdio+HTTP), real-time session monitoring, worker spawn/kill, beads task assignment, advisory messages to lead session.","priority":"2","title":"Claude Team TUI Companion App","type":"epic"}}
{"type":"create","timestamp":"2025-12-16T17:20:11.113365Z","issue_id":"cic-l8u","payload":{"description":"Allow claude-team to spawn terminal sessions that do NOT run Claude Code. Useful for long-running shell programs like dev servers (npm run dev), build watchers, database clients, etc. Sessions should be trackable and manageable like Claude sessions but without JSONL/conversation tracking.","priority":"2","title":"Shell-only terminal sessions for long-running processes","type":"epic"}}
{"type":"create","timestamp":"2025-12-16T17:20:34.630863Z","issue_id":"cic-avg","payload":{"description":"Create new MCP tool spawn_shell() similar to spawn_session but without starting Claude. Parameters: project_path, session_name, command (optional - command to run), layout. Should create iTerm window/pane, cd to project, optionally run initial command.","priority":"2","title":"Add spawn_shell MCP tool","type":"task"}}
{"type":"create","timestamp":"2025-12-16T17:20:45.501187Z","issue_id":"cic-q6l","payload":{"description":"Create MCP tool to send commands/input to shell-only sessions. Similar to send_message but for raw shell input. Should handle Enter key properly. May want option to wait for command completion.","priority":"2","title":"Add send_to_shell MCP tool","type":"task"}}
{"type":"create","timestamp":"2025-12-16T17:20:50.891408Z","issue_id":"cic-hr4","payload":{"description":"Create MCP tool to read terminal output from shell-only sessions. Use iTerm2 screen content API (already have this in get_session_status). Return recent lines of output. May want options for line count, follow mode.","priority":"2","title":"Add get_shell_output MCP tool","type":"task"}}
{"type":"create","timestamp":"2025-12-16T17:20:56.307156Z","issue_id":"cic-2q6","payload":{"description":"Ensure spawn_team and layout options work with mixed session types. E.g., quad layout with 3 Claude workers + 1 shell running dev server. May need to extend spawn_team API or add spawn_mixed_team.","priority":"2","title":"Support mixed layouts with shell and Claude sessions","type":"task"}}
{"type":"create","timestamp":"2025-12-16T17:21:01.708275Z","issue_id":"cic-7pt","payload":{"description":"Handle shell session lifecycle: detect if process is still running, graceful shutdown (SIGTERM then SIGKILL), restart capability. Reuse close_session or add close_shell. Add is_process_running check.","priority":"2","title":"Add shell session lifecycle management","type":"task"}}
{"type":"create","timestamp":"2025-12-17T04:38:23.214042Z","issue_id":"cic-x5t","payload":{"description":"Consider adding a close_team() or close_all_sessions() helper for batch closing workers.\n\n**Context from dogfooding:**\nWhen coordinating a team of 4 workers, had to call close_session 4 times sequentially. Minor friction but noticeable.\n\n**Open questions:**\n- Should this close all sessions, or just sessions from a specific spawn_team call?\n- If the latter, need team tracking (see related spike)\n- Is this worth the API surface area or is 4 close calls fine?\n\n**Status:** Thought experiment - not ready to build. Consider independently from main orchestration epic.","priority":"3","title":"Thought experiment: close_team / batch session close","type":"chore"}}
{"type":"create","timestamp":"2025-12-17T04:38:23.497704Z","issue_id":"cic-1vn","payload":{"description":"Consider tracking which workers were spawned together as a 'team'.\n\n**Context from dogfooding:**\nAfter spawning 4 workers, they become individual sessions with no memory that they were spawned together. If I wanted to 'close the team I just spawned' I had to remember which worker IDs belonged to it.\n\n**Possible approaches:**\n1. spawn_team returns a team_id, sessions store it\n2. list_sessions can filter by team_id\n3. close_team(team_id) closes all sessions in that team\n\n**Open questions:**\n- Is this over-engineering? Coordinator could just track IDs themselves\n- Does this conflict with the 'iconic names' approach? (team = name_set used?)\n- What happens if you spawn multiple teams with same name_set?\n\n**Status:** Thought experiment - not ready to build. Consider independently from main orchestration epic.","priority":"3","title":"Thought experiment: team tracking / team_id concept","type":"chore"}}
{"type":"create","timestamp":"2025-12-17T04:42:36.631081Z","issue_id":"cic-bcf","payload":{"description":"Evaluate whether the existing wait_for_completion tool should be kept, modified, or removed.\n\n**Current state:**\n- wait_for_completion exists with 5 min default timeout, polls every 2 seconds\n- Uses multiple detection methods (markers, git, beads, screen, idle time)\n- Unclear if MCP tool timeouts from Claude Code side would even allow 5 min waits\n\n**Concerns:**\n- MCP tool timeout behavior is undocumented\n- Blocking waits don't let coordinator do other work\n- If one worker is slow/blocked, coordinator is stuck\n\n**Alternative pattern (used in dogfooding):**\n- Non-blocking send_message calls\n- Coordinator polls list_sessions / get_conversation_history\n- Coordinator decides when workers are done\n- Each tool call returns quickly, no timeout issues\n\n**Options:**\n1. Keep wait_for_completion as-is (useful for simple single-worker cases?)\n2. Remove it for clarity - polling pattern is safer\n3. Replace with non-blocking check_completion_status\n4. Add wait_for_team that returns when ANY worker finishes (not all)\n\n**Status:** Thought experiment - consider removing existing implementation for clarity.","priority":"3","title":"Thought experiment: wait_for_completion / wait_for_team","type":"chore"}}
{"type":"create","timestamp":"2025-12-21T06:17:51.72494Z","issue_id":"cic-7on","payload":{"description":"Improve the message format returned by read_worker_logs for better coordinator usability.\n\n## Key Improvements\n\n### Add New Fields\n- `index`: Message number in conversation (1-based) for easy reference\n- `time_ago`: Relative timestamp (e.g., '2 min ago') for quick scanning\n- `content_length`: Character count to know message size before reading\n- `content_preview`: First 200 chars for long messages\n- `tools_summary`: List of readable tool summaries (e.g., 'Read â†’ src/foo.py')\n- `tool_count`: Quick count of tools used\n- `has_thinking`: Boolean flag instead of full thinking text by default\n\n### Remove/Simplify\n- Remove `uuid` from default output (noise for coordinators)\n- Simplify `tool_uses` - summarize large inputs instead of full content\n- Replace full `thinking` blocks with boolean flag by default\n\n### Optional Enhancement\n- Consider adding `format` parameter: 'full' (current), 'compact' (previews only), 'summary' (one-line per message)\n\n## Files to Modify\n- src/claude_team_mcp/session_state.py - Message.to_dict() method\n- src/claude_team_mcp/server.py - read_worker_logs tool\n\n## References\nBased on JSONL Conversation Formatting Review research.","priority":"2","title":"Enhance read_worker_logs output formatting","type":"feature"}}
{"type":"create","timestamp":"2025-12-23T04:33:57.891092Z","issue_id":"cic-ivhu","payload":{"description":"When message_workers receives a message that begins with forward slash (/), return immediately despite wait conditions. Interpret this as an attempt at a slash command which doesn't produce reliable telemetry (no stop hook fires). Include in the return that we detected a slash command and recommend the coordinator read the conversation logs to verify success.","priority":"2","title":"Return immediately on slash command messages","type":"feature"}}
{"type":"create","timestamp":"2025-12-23T04:36:31.89944Z","issue_id":"cic-5xot","payload":{"description":"Create a comprehensive terminal abstraction layer that captures full feature parity with both iTerm2 and Zed Terminal CLI backends. The abstraction should be complete and extensible, covering all current and future capabilities.\n\n## Core Features\n- Self-identification (which terminal am I in?)\n- Layout introspection (what panes exist, who are my neighbors?)\n- Splitting panes\n- Spawning new terminals (with or without Claude)\n- Sending text/keys\n- Reading screen content\n- Managing focus\n- Setting titles\n- Layout reorganization\n\n## Advanced Features (iTerm2)\n- Event subscriptions (new session, keystroke, screen update, prompt, location change, custom escape sequences, session terminate, layout change, focus change)\n- Custom control sequences for bidirectional communication\n- Profile customizations (tab colors, badges)\n\n## Advanced Features (Zed)\n- Layout control (TileVertical, TileHorizontal, Consolidate)\n- Layout tree introspection with bounding boxes\n- Move terminal between panes\n- Terminal idle detection\n- in_pane_of targeting for terminal creation","priority":"1","title":"Comprehensive Terminal Abstraction Layer","type":"epic"}}
{"type":"create","timestamp":"2025-12-23T04:37:13.825284Z","issue_id":"cic-bt3a","payload":{"description":"Update existing code in claude_team_mcp to use the new terminal abstraction layer.\n\n## Files to Update\n- server.py - Use TerminalBackend instead of direct iTerm2 connection\n- registry.py - Update ManagedSession to use TerminalHandle\n- tools/*.py - Update all tools to use abstraction\n\n## Migration Strategy\n1. Create TerminalBackend instance in app_lifespan\n2. Update AppContext to hold backend instead of raw connection\n3. Update ensure_connection pattern to work with backend\n4. Migrate iterm_utils.py calls to backend methods\n5. Update ManagedSession to store TerminalHandle instead of iterm_session\n\n## Backwards Compatibility\n- Keep iterm_utils.py as internal implementation detail for now\n- Eventually deprecate direct iterm_utils usage","priority":"2","title":"Migrate existing code to terminal abstraction","type":"task"}}
{"type":"create","timestamp":"2026-01-13T19:23:23.632251Z","issue_id":"cic-d9j","payload":{"description":"When listing or examining workers, the agent_type field (claude vs codex) is not included in the output. Coordinators need this to know which type of worker they're managing.","priority":"2","title":"agent_type not shown in list_workers/examine_worker","type":"bug"}}
{"type":"create","timestamp":"2026-01-13T22:26:56.533366Z","issue_id":"cic-fgx","payload":{"description":"When the MCP server is running inside iTerm2, automatically detect the coordinator's window and prefer spawning workers there (when space is available) before falling back to find_available_window().\n\n## Background\niTerm2 sets ITERM_SESSION_ID in the environment for processes running inside it. We can use this to detect the coordinator's session and find its parent window.\n\n## Implementation\n1. In spawn_workers.py, check os.environ.get('ITERM_SESSION_ID')\n2. If present, use iTerm2 API to look up that session\n3. Use get_window_for_session() to find the coordinator's window\n4. When layout='auto', prefer that window first (if it has space)\n5. Fall back to existing find_available_window() logic if coordinator window is full\n\n## Existing Infrastructure\n- get_window_for_session(app, session) already exists in iterm_utils.py:1098-1117\n- split_pane() supports incremental pane addition\n- find_available_window() handles the general case\n\n## Notes\n- Only affects layout='auto' mode\n- Gracefully degrades if not running in iTerm or window is full\n- No new parameters needed - this is transparent behavior improvement","priority":"2","title":"Auto-detect coordinator's iTerm window and prefer it for spawning workers","type":"feature"}}
{"type":"create","timestamp":"2026-01-13T23:13:50.495475Z","issue_id":"cic-7ni","payload":{"description":"Add name sets featuring famous Romans from antiquity to names.py, covering multiple worker configurations (1, 2, 3, and 4 workers).\n\n## Requirements\n- Add entries to SOLOS, DUOS, TRIOS, QUARTETS dicts in src/claude_team_mcp/names.py\n- Follow existing naming conventions (lowercase keys with underscores)\n- Choose historically notable Romans and groupings","priority":"3","title":"Add famous Romans from antiquity to worker name sets","type":"feature"}}
{"type":"comment","timestamp":"2025-12-15T19:38:22Z","issue_id":"cic-une","payload":{"body":"Author: rabsef-bicrym\nPartial progress: Added get_conversation_history tool (cic-8mk) which allows coordinator to observe worker activity with reverse pagination. This addresses the OBSERVATION part of the problem. The back-channel messaging (workers sending TO coordinator) still needs a queue/inbox system since coordinator isn't in iTerm."}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:17.258226Z","issue_id":"cic-l8u","payload":{"dep_type":"blocks","depends_on":"cic-avg"}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:27.546817Z","issue_id":"cic-l8u","payload":{"dep_type":"blocks","depends_on":"cic-q6l"}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:32.679775Z","issue_id":"cic-l8u","payload":{"dep_type":"blocks","depends_on":"cic-hr4"}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:37.820296Z","issue_id":"cic-l8u","payload":{"dep_type":"blocks","depends_on":"cic-2q6"}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:42.959352Z","issue_id":"cic-l8u","payload":{"dep_type":"blocks","depends_on":"cic-7pt"}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:54.814672Z","issue_id":"cic-q6l","payload":{"dep_type":"blocks","depends_on":"cic-avg"}}
{"type":"dep_add","timestamp":"2025-12-16T17:21:59.958568Z","issue_id":"cic-hr4","payload":{"dep_type":"blocks","depends_on":"cic-avg"}}
{"type":"dep_add","timestamp":"2025-12-16T17:22:05.095812Z","issue_id":"cic-2q6","payload":{"dep_type":"blocks","depends_on":"cic-avg"}}
{"type":"dep_add","timestamp":"2025-12-23T04:37:23.162209Z","issue_id":"cic-5xot","payload":{"dep_type":"blocks","depends_on":"cic-bt3a"}}
{"type":"comment","timestamp":"2026-01-13T23:10:14.082126Z","issue_id":"cic-fgx","payload":{"body":"Close reason: Implemented auto-detect coordinator window with proper ITERM_SESSION_ID parsing and 3-pane layout"}}
{"type":"close","timestamp":"2026-01-13T23:10:14.082126Z","issue_id":"cic-fgx","payload":{}}
{"type":"create","timestamp":"2026-01-20T04:09:10.311493Z","issue_id":"cic-367","payload":{"description":"Abstract claude-team issue tracking so it can work with either Beads (bd) or Pebbles (pb), including detection and prompt/help updates.","priority":"1","title":"Issue tracker abstraction","type":"epic"}}
{"type":"create","timestamp":"2026-01-20T04:09:16.716586Z","issue_id":"cic-90d","payload":{"description":"Add an issue tracker abstraction module with backend registry, command templates, capabilities, and detection (beads vs pebbles).","priority":"1","title":"Phase 1: Issue tracker abstraction module","type":"task"}}
{"type":"create","timestamp":"2026-01-20T04:09:21.078029Z","issue_id":"cic-107","payload":{"description":"Update worktree detection to return tracker-specific env var paths (e.g., BEADS_DIR or Pebbles equivalent).","priority":"1","title":"Phase 2: Worktree detection for tracker env","type":"task"}}
{"type":"create","timestamp":"2026-01-20T04:09:26.691584Z","issue_id":"cic-7c5","payload":{"description":"Replace Beads-specific prompt/help strings with backend data (worker_prompt, constants, bd_help/message hint).","priority":"1","title":"Phase 3: Tracker-neutral prompts and help","type":"task"}}
{"type":"create","timestamp":"2026-01-20T04:09:32.962712Z","issue_id":"cic-a97","payload":{"description":"Update docs and tests to remove Beads-only language and align with the new abstraction.","priority":"2","title":"Phase 4: Tracker-neutral docs and tests","type":"task"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:38.868502Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-90d"}}
{"type":"create","timestamp":"2026-01-20T04:09:41.079133Z","issue_id":"cic-b54","payload":{"description":"Update tests and documentation to be tracker-neutral. Adjust tests/test_worker_prompt.py, CLAUDE.md, README.md, and commands/*.md.","priority":"1","title":"Phase 4: Update docs and tests","type":"task"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:41.09764Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-90d"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:41.116226Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-107"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:41.133989Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-7c5"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:41.16431Z","issue_id":"cic-107","payload":{"dep_type":"blocks","depends_on":"cic-90d"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:41.183647Z","issue_id":"cic-7c5","payload":{"dep_type":"blocks","depends_on":"cic-107"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:44.032047Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-107"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:47.87402Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-7c5"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:51.578675Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-a97"}}
{"type":"close","timestamp":"2026-01-20T04:09:52.39411Z","issue_id":"cic-a97","payload":{}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:52.415024Z","issue_id":"cic-367","payload":{"dep_type":"blocks","depends_on":"cic-b54"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:52.434493Z","issue_id":"cic-b54","payload":{"dep_type":"blocks","depends_on":"cic-7c5"}}
{"type":"dep_add","timestamp":"2026-01-20T04:09:54.91112Z","issue_id":"cic-107","payload":{"dep_type":"blocks","depends_on":"cic-90d"}}
{"type":"dep_add","timestamp":"2026-01-20T04:10:00.488585Z","issue_id":"cic-7c5","payload":{"dep_type":"blocks","depends_on":"cic-107"}}
{"type":"dep_add","timestamp":"2026-01-20T04:10:06.055452Z","issue_id":"cic-a97","payload":{"dep_type":"blocks","depends_on":"cic-7c5"}}
{"type":"status_update","timestamp":"2026-01-20T05:05:20.944388Z","issue_id":"cic-b54","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-01-20T05:18:20.542131Z","issue_id":"cic-b54","payload":{}}
{"type":"create","timestamp":"2026-01-21T19:06:11.932386Z","issue_id":"cic-c09","payload":{"description":"Three tests in test_cli_backends.py are failing because they expect --full-auto flag but implementation uses --dangerously-bypass-approvals-and-sandbox. Need to investigate which is correct and update either the implementation or tests accordingly.","priority":"2","title":"Fix failing Codex CLI tests","type":"task"}}
{"type":"status_update","timestamp":"2026-01-21T19:06:35.580259Z","issue_id":"cic-c09","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-01-21T19:08:45.621746Z","issue_id":"cic-c09","payload":{}}
