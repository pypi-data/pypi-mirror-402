# 更新日志

## [1.0.0] - 2026年1月18日 🎉 正式发布

### 🎉 重大更新
- **Web UI 可视化管理界面**：全新的现代化 Web 界面，支持任务的创建、编辑、执行和监控
- **CLI 集成**：通过 `taskflow web` 命令一键启动 Web UI
- **多队列管理**：支持同时管理多个任务队列

### 新功能
- **`taskflow web` 子命令**：支持通过命令行启动 Web UI
  - `taskflow web` - 使用当前目录作为工作空间
  - `taskflow web tasks.yaml` - 加载指定配置文件
  - `taskflow web --port 9000` - 指定自定义端口
  - `taskflow web -w /path/workspace` - 指定工作空间目录
- **消息推送通知**：集成 PushPlus，任务完成/失败时推送通知到微信
  - 支持 Web UI 配置 Token（优先级高于环境变量）
  - 通知包含任务状态、运行时长、最后10行日志
- **会话持久化**：重启后端后无需重新登录，会话有效期7天
- **任务状态智能判断**：通过日志内容分析任务成功/失败状态
- **实时日志查看**：WebSocket 实时推送运行日志

### 优化
- **任务详情对话框**：合并查看和编辑功能，支持模式切换
- **日志面板**：防止自动切换覆盖用户手动选择，修复内容竞态条件
- **XTerminal**：正确处理内容追加和替换逻辑
- **认证保护**：所有 API 端点强制认证

### 安装
```bash
# 基础安装（仅 CLI）
pip install multitaskflow

# 完整安装（CLI + Web UI）
pip install multitaskflow[web]
```

## [0.1.5] - 2025年11月10日
### 新功能
- **任务跳过功能**：支持在配置文件中使用 `status: skipped` 跳过任务执行
  - 加载任务时自动过滤 `status` 为 `skipped` 的任务
  - 日志输出跳过的任务数量和名称
  - 适用于临时禁用某些任务的场景

### 优化
- 新增 `STATUS_SKIPPED` 状态常量
- 改进 `load_tasks()` 方法的日志输出，区分加载和跳过的任务

### 文档
- 更新 README，添加 `status` 字段详细说明
- 添加任务跳过功能的使用示例
- 新增 TODO 章节，规划动态任务管理功能（基于 watchdog 的文件监控）

## [0.1.4] - 2025年11月10日
### 新功能
- **智能环境变量加载**：优先从配置文件同目录加载 `.env` 文件，提升配置管理便利性
  - 优先级顺序：配置文件同目录 > 当前工作目录 > 向上递归查找
  - 未找到时会提示推荐的创建位置
- **环境变量配置检查**：启动时和配置变更时自动显示环境变量配置状态
  - 显示 `.env` 文件加载位置
  - Token 脱敏显示（前6位...后6位）
  - 实时显示 `MTF_SILENT_MODE` 状态
  - 支持彩色输出（需安装 `colorama`，可选）
- **环境变量变更检测**：任务执行前自动检测环境变量变化，有变化时重新显示配置

### 优化
- 每个任务执行前重新加载环境变量，支持运行时修改 `.env` 文件
- 改进日志输出层级，环境变量加载使用 debug 级别
- 添加 `colorama` 作为可选依赖，提供更友好的彩色输出

### 文档
- 更新 README，添加环境变量加载机制说明
- 添加彩色输出可选功能说明


## [0.1.3] - 2025年5月13日
### 新功能
- 增加环境变量静默模式，通过设置MTF_SILENT_MODE环境变量控制是否发送消息通知，适用于无网络或者不想要接收消息场景
### 优化
- 优化日志输出，提供更清晰的任务状态信息

## [0.1.1] - 2025年4月30日



### 修复
- MSG_PUSH_TOKEN环境变量读取问题 

## 2025年5月12日 TODO

1. CLI 命令增加一个 监听单个任务的功能：
    输入 taskflow monitor 'XXX', 其中'XXX'表示需要监听的任务的进程名称，针对已经有一个且只有一个任务已经在跑的场景，通过 monitor 在任务结束发送消息。
<!-- 2. 发送消息改为  -->
