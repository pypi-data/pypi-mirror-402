# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.create_monitor_response_dto import CreateMonitorResponseDto
from ..types.list_monitors_response_dto import ListMonitorsResponseDto
from ..types.pull_monitor_response_dto import PullMonitorResponseDto
from ..types.update_monitor_response_dto import UpdateMonitorResponseDto
from ..types.webhook_dto import WebhookDto
from .raw_client import AsyncRawMonitorsClient, RawMonitorsClient
from .types.disable_monitor_response import DisableMonitorResponse
from .types.enable_monitor_response import EnableMonitorResponse
from .types.list_monitor_jobs_request_sort import ListMonitorJobsRequestSort
from .types.list_monitor_jobs_response import ListMonitorJobsResponse

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class MonitorsClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawMonitorsClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawMonitorsClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawMonitorsClient
        """
        return self._raw_client

    def create_monitor(
        self,
        *,
        reference_job_id: str,
        schedule: str,
        webhook: typing.Optional[WebhookDto] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> CreateMonitorResponseDto:
        """
        Create a monitor that runs jobs based on a reference job with a specified schedule.

        **Schedule requirements:**
        - Minimum 24-hour interval between executions
        - Natural language format (e.g., "every day at 12 PM UTC", "every 48 hours")

        **Validation:**
        - Schedules below minimum frequency return error with descriptive message.
        - Invalid job IDs return 400 Bad Request.
        - Duplicate monitors (same job already monitored) return error.

        Parameters
        ----------
        reference_job_id : str
            Job ID to use as template for scheduled runs.

        schedule : str
            Natural language schedule (e.g. 'every day at 12 AM EST').

            **Minimum frequency:** Monitors must be scheduled at least 24 hours apart.

        webhook : typing.Optional[WebhookDto]
            Optional webhook to receive notifications when jobs complete.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        CreateMonitorResponseDto
            Monitor created successfully

        Examples
        --------
        from newscatcher_catchall import CatchAllApi

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.create_monitor(
            reference_job_id="reference_job_id",
            schedule="every day at 12 PM UTC",
        )
        """
        _response = self._raw_client.create_monitor(
            reference_job_id=reference_job_id, schedule=schedule, webhook=webhook, request_options=request_options
        )
        return _response.data

    def update_monitor(
        self,
        monitor_id: str,
        *,
        webhook: typing.Optional[WebhookDto] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> UpdateMonitorResponseDto:
        """
        Update webhook configuration for an existing monitor without recreating it.

        **Supported updates:**
        - Webhook URL
        - HTTP method (POST/PUT)
        - Headers and authentication
        - Query parameters

        **Note:** Schedule and reference job cannot be modified. To change these, create a new monitor.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        webhook : typing.Optional[WebhookDto]
            Updated webhook configuration.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        UpdateMonitorResponseDto
            Monitor updated successfully

        Examples
        --------
        from newscatcher_catchall import CatchAllApi, WebhookDto

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.update_monitor(
            monitor_id="monitor_id",
            webhook=WebhookDto(
                url="https://new-endpoint.com/webhook",
                method="POST",
                headers={"Authorization": "Bearer new_token_xyz"},
            ),
        )
        """
        _response = self._raw_client.update_monitor(monitor_id, webhook=webhook, request_options=request_options)
        return _response.data

    def list_monitor_jobs(
        self,
        monitor_id: str,
        *,
        sort: typing.Optional[ListMonitorJobsRequestSort] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> ListMonitorJobsResponse:
        """
        Returns all jobs associated with a monitor, sorted by start_date.
        Each job includes job_id, start_date, and end_date.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        sort : typing.Optional[ListMonitorJobsRequestSort]
            Sort by start_date (asc or desc).

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        ListMonitorJobsResponse
            List of monitor jobs

        Examples
        --------
        from newscatcher_catchall import CatchAllApi

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.list_monitor_jobs(
            monitor_id="monitor_id",
        )
        """
        _response = self._raw_client.list_monitor_jobs(monitor_id, sort=sort, request_options=request_options)
        return _response.data

    def pull_monitor_results(
        self, monitor_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> PullMonitorResponseDto:
        """
        Retrieve aggregated results from all jobs executed by this monitor.
        Includes monitor configuration, execution history, and all records collected.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        PullMonitorResponseDto
            Monitor results retrieved successfully.

        Examples
        --------
        from newscatcher_catchall import CatchAllApi

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.pull_monitor_results(
            monitor_id="monitor_id",
        )
        """
        _response = self._raw_client.pull_monitor_results(monitor_id, request_options=request_options)
        return _response.data

    def disable_monitor(
        self, monitor_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> DisableMonitorResponse:
        """
        Disables a monitor to stop executing scheduled jobs.
        Validates that the provided API key is associated with the monitor.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        DisableMonitorResponse
            Monitor disabled successfully

        Examples
        --------
        from newscatcher_catchall import CatchAllApi

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.disable_monitor(
            monitor_id="monitor_id",
        )
        """
        _response = self._raw_client.disable_monitor(monitor_id, request_options=request_options)
        return _response.data

    def enable_monitor(
        self, monitor_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> EnableMonitorResponse:
        """
        Enables a monitor to resume executing scheduled jobs.
        Validates that the provided API key is associated with the monitor.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EnableMonitorResponse
            Monitor enabled successfully

        Examples
        --------
        from newscatcher_catchall import CatchAllApi

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.enable_monitor(
            monitor_id="monitor_id",
        )
        """
        _response = self._raw_client.enable_monitor(monitor_id, request_options=request_options)
        return _response.data

    def list_monitors(self, *, request_options: typing.Optional[RequestOptions] = None) -> ListMonitorsResponseDto:
        """
        Returns all monitors created by the authenticated user.

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        ListMonitorsResponseDto
            List of user monitors

        Examples
        --------
        from newscatcher_catchall import CatchAllApi

        client = CatchAllApi(
            api_key="YOUR_API_KEY",
        )
        client.monitors.list_monitors()
        """
        _response = self._raw_client.list_monitors(request_options=request_options)
        return _response.data


class AsyncMonitorsClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawMonitorsClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawMonitorsClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawMonitorsClient
        """
        return self._raw_client

    async def create_monitor(
        self,
        *,
        reference_job_id: str,
        schedule: str,
        webhook: typing.Optional[WebhookDto] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> CreateMonitorResponseDto:
        """
        Create a monitor that runs jobs based on a reference job with a specified schedule.

        **Schedule requirements:**
        - Minimum 24-hour interval between executions
        - Natural language format (e.g., "every day at 12 PM UTC", "every 48 hours")

        **Validation:**
        - Schedules below minimum frequency return error with descriptive message.
        - Invalid job IDs return 400 Bad Request.
        - Duplicate monitors (same job already monitored) return error.

        Parameters
        ----------
        reference_job_id : str
            Job ID to use as template for scheduled runs.

        schedule : str
            Natural language schedule (e.g. 'every day at 12 AM EST').

            **Minimum frequency:** Monitors must be scheduled at least 24 hours apart.

        webhook : typing.Optional[WebhookDto]
            Optional webhook to receive notifications when jobs complete.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        CreateMonitorResponseDto
            Monitor created successfully

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.create_monitor(
                reference_job_id="reference_job_id",
                schedule="every day at 12 PM UTC",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.create_monitor(
            reference_job_id=reference_job_id, schedule=schedule, webhook=webhook, request_options=request_options
        )
        return _response.data

    async def update_monitor(
        self,
        monitor_id: str,
        *,
        webhook: typing.Optional[WebhookDto] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> UpdateMonitorResponseDto:
        """
        Update webhook configuration for an existing monitor without recreating it.

        **Supported updates:**
        - Webhook URL
        - HTTP method (POST/PUT)
        - Headers and authentication
        - Query parameters

        **Note:** Schedule and reference job cannot be modified. To change these, create a new monitor.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        webhook : typing.Optional[WebhookDto]
            Updated webhook configuration.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        UpdateMonitorResponseDto
            Monitor updated successfully

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi, WebhookDto

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.update_monitor(
                monitor_id="monitor_id",
                webhook=WebhookDto(
                    url="https://new-endpoint.com/webhook",
                    method="POST",
                    headers={"Authorization": "Bearer new_token_xyz"},
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.update_monitor(monitor_id, webhook=webhook, request_options=request_options)
        return _response.data

    async def list_monitor_jobs(
        self,
        monitor_id: str,
        *,
        sort: typing.Optional[ListMonitorJobsRequestSort] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> ListMonitorJobsResponse:
        """
        Returns all jobs associated with a monitor, sorted by start_date.
        Each job includes job_id, start_date, and end_date.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        sort : typing.Optional[ListMonitorJobsRequestSort]
            Sort by start_date (asc or desc).

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        ListMonitorJobsResponse
            List of monitor jobs

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.list_monitor_jobs(
                monitor_id="monitor_id",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.list_monitor_jobs(monitor_id, sort=sort, request_options=request_options)
        return _response.data

    async def pull_monitor_results(
        self, monitor_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> PullMonitorResponseDto:
        """
        Retrieve aggregated results from all jobs executed by this monitor.
        Includes monitor configuration, execution history, and all records collected.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        PullMonitorResponseDto
            Monitor results retrieved successfully.

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.pull_monitor_results(
                monitor_id="monitor_id",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.pull_monitor_results(monitor_id, request_options=request_options)
        return _response.data

    async def disable_monitor(
        self, monitor_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> DisableMonitorResponse:
        """
        Disables a monitor to stop executing scheduled jobs.
        Validates that the provided API key is associated with the monitor.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        DisableMonitorResponse
            Monitor disabled successfully

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.disable_monitor(
                monitor_id="monitor_id",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.disable_monitor(monitor_id, request_options=request_options)
        return _response.data

    async def enable_monitor(
        self, monitor_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> EnableMonitorResponse:
        """
        Enables a monitor to resume executing scheduled jobs.
        Validates that the provided API key is associated with the monitor.

        Parameters
        ----------
        monitor_id : str
            Monitor identifier.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EnableMonitorResponse
            Monitor enabled successfully

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.enable_monitor(
                monitor_id="monitor_id",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.enable_monitor(monitor_id, request_options=request_options)
        return _response.data

    async def list_monitors(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> ListMonitorsResponseDto:
        """
        Returns all monitors created by the authenticated user.

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        ListMonitorsResponseDto
            List of user monitors

        Examples
        --------
        import asyncio

        from newscatcher_catchall import AsyncCatchAllApi

        client = AsyncCatchAllApi(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.monitors.list_monitors()


        asyncio.run(main())
        """
        _response = await self._raw_client.list_monitors(request_options=request_options)
        return _response.data
