# Example Compose Farm configuration
# Demonstrates a multi-host setup with NFS shared storage
#
# To test locally: Update the host addresses and run from the examples directory

compose_dir: /opt/stacks/compose-farm/examples

# Auto-regenerate Traefik file-provider config after up/down/update
traefik_file: /opt/stacks/compose-farm/examples/traefik/dynamic.d/compose-farm.yml
traefik_stack: traefik  # Skip Traefik's host in file-provider (docker provider handles it)

hosts:
  # Primary server - runs Traefik and most stacks
  # Full form with all options
  primary:
    address: 192.168.1.10
    user: deploy
    port: 22

  # Secondary server - runs some stacks for load distribution
  # Short form (user defaults to current user, port defaults to 22)
  secondary: 192.168.1.11

  # Local execution (no SSH) - for testing or when running on the host itself
  local: localhost

stacks:
  # Infrastructure (runs on primary where Traefik is)
  traefik: primary
  coredns: primary  # DNS for *.local resolution

  # Multi-host stacks (runs on ALL hosts)
  # AutoKuma monitors Docker containers on each host
  autokuma: all

  # Primary server stacks
  paperless-ngx: primary

  # Secondary server stacks (distributed for performance)
  mealie: secondary
  uptime-kuma: secondary
