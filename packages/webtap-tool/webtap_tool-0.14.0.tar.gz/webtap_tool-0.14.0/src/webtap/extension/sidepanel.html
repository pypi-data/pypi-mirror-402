<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="sidepanel.css" />
  </head>
  <body>
    <header class="header">
      <h1>WebTap</h1>
      <div id="status" class="header-status">
        <span class="status-dot"></span>
        <span class="status-text">Disconnected</span>
      </div>
      <button
        id="captureToggle"
        class="btn-sm"
        data-disabled="!connected"
      >
        Capture: Off
      </button>
      <button id="clear" class="btn-sm" title="Clear events">
        Clear Events
      </button>
      <button
        id="themeToggle"
        class="btn-sm"
        title="Toggle theme"
        aria-label="Toggle theme"
      ></button>
    </header>

    <!-- Notices Banner -->
    <div id="noticesBanner" class="notices-banner hidden"></div>

    <div id="errorBanner" class="error-banner">
      <div class="error-banner-header">
        <div class="error-banner-message" id="errorMessage"></div>
        <button
          class="icon-btn icon-btn--error"
          id="dismissError"
          title="Dismiss error"
          aria-label="Dismiss error"
        >
          âœ•
        </button>
      </div>
    </div>

    <!-- Tab Bar -->
    <nav class="tab-bar" role="tablist">
      <button
        class="tab-button active"
        data-tab="pages"
        role="tab"
        aria-selected="true"
      >
        Pages
      </button>
      <button
        class="tab-button"
        data-tab="network"
        role="tab"
        aria-selected="false"
      >
        Network
      </button>
      <button
        class="tab-button"
        data-tab="console"
        role="tab"
        aria-selected="false"
      >
        Console
      </button>
    </nav>

    <!-- Tab 1: Pages, Targets & Selection -->
    <main class="tab-content active" data-tab="pages" role="tabpanel">
      <section class="section">
        <div class="section-header flex-row">
          <span class="section-title">Available Pages</span>
          <button
            id="reloadPages"
            class="icon-btn"
            title="Reload pages"
            aria-label="Reload pages"
          ></button>
        </div>

        <div id="pageList" class="list-box"></div>
      </section>

      <!-- Targets Section (shown when connected) -->
      <section id="targetsSection" class="section hidden">
        <div class="section-header flex-row">
          <span class="section-title">Connected Targets</span>
          <span id="targetsCount" class="section-meta">0</span>
        </div>
        <div id="targetsList"></div>
      </section>

      <div class="divider"></div>

      <section class="section selection-section">
        <div class="section-header flex-row">
          <span class="section-title">Selections</span>
          <button
            id="clearSelections"
            class="btn-sm"
            data-show="browser.selections.length > 0"
          >
            Clear
          </button>
        </div>

        <div
          id="selectionList"
          data-show="browser.selections.length > 0"
        ></div>

        <div
          id="selectionHelp"
          class="help-text"
          data-show="browser.selections.length > 0"
        >
          Use <code>@webtap:webtap://selections</code> in prompts. Reference as
          #1, #2, etc.
        </div>
      </section>
    </main>

    <!-- Tab 2: Network & Filters -->
    <main class="tab-content" data-tab="network" role="tabpanel">
      <details class="filter-accordion" open>
        <summary class="section-header flex-row">
          <span class="section-title">Filters</span>
          <div class="filter-actions">
            <button
              id="enableAllFilters"
              class="btn-sm"
              title="Enable all filters"
            >
              All
            </button>
            <button
              id="disableAllFilters"
              class="btn-sm"
              title="Disable all filters"
            >
              None
            </button>
          </div>
          <span id="filterStats" class="section-meta">0/0</span>
        </summary>
        <div id="filterList"></div>
      </details>

      <div class="divider"></div>

      <section class="network-section">
        <div class="section-header flex-row">
          <span class="section-title">Network Requests</span>
          <span id="networkCount" class="section-meta">0 requests</span>
        </div>

        <div id="networkTable"></div>

        <div id="requestDetails" class="request-details hidden"></div>
      </section>
    </main>

    <!-- Tab 3: Console -->
    <main class="tab-content" data-tab="console" role="tabpanel">
      <section class="console-section">
        <div class="section-header flex-row">
          <span class="section-title">Console Messages</span>
          <span id="consoleCount" class="section-meta">0 messages</span>
        </div>

        <div id="consoleTable"></div>

        <div id="consoleDetails" class="console-details hidden"></div>
      </section>
    </main>

    <script type="module" src="main.js"></script>
  </body>
</html>
