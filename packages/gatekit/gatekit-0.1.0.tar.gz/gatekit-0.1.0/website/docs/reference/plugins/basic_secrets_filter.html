<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Basic Secrets Filter - Gatekit Documentation</title>
  <meta name="description" content="Detect and filter secrets, API keys, and tokens using pattern matching and entropy analysis.">
  <link rel="icon" type="image/png" href="../../../favicon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../../css/style.css">
  <script defer src="https://api.pirsch.io/pa.js" id="pianjs" data-code="GUYxLQ7LGQThWCqSrzrtg2qOOArCNKPS"></script>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a href="../../../" class="logo">Gate<span class="logo-kit">kit</span></a>
      <nav class="header-nav">
        <a href="../../../docs/getting-started.html">Get started</a>
        <a href="../../../docs/">Docs</a>
        <a href="https://github.com/gatekit-ai/gatekit">GitHub</a>
      </nav>
    </div>
  </header>

  <div class="docs-layout">
    <aside class="docs-sidebar">
      <nav class="docs-nav">
<div class="nav-section">
<h3>Getting Started</h3>
<ul>
<li><a href="/docs/getting-started.html">Quick Start</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Guides</h3>
<ul>
<li><a href="/docs/guides/managing-tools.html">Managing Tools</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Concepts</h3>
<ul>
<li><a href="/docs/concepts/configuration.html">Configuration</a></li>
<li><a href="/docs/concepts/routing.html">Routing Model</a></li>
<li><a href="/docs/concepts/security.html">Security Model</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Plugin Development</h3>
<ul>
<li><a href="/docs/plugins/development-guide.html">Plugin Guide</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Reference</h3>
<ul>
<li><a href="/docs/reference/plugins/">Built-in Plugins</a></li>
<li><a href="/docs/reference/known-issues.html">Known Issues</a></li>
</ul>
</div>
<div class="nav-section">
<h3>Decisions</h3>
<ul>
<li><a href="/decisions/">Architecture Decision Records</a></li>
</ul>
</div>
</nav>
    </aside>
    <main class="docs-content">
      <h1 id="basic-secrets-filter">Basic Secrets Filter</h1>
<p>Detect and filter secrets, API keys, and tokens using pattern matching and entropy analysis.</p>
<blockquote>
<p><strong>Warning:</strong> This plugin provides basic protection only and is NOT suitable for production use. Pattern-based detection can be bypassed with encoding, obfuscation, or novel formats. For production environments, use enterprise-grade secret detection solutions.</p>
</blockquote>
<h2 id="quick-reference">Quick Reference</h2>
<table>
<thead>
<tr>
  <th>Property</th>
  <th>Value</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Handler</td>
  <td><code>basic_secrets_filter</code></td>
</tr>
<tr>
  <td>Type</td>
  <td>Security</td>
</tr>
<tr>
  <td>Scope</td>
  <td>Global (can be configured globally or per-server)</td>
</tr>
</tbody>
</table>
<h2 id="detected-secret-types">Detected Secret Types</h2>
<table>
<thead>
<tr>
  <th>Type</th>
  <th>Description</th>
  <th>Enabled by Default</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>aws_access_keys</code></td>
  <td>AWS access key IDs (AKIA-prefixed)</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>github_tokens</code></td>
  <td>GitHub tokens (ghp_, gho_, ghu_, ghs_, ghr_ prefixes)</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>google_api_keys</code></td>
  <td>Google API keys (AIza-prefixed)</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>jwt_tokens</code></td>
  <td>JWT tokens (three-part base64url structure)</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>openai_api_keys</code></td>
  <td>OpenAI API keys (sk-, sk-proj-, sk-admin-)</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>slack_tokens</code></td>
  <td>Slack tokens (xoxb-, xoxp-, xoxa-, xoxr-, xoxs-)</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>ssh_private_keys</code></td>
  <td>SSH private key PEM headers</td>
  <td>Yes</td>
</tr>
<tr>
  <td><code>private_keys</code></td>
  <td>General PKCS#8 private key headers</td>
  <td><strong>No</strong> (high false positives)</td>
</tr>
</tbody>
</table>
<h2 id="configuration-reference">Configuration Reference</h2>
<h3 id="action">action</h3>
<p>What to do when a secret is detected.</p>
<table>
<thead>
<tr>
  <th>Value</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>block</code></td>
  <td>Reject the request/response entirely</td>
</tr>
<tr>
  <td><code>redact</code></td>
  <td>Replace secrets with <code>[SECRET REDACTED by Gatekit]</code></td>
</tr>
<tr>
  <td><code>audit_only</code></td>
  <td>Log detection but allow through unchanged</td>
</tr>
</tbody>
</table>
<p><strong>Default:</strong> <code>redact</code></p>
<h3 id="secret_types">secret_types</h3>
<p>Configure which secret types to detect. Each type has an <code>enabled</code> boolean.</p>
<p><strong>Default:</strong> All types enabled except <code>private_keys</code></p>
<h3 id="entropy_detection">entropy_detection</h3>
<p>Detect high-entropy strings that may be secrets even without matching known patterns.</p>
<table>
<thead>
<tr>
  <th>Option</th>
  <th>Type</th>
  <th>Default</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>enabled</code></td>
  <td>boolean</td>
  <td><code>false</code></td>
  <td>Enable entropy-based detection</td>
</tr>
<tr>
  <td><code>threshold</code></td>
  <td>number</td>
  <td><code>5.0</code></td>
  <td>Minimum Shannon entropy to flag (4.0-5.0, higher = fewer false positives)</td>
</tr>
<tr>
  <td><code>min_length</code></td>
  <td>integer</td>
  <td><code>20</code></td>
  <td>Minimum string length to analyze</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Warning: High False Positive Rate at Low Thresholds</strong></p>
<p>Entropy detection produces significant false positives at thresholds below 4.8. In testing:</p>
<ul>
<li>At 4.0: Blocks/redacts nearly all content including simple messages</li>
<li>At 4.5: Still catches legitimate request metadata and UUIDs</li>
<li>At 5.0 (default): Most conservative, fewest false positives</li>
</ul>
<p><strong>Recommendation:</strong> Start with the default threshold of 5.0 and only lower it if you need to catch more potential secrets and can tolerate the increased false positive rate. Consider using <code>action: audit_only</code> first to evaluate the impact before enabling blocking or redaction.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> Entropy detection is disabled by default due to false positives. When enabled, it can catch unknown secret formats but may flag legitimate high-entropy data like UUIDs or encoded file content.</p>
</blockquote>
<h3 id="scan_base64">scan_base64</h3>
<p>Decode and scan base64-encoded content for secrets.</p>
<p><strong>Default:</strong> <code>false</code></p>
<blockquote>
<p><strong>Note:</strong> Base64 content cannot be safely redacted (would corrupt data). When <code>scan_base64</code> is enabled and secrets are found in base64 content, the plugin forces blocking even if <code>action</code> is set to <code>redact</code>. Includes DoS protection: max 50 candidates, max 100KB total decoded.</p>
</blockquote>
<h2 id="yaml-configuration">YAML Configuration</h2>
<h3 id="minimal-configuration">Minimal Configuration</h3>
<pre><code class="language-yaml"><span class="nt">plugins</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">handler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">basic_secrets_filter</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre>
<h3 id="full-configuration">Full Configuration</h3>
<pre><code class="language-yaml"><span class="nt">plugins</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">handler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">basic_secrets_filter</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">              </span><span class="c1"># Run early in pipeline</span>
<span class="w">    </span><span class="nt">critical</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">            </span><span class="c1"># Block requests if plugin fails</span>

<span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redact</span><span class="w">            </span><span class="c1"># block | redact | audit_only</span>
<span class="w">    </span><span class="nt">scan_base64</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">        </span><span class="c1"># Decode and scan base64 content</span>

<span class="w">    </span><span class="nt">secret_types</span><span class="p">:</span>
<span class="w">      </span><span class="nt">aws_access_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">github_tokens</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">google_api_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">jwt_tokens</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">openai_api_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">slack_tokens</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">ssh_private_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">private_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">        </span><span class="c1"># Disabled due to high false positives</span>

<span class="w">    </span><span class="nt">entropy_detection</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">          </span><span class="c1"># Disabled by default</span>
<span class="w">      </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5.0</span><span class="w">          </span><span class="c1"># Higher = fewer false positives (range: 4.0-5.0)</span>
<span class="w">      </span><span class="nt">min_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">          </span><span class="c1"># Minimum string length to analyze</span>
</code></pre>
<h3 id="production-example-maximum-protection">Production Example (Maximum Protection)</h3>
<pre><code class="language-yaml"><span class="nt">plugins</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">handler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">basic_secrets_filter</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">block</span><span class="w">             </span><span class="c1"># Never allow secrets through</span>
<span class="w">    </span><span class="nt">scan_base64</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">         </span><span class="c1"># Also check encoded content</span>

<span class="w">    </span><span class="nt">secret_types</span><span class="p">:</span>
<span class="w">      </span><span class="nt">aws_access_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">github_tokens</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">openai_api_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">jwt_tokens</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">        </span><span class="c1"># JWTs are often legitimate in our API</span>
<span class="w">      </span><span class="nt">google_api_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">slack_tokens</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">ssh_private_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">private_keys</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">         </span><span class="c1"># Enable despite false positives for max security</span>

<span class="w">    </span><span class="nt">entropy_detection</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.5</span><span class="w">          </span><span class="c1"># More aggressive detection</span>
<span class="w">      </span><span class="nt">min_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
</code></pre>
<h2 id="limitations">Limitations</h2>
<p>This plugin will NOT detect:</p>
<ul>
<li><strong>Secrets in novel or proprietary formats</strong> - Only known patterns are detected</li>
<li><strong>Obfuscated secrets</strong> - ROT13, custom encoding, split across fields</li>
<li><strong>Context-dependent credentials</strong> - Passwords without structure</li>
<li><strong>AWS secret access keys</strong> - Removed due to high false positive rate on file paths</li>
<li><strong>High-entropy strings with special characters</strong> - Special chars fragment tokens below min_length threshold</li>
</ul>
<h2 id="redaction-format">Redaction Format</h2>
<p>When <code>action: redact</code>, detected secrets are replaced with:</p>
<pre><code class="language-text"><span class="k">[SECRET REDACTED by Gatekit]</span>
</code></pre>

    </main>
  </div>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-links">
        <a href="../../../docs/">Documentation</a>
        <a href="https://github.com/gatekit-ai/gatekit">GitHub</a>
        <a href="https://github.com/gatekit-ai/gatekit/issues">Issues</a>
        <a href="https://pypi.org/project/gatekit/">PyPI</a>
      </div>
      <p>Apache 2.0 License</p>
    </div>
  </footer>
</body>
</html>
