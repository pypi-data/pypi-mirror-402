[project]
name = "vpop-calibration"
version = "2.5.1"
description = ""
authors = [{ name = "Paul Lemarre", email = "paul.lemarre@novainsilico.ai" }]
readme = "README.md"
requires-python = ">=3.12,<4.0"
dependencies = [
    "torch",
    "gpytorch (>=1.14.2,<2.0.0)",
    "scipy (>=1.16.3,<2.0.0)",
    "uuid (>=1.30,<2.0)",
    "matplotlib (>=3.10.7,<4.0.0)",
    "plotly (>=6.4.0,<7.0.0)",
    "pandas (>=2.3.3,<3.0.0)",
    "numpy (>=2.3.4,<3.0.0)",
    "tqdm (>=4.67.1,<5.0.0)",
]

[tool.poetry.group.dev.dependencies]
torch = { url = "https://download.pytorch.org/whl/cpu/torch-2.9.0%2Bcpu-cp313-cp313-manylinux_2_28_x86_64.whl#sha256=6c9b217584400963d5b4daddb3711ec7a3778eab211e18654fba076cce3b8682" }
ipykernel = "^7.1.0"
jupyter = "^1.1.1"
ipython = "^9.7.0"
jupyterlab = "^4.4.10"
jupytext = "^1.18.1"
plotnine = "^0.15.1"
pytest = "^9.0.1"
pytest-cov = "^7.0.0"
nbmake = "^1.5.5"
pytest-env = "^1.2.0"
pytest-profiling = "^1.8.1"
pre-commit = "^4.5.0"
pytest-subtests = "^0.15.0"


[build-system]
requires = ["poetry-core>=2.0.0,<3.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.pytest]
minversion = "9.0"
addopts = [
    "-ra",
    "-q",
    "--cov=vpop_calibration",
    "--cov-report=markdown",
    "--nbmake",
    "--nbmake-timeout=100",
    "--profile",
    "--durations=5",
]
testpaths = ["vpop_calibration/test", "examples"]
filterwarnings = ["error", "ignore::UserWarning", "ignore::DeprecationWarning"]
env = ["IS_PYTEST_RUNNING=True", "CUDA_VISIBLE_DEVICES=", "MPLBACKEND=agg"]

[tool.coverage.run]
branch = true
omit = ["vpop_calibration/test/*", "examples"]

[tool.coverage.report]
# Regexes for lines to exclude from consideration
exclude_also = [
    # Don't complain about missing debug-only code:
    "def __repr__",
    "if self\\.debug",

    # Don't complain if tests don't hit defensive assertion code:
    "raise AssertionError",
    "raise NotImplementedError",

    # Don't complain if non-runnable code isn't run:
    "if 0:",
    "if __name__ == .__main__.:",

    # Don't complain about abstract methods, they aren't run:
    "@(abc\\.)?abstractmethod",
]
show_missing = true
ignore_errors = true
