<odoo>
    <record id="product_editorial_form_view" model="ir.ui.view">
        <field name="name">product.editorial.form.view</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
          <!-- DDAA Page -->
          <xpath expr="//page[@name='general_information']" position="after">
            <field name="show_ddaa_data" invisible="1" />
            <page string="DDAA" name="ddaa" invisible="show_ddaa_data == False">
              <field name="view_show_genera_ddaa_fields" invisible="1" />
              <field name="view_show_ddaa_fields" invisible="1" />
              <group>
                <group>
                  <field name="genera_ddaa"
                    optional="show" string="Genera derechos de autoría"
                    invisible="view_show_genera_ddaa_fields == False"
                  />
                  <field name="producto_referencia" widget="many2many_tags"
                    optional="show" string="Libro de referencia"
                    invisible="view_show_ddaa_fields == False"
                  />
                </group>  
                <group>
                  <field name="derecho_autoria"
                    optional="show" string="Referencia a derecho de autoría"
                    invisible="view_show_genera_ddaa_fields == False"
                  />
                </group>
                <field name="authorship_ids"
                    invisible="view_show_genera_ddaa_fields == False">
                  <tree editable="bottom">
                    <field name="product_id" column_invisible="1"/>
                    <field name="author_id" widget="many2one_avatar" string="Autoría/Receptoras de regalías" width="50%"/>
                    <field name="contact_type" string="Tipo de contacto" width="20%"/>
                    <field name="ddaa_percentage" string="Porcentaje" width="15%"/>
                    <field name="price" string="Importe" width="15%"/>
                    <button name="open_ddaa_conditions" icon="fa-cog" type="object" title="Configure DDAA" width="5%"/>
                  </tree>
                </field>
                  <field name="authorship_ddaa"
                    invisible="view_show_ddaa_fields == False">
                      <tree editable="bottom">
                        <field name="product_id" column_invisible="1"/>
                        <field name="author_id" widget="many2one_avatar" string="Autoría/Receptoras de regalías" width="50%"/>
                        <field name="contact_type" string="Tipo de contacto" width="20%"/>
                        <field name="ddaa_percentage" string="Porcentaje" width="15%"/>
                        <field name="price" string="Importe" width="15%"/>
                      </tree>
                </field>
                <div class="container-fluid w-100">
                    <button name="button_generate_ddaa_purchase_order" type="object"
                      string="Generar albaranes de autoría" class="oe_highlight" />
                </div>
              </group>
            </page>
          </xpath>
          <!-- End DDAA Page -->

          <!-- Page: Price for book related contacts -->
          <xpath expr="//group[@name='sale']" position="before">
            <group colspan="12" string="Precio de venta para contactos relacionados con el libro"
              name="page_price_contacts" invisible="view_show_genera_ddaa_fields == False">
              <field name="main_authorship_ids" string="">
                <tree editable="bottom">
                    <field name="product_id" column_invisible="1"/>
                    <field name="author_id" widget="many2one_avatar" string="Contacto" width="50%"/>
                    <field name="sales_price" string="Precio de venta (Sin IVA)" width="15%"/>
                </tree>
              </field>
            </group>
          </xpath>
          <!-- End Page: Price for book related contacts -->

          <xpath expr="//field[@name='detailed_type']" position="after">
            <field name="is_book" invisible="1"/>
            <field name="product_tags" widget="many2many_tags" string="Etiquetas"/>
            <field name="collections" widget="many2many_tags" invisible="is_book == False"/>
            <field name="page_count" invisible="is_book == False"/>
            <field name="total_copies" invisible="is_book == False"/>
          </xpath>
          <xpath expr="//group[@name='purchase']" position="before">
              <field name="limited_visibility_by_provider"/>
              <label for="limited_visibility_by_provider"/>
          </xpath>

          <xpath expr="//field[@name='product_tag_ids']" position="before">
            <field name="isbn_number" string="ISBN" invisible="is_book == False"/>
            <field name="legal_deposit_number"  invisible="is_book == False"/>
            <field name="test_book_number"  invisible="True"/>
          </xpath>

          <xpath expr="//group[@name='group_general']/parent::group" position="after">
              <group string="Contactos" invisible="view_show_genera_ddaa_fields == False">
                  <field name="authorship_ids" nolabel="1" colspan="2">
                      <tree editable="bottom">
                          <field name="author_id" widget="many2one_avatar" string="Nombre" width="60%"/>
                          <field name="contact_type" string="Tipo de contacto" width="35%"/>
                          <button name="action_open_contact" icon="fa-external-link" type="object" title="Open contact page" width="5%"/>
                      </tree>
                  </field>
              </group>
          </xpath>

        </field>
    </record>

    <!-- view used for product.template only -->
    <record model="ir.ui.view" id="editorial_product_template_form_view">
      <field name="name">product.template.editorial.form</field>
      <field name="model">product.template</field>
      <field name="inherit_id" ref="product.product_template_only_form_view"/>
      <field name="priority" eval="90"/>
      <field name="arch" type="xml">
        <xpath expr="//button[@name='open_pricelist_rules'][1]" position="before">
          <button
              invisible="type != 'product'" type="object"
              name="button_total_existences" 
              class="oe_stat_button" icon="fa-folder-open">
              
              <div class="o_field_widget o_stat_info">
                <span class="o_stat_value">
                  <field name="owned_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4" col="2"/>
                  <field name="uom_name"/>
                </span>
                <span class="o_stat_text">Existencias totales</span>
              </div>
          </button>
        </xpath>

        <xpath expr="//button[@name='button_total_existences'][1]" position="after">
          <button
              invisible="type != 'product'" type="object"
              name="button_in_stock"
              context="{'default_product_tmpl_id': id}"
              class="oe_stat_button" icon="fa-cubes">
              <div class="o_field_widget o_stat_info">
                <span class="o_stat_value" widget="statinfo">
                  <field name="on_hand_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4" col="2"/>
                  <field name="uom_name"/>
                </span>
                <span class="o_stat_text">En almacén</span>
              </div>
          </button>
        </xpath>

        <xpath expr="//button[@name='button_in_stock']" position="after">
          <button
              invisible="type != 'product'" type="object"
              name="button_in_distribution"
              context="{'default_product_tmpl_id': id}"
              class="oe_stat_button" icon="fa-building">
              <div class="o_field_widget o_stat_info">
                <span class="o_stat_value" widget="statinfo">
                  <field name="in_distribution_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4" col="2"/>
                  <field name="uom_name"/>
                </span>
                <span class="o_stat_text">En distribución</span>
              </div>
          </button>        
        </xpath>

        <xpath expr="//button[@name='button_in_distribution']" position="after">
          <button
              invisible="type != 'product'" type="object"
              name="button_purchases_deposit"
              context="{'default_product_id': id}"
              class="oe_stat_button" icon="fa-archive">
              <div class="o_field_widget o_stat_info">
                <span class="o_stat_value">
                  <field name="purchase_deposit_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4"/>
                  <field name="uom_name"/>
                </span>
                <span class="o_stat_text">Depósito compra</span>
              </div>
          </button>        
        </xpath>

        <xpath expr="//button[@name='button_purchases_deposit']" position="after">
          <button
              name="button_received" type="object"
              invisible="type != 'product'"
              context="{'default_product_id': id}"
              class="oe_stat_button" icon="fa-truck">
              <div class="o_field_widget o_stat_info">
                <span class="o_stat_value">
                  <field name="received_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4"/>
                  <field name="uom_name"/>
                </span>
                <span class="o_stat_text">Recibidos</span>
              </div>
          </button>        
        </xpath>

        <xpath expr="//button[@name='button_received']" position="after">
          <button
              name="button_liquidated_purchases"
              invisible="type != 'product'" type="object"
              context="{'default_product_id': id}"
              class="oe_stat_button" icon="fa-shopping-cart">
              <div class="o_field_widget o_stat_info">
                <span class="o_stat_value">
                  <field name="liquidated_purchases_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4"/>
                  <field name="uom_name"/>
                </span>
                <span class="o_stat_text">Compras liquidadas</span>
              </div>
          </button>        
        </xpath>

        <xpath expr="//button[@name='button_liquidated_purchases']" position="after">
          <button 
              name="button_liquidated_sales"
              invisible="type != 'product'" type="object"
              class="oe_stat_button" icon="fa-eur">
              <div class="o_field_widget o_stat_info">
                  <span class="o_stat_value">
                      <field name="liquidated_qty" widget="integer" digits="[12,0]" nolabel="1" class="mr4"/>
                      <field name="uom_name"/>
                  </span>
                  <span class="o_stat_text">Ventas liquidadas</span>
              </div>
            </button>
        </xpath>

        <!-- Hide cell "Vendidos" in product template view-->
        <xpath expr="//button[.//field[@name='sales_count']]" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <!-- Hide cell "Pronosticado", "Entrada" in product template view -->
        <xpath expr="//button[@name='action_view_stock_move_lines']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//button[@name='action_product_tmpl_forecast_report']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <!-- Hide cell "Stock real" in product template view -->
        <xpath expr="//button[@name='action_update_quantity_on_hand']" position="replace"/>    
        <xpath expr="//button[@name='action_update_quantity_on_hand']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>  

      </field>
    </record>

    <!--Remueve botón de comprados en vista product.template-->
    <record id="view_product_template_purchase_buttons_from_replace" model="ir.ui.view">
      <field name="name">product.template.purchase.button.inherit</field>
      <field name="model">product.template</field>
      <field name="inherit_id" ref="product.product_template_only_form_view"/>
      <field name="arch" type="xml">
        <xpath expr="//button[@name='action_view_po'][1]" position="replace">
        </xpath>
      </field>
    </record>

    <record id="editorial_product_template_tree_view" model="ir.ui.view">
        <field name="name">editorial.product.template.tree.view</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_tree_view"/>
        <field name="arch" type="xml">
          <xpath expr="//tree" position="attributes">
              <!-- <attribute name="decoration-danger">type == 'product' and owned_qty &lt; 0</attribute>
              <attribute name="decoration-info">type != 'product' or owned_qty &gt;= 0</attribute> -->
          </xpath>
          <xpath expr="//field[@name='default_code']" position="replace">
              <field name="default_code" invisible="1"/>
          </xpath> 
          <xpath expr="//field[@name='qty_available']" position="replace">
              <field name="owned_qty" invisible="type != 'product'" optional="show"/>
          </xpath>       
          <xpath expr="//field[@name='virtual_available'][1]" position="replace">
            <field name="virtual_available" invisible="1"/>
            <field name="on_hand_qty" invisible="type != 'product'" optional="show"/>
            <field name="in_distribution_qty" invisible="type != 'product'" optional="show"/>
          </xpath>
        </field>
    </record>

    <record model="ir.ui.view" id="editorial_product_template_kanban_stock_view">
        <field name="name">Editorial Product Template Kanban Stock</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_kanban_view"/>
        <field name="arch" type="xml">
            <xpath expr="//div[field[@name='qty_available']]" position="replace">
                <div t-if="record.show_on_hand_qty_status_button.raw_value">
                    En almacén: <field name="on_hand_qty" widget="integer"/> <field name="uom_id"/>
                </div>
            </xpath>

            <xpath expr="//div[hasclass('oe_kanban_details')]" position="inside">
                <div t-if="record.categ_id.value" class="pt-1">
                    <field name="categ_name" widget="badge"/>
                </div>
            </xpath>
        </field>
    </record>

    <record id="product_product_view_form_easy_inherit_stock_editorial" model="ir.ui.view">
        <field name="name">product.product.view.form.easy.inherit.stock.editorial</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="stock.product_product_view_form_easy_inherit_stock"/>
        <field name="arch" type="xml">
          <xpath expr="//button[@name='action_update_quantity_on_hand']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
        </field>
    </record>
    <record id="product_form_view_procurement_button_editorial" model="ir.ui.view">
        <field name="name">product.product.procurement.editorial</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="stock.product_form_view_procurement_button"/>
        <field name="arch" type="xml">
          <xpath expr="//button[@name='action_update_quantity_on_hand']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <!-- Hide Replenish button -->
          <xpath expr="//button[@name='%(stock.action_product_replenish)d']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
        </field>
    </record>
    <record id="product_template_form_view_procurement_button_editorial" model="ir.ui.view">
        <field name="name">product.template_procurement.editorial</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="stock.product_template_form_view_procurement_button"/>
        <field name="arch" type="xml">
          <xpath expr="//button[@name='action_update_quantity_on_hand']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <!-- Hide Replenish button -->
          <xpath expr="//button[@name='%(stock.action_product_replenish)d']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
        </field>
    </record>

    <record id="product_ddaa_editorial_form_view" model="ir.ui.view" >
        <field name="name">product.editorial.form.view</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_only_form_view"/>
        <field name="arch" type="xml">

            <!-- General Information -->
            <xpath expr="//page[@name='general_information']//label[@for='list_price']" position="attributes">
                <attribute name="invisible">view_show_ddaa_fields == True</attribute>
            </xpath>

            <xpath expr="//page[@name='general_information']//div[@name='pricing']" position="attributes">
                <attribute name="invisible">view_show_ddaa_fields == True</attribute>
            </xpath>
        </field>
    </record>

</odoo>
