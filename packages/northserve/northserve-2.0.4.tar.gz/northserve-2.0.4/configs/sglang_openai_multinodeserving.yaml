image: "harbor.local.clusters/bp/lmsysorg/sglang:v0.5.5.post3-cu129-amd64"
cmd:
  - OUTLINES_CACHE_DIR=/tmp/.outlines python3
  - -m
  - sglang.launch_server
  - --model-path='{{MODEL_PATH}}'
  - --trust-remote-code
  - --tensor-parallel-size={{ (GPUS_PER_POD | int) * (PODS_PER_JOB | int) }}
  - --served-model-name={{SERVED_MODEL_NAME}}
  - --nccl-init-addr="$MASTER_ADDR:6379"
  - --nnodes={{TOTAL_REPLICAS}}
  - --node-rank="$RANK"
  - --mem-fraction-static=0.80
  - --chunked-prefill-size=8192
  - --max-running-requests=128
  - --max-prefill-tokens=16384
  - --enable-metrics
  - --port 8000
  - --host 0.0.0.0
livenessPath: "/health"
readinessPath: "/health"
