Metadata-Version: 2.3
Name: napcat-sdk
Version: 0.3.1
Summary: NapCat SDK for Python - Fully typed and async ready
Keywords: napcat,sdk,api,async,typed
Author: å´å¤©ä¸€
Author-email: å´å¤©ä¸€ <faithleysath@gmail.com>
License: MIT License
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Programming Language :: Python :: 3.14
Classifier: Operating System :: OS Independent
Classifier: Typing :: Typed
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Communications :: Chat
Requires-Dist: orjson>=3.11.5
Requires-Dist: websockets>=15.0.1
Requires-Python: >=3.12
Project-URL: Homepage, https://github.com/faithleysath/napcat-sdk
Project-URL: Repository, https://github.com/faithleysath/napcat-sdk
Project-URL: Documentation, https://github.com/faithleysath/napcat-sdk/blob/main/README.md
Project-URL: Bug Tracker, https://github.com/faithleysath/napcat-sdk/issues
Description-Content-Type: text/markdown

<div align="center">
  <img src="https://raw.githubusercontent.com/faithleysath/napcat-sdk/refs/heads/main/docs/img/logo.png" width="250" height="200" alt="NapCat Logo">

  # NapCat-SDK for Python

  <p align="center">
    <b>Type-Safe</b> â€¢ <b>Async-Ready</b> â€¢ <b>Framework-Free</b>
  </p>

  <p>
    <a href="https://pypi.org/project/napcat-sdk/">
        <img src="https://img.shields.io/pypi/v/napcat-sdk?style=flat-square&color=006DAD&label=PyPI" alt="PyPI">
    </a>
    <a href="https://github.com/faithleysath/napcat-sdk/blob/main/LICENSE">
        <img src="https://img.shields.io/github/license/faithleysath/napcat-sdk?style=flat-square&color=blueviolet" alt="License">
    </a>
    <img src="https://img.shields.io/badge/Python-3.12+-FFE873?style=flat-square&logo=python&logoColor=black" alt="Python Version">
    <img src="https://img.shields.io/badge/Typing-Strict-22c55e?style=flat-square" alt="Typing">
  </p>

  <p>
    <a href="https://zread.ai/faithleysath/napcat-sdk" target="_blank"><img src="https://img.shields.io/badge/Ask_Zread-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff" alt="zread"/></a>
    <a href="https://deepwiki.com/faithleysath/napcat-sdk">
        <img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki">
    </a>
    <img src="https://img.shields.io/badge/QQ%E7%BE%A4-819085771-54a3ff?style=flat-square&logo=tencent-qq&logoColor=white" alt="QQ Group">
  </p>

  <h3>Stop guessing parameter types. Let the IDE do the work.</h3>
  <p>å‘Šåˆ«æŸ¥æ–‡æ¡£ï¼Œäº«å— <b>100% ç±»å‹è¦†ç›–</b> å¸¦æ¥çš„æè‡´è¡¥å…¨ä½“éªŒã€‚</p>
</div>

---

## âš¡ The "IDE Magic"

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åº”è¯¥é€‰æ‹© NapCat-SDKï¼š

| **æ™ºèƒ½ API è¡¥å…¨ + ç²¾å‡†å‚æ•°æç¤º** | **åŸç”Ÿå¼€å‘ä½“éªŒ + é›¶å¿ƒæ™ºè´Ÿæ‹…** |
| :---: | :---: |
| ![API Completion](https://raw.githubusercontent.com/faithleysath/napcat-sdk/refs/heads/main/docs/img/api-completion.gif) | ![Native Dev](https://raw.githubusercontent.com/faithleysath/napcat-sdk/refs/heads/main/docs/img/native-dev.gif) |

> ğŸ‘† çœŸæ­£çš„ **140+ API** å…¨é‡ç±»å‹è¦†ç›–ï¼Œæ¯ä¸€æ¬¡æŒ‰é”®éƒ½æœ‰ IDE çš„å®ˆæŠ¤ã€‚

---

## âœ¨ Features

- ğŸ”„ **åè®®è‡ªåŠ¨åŒæ­¥**: åŸºäº OpenAPI è‡ªåŠ¨æ„å»ºï¼Œä¸ NapCat ä¸Šæ¸¸å®šä¹‰é›¶æ—¶å·®åŒæ­¥ã€‚
- ğŸ§˜ **åŸç”Ÿæ— æ¡†æ¶**: æ‹’ç»æ¡†æ¶â€œé»‘é­”æ³•â€ï¼Œçº¯ç²¹ Python è¯­æ³•ï¼Œé›¶å¿ƒæ™ºè´Ÿæ‹…ã€‚
- ğŸ’ **æè‡´ç±»å‹**: 100% ç±»å‹è¦†ç›–ï¼Œæ¯ä¸€ä¸ªå‚æ•°éƒ½æœ‰å®šä¹‰ï¼Œäº«å—æè‡´ IDE è¡¥å…¨ã€‚
- âš¡ **å®Œå…¨å¼‚æ­¥**: åŸºäº `websockets` + `asyncio` åŸç”Ÿå¼€å‘ï¼Œæ— æƒ§é«˜å¹¶å‘ã€‚
- ğŸ”Œ **åŒæ¨¡æ”¯æŒ**: å®Œç¾æ”¯æŒæ­£å‘ (Client) ä¸åå‘ (Server) WebSocket è¿æ¥ã€‚
- ğŸ“¦ **æè½»é‡çº§**: ä»…ä¾èµ– `websockets` å’Œ `orjson`ï¼Œæé€Ÿå®‰è£…ï¼Œæ‹’ç»è‡ƒè‚¿ã€‚

---

## ğŸ“¦ Installation

```bash
uv add napcat-sdk
# or
pip install napcat-sdk
```

---

## ğŸ“¸ Quick Look

<div align="center"> <img src="https://raw.githubusercontent.com/faithleysath/napcat-sdk/refs/heads/main/docs/img/code-snapshot.png" alt="Code Example" width="800"> </div>

<details> <summary><b>ğŸ–±ï¸ ç‚¹å‡»å¤åˆ¶ä»£ç æ–‡æœ¬</b></summary>

```python
import asyncio
from napcat import NapCatClient, GroupMessageEvent, PrivateMessageEvent

async def listen_private(client: NapCatClient):
    print(">> ç§èŠç›‘å¬å¯åŠ¨")
    async for event in client.events():
        match event:
            case PrivateMessageEvent():
                print(f"[ç§ä¿¡] {event.sender.nickname}: {event.raw_message}")
                await event.send_msg("å·²é˜…")
            case _:
                pass

async def listen_group(client: NapCatClient):
    print(">> ç¾¤èŠç›‘å¬å¯åŠ¨")
    async for event in client.events():
        match event:
            case GroupMessageEvent():
                print(f"[ç¾¤æ¶ˆæ¯] {event.group_id}: {event.raw_message}")
                await event.reply("å¤è¯»")
            case _:
                pass

async def main():
    # æ­£å‘ WebSocket è¿æ¥
    async with NapCatClient(ws_url="ws://localhost:3001", token="123") as client:
        await asyncio.gather(
            listen_private(client),
            listen_group(client)
        )

if __name__ == "__main__":
    asyncio.run(main())
```

</details>

---

## ğŸ“– Usage

<details> <summary><b>ğŸ”Œ åå‘ WebSocket æœåŠ¡ç«¯ (Server Mode)</b></summary>

å¦‚æœä½ é…ç½® NapCat ä¸»åŠ¨è¿æ¥ä½ çš„ç¨‹åºï¼Œè¯·ä½¿ç”¨ `ReverseWebSocketServer`ã€‚

```python
import asyncio
from napcat import ReverseWebSocketServer, NapCatClient, GroupMessageEvent

async def handler(client: NapCatClient):
    """æ¯ä¸ªæ–°çš„ WebSocket è¿æ¥éƒ½ä¼šè§¦å‘æ­¤å›è°ƒ"""
    print(f"Bot Connected! Self ID: {client.self_id}")
    
    # å°±åƒ Client æ¨¡å¼ä¸€æ ·å¤„ç†äº‹ä»¶
    async for event in client.events():
        if isinstance(event, GroupMessageEvent):
            print(f"æ”¶åˆ°ç¾¤ {event.group_id} æ¶ˆæ¯: {event.raw_message}")
            await event.reply("æœåŠ¡ç«¯å·²æ”¶åˆ°")

async def main():
    # å¯åŠ¨æœåŠ¡å™¨ç›‘å¬ 8080 ç«¯å£
    server = ReverseWebSocketServer(handler, host="0.0.0.0", port=8080, token="my-token")
    await server.run_forever()

if __name__ == "__main__":
    asyncio.run(main())
```

</details>

<details> <summary><b>ğŸ–¼ï¸ å‘é€å¯Œåª’ä½“æ¶ˆæ¯ (å›¾ç‰‡/At/å›å¤)</b></summary>

SDK æä¾›äº†å¼ºç±»å‹çš„ `MessageSegment`ï¼Œå‘Šåˆ«æ‰‹åŠ¨æ‹¼æ¥ CQ ç ã€‚

```python
from napcat import (
    NapCatClient, 
    TextMessageSegment, 
    ImageMessageSegment, 
    AtMessageSegment
)

async def send_rich_media(client: NapCatClient, group_id: int):
    # æ„å»ºæ¶ˆæ¯é“¾ï¼š@æŸäºº + æ–‡æœ¬ + å›¾ç‰‡
    message = [
        AtMessageSegment(qq=12345678),
        TextMessageSegment(text=" æ¥çœ‹è¿™å¼ å›¾ï¼š"),
        ImageMessageSegment(file="[https://example.com/image.jpg](https://example.com/image.jpg)")
    ]
    
    # ç›´æ¥å‘é€åˆ—è¡¨
    await client.send_group_msg(group_id=group_id, message=message)
```

</details>

<details> <summary><b>ğŸ”— è°ƒç”¨ OneBot API (100% ç±»å‹æç¤º)</b></summary>

æ‰€æœ‰ API éƒ½æŒ‚è½½åœ¨ `client.api` ä¸‹ï¼Œæ‹¥æœ‰å®Œæ•´çš„å‚æ•°ç±»å‹æ£€æŸ¥ã€‚

```python
async def managing_bot(client: NapCatClient):
    # è·å–ç™»å½•å·ä¿¡æ¯
    login_info = await client.api.get_login_info()
    print(f"å½“å‰ç™»å½•: {login_info['nickname']}")

    # è·å–ç¾¤æˆå‘˜åˆ—è¡¨
    members = await client.api.get_group_member_list(
        group_id=123456, 
        no_cache=True
    )
    for member in members:
        print(f"æˆå‘˜: {member['card'] or member['nickname']}")
    
    # åŠ¨æ€è°ƒç”¨ï¼ˆé’ˆå¯¹æœªæ”¶å½•çš„ APIï¼‰
    await client.call_action("some_new_action", {"param": 1})
```

</details>

---

## ğŸ› ï¸ Development

æœ¬é¡¹ç›®ä½¿ç”¨ [uv](https://github.com/astral-sh/uv) è¿›è¡ŒåŒ…ç®¡ç†ã€‚

1. **å…‹éš†é¡¹ç›®å¹¶åŒæ­¥ç¯å¢ƒ**:
```
git clone https://github.com/faithleysath/napcat-sdk.git
cd napcat-sdk
uv sync
```

2. **åŒæ­¥åè®®å®šä¹‰**: SDK çš„æ ¸å¿ƒä»£ç ç”± OpenAPI è§„èŒƒè‡ªåŠ¨ç”Ÿæˆã€‚å¦‚æœä½ æ›´æ–°äº† `schema.openapi.json`ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°ç”Ÿæˆä»£ç ï¼š
```
uv run scripts/generate_schema.py
```
*è¿™ä¼šè‡ªåŠ¨æ›´æ–° `src/napcat/types/schemas.py` å’Œ `src/napcat/client_api.py`ã€‚*

3. **è¿è¡Œæµ‹è¯•**:
```
uv run tests/smoke_test.py
```

---

## ğŸ“„ License

MIT License Â© 2025 [faithleysath](https://github.com/faithleysath)

<a href="https://star-history.com/#faithleysath/napcat-sdk&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=faithleysath/napcat-sdk&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=faithleysath/napcat-sdk&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=faithleysath/napcat-sdk&type=Date" />
 </picture>
</a>