<?xml version="1.0" encoding="utf-8" ?>
<!-- Copyright 2024 Camptocamp SA
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->
<odoo>

  <record id="odoo_project_view_form" model="ir.ui.view">
    <field name="name">odoo.project.form.inherit</field>
    <field name="model">odoo.project</field>
    <field name="inherit_id" ref="odoo_project.odoo_project_view_form" />
    <field name="arch" type="xml">
      <notebook position="inside">
        <page string="Changelog" name="changelog">
          <div
                        class="align-items-center"
                        colspan="2"
                        attrs="{'invisible': [('changelog_enabled_repository_ids', '=', [])]}"
                    >
            <field name="changelog_state" invisible="1" />
            <button
                            name="action_generate_changelog"
                            type="object"
                            string="Generate CHANGELOG"
                            icon="fa-gear"
                            class="btn-primary"
                            attrs="{'invisible': [('changelog_state', '=', 'in_progress')]}"
                        />
            <span
                            class="fa fa-arrow-right ml8 mr8"
                            title="Arrow Right"
                            attrs="{'invisible': [('changelog_state', '!=', 'done')]}"
                        />
            <button
                            name="exists"
                            type="object"
                            string="Refresh"
                            icon="fa-refresh"
                            attrs="{'invisible': [('changelog_state', '!=', 'in_progress')]}"
                        />
            <button
                            name="action_open_changelog"
                            type="object"
                            string="Open CHANGELOG"
                            icon="fa-book"
                            class="btn-primary"
                            attrs="{'invisible': [('changelog_state', '!=', 'done')]}"
                        />
          </div>
          <group name="repositories" string="Repositories">
            <field name="used_repository_ids" nolabel="1" colspan="2">
              <tree editable="bottom">
                <field
                                    name="repository_branch_id"
                                    domain="[('branch_id', '=', parent.odoo_version_id)]"
                                />
                <field name="deployed_commit" required="1" />
                <field name="target_commit" string="To compare with" />
                <field name="active" />
              </tree>
            </field>
            <field name="changelog_enabled_repository_ids" invisible="1" />
          </group>
        </page>
      </notebook>
    </field>
  </record>

</odoo>
