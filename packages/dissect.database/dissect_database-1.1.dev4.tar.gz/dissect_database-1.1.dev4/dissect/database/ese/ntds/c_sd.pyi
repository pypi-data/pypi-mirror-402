# Generated by cstruct-stubgen
from typing import BinaryIO, TypeAlias, overload

import dissect.cstruct as __cs__

class _c_sd(__cs__.cstruct):
    class SECURITY_DESCRIPTOR_CONTROL(__cs__.Flag):
        SE_OWNER_DEFAULTED = ...
        SE_GROUP_DEFAULTED = ...
        SE_DACL_PRESENT = ...
        SE_DACL_DEFAULTED = ...
        SE_SACL_PRESENT = ...
        SE_SACL_DEFAULTED = ...
        SE_DACL_AUTO_INHERIT_REQ = ...
        SE_SACL_AUTO_INHERIT_REQ = ...
        SE_DACL_AUTO_INHERITED = ...
        SE_SACL_AUTO_INHERITED = ...
        SE_DACL_PROTECTED = ...
        SE_SACL_PROTECTED = ...
        SE_RM_CONTROL_VALID = ...
        SE_SELF_RELATIVE = ...

    class ACCESS_MASK(__cs__.Flag):
        ADS_RIGHT_DS_CREATE_CHILD = ...
        ADS_RIGHT_DS_DELETE_CHILD = ...
        ADS_RIGHT_DS_SELF = ...
        ADS_RIGHT_DS_READ_PROP = ...
        ADS_RIGHT_DS_WRITE_PROP = ...
        ADS_RIGHT_DS_CONTROL_ACCESS = ...
        DELETE = ...
        READ_CONTROL = ...
        WRITE_DACL = ...
        WRITE_OWNER = ...
        SYNCHRONIZE = ...
        ACCESS_SYSTEM_SECURITY = ...
        MAXIMUM_ALLOWED = ...
        GENERIC_ALL = ...
        GENERIC_EXECUTE = ...
        GENERIC_WRITE = ...
        GENERIC_READ = ...

    class ACE_TYPE(__cs__.Enum):
        ACCESS_ALLOWED = ...
        ACCESS_DENIED = ...
        SYSTEM_AUDIT = ...
        SYSTEM_ALARM = ...
        ACCESS_ALLOWED_COMPOUND = ...
        ACCESS_ALLOWED_OBJECT = ...
        ACCESS_DENIED_OBJECT = ...
        SYSTEM_AUDIT_OBJECT = ...
        SYSTEM_ALARM_OBJECT = ...
        ACCESS_ALLOWED_CALLBACK = ...
        ACCESS_DENIED_CALLBACK = ...
        ACCESS_ALLOWED_CALLBACK_OBJECT = ...
        ACCESS_DENIED_CALLBACK_OBJECT = ...
        SYSTEM_AUDIT_CALLBACK = ...
        SYSTEM_ALARM_CALLBACK = ...
        SYSTEM_AUDIT_CALLBACK_OBJECT = ...
        SYSTEM_ALARM_CALLBACK_OBJECT = ...
        SYSTEM_MANDATORY_LABEL = ...
        SYSTEM_RESOURCE_ATTRIBUTE = ...
        SYSTEM_SCOPED_POLICY_ID = ...
        SYSTEM_PROCESS_TRUST_LABEL = ...
        SYSTEM_ACCESS_FILTER = ...

    class ACE_FLAGS(__cs__.Flag):
        OBJECT_INHERIT_ACE = ...
        CONTAINER_INHERIT_ACE = ...
        NO_PROPAGATE_INHERIT_ACE = ...
        INHERIT_ONLY_ACE = ...
        INHERITED_ACE = ...
        SUCCESSFUL_ACCESS_ACE_FLAG = ...
        FAILED_ACCESS_ACE_FLAG = ...

    class ACE_OBJECT_FLAGS(__cs__.Flag):
        ACE_OBJECT_TYPE_PRESENT = ...
        ACE_INHERITED_OBJECT_TYPE_PRESENT = ...

    class COMPOUND_ACE_TYPE(__cs__.Enum):
        COMPOUND_ACE_IMPERSONATION = ...

    class _ACL(__cs__.Structure):
        AclRevision: _c_sd.uint8
        Sbz1: _c_sd.uint8
        AclSize: _c_sd.uint16
        AceCount: _c_sd.uint16
        Sbz2: _c_sd.uint16
        @overload
        def __init__(
            self,
            AclRevision: _c_sd.uint8 | None = ...,
            Sbz1: _c_sd.uint8 | None = ...,
            AclSize: _c_sd.uint16 | None = ...,
            AceCount: _c_sd.uint16 | None = ...,
            Sbz2: _c_sd.uint16 | None = ...,
        ): ...
        @overload
        def __init__(self, fh: bytes | memoryview | bytearray | BinaryIO, /): ...

    ACL: TypeAlias = _ACL
    class _ACE_HEADER(__cs__.Structure):
        AceType: _c_sd.ACE_TYPE
        AceFlags: _c_sd.ACE_FLAGS
        AceSize: _c_sd.uint16
        @overload
        def __init__(
            self,
            AceType: _c_sd.ACE_TYPE | None = ...,
            AceFlags: _c_sd.ACE_FLAGS | None = ...,
            AceSize: _c_sd.uint16 | None = ...,
        ): ...
        @overload
        def __init__(self, fh: bytes | memoryview | bytearray | BinaryIO, /): ...

    ACE_HEADER: TypeAlias = _ACE_HEADER
    class _SECURITY_DESCRIPTOR_HEADER(__cs__.Structure):
        HashId: _c_sd.uint32
        SecurityId: _c_sd.uint32
        Offset: _c_sd.uint64
        Length: _c_sd.uint32
        @overload
        def __init__(
            self,
            HashId: _c_sd.uint32 | None = ...,
            SecurityId: _c_sd.uint32 | None = ...,
            Offset: _c_sd.uint64 | None = ...,
            Length: _c_sd.uint32 | None = ...,
        ): ...
        @overload
        def __init__(self, fh: bytes | memoryview | bytearray | BinaryIO, /): ...

    SECURITY_DESCRIPTOR_HEADER: TypeAlias = _SECURITY_DESCRIPTOR_HEADER
    class _SECURITY_DESCRIPTOR_RELATIVE(__cs__.Structure):
        Revision: _c_sd.uint8
        Sbz1: _c_sd.uint8
        Control: _c_sd.SECURITY_DESCRIPTOR_CONTROL
        Owner: _c_sd.uint32
        Group: _c_sd.uint32
        Sacl: _c_sd.uint32
        Dacl: _c_sd.uint32
        @overload
        def __init__(
            self,
            Revision: _c_sd.uint8 | None = ...,
            Sbz1: _c_sd.uint8 | None = ...,
            Control: _c_sd.SECURITY_DESCRIPTOR_CONTROL | None = ...,
            Owner: _c_sd.uint32 | None = ...,
            Group: _c_sd.uint32 | None = ...,
            Sacl: _c_sd.uint32 | None = ...,
            Dacl: _c_sd.uint32 | None = ...,
        ): ...
        @overload
        def __init__(self, fh: bytes | memoryview | bytearray | BinaryIO, /): ...

    SECURITY_DESCRIPTOR_RELATIVE: TypeAlias = _SECURITY_DESCRIPTOR_RELATIVE

# Technically `c_sd` is an instance of `_c_sd`, but then we can't use it in type hints
c_sd: TypeAlias = _c_sd
