var ke=Object.defineProperty;var r=(d,u)=>ke(d,"name",{value:u,configurable:!0});import{bx as F,cM as X,cN as L,r as O,o as Q,cd as Y,h as W,c as x,d as o,l as C,j as y,k as D,e as n,s as G,z as _,by as e,v as H,E as T,q as $,F as ee,y as oe,A as ne,u as K,I as z,T as ye,bg as P}from"./vendor-other-PcOcwbNM.js";import{j as ie}from"./vendor-primevue-6nO4LMK3.js";import{_ as S,e as Z,t as A,c as q,d as se,cG as xe,u as we,cH as he,cI as Me,r as Ce,cJ as $e,cK as De}from"./index-Btwre5kD.js";const Re={class:"relative show-slider"},Ie={class:"absolute top-0 left-12 rounded-lg bg-interface-menu-surface p-4 shadow-lg w-[150px]"},re=F({__name:"PopupSlider",props:X({icon:{default:"pi-expand"},tooltipText:{},min:{default:10},max:{default:150},step:{default:1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(d){const u=L(d,"modelValue"),l=O(!1),t=r(()=>{l.value=!l.value},"toggleSlider"),i=r(a=>{a.target.closest(".show-slider")||(l.value=!1)},"closeSlider");return Q(()=>{document.addEventListener("click",i)}),Y(()=>{document.removeEventListener("click",i)}),(a,p)=>{const b=W("tooltip");return o(),x("div",Re,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":a.tooltipText,onClick:t},{default:D(()=>[n("i",{class:G(["pi",a.icon,"text-lg text-base-foreground"])},null,2)]),_:1},8,["aria-label"])),[[b,{value:a.tooltipText,showDelay:300},void 0,{right:!0}]]),C(n("div",Ie,[_(e(ie),{modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=v=>u.value=v),class:"w-full",min:a.min,max:a.max,step:a.step},null,8,["modelValue","min","max","step"])],512),[[H,l.value]])])}}}),Se={class:"flex flex-col"},Le=F({__name:"CameraControls",props:{cameraType:{},cameraTypeModifiers:{},fov:{},fovModifiers:{}},emits:["update:cameraType","update:fov"],setup(d){const u=L(d,"cameraType"),l=L(d,"fov"),t=T(()=>u.value==="perspective"),i=r(()=>{u.value=u.value==="perspective"?"orthographic":"perspective"},"switchCamera");return(a,p)=>{const b=W("tooltip");return o(),x("div",Se,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":a.$t("load3d.switchCamera"),onClick:i},{default:D(()=>p[1]||(p[1]=[n("i",{class:G(["pi","pi-camera","text-lg text-base-foreground"])},null,-1)])),_:1},8,["aria-label"])),[[b,{value:a.$t("load3d.switchCamera"),showDelay:300},void 0,{right:!0}]]),t.value?(o(),y(re,{key:0,modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=v=>l.value=v),"tooltip-text":a.$t("load3d.fov")},null,8,["modelValue","tooltip-text"])):$("",!0)])}}}),Be={class:"flex flex-col"},Ue={class:"show-export-formats relative"},ze={class:"absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg"},Ee={class:"flex flex-col"},Pe=F({__name:"ExportControls",emits:["exportModel"],setup(d,{emit:u}){const l=u,t=O(!1),i=[{label:"GLB",value:"glb"},{label:"OBJ",value:"obj"},{label:"STL",value:"stl"}];function a(){t.value=!t.value}r(a,"toggleExportFormats");function p(v){l("exportModel",v),t.value=!1}r(p,"exportModel");function b(v){v.target.closest(".show-export-formats")||(t.value=!1)}return r(b,"closeExportFormatsList"),Q(()=>{document.addEventListener("click",b)}),Y(()=>{document.removeEventListener("click",b)}),(v,s)=>{const f=W("tooltip");return o(),x("div",Be,[n("div",Ue,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":v.$t("load3d.exportModel"),onClick:a},{default:D(()=>s[0]||(s[0]=[n("i",{class:"pi pi-download text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[f,{value:v.$t("load3d.exportModel"),showDelay:300},void 0,{right:!0}]]),C(n("div",ze,[n("div",Ee,[(o(),x(ee,null,oe(i,w=>_(S,{key:w.value,variant:"textonly",class:"text-base-foreground",onClick:r(E=>p(w.value),"onClick")},{default:D(()=>[ne(K(w.label),1)]),_:2},1032,["onClick"])),64))])],512),[[H,t.value]])])])}}}),Ve={class:"flex flex-col"},Te={key:0,class:"show-light-intensity relative"},Ge={class:"absolute top-0 left-12 rounded-lg bg-black/50 p-4 shadow-lg",style:{width:"150px"}},Fe=F({__name:"LightControls",props:{lightIntensity:{},lightIntensityModifiers:{},materialMode:{},materialModeModifiers:{}},emits:["update:lightIntensity","update:materialMode"],setup(d){const u=L(d,"lightIntensity"),l=L(d,"materialMode"),t=T(()=>l.value==="original"),i=O(!1),a=Z().get("Comfy.Load3D.LightIntensityMaximum"),p=Z().get("Comfy.Load3D.LightIntensityMinimum"),b=Z().get("Comfy.Load3D.LightAdjustmentIncrement");function v(){i.value=!i.value}r(v,"toggleLightIntensity");function s(f){f.target.closest(".show-light-intensity")||(i.value=!1)}return r(s,"closeLightSlider"),Q(()=>{document.addEventListener("click",s)}),Y(()=>{document.removeEventListener("click",s)}),(f,w)=>{const E=W("tooltip");return o(),x("div",Ve,[t.value?(o(),x("div",Te,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":f.$t("load3d.lightIntensity"),onClick:v},{default:D(()=>w[1]||(w[1]=[n("i",{class:"pi pi-sun text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[E,{value:f.$t("load3d.lightIntensity"),showDelay:300},void 0,{right:!0}]]),C(n("div",Ge,[_(e(ie),{modelValue:u.value,"onUpdate:modelValue":w[0]||(w[0]=V=>u.value=V),class:"w-full",min:e(p),max:e(a),step:e(b)},null,8,["modelValue","min","max","step"])],512),[[H,i.value]])])):$("",!0)])}}}),je={class:"flex flex-col"},Ne={class:"show-up-direction relative"},Oe={class:"absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg"},Ae={class:"flex flex-col"},_e={key:0,class:"show-material-mode relative"},Je={class:"absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg"},We={class:"flex flex-col"},qe={key:1},He=F({__name:"ModelControls",props:X({hideMaterialMode:{type:Boolean,default:!1},isPlyModel:{type:Boolean,default:!1},hasSkeleton:{type:Boolean,default:!1}},{materialMode:{},materialModeModifiers:{},upDirection:{},upDirectionModifiers:{},showSkeleton:{type:Boolean},showSkeletonModifiers:{}}),emits:["update:materialMode","update:upDirection","update:showSkeleton"],setup(d){const u=L(d,"materialMode"),l=L(d,"upDirection"),t=L(d,"showSkeleton"),i=O(!1),a=O(!1),p=["original","-x","+x","-y","+y","-z","+z"],b=T(()=>{const R=["original","normal","wireframe"];return d.isPlyModel&&R.splice(1,0,"pointCloud"),R});function v(){i.value=!i.value,a.value=!1}r(v,"toggleUpDirection");function s(R){l.value=R,i.value=!1}r(s,"selectUpDirection");function f(){a.value=!a.value,i.value=!1}r(f,"toggleMaterialMode");function w(R){u.value=R,a.value=!1}r(w,"selectMaterialMode");function E(R){return A(`load3d.materialModes.${R}`)}r(E,"formatMaterialMode");function V(R){const I=R.target;I.closest(".show-up-direction")||(i.value=!1),I.closest(".show-material-mode")||(a.value=!1)}return r(V,"closeSceneSlider"),Q(()=>{document.addEventListener("click",V)}),Y(()=>{document.removeEventListener("click",V)}),(R,I)=>{const j=W("tooltip");return o(),x("div",je,[n("div",Ne,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":e(A)("load3d.upDirection"),onClick:v},{default:D(()=>I[1]||(I[1]=[n("i",{class:"pi pi-arrow-up text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[j,{value:e(A)("load3d.upDirection"),showDelay:300},void 0,{right:!0}]]),C(n("div",Oe,[n("div",Ae,[(o(),x(ee,null,oe(p,B=>_(S,{key:B,variant:"textonly",class:G(e(q)("text-base-foreground",l.value===B&&"bg-blue-500")),onClick:r(h=>s(B),"onClick")},{default:D(()=>[ne(K(B.toUpperCase()),1)]),_:2},1032,["class","onClick"])),64))])],512),[[H,i.value]])]),R.hideMaterialMode?$("",!0):(o(),x("div",_e,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":e(A)("load3d.materialMode"),onClick:f},{default:D(()=>I[2]||(I[2]=[n("i",{class:"pi pi-box text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[j,{value:e(A)("load3d.materialMode"),showDelay:300},void 0,{right:!0}]]),C(n("div",Je,[n("div",We,[(o(!0),x(ee,null,oe(b.value,B=>(o(),y(S,{key:B,variant:"textonly",class:G(e(q)("whitespace-nowrap text-base-foreground",u.value===B&&"bg-blue-500")),onClick:r(h=>w(B),"onClick")},{default:D(()=>[ne(K(E(B)),1)]),_:2},1032,["class","onClick"]))),128))])],512),[[H,a.value]])])),R.hasSkeleton?(o(),x("div",qe,[C((o(),y(S,{size:"icon",variant:"textonly",class:G(e(q)("rounded-full",t.value&&"bg-blue-500")),"aria-label":e(A)("load3d.showSkeleton"),onClick:I[0]||(I[0]=B=>t.value=!t.value)},{default:D(()=>I[3]||(I[3]=[n("i",{class:"pi pi-sitemap text-lg text-base-foreground"},null,-1)])),_:1},8,["class","aria-label"])),[[j,{value:e(A)("load3d.showSkeleton"),showDelay:300},void 0,{right:!0}]])])):$("",!0)])}}}),Ke={class:"flex flex-col"},Qe={key:0},Xe=["value"],Ye={key:1},Ze={key:2},eo={key:4},oo=F({__name:"SceneControls",props:{showGrid:{type:Boolean},showGridModifiers:{},backgroundColor:{},backgroundColorModifiers:{},backgroundImage:{},backgroundImageModifiers:{},backgroundRenderMode:{default:"tiled"},backgroundRenderModeModifiers:{},fov:{},fovModifiers:{}},emits:X(["updateBackgroundImage"],["update:showGrid","update:backgroundColor","update:backgroundImage","update:backgroundRenderMode","update:fov"]),setup(d,{emit:u}){const l=u,t=L(d,"showGrid"),i=L(d,"backgroundColor"),a=L(d,"backgroundImage"),p=L(d,"backgroundRenderMode"),b=L(d,"fov"),v=T(()=>a.value&&a.value!==""),s=O(null),f=O(null),w=r(()=>{t.value=!t.value},"toggleGrid"),E=r(h=>{i.value=h},"updateBackgroundColor"),V=r(()=>{s.value?.click()},"openColorPicker"),R=r(()=>{f.value?.click()},"openImagePicker"),I=r(h=>{const M=h.target;M.files&&M.files[0]&&l("updateBackgroundImage",M.files[0])},"uploadBackgroundImage"),j=r(()=>{l("updateBackgroundImage",null)},"removeBackgroundImage"),B=r(()=>{p.value=p.value==="panorama"?"tiled":"panorama"},"toggleBackgroundRenderMode");return(h,M)=>{const N=W("tooltip");return o(),x("div",Ke,[C((o(),y(S,{variant:"textonly",size:"icon",class:G(e(q)("rounded-full",t.value&&"ring-2 ring-white/50")),"aria-label":h.$t("load3d.showGrid"),onClick:w},{default:D(()=>M[2]||(M[2]=[n("i",{class:"pi pi-table text-lg text-base-foreground"},null,-1)])),_:1},8,["class","aria-label"])),[[N,{value:h.$t("load3d.showGrid"),showDelay:300},void 0,{right:!0}]]),v.value?$("",!0):(o(),x("div",Qe,[C((o(),y(S,{variant:"textonly",size:"icon",class:"rounded-full","aria-label":h.$t("load3d.backgroundColor"),onClick:V},{default:D(()=>[M[3]||(M[3]=n("i",{class:"pi pi-palette text-lg text-base-foreground"},null,-1)),n("input",{ref_key:"colorPickerRef",ref:s,type:"color",value:i.value,class:"pointer-events-none absolute m-0 h-0 w-0 p-0 opacity-0",onInput:M[0]||(M[0]=J=>E(J.target.value))},null,40,Xe)]),_:1},8,["aria-label"])),[[N,{value:h.$t("load3d.backgroundColor"),showDelay:300},void 0,{right:!0}]])])),v.value?$("",!0):(o(),x("div",Ye,[C((o(),y(S,{variant:"textonly",size:"icon",class:"rounded-full","aria-label":h.$t("load3d.uploadBackgroundImage"),onClick:R},{default:D(()=>[M[4]||(M[4]=n("i",{class:"pi pi-image text-lg text-base-foreground"},null,-1)),n("input",{ref_key:"imagePickerRef",ref:f,type:"file",accept:"image/*",class:"pointer-events-none absolute m-0 h-0 w-0 p-0 opacity-0",onChange:I},null,544)]),_:1},8,["aria-label"])),[[N,{value:h.$t("load3d.uploadBackgroundImage"),showDelay:300},void 0,{right:!0}]])])),v.value?(o(),x("div",Ze,[C((o(),y(S,{variant:"textonly",size:"icon",class:G(e(q)("rounded-full",p.value==="panorama"&&"ring-2 ring-white/50")),"aria-label":h.$t("load3d.panoramaMode"),onClick:B},{default:D(()=>M[5]||(M[5]=[n("i",{class:"pi pi-globe text-lg text-base-foreground"},null,-1)])),_:1},8,["class","aria-label"])),[[N,{value:h.$t("load3d.panoramaMode"),showDelay:300},void 0,{right:!0}]])])):$("",!0),v.value&&p.value==="panorama"?(o(),y(re,{key:3,modelValue:b.value,"onUpdate:modelValue":M[1]||(M[1]=J=>b.value=J),"tooltip-text":h.$t("load3d.fov")},null,8,["modelValue","tooltip-text"])):$("",!0),v.value?(o(),x("div",eo,[C((o(),y(S,{variant:"textonly",size:"icon",class:"rounded-full","aria-label":h.$t("load3d.removeBackgroundImage"),onClick:j},{default:D(()=>M[6]||(M[6]=[n("i",{class:"pi pi-times text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[N,{value:h.$t("load3d.removeBackgroundImage"),showDelay:300},void 0,{right:!0}]])])):$("",!0)])}}}),to={class:"show-menu relative"},lo={class:"absolute top-0 left-12 rounded-lg bg-interface-menu-surface shadow-lg"},ao={class:"flex flex-col"},no={class:"whitespace-nowrap text-base-foreground"},io={class:"rounded-lg bg-smoke-700/30"},so=F({__name:"Load3DControls",props:X({isSplatModel:{type:Boolean,default:!1},isPlyModel:{type:Boolean,default:!1},hasSkeleton:{type:Boolean,default:!1}},{sceneConfig:{},sceneConfigModifiers:{},modelConfig:{},modelConfigModifiers:{},cameraConfig:{},cameraConfigModifiers:{},lightConfig:{},lightConfigModifiers:{}}),emits:X(["updateBackgroundImage","exportModel"],["update:sceneConfig","update:modelConfig","update:cameraConfig","update:lightConfig"]),setup(d,{emit:u}){const l=L(d,"sceneConfig"),t=L(d,"modelConfig"),i=L(d,"cameraConfig"),a=L(d,"lightConfig"),p=O(!1),b=O("scene"),v={scene:"load3d.scene",model:"load3d.model",camera:"load3d.camera",light:"load3d.light",export:"load3d.export"},s=T(()=>d.isSplatModel?["scene","model","camera"]:["scene","model","camera","light","export"]),f=T(()=>b.value==="scene"&&!!l.value),w=T(()=>b.value==="model"&&!!t.value),E=T(()=>b.value==="camera"&&!!i.value),V=T(()=>b.value==="light"&&!!a.value&&!!t.value),R=T(()=>b.value==="export"),I=r(()=>{p.value=!p.value},"toggleMenu"),j=r(U=>{b.value=U,p.value=!1},"selectCategory"),B=r(U=>`${{scene:"pi pi-image",model:"pi pi-box",camera:"pi pi-camera",light:"pi pi-sun",export:"pi pi-download"}[U]} text-base-foreground text-lg`,"getCategoryIcon"),h=u,M=r(U=>{h("updateBackgroundImage",U)},"handleBackgroundImageUpdate"),N=r(U=>{h("exportModel",U)},"handleExportModel"),J=r(U=>{U.target.closest(".show-menu")||(p.value=!1)},"closeSlider");return Q(()=>{document.addEventListener("click",J)}),Y(()=>{document.removeEventListener("click",J)}),(U,g)=>(o(),x("div",{class:"pointer-events-auto absolute top-12 left-2 z-20 flex flex-col rounded-lg bg-backdrop/30",onPointerdown:g[12]||(g[12]=z(()=>{},["stop"])),onPointermove:g[13]||(g[13]=z(()=>{},["stop"])),onPointerup:g[14]||(g[14]=z(()=>{},["stop"])),onWheel:g[15]||(g[15]=z(()=>{},["stop"]))},[n("div",to,[_(S,{variant:"textonly",size:"icon","aria-label":U.$t("menu.showMenu"),class:"rounded-full",onClick:I},{default:D(()=>g[16]||(g[16]=[n("i",{class:"pi pi-bars text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"]),C(n("div",lo,[n("div",ao,[(o(!0),x(ee,null,oe(s.value,m=>(o(),y(S,{key:m,variant:"textonly",class:G(e(q)("flex w-full items-center justify-start",b.value===m&&"bg-button-active-surface")),onClick:r(te=>j(m),"onClick")},{default:D(()=>[n("i",{class:G(B(m))},null,2),n("span",no,K(U.$t(v[m])),1)]),_:2},1032,["class","onClick"]))),128))])],512),[[H,p.value]])]),C(n("div",io,[f.value?(o(),y(oo,{key:0,"show-grid":l.value.showGrid,"onUpdate:showGrid":g[0]||(g[0]=m=>l.value.showGrid=m),"background-color":l.value.backgroundColor,"onUpdate:backgroundColor":g[1]||(g[1]=m=>l.value.backgroundColor=m),"background-image":l.value.backgroundImage,"onUpdate:backgroundImage":g[2]||(g[2]=m=>l.value.backgroundImage=m),"background-render-mode":l.value.backgroundRenderMode,"onUpdate:backgroundRenderMode":g[3]||(g[3]=m=>l.value.backgroundRenderMode=m),fov:i.value.fov,"onUpdate:fov":g[4]||(g[4]=m=>i.value.fov=m),onUpdateBackgroundImage:M},null,8,["show-grid","background-color","background-image","background-render-mode","fov"])):$("",!0),w.value?(o(),y(He,{key:1,"material-mode":t.value.materialMode,"onUpdate:materialMode":g[5]||(g[5]=m=>t.value.materialMode=m),"up-direction":t.value.upDirection,"onUpdate:upDirection":g[6]||(g[6]=m=>t.value.upDirection=m),"show-skeleton":t.value.showSkeleton,"onUpdate:showSkeleton":g[7]||(g[7]=m=>t.value.showSkeleton=m),"hide-material-mode":U.isSplatModel,"is-ply-model":U.isPlyModel,"has-skeleton":U.hasSkeleton},null,8,["material-mode","up-direction","show-skeleton","hide-material-mode","is-ply-model","has-skeleton"])):$("",!0),E.value?(o(),y(Le,{key:2,"camera-type":i.value.cameraType,"onUpdate:cameraType":g[8]||(g[8]=m=>i.value.cameraType=m),fov:i.value.fov,"onUpdate:fov":g[9]||(g[9]=m=>i.value.fov=m)},null,8,["camera-type","fov"])):$("",!0),V.value?(o(),y(Fe,{key:3,"light-intensity":a.value.intensity,"onUpdate:lightIntensity":g[10]||(g[10]=m=>a.value.intensity=m),"material-mode":t.value.materialMode,"onUpdate:materialMode":g[11]||(g[11]=m=>t.value.materialMode=m)},null,8,["light-intensity","material-mode"])):$("",!0),R.value?(o(),y(Pe,{key:4,onExportModel:N})):$("",!0)],512),[[H,b.value]])],32))}}),ro={key:0,class:"absolute inset-0 z-50 flex items-center justify-center bg-backdrop/50"},uo={class:"flex flex-col items-center"},go={class:"mt-4 text-lg text-base-foreground"},co=F({__name:"LoadingOverlay",props:{loading:{type:Boolean},loadingMessage:{}},setup(d){return(u,l)=>(o(),y(ye,{name:"fade"},{default:D(()=>[u.loading?(o(),x("div",ro,[n("div",uo,[l[0]||(l[0]=n("div",{class:"spinner"},null,-1)),n("div",go,K(u.loadingMessage),1)])])):$("",!0)]),_:1}))}}),po=se(co,[["__scopeId","data-v-c31c7285"]]),vo={key:0,class:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm"},fo={class:"rounded-lg border-2 border-dashed border-blue-400 bg-blue-500/20 px-6 py-4 text-lg font-medium text-blue-100"},mo=F({__name:"Load3DScene",props:{initializeLoad3d:{type:Function},cleanup:{type:Function},loading:{type:Boolean},loadingMessage:{},onModelDrop:{type:Function},isPreview:{type:Boolean}},setup(d){const u=d,l=O(null),{isDragging:t,dragMessage:i,handleDragOver:a,handleDragLeave:p,handleDrop:b}=xe({onModelDrop:r(async v=>{u.onModelDrop&&await u.onModelDrop(v)},"onModelDrop"),disabled:T(()=>u.isPreview)});return Q(()=>{l.value&&u.initializeLoad3d(l.value)}),Y(()=>{u.cleanup()}),(v,s)=>(o(),x("div",{ref_key:"container",ref:l,class:"relative h-full w-full min-h-[200px]","data-capture-wheel":"true",onPointerdown:s[0]||(s[0]=z(()=>{},["stop"])),onPointermove:s[1]||(s[1]=z(()=>{},["stop"])),onPointerup:s[2]||(s[2]=z(()=>{},["stop"])),onMousedown:s[3]||(s[3]=z(()=>{},["stop"])),onMousemove:s[4]||(s[4]=z(()=>{},["stop"])),onMouseup:s[5]||(s[5]=z(()=>{},["stop"])),onContextmenu:s[6]||(s[6]=z(()=>{},["stop","prevent"])),onDragover:s[7]||(s[7]=z((...f)=>e(a)&&e(a)(...f),["prevent","stop"])),onDragleave:s[8]||(s[8]=z((...f)=>e(p)&&e(p)(...f),["stop"])),onDrop:s[9]||(s[9]=z((...f)=>e(b)&&e(b)(...f),["prevent","stop"]))},[_(po,{loading:v.loading,"loading-message":v.loadingMessage},null,8,["loading","loading-message"]),!v.isPreview&&e(t)?(o(),x("div",vo,[n("div",fo,K(e(i)),1)])):$("",!0)],544))}}),bo={class:"relative rounded-lg bg-backdrop/30"},ko={class:"flex flex-col gap-2"},yo={key:2,class:"mt-1 text-center text-xs text-base-foreground"},xo=F({__name:"RecordingControls",props:{hasRecording:{type:Boolean},hasRecordingModifiers:{},isRecording:{type:Boolean},isRecordingModifiers:{},recordingDuration:{},recordingDurationModifiers:{}},emits:X(["startRecording","stopRecording","exportRecording","clearRecording"],["update:hasRecording","update:isRecording","update:recordingDuration"]),setup(d,{emit:u}){const l=L(d,"hasRecording"),t=L(d,"isRecording"),i=L(d,"recordingDuration"),a=u;function p(){t.value?a("stopRecording"):a("startRecording")}r(p,"toggleRecording");function b(){a("exportRecording")}r(b,"handleExportRecording");function v(){a("clearRecording")}r(v,"handleClearRecording");function s(f){const w=Math.floor(f/60),E=Math.floor(f%60);return`${w.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`}return r(s,"formatDuration"),(f,w)=>{const E=W("tooltip");return o(),x("div",bo,[n("div",ko,[C((o(),y(S,{size:"icon",variant:"textonly",class:G(e(q)("rounded-full",t.value&&"text-red-500 recording-button-blink")),"aria-label":t.value?f.$t("load3d.stopRecording"):f.$t("load3d.startRecording"),onClick:p},{default:D(()=>[n("i",{class:G(["pi",t.value?"pi-circle-fill":"pi-video","text-lg text-base-foreground"])},null,2)]),_:1},8,["class","aria-label"])),[[E,{value:t.value?f.$t("load3d.stopRecording"):f.$t("load3d.startRecording"),showDelay:300},void 0,{right:!0}]]),l.value&&!t.value?C((o(),y(S,{key:0,size:"icon",variant:"textonly",class:"rounded-full","aria-label":f.$t("load3d.exportRecording"),onClick:b},{default:D(()=>w[0]||(w[0]=[n("i",{class:"pi pi-download text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[E,{value:f.$t("load3d.exportRecording"),showDelay:300},void 0,{right:!0}]]):$("",!0),l.value&&!t.value?C((o(),y(S,{key:1,size:"icon",variant:"textonly",class:"rounded-full","aria-label":f.$t("load3d.clearRecording"),onClick:v},{default:D(()=>w[1]||(w[1]=[n("i",{class:"pi pi-trash text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[E,{value:f.$t("load3d.clearRecording"),showDelay:300},void 0,{right:!0}]]):$("",!0),i.value&&i.value>0&&!t.value?(o(),x("div",yo,K(s(i.value)),1)):$("",!0)])])}}}),wo=se(xo,[["__scopeId","data-v-24c77a32"]]),ho={class:"relative rounded-lg bg-backdrop/30"},Mo={class:"flex flex-col gap-2"},Co=F({__name:"ViewerControls",props:{node:{}},setup(d){const u=r(()=>{const l={node:d.node};we().showDialog({key:"global-load3d-viewer",title:A("load3d.viewer.title"),component:he,props:l,dialogComponentProps:{style:"width: 80vw; height: 80vh;",maximizable:!0,onClose:r(async()=>{await Me().handleViewerClose(l.node)},"onClose")}})},"openIn3DViewer");return(l,t)=>{const i=W("tooltip");return o(),x("div",ho,[n("div",Mo,[C((o(),y(S,{size:"icon",variant:"textonly",class:"rounded-full","aria-label":e(A)("load3d.openIn3DViewer"),onClick:u},{default:D(()=>t[0]||(t[0]=[n("i",{class:"pi pi-expand text-lg text-base-foreground"},null,-1)])),_:1},8,["aria-label"])),[[i,{value:e(A)("load3d.openIn3DViewer"),showDelay:300},void 0,{right:!0}]])])])}}}),$o={class:"pointer-events-none absolute top-0 left-0 size-full"},Do={key:1,class:"pointer-events-auto absolute top-12 right-2 z-20"},Bo=F({__name:"Load3D",props:{widget:{},nodeId:{}},setup(d){const u=d;function l(ae){return"node"in ae&&ae.node!==void 0}r(l,"isComponentWidget");const t=O(null);l(u.widget)?t.value=u.widget.node:u.nodeId&&Q(()=>{t.value=Ce.rootGraph?.getNodeById(u.nodeId)||null});const{sceneConfig:i,modelConfig:a,cameraConfig:p,lightConfig:b,isRecording:v,isPreview:s,isSplatModel:f,isPlyModel:w,hasSkeleton:E,hasRecording:V,recordingDuration:R,animations:I,playing:j,selectedSpeed:B,selectedAnimation:h,animationProgress:M,animationDuration:N,loading:J,loadingMessage:U,initializeLoad3d:g,handleMouseEnter:m,handleMouseLeave:te,handleStartRecording:de,handleStopRecording:ue,handleExportRecording:ge,handleClearRecording:ce,handleSeek:pe,handleBackgroundImageUpdate:ve,handleExportModel:fe,handleModelDrop:me,cleanup:be}=$e(t),le=T(()=>Z().get("Comfy.Load3D.3DViewerEnable"));return(ae,c)=>(o(),x("div",{class:"relative size-full",onMouseenter:c[13]||(c[13]=(...k)=>e(m)&&e(m)(...k)),onMouseleave:c[14]||(c[14]=(...k)=>e(te)&&e(te)(...k)),onPointerdown:c[15]||(c[15]=z(()=>{},["stop"])),onPointermove:c[16]||(c[16]=z(()=>{},["stop"])),onPointerup:c[17]||(c[17]=z(()=>{},["stop"]))},[t.value?(o(),y(mo,{key:0,"initialize-load3d":e(g),cleanup:e(be),loading:e(J),"loading-message":e(U),"on-model-drop":e(s)?void 0:e(me),"is-preview":e(s)},null,8,["initialize-load3d","cleanup","loading","loading-message","on-model-drop","is-preview"])):$("",!0),n("div",$o,[_(so,{"scene-config":e(i),"onUpdate:sceneConfig":c[0]||(c[0]=k=>P(i)?i.value=k:null),"model-config":e(a),"onUpdate:modelConfig":c[1]||(c[1]=k=>P(a)?a.value=k:null),"camera-config":e(p),"onUpdate:cameraConfig":c[2]||(c[2]=k=>P(p)?p.value=k:null),"light-config":e(b),"onUpdate:lightConfig":c[3]||(c[3]=k=>P(b)?b.value=k:null),"is-splat-model":e(f),"is-ply-model":e(w),"has-skeleton":e(E),onUpdateBackgroundImage:e(ve),onExportModel:e(fe)},null,8,["scene-config","model-config","camera-config","light-config","is-splat-model","is-ply-model","has-skeleton","onUpdateBackgroundImage","onExportModel"]),e(I)&&e(I).length>0?(o(),y(De,{key:0,animations:e(I),"onUpdate:animations":c[4]||(c[4]=k=>P(I)?I.value=k:null),playing:e(j),"onUpdate:playing":c[5]||(c[5]=k=>P(j)?j.value=k:null),"selected-speed":e(B),"onUpdate:selectedSpeed":c[6]||(c[6]=k=>P(B)?B.value=k:null),"selected-animation":e(h),"onUpdate:selectedAnimation":c[7]||(c[7]=k=>P(h)?h.value=k:null),"animation-progress":e(M),"onUpdate:animationProgress":c[8]||(c[8]=k=>P(M)?M.value=k:null),"animation-duration":e(N),"onUpdate:animationDuration":c[9]||(c[9]=k=>P(N)?N.value=k:null),onSeek:e(pe)},null,8,["animations","playing","selected-speed","selected-animation","animation-progress","animation-duration","onSeek"])):$("",!0)]),le.value&&t.value?(o(),x("div",Do,[_(Co,{node:t.value},null,8,["node"])])):$("",!0),e(s)?$("",!0):(o(),x("div",{key:2,class:G(["pointer-events-auto absolute right-2 z-20",{"top-12":!le.value,"top-24":le.value}])},[_(wo,{"is-recording":e(v),"onUpdate:isRecording":c[10]||(c[10]=k=>P(v)?v.value=k:null),"has-recording":e(V),"onUpdate:hasRecording":c[11]||(c[11]=k=>P(V)?V.value=k:null),"recording-duration":e(R),"onUpdate:recordingDuration":c[12]||(c[12]=k=>P(R)?R.value=k:null),onStartRecording:e(de),onStopRecording:e(ue),onExportRecording:e(ge),onClearRecording:e(ce)},null,8,["is-recording","has-recording","recording-duration","onStartRecording","onStopRecording","onExportRecording","onClearRecording"])],2))],32))}});export{Bo as _};
//# sourceMappingURL=Load3D.vue_vue_type_script_setup_true_lang-Bxfi2BNt.js.map
