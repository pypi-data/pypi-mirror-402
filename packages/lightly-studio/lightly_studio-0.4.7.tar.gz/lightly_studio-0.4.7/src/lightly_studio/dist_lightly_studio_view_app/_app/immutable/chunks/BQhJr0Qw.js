var yt=t=>{throw TypeError(t)};var G=(t,e,s)=>e.has(t)||yt("Cannot "+s);var n=(t,e,s)=>(G(t,e,"read from private field"),s?s.call(t):e.get(t)),m=(t,e,s)=>e.has(t)?yt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),l=(t,e,s,a)=>(G(t,e,"write to private field"),a?a.call(t,s):e.set(t,s),s),y=(t,e,s)=>(G(t,e,"access private method"),s);import{f as At,u as Ct,h as Et,i as Qt,j as qt,k as Rt,l as Kt,m as St,n as Mt,o as xt,p as Bt,q as Tt,s as Vt,t as Dt,v as Ut,w as Lt,g as jt,d as Pt,e as Wt,x as kt,y as _t,z as zt,A as Ht,B as Nt,C as Gt,D as Jt,E as Xt,F as Yt}from"./BDOtEUpJ.js";import{c as Zt}from"./CvGjimpO.js";import{aN as $t,x as J,h as rt,w as te}from"./Yb_TZ_Rf.js";import{u as it}from"./C3A6m4-m.js";import{S as ee,p as ft,r as v,s as X,a as k,n as se,i as mt,b as pt,t as ae,f as ne,c as re,d as bt,e as It,g as ie,h as oe}from"./CatoPwpr.js";var g,r,j,O,K,T,E,I,P,V,D,S,M,Q,U,c,L,Y,Z,$,tt,et,st,at,vt,Ft,ue=(Ft=class extends ee{constructor(e,s){super();m(this,c);m(this,g);m(this,r);m(this,j);m(this,O);m(this,K);m(this,T);m(this,E);m(this,I);m(this,P);m(this,V);m(this,D);m(this,S);m(this,M);m(this,Q);m(this,U,new Set);this.options=s,l(this,g,e),l(this,I,null),l(this,E,ft()),this.options.experimental_prefetchInRender||n(this,E).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(n(this,r).addObserver(this),Ot(n(this,r),this.options)?y(this,c,L).call(this):this.updateResult(),y(this,c,tt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return nt(n(this,r),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return nt(n(this,r),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,y(this,c,et).call(this),y(this,c,st).call(this),n(this,r).removeObserver(this)}setOptions(e,s){const a=this.options,o=n(this,r);if(this.options=n(this,g).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof v(this.options.enabled,n(this,r))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");y(this,c,at).call(this),n(this,r).setOptions(this.options),a._defaulted&&!X(this.options,a)&&n(this,g).getQueryCache().notify({type:"observerOptionsUpdated",query:n(this,r),observer:this});const i=this.hasListeners();i&&gt(n(this,r),o,this.options,a)&&y(this,c,L).call(this),this.updateResult(s),i&&(n(this,r)!==o||v(this.options.enabled,n(this,r))!==v(a.enabled,n(this,r))||k(this.options.staleTime,n(this,r))!==k(a.staleTime,n(this,r)))&&y(this,c,Y).call(this);const u=y(this,c,Z).call(this);i&&(n(this,r)!==o||v(this.options.enabled,n(this,r))!==v(a.enabled,n(this,r))||u!==n(this,Q))&&y(this,c,$).call(this,u)}getOptimisticResult(e){const s=n(this,g).getQueryCache().build(n(this,g),e),a=this.createResult(s,e);return he(this,a)&&(l(this,O,a),l(this,T,this.options),l(this,K,n(this,r).state)),a}getCurrentResult(){return n(this,O)}trackResult(e,s){const a={};return Object.keys(e).forEach(o=>{Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(o),s==null||s(o),e[o])})}),a}trackProp(e){n(this,U).add(e)}getCurrentQuery(){return n(this,r)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=n(this,g).defaultQueryOptions(e),a=n(this,g).getQueryCache().build(n(this,g),s);return a.fetch().then(()=>this.createResult(a,s))}fetch(e){return y(this,c,L).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),n(this,O)))}createResult(e,s){var lt;const a=n(this,r),o=this.options,i=n(this,O),u=n(this,K),p=n(this,T),A=e!==a?e.state:n(this,j),{state:h}=e;let d={...h},q=!1,w;if(s._optimisticResults){const b=this.hasListeners(),x=!b&&Ot(e,s),B=b&&gt(e,a,s,o);(x||B)&&(d={...d,...re(h.data,e.options)}),s._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:ut,errorUpdatedAt:ct,status:R}=d;if(s.select&&d.data!==void 0)if(i&&d.data===(u==null?void 0:u.data)&&s.select===n(this,P))w=n(this,V);else try{l(this,P,s.select),w=s.select(d.data),w=bt(i==null?void 0:i.data,w,s),l(this,V,w),l(this,I,null)}catch(b){l(this,I,b)}else w=d.data;if(s.placeholderData!==void 0&&w===void 0&&R==="pending"){let b;if(i!=null&&i.isPlaceholderData&&s.placeholderData===(p==null?void 0:p.placeholderData))b=i.data;else if(b=typeof s.placeholderData=="function"?s.placeholderData((lt=n(this,D))==null?void 0:lt.state.data,n(this,D)):s.placeholderData,s.select&&b!==void 0)try{b=s.select(b),l(this,I,null)}catch(x){l(this,I,x)}b!==void 0&&(R="success",w=bt(i==null?void 0:i.data,b,s),q=!0)}n(this,I)&&(ut=n(this,I),w=n(this,V),ct=Date.now(),R="error");const z=d.fetchStatus==="fetching",H=R==="pending",N=R==="error",ht=H&&z,dt=w!==void 0,F={status:R,fetchStatus:d.fetchStatus,isPending:H,isSuccess:R==="success",isError:N,isInitialLoading:ht,isLoading:ht,data:w,dataUpdatedAt:d.dataUpdatedAt,error:ut,errorUpdatedAt:ct,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>A.dataUpdateCount||d.errorUpdateCount>A.errorUpdateCount,isFetching:z,isRefetching:z&&!H,isLoadingError:N&&!dt,isPaused:d.fetchStatus==="paused",isPlaceholderData:q,isRefetchError:N&&dt,isStale:ot(e,s),refetch:this.refetch,promise:n(this,E)};if(this.options.experimental_prefetchInRender){const b=W=>{F.status==="error"?W.reject(F.error):F.data!==void 0&&W.resolve(F.data)},x=()=>{const W=l(this,E,F.promise=ft());b(W)},B=n(this,E);switch(B.status){case"pending":e.queryHash===a.queryHash&&b(B);break;case"fulfilled":(F.status==="error"||F.data!==B.value)&&x();break;case"rejected":(F.status!=="error"||F.error!==B.reason)&&x();break}}return F}updateResult(e){const s=n(this,O),a=this.createResult(n(this,r),this.options);if(l(this,K,n(this,r).state),l(this,T,this.options),n(this,K).data!==void 0&&l(this,D,n(this,r)),X(a,s))return;l(this,O,a);const o={},i=()=>{if(!s)return!0;const{notifyOnChangeProps:u}=this.options,p=typeof u=="function"?u():u;if(p==="all"||!p&&!n(this,U).size)return!0;const C=new Set(p??n(this,U));return this.options.throwOnError&&C.add("error"),Object.keys(n(this,O)).some(A=>{const h=A;return n(this,O)[h]!==s[h]&&C.has(h)})};(e==null?void 0:e.listeners)!==!1&&i()&&(o.listeners=!0),y(this,c,vt).call(this,{...o,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&y(this,c,tt).call(this)}},g=new WeakMap,r=new WeakMap,j=new WeakMap,O=new WeakMap,K=new WeakMap,T=new WeakMap,E=new WeakMap,I=new WeakMap,P=new WeakMap,V=new WeakMap,D=new WeakMap,S=new WeakMap,M=new WeakMap,Q=new WeakMap,U=new WeakMap,c=new WeakSet,L=function(e){y(this,c,at).call(this);let s=n(this,r).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(se)),s},Y=function(){y(this,c,et).call(this);const e=k(this.options.staleTime,n(this,r));if(mt||n(this,O).isStale||!pt(e))return;const a=ae(n(this,O).dataUpdatedAt,e)+1;l(this,S,setTimeout(()=>{n(this,O).isStale||this.updateResult()},a))},Z=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(n(this,r)):this.options.refetchInterval)??!1},$=function(e){y(this,c,st).call(this),l(this,Q,e),!(mt||v(this.options.enabled,n(this,r))===!1||!pt(n(this,Q))||n(this,Q)===0)&&l(this,M,setInterval(()=>{(this.options.refetchIntervalInBackground||ne.isFocused())&&y(this,c,L).call(this)},n(this,Q)))},tt=function(){y(this,c,Y).call(this),y(this,c,$).call(this,y(this,c,Z).call(this))},et=function(){n(this,S)&&(clearTimeout(n(this,S)),l(this,S,void 0))},st=function(){n(this,M)&&(clearInterval(n(this,M)),l(this,M,void 0))},at=function(){const e=n(this,g).getQueryCache().build(n(this,g),this.options);if(e===n(this,r))return;const s=n(this,r);l(this,r,e),l(this,j,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},vt=function(e){It.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(n(this,O))}),n(this,g).getQueryCache().notify({query:n(this,r),type:"observerResultsUpdated"})})},Ft);function ce(t,e){return v(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Ot(t,e){return ce(t,e)||t.state.data!==void 0&&nt(t,e,e.refetchOnMount)}function nt(t,e,s){if(v(e.enabled,t)!==!1){const a=typeof s=="function"?s(t):s;return a==="always"||a!==!1&&ot(t,e)}return!1}function gt(t,e,s,a){return(t!==e||v(a.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&ot(t,s)}function ot(t,e){return v(e.enabled,t)!==!1&&t.isStaleByTime(k(e.staleTime,t))}function he(t,e){return!X(t.getCurrentResult(),e)}function de(){return ie()}function le(t){return oe()}function ye(t){return"subscribe"in t&&typeof t.subscribe=="function"}function fe(){}function me(t,e,s){const a=le(),o=de(),i=ye(t)?t:$t(t),u=J([i,o],([h,d])=>{const q=a.defaultQueryOptions(h);return q._optimisticResults=d?"isRestoring":"optimistic",q}),p=new e(a,rt(u));u.subscribe(h=>{p.setOptions(h,{listeners:!1})});const C=J(o,(h,d)=>{const q=h?fe:p.subscribe(It.batchCalls(d));return p.updateResult(),q}),{subscribe:A}=J([C,u],([h,d])=>(h=p.getOptimisticResult(d),d.notifyOnChangeProps?h:p.trackResult(h)));return{subscribe:A}}function pe(t,e){return me(t,ue)}function He(t){return t}const f=(t,e,s)=>{const a={_id:t,baseUrl:(e==null?void 0:e.baseUrl)||((e==null?void 0:e.client)??Zt).getConfig().baseUrl};return s&&(a._infinite=s),e!=null&&e.body&&(a.body=e.body),e!=null&&e.headers&&(a.headers=e.headers),e!=null&&e.path&&(a.path=e.path),e!=null&&e.query&&(a.query=e.query),[a]},_=(t,e)=>{const s={...t[0]};return e.body&&(s.body={...t[0].body,...e.body}),e.headers&&(s.headers={...t[0].headers,...e.headers}),e.path&&(s.path={...t[0].path,...e.path}),e.query&&(s.query={...t[0].query,...e.query}),s},be=t=>f("readDataset",t),Ne=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Rt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:be(t)}),Oe=t=>f("hasEmbeddings",t),Ge=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Kt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Oe(t)}),ge=t=>f("readImage",t),Je=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Bt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:ge(t)}),we=t=>f("readSamples",t,!0),Xe=t=>({queryFn:async({pageParam:e,queryKey:s,signal:a})=>{const i=_(s,typeof e=="object"?e:{query:{cursor:e}}),{data:u}=await Lt({...t,...i,signal:a,throwOnError:!0});return u},queryKey:we(t)}),Ye=t=>({mutationFn:async s=>{const{data:a}=await At({...t,...s,throwOnError:!0});return a}}),Fe=t=>f("readAnnotationLabels",t),Ze=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await St({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Fe(t)}),$e=t=>({mutationFn:async s=>{const{data:a}=await Ht({...t,...s,throwOnError:!0});return a}}),ts=t=>({mutationFn:async s=>{const{data:a}=await _t({...t,...s,throwOnError:!0});return a}}),es=t=>({mutationFn:async s=>{const{data:a}=await Ct({...t,...s,throwOnError:!0});return a}}),Ie=t=>f("countAnnotationsByCollection",t),ss=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await xt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Ie(t)}),ve=t=>f("readAnnotationsWithPayload",t,!0),as=t=>({queryFn:async({pageParam:e,queryKey:s,signal:a})=>{const i=_(s,typeof e=="object"?e:{query:{cursor:e}}),{data:u}=await kt({...t,...i,signal:a,throwOnError:!0});return u},queryKey:ve(t)}),ns=t=>({mutationFn:async s=>{const{data:a}=await Yt({...t,...s,throwOnError:!0});return a}}),rs=t=>({mutationFn:async s=>{const{data:a}=await zt({...t,...s,throwOnError:!0});return a}}),Ae=t=>f("getAnnotation",t),is=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Nt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Ae(t)}),Ce=t=>f("getAnnotationWithPayload",t),os=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Ut({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Ce(t)}),us=t=>({mutationFn:async s=>{const{data:a}=await Et({...t,...s,throwOnError:!0});return a}}),Ee=t=>f("getCaption",t),cs=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Gt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Ee(t)}),hs=t=>({mutationFn:async s=>{const{data:a}=await Jt({...t,...s,throwOnError:!0});return a}}),ds=t=>({mutationFn:async s=>{const{data:a}=await Qt({...t,...s,throwOnError:!0});return a}}),Qe=t=>f("embedText",t),ls=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Tt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Qe(t)}),qe=t=>f("get2dEmbeddings",t),ys=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Xt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:qe(t)}),Re=t=>f("getMetadataInfo",t),Ke=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Mt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Re(t)}),Se=t=>f("getAllFrames",t,!0),fs=t=>({queryFn:async({pageParam:e,queryKey:s,signal:a})=>{const i=_(s,typeof e=="object"?e:{query:{cursor:e}}),{data:u}=await jt({...t,...i,signal:a,throwOnError:!0});return u},queryKey:Se(t)}),Me=t=>f("getFrameById",t),ms=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await qt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Me(t)}),xe=t=>f("countVideoFrameAnnotations",t),ps=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Vt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:xe(t)}),Be=t=>f("countVideoFrameAnnotationsByVideoCollection",t),bs=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Dt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Be(t)}),Te=t=>f("getAllVideos",t,!0),Os=t=>({queryFn:async({pageParam:e,queryKey:s,signal:a})=>{const i=_(s,typeof e=="object"?e:{query:{cursor:e}}),{data:u}=await Pt({...t,...i,signal:a,throwOnError:!0});return u},queryKey:Te(t)}),Ve=t=>f("getVideoById",t),gs=t=>({queryFn:async({queryKey:e,signal:s})=>{const{data:a}=await Wt({...t,...e[0],signal:s,throwOnError:!0});return a},queryKey:Ve(t)}),wt=te(),De=async t=>{if(rt(wt)==t)return;const e=Ke({path:{collection_id:t}});pe(e).subscribe(a=>{if(a.data){const o=a.data,{updateMetadataBounds:i,updateMetadataValues:u,updateMetadataInfo:p}=it(),C={},A={};o.forEach(h=>{(h.type==="integer"||h.type==="float")&&h.min!=null&&h.max!=null&&(C[h.name]={min:h.min,max:h.max},A[h.name]={min:h.min,max:h.max})}),i(C),u(A),p(o),wt.set(t)}})},Ue=t=>{const e=[],{metadataBounds:s}=it();for(const[a,o]of Object.entries(t)){const u=rt(s)[a];u&&(o.min>u.min&&e.push({key:a,value:o.min,op:">="}),o.max<u.max&&e.push({key:a,value:o.max,op:"<="}))}return e},ws=t=>{t&&De(t);const{metadataBounds:e,metadataValues:s,metadataInfo:a,updateMetadataValues:o,updateMetadataBounds:i,updateMetadataInfo:u}=it();return{metadataBounds:e,metadataValues:s,metadataInfo:a,updateMetadataValues:o,updateMetadataBounds:i,updateMetadataInfo:u,createMetadataFilters:Ue}};export{is as A,ts as B,rs as C,$e as D,cs as E,hs as F,ds as G,us as H,He as I,ue as Q,le as a,Os as b,Ue as c,ms as d,pe as e,gs as f,fs as g,Xe as h,Je as i,ns as j,os as k,Ze as l,ss as m,Ge as n,ls as o,ys as p,bs as q,Ye as r,ps as s,me as t,ws as u,ye as v,fe as w,es as x,as as y,Ne as z};
