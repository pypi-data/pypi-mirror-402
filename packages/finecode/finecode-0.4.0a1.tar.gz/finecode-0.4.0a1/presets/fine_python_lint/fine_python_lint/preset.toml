[tool.finecode.action.lint_files_python]
source = "finecode_extension_api.actions.lint_files.LintFilesAction"
handlers = [
    { name = "ruff", source = "fine_python_ruff.RuffLintFilesHandler", env = "dev_no_runtime", dependencies = [
        "fine_python_ruff==0.2.*",
    ] },
    { name = "flake8", source = "fine_python_flake8.Flake8LintFilesHandler", env = "dev_no_runtime", dependencies = [
        "fine_python_flake8==0.3.*",
    ] },
    { name = "pyrefly", source = "fine_python_pyrefly.PyreflyLintFilesHandler", env = "dev_no_runtime", dependencies = [
        "fine_python_pyrefly==0.2.*",
    ] },
]

[[tool.finecode.action_handler]]
source = "fine_python_ruff.RuffLintFilesHandler"
config.extend_select = ["B", "I"]

# flake8 is used only for custom rules, all standard rules are checked by ruff, but
# keep flake8 configuration if someone activates some rules or uses flake8 config
# parameters in their own rules
[[tool.finecode.action_handler]]
source = "fine_python_flake8.Flake8LintFilesHandler"
config.max_line_length = 80
# W391 is not compatible with black(and ruff formatter, which is compatible with black),
# because black adds an empty line to the end of the file
# TODO: move in recommended config once config merging is implemented
config.extend_ignore = ["E203", "E501", "E701", "W391"]
# disable all standard rules
config.select = []

[[tool.finecode.action_handler]]
source = "fine_python_pip.PipInstallDepsInEnvHandler"
# use compat editable mode because some static analysis tools like pyrefly support
# only .pth files with pathes, not with executable code lines:
# https://pyrefly.org/en/docs/import-resolution/#editable-installs
# another possibility is strict mode, but it doesn't work in this case, because it
# creates editable directory directly in the package and if the package is installed
# as editable in multiple packages, there are concurrency problems and it would require
# sequential installation of dependencies in all envs.
config.editable_mode = 'compat'
