(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2462],{40135:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/locations",function(){return n(36956)}])},36956:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var i=n(24246),l=n(10034),s=n(16134),o=n(77213),a=n(58754),r=n(98784),d=n.n(r),c=n(86677),u=n(27378),h=n(812),g=n(58452),m=n(26917),p=n(46628),x=n(60240),j=n(31883),f=n(77830),C=n(26089),v=n(61524),y=n(46238),w=e=>{let{id:t,isChecked:n,onChange:s}=e;return(0,i.jsxs)(l.ad9,{alignItems:"center",gap:"8px",children:[(0,i.jsx)(l.rsf,{checked:n,size:"small",onChange:s,id:t,"data-testid":"regulated-toggle"}),(0,i.jsx)(l.tLq,{fontSize:"sm",m:0,htmlFor:t,children:"Regulated"}),(0,i.jsx)(y.b,{label:"Toggle on to see only locations in this region with privacy regulations supported by Fides"})]})},b=n(67991),S=n(12282),k=n(85759),_=e=>{let{groups:t,locations:n,isOpen:s,onClose:o,selected:a,onChange:r}=e,[d,c]=(0,u.useState)(a),[h,g]=(0,u.useState)(!1),{filteredLocations:m,locationsByGroup:p}=(0,u.useMemo)(()=>{let e=h?n.filter(e=>{var t;return null===(t=e.regulation)||void 0===t?void 0:t.length}):n;return{locationsByGroup:(0,k.VT)(e),filteredLocations:e}},[n,h]),{allSelected:x,handleToggleAll:j,handleToggleSelection:f}=(0,b.QZ)({items:m,selected:d,onChange:c}),C=d.filter(e=>!Object.keys(p).includes(e)).length,v=n[0].continent,y=Object.keys(p),_=!(1===y.length&&"Other"===y[0]);return(0,i.jsxs)(l.TGG,{size:"2xl",isOpen:s,onClose:o,isCentered:!0,children:[(0,i.jsx)(l.T5Q,{}),(0,i.jsxs)(l.Z8H,{"data-testid":"subgroup-modal",children:[(0,i.jsx)(S.h4,{title:"Select locations"}),(0,i.jsxs)(l.zOL,{p:6,maxHeight:"70vh",overflowY:"auto",children:[(0,i.jsx)(S.x$,{title:v,allSelected:x,onToggleAll:j,numSelected:C,children:(0,i.jsx)(w,{id:"".concat(v,"-modal-regulated"),isChecked:h,onChange:()=>g(!h)})}),_?(0,i.jsx)(l.NvE,{allowToggle:!0,allowMultiple:!0,children:Object.entries(p).map(e=>{let[n,s]=e,o=t.find(e=>n===e.id),a=o?o.name:n;return(0,i.jsxs)(l.nCC,{"data-testid":"".concat(a,"-accordion"),children:[(0,i.jsx)("h2",{children:(0,i.jsxs)(l.rKS,{children:[(0,i.jsx)(l.TJV,{as:"span",flex:"1",textAlign:"left",fontWeight:"semibold",fontSize:"sm",children:a}),(0,i.jsx)(l.UhW,{})]})}),(0,i.jsx)(l.rnb,{pb:4,children:(0,i.jsx)(l.RmD,{columns:3,spacing:6,children:s.map(e=>(0,i.jsx)(l.gxE,{size:"sm",colorScheme:"complimentary",isChecked:d.includes(e.id),onChange:()=>f(e.id),"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id))})})]},n)})}):(0,i.jsx)(l.RmD,{columns:3,spacing:6,paddingInline:4,children:m.map(e=>(0,i.jsx)(l.gxE,{size:"sm",colorScheme:"complimentary",isChecked:d.includes(e.id),onChange:()=>f(e.id),"data-testid":"".concat(e.name,"-checkbox"),children:e.name},e.id))})]}),(0,i.jsx)(S.$_,{onApply:()=>{let e=new Set(d);Object.entries(p).forEach(t=>{let[n,i]=t;i.every(e=>d.includes(e.id))?e.add(n):e.delete(n)}),r(Array.from(e)),o()},onClose:o})]})]})};let O=(e,t)=>{var n;return null===(n=e.name)||void 0===n?void 0:n.toLocaleLowerCase().includes(t.toLocaleLowerCase())};var E=e=>{let{title:t,groups:n,locations:s,selected:o,onChange:a,search:r}=e,d=(0,l.E2M)(),[c,h]=(0,u.useState)(!1),g=!!(null==r?void 0:r.length),m=n.length>0,p=s;n.length&&(p=n),g&&(p=[...s,...n].sort((e,t)=>e.name.localeCompare(t.name)));let x=c?p.filter(e=>(0,k.$q)(e,s)):p,j=r?x.filter(e=>O(e,r)):x,f=n.filter(e=>"checked"===(0,k.ji)({group:e,selected:o,locations:s})).map(e=>e.id),C=n.filter(e=>"indeterminate"===(0,k.ji)({group:e,selected:o,locations:s})).map(e=>e.id),y=m?[...f,...o]:o,b=o.length,S=e=>{a(s.map(t=>e.includes(t.id)?{...t,selected:!0}:{...t,selected:!1}))};return 0===j.length&&r?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.ZP,{title:t,items:j,selected:y,indeterminate:m?C:[],onChange:e=>{let t=new Set(e),i=new Set(y);e.forEach(e=>{!i.has(e)&&n.find(t=>t.id===e)&&s.filter(t=>{var n;return null===(n=t.belongs_to)||void 0===n?void 0:n.includes(e)}).forEach(e=>{t.add(e.id)})}),i.forEach(e=>{!t.has(e)&&n.find(t=>t.id===e)&&s.filter(t=>{var n;return null===(n=t.belongs_to)||void 0===n?void 0:n.includes(e)}).forEach(e=>{t.delete(e.id)})}),S(Array.from(t))},onViewMore:()=>{d.onOpen()},numSelected:b,toggle:(0,i.jsx)(w,{id:"".concat(t,"-regulated"),isChecked:c,onChange:()=>h(!c)})}),(0,i.jsx)(_,{groups:n,locations:s,isOpen:d.isOpen,onClose:d.onClose,selected:o,onChange:S},"subgroup-modal-selected-".concat(y.length))]})},L=n(64781),T=e=>{var t,n;let{data:s}=e,o=(0,l.p8r)(),a=(0,l.E2M)(),[r,v]=(0,u.useState)(null!==(n=null===(t=s.locations)||void 0===t?void 0:t.filter(e=>e.id!==x._F.GLOBAL))&&void 0!==n?n:[]),[y,w]=(0,u.useState)(""),[b,{isLoading:S}]=(0,L.WA)(),_=(0,u.useMemo)(()=>(0,k.Il)((s.locations||[]).filter(e=>e.id!==x._F.GLOBAL),s.location_groups||[]),[s]),O=!d().isEqual(r,s.locations),T=(0,c.useRouter)(),z=()=>{T.push(f.vY).then(()=>{o.closeAll()})},A=async()=>{let e=await b({locations:r.map(e=>({id:e.id,selected:e.selected})),regulations:[]});(0,j.D4)(e)?o((0,p.Vo)((0,h.e$)(e.error))):o((0,p.t5)((0,i.jsxs)(l.Bjg,{display:"inline",children:["Fides has automatically associated the relevant regulations with your location choices."," ",(0,i.jsx)(C.Z,{onClick:z,children:"View regulations here."})]})))},F=e=>{v(r.map(t=>{let n=e.find(e=>e.id===t.id);return null!=n?n:t}))};return(0,i.jsxs)(l.s_g,{alignItems:"start",spacing:4,children:[(0,i.jsx)(l.TJV,{maxWidth:"510px",width:"100%",children:(0,i.jsx)(m.Z,{onChange:w,placeholder:"Search",value:y,onClear:()=>w("")})}),(0,i.jsx)(l.RmD,{columns:{base:1,md:2,xl:3},spacing:6,width:"100%",children:Object.entries(_).map(e=>{let[t,n]=e;return(0,i.jsx)(E,{title:t,groups:n.locationGroups,locations:n.locations,selected:r.filter(e=>n.locations.find(t=>t.id===e.id)&&e.selected).map(e=>e.id),onChange:F,search:y},t)})}),(0,i.jsx)(g.Z,{isOpen:a.isOpen,onClose:a.onClose,onConfirm:()=>{A(),a.onClose()},title:"Regulation updates",message:"Modifications in your location settings may also affect your regulation settings to simplify management. You can override any Fides-initiated changes directly in the regulation settings.",isCentered:!0,icon:(0,i.jsx)(l.aNP,{color:"orange"})}),O?(0,i.jsx)(l.zxk,{type:"primary",onClick:a.onOpen,loading:S,"data-testid":"save-btn",children:"Save"}):null]})},z=()=>{let{isLoading:e}=(0,L.QM)(),t=(0,s.C)(L.P8);return(0,i.jsx)(o.Z,{title:"Locations",children:(0,i.jsxs)(l.TJV,{"data-testid":"location-management",children:[(0,i.jsx)(a.Z,{heading:"Locations"}),(0,i.jsx)(l.Bjg,{fontSize:"sm",maxWidth:"720px",pb:6,children:"Select the locations that you operate in and Fides will make sure that you are automatically presented with the relevant regulatory guidelines and global frameworks for your locations."}),(0,i.jsx)(l.TJV,{children:e?(0,i.jsx)(l.Y6B,{}):(0,i.jsx)(T,{data:t})})]})})}}},function(e){e.O(0,[9826,2888,9774,179],function(){return e(e.s=40135)}),_N_E=e.O()}]);