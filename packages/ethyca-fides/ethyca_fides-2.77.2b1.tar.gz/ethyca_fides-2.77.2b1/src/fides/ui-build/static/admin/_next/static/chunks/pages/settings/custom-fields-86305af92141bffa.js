(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4065],{1770:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/custom-fields",function(){return i(5810)}])},30952:function(e,t,i){"use strict";i.d(t,{f:function(){return l}});var n=i(24246),a=i(26917);let l=e=>{let{...t}=e;return(0,n.jsx)(a.Z,{debounce:!0,...t})}},94799:function(e,t,i){"use strict";i.d(t,{k:function(){return l}});var n=i(76649);let a=e=>(0,n.Ln)({id:"string"},e),l=e=>(null!=e?e:[]).filter(a)},30320:function(e,t,i){"use strict";i.d(t,{m:function(){return o}});var n=i(27378),a=i(25980),l=i(17245),s=i(32885),r=i(94799);let o=e=>{let{resourceFidesKey:t,resourceType:i}=e,{errorAlert:o}=(0,l.VY)(),{plus:d}=(0,a.hz)(),u=(0,n.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(i,{skip:!d}),{data:f,isLoading:p,error:h,isError:_}=(0,s.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[x]=(0,s._D)(),y=c.isLoading||m.isLoading||p,v=(0,n.useMemo)(()=>new Map((0,r.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),g=(0,n.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),T=(0,n.useMemo)(()=>new Map((0,r.k)(g).map(e=>[e.id,e])),[g]),S=(0,n.useMemo)(()=>_&&h&&"status"in h&&404===h.status?new Map:new Map((0,r.k)(f).map(e=>[e.custom_field_definition_id,e])),[f,_,h]),j=(0,n.useMemo)(()=>{let e=[...T.keys()];return e.sort(),e},[T]),A=(0,n.useMemo)(()=>{let e={};return g&&S&&g.forEach(t=>{let i=S.get(t.id||"");i&&(t.allow_list_id&&"string[]"===t.field_type?e[i.custom_field_definition_id]=i.value:e[i.custom_field_definition_id]=i.value.toString())}),e},[g,S]),b=(0,n.useCallback)(async e=>{if(!d)return;let n="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!n)return;let{customFieldValues:a}=e;if(!a||0===Object.keys(a).length)return;let l=[],s=[];j.forEach(e=>{let t=S.get(e),i=a[e];void 0===i||""===i||Array.isArray(i)&&0===i.length?(null==t?void 0:t.id)&&s.push(t.id):l.push({custom_field_definition_id:e,resource_id:n,id:null==t?void 0:t.id,value:i})});try{await x({resource_type:i,resource_id:n,upsert:l,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,S,o,t,j,x,i]);return{customFieldValues:A,definitionIdToCustomField:S,idToAllowListWithOptions:v,idToCustomFieldDefinition:T,isEnabled:d,isLoading:y,sortedCustomFieldDefinitionIds:j,upsertCustomFields:b}}},33162:function(e,t,i){"use strict";i.d(t,{uc:function(){return c},JY:function(){return s.J},mZ:function(){return u.m}});var n=i(24246),a=i(10034),l=i(34090),s=i(20987),r=i(30234),o=i(97181),d=i(40324),u=i(30320);let c=e=>{let{resourceFidesKey:t,resourceType:i}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:f,isLoading:p,sortedCustomFieldDefinitionIds:h}=(0,u.m)({resourceFidesKey:t,resourceType:i});return f&&0!==h.length?(0,n.jsx)(r.Z,{heading:"Custom fields",children:(0,n.jsx)(a.ad9,{flexDir:"column","data-testid":"custom-fields-list",children:(0,n.jsx)(a.ad9,{flexDir:"column",gap:"24px",children:p?(0,n.jsx)(a.w4_,{children:(0,n.jsx)(a.Y6B,{})}):h.length>0&&(0,n.jsx)(a.ad9,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:h.map(e=>{let t=m.get(e);if(!t)return null;let i="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,n.jsx)(l.gN,{name:i,children:e=>{let{field:i}=e;return(0,n.jsx)(d.j0,{...i,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let a=c.get(t.allow_list_id);if(!a)return null;let{options:r}=a;return(0,n.jsx)(o.d,{name:i,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};i(94799)},97181:function(e,t,i){"use strict";i.d(t,{d:function(){return d}});var n=i(24246),a=i(10034),l=i(34090),s=i(27378),r=i(46238),o=i(40324);let d=e=>{let{name:t,label:i,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:f,...p}=e,[h,_,{setValue:x}]=(0,l.U$)(t),y=!!(_.touched&&_.error),[v,g]=(0,s.useState)("");h.value||"tags"!==p.mode&&"multiple"!==p.mode||(h.value=[]),"tags"===p.mode&&"string"==typeof h.value&&(h.value=[h.value]);let T="tags"===p.mode?(e,t)=>e?e.value!==v||h.value.includes(v)?p.optionRender?p.optionRender(e,t):e.label:'Create "'.concat(v,'"'):void 0:p.optionRender||void 0,S=e=>{g(e),p.onSearch&&p.onSearch(e)},j=(e,t)=>{x(e),p.onChange&&p.onChange(e,t)};return"inline"===m?(0,n.jsx)(a.DTt,{isInvalid:y,isRequired:c,children:(0,n.jsxs)(a.MoG,{templateColumns:i?"1fr 3fr":"1fr",children:[i?(0,n.jsx)(o.__,{htmlFor:p.id||t,...d,children:i}):null,(0,n.jsxs)(a.kCb,{align:"center",children:[(0,n.jsxs)(a.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,n.jsx)(a.PhF,{...h,id:p.id||t,"data-testid":"controlled-select-".concat(h.name),...p,optionRender:T,onSearch:"tags"===p.mode?S:void 0,onChange:j,value:h.value||void 0,status:y?"error":void 0}),f&&(0,n.jsx)(a.Kug,{children:f}),(0,n.jsx)(o.Bc,{isInvalid:y,message:_.error,fieldName:h.name})]}),(0,n.jsx)(r.b,{label:u,className:y?"mt-2 self-start":void 0})]})]})}):(0,n.jsx)(a.DTt,{isInvalid:y,isRequired:c,children:(0,n.jsxs)(a.s_g,{alignItems:"start",children:[(0,n.jsxs)(a.kCb,{align:"center",children:[i?(0,n.jsx)(o.__,{htmlFor:p.id||t,fontSize:"xs",my:0,mr:1,...d,children:i}):null,(0,n.jsx)(r.b,{label:u})]}),(0,n.jsx)(a.PhF,{...h,id:p.id||t,"data-testid":"controlled-select-".concat(h.name),...p,optionRender:T,onSearch:"tags"===p.mode?S:void 0,onChange:j,value:h.value||void 0,status:y?"error":void 0}),f&&(0,n.jsx)(a.Kug,{style:{marginTop:0},children:f}),(0,n.jsx)(o.Bc,{isInvalid:y,message:_.error,fieldName:h.name})]})})}},94770:function(e,t,i){"use strict";i.d(t,{r:function(){return l}});var n=i(24246),a=i(10034);let l=e=>{let{children:t,...i}=e;return t&&"string"==typeof t?(0,n.jsx)(a.Typography.Text,{ellipsis:{tooltip:t},...i,children:t}):t}},8917:function(e,t,i){"use strict";i.d(t,{Fb:function(){return o},P3:function(){return c},TY:function(){return u},Un:function(){return m},Uv:function(){return a},mJ:function(){return d},uP:function(){return r}});var n,a,l=i(20987),s=i(59001);let r=new Map([[l.J.SYSTEM,"system:information"],[l.J.DATA_USE,"taxonomy:data use"],[l.J.DATA_CATEGORY,"taxonomy:data category"],[l.J.DATA_SUBJECT,"taxonomy:data subject"],[l.J.PRIVACY_DECLARATION,"system:data use"]]),o={[s.ac.DATA_CATEGORY]:"taxonomy:data category",[s.ac.DATA_USE]:"taxonomy:data use",[s.ac.DATA_SUBJECT]:"taxonomy:data subject",[s.ac.SYSTEM_GROUP]:"taxonomy:system group"},d={[s.ac.DATA_CATEGORY]:l.J.DATA_CATEGORY,[s.ac.DATA_USE]:l.J.DATA_USE,[s.ac.DATA_SUBJECT]:l.J.DATA_SUBJECT,[s.ac.SYSTEM_GROUP]:"system group"};(n=a||(a={})).SINGLE_SELECT="singleSelect",n.MULTIPLE_SELECT="multipleSelect",n.OPEN_TEXT="openText";let u=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open text",value:"openText"}],c={singleSelect:"Single-value select",multipleSelect:"Multi-value select",openText:"Open text"},m={[s.ac.DATA_CATEGORY]:"Data category",[s.ac.DATA_USE]:"Data use field",[s.ac.DATA_SUBJECT]:"Data subject",[s.ac.SYSTEM_GROUP]:"System group"}},66236:function(e,t,i){"use strict";i.d(t,{S:function(){return s},_:function(){return l}});var n=i(20987),a=i(8917);let l=e=>e.field_type===n.H.STRING_ARRAY?a.Uv.MULTIPLE_SELECT:e.allow_list_id?a.Uv.SINGLE_SELECT:e.field_type===n.H.STRING?a.Uv.OPEN_TEXT:e.field_type,s=e=>{let t=l(e);return t in a.P3?a.P3[t]:t in a.Un?a.Un[t]:t}},30234:function(e,t,i){"use strict";var n=i(24246),a=i(10034);t.Z=e=>{let{heading:t,HeadingButton:i,children:l}=e;return(0,n.jsx)(a.EO$,{spacing:4,children:(0,n.jsxs)(a.TJV,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,n.jsxs)(a.TJV,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,n.jsx)(a.y_b,{as:"h3",size:"xs",children:t}),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.s3C,{}),i]})]}),(0,n.jsx)(a.EO$,{spacing:4,px:6,py:6,children:l})]})})}},5810:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return E}});var n=i(24246),a=i(77213),l=i(10034),s=i(27378),r=i(58754),o=i(30952),d=i(86677),u=i(33162),c=i(77830),m=i(19904),f=i(94770),p=i(99640),h=i(84450),_=i(8125),x=i(72625),y=i(32885),v=e=>{var t;let{field:i,isDisabled:a}=e,[l,{isLoading:s}]=(0,y.yM)(),r=async e=>l({...i,active:e});return(0,n.jsx)(x.S1,{enabled:null!==(t=i.active)&&void 0!==t&&t,onToggle:r,title:"Disable custom field",message:"Are you sure you want to disable this custom field?",isDisabled:a,"aria-label":i.active?"Disable custom field":"Enable custom field",loading:s})},g=i(66236),T=i(39864),S=i(60240);let j={[u.JY.SYSTEM]:"System",[u.JY.DATA_USE]:"Taxonomy data use",[u.JY.DATA_CATEGORY]:"Data category",[u.JY.DATA_SUBJECT]:"Data subject",[u.JY.PRIVACY_DECLARATION]:"System data use","system group":"System group"};var A=()=>{let e=(0,_.o)({pagination:{defaultPageSize:25,pageSizeOptions:[10,25,50]},search:{defaultSearchQuery:""}}),t=(0,d.useRouter)(),{data:i,isLoading:a}=(0,y.GH)(),{data:r}=(0,T.MU)(),{tableProps:o}=(0,_.V)(e,{dataSource:i||[],totalRows:(null==i?void 0:i.length)||0,isLoading:a,customTableProps:{layout:"fixed",sticky:{offsetHeader:40}}}),u=(0,m.Tg)([S.Sh.CUSTOM_FIELD_UPDATE]);return{tableProps:o,columns:(0,s.useMemo)(()=>[{title:"Name",dataIndex:"name",key:"name",filteredValue:e.searchQuery?[e.searchQuery]:null,onFilter:(e,t)=>t.name.toLowerCase().includes(e.toString().toLowerCase()),render:(e,t)=>{let{id:i,name:a}=t;return(0,n.jsx)(p.Z,{href:"".concat(c.WC,"/").concat(i),children:a})}},{title:"Description",dataIndex:"description",key:"description",render:e=>(0,n.jsx)(f.r,{className:"w-96",children:e}),width:384},{title:"Type",dataIndex:"field_type",key:"field_type",render:(e,t)=>{var i;let a=null==r?void 0:r.find(e=>e.fides_key===t.field_type),l=null!==(i=null==a?void 0:a.name)&&void 0!==i?i:(0,g.S)(t);return(0,n.jsx)(h.Z,{value:l})}},{title:"Applies to",dataIndex:"resource_type",key:"resource_type",render:(e,t)=>{let i,{resource_type:a}=t;if(a in j)i=j[a];else{var l,s;i=null!==(s=null==r?void 0:null===(l=r.find(e=>e.fides_key===a))||void 0===l?void 0:l.name)&&void 0!==s?s:a}return(0,n.jsx)(h.Z,{value:i})}},{title:"Enabled",dataIndex:"active",key:"active",hidden:!u,render:(e,t)=>(0,n.jsx)(v,{field:t,isDisabled:!u}),width:96},{title:"Actions",key:"actions",render:(e,i)=>(0,n.jsx)(l.kCb,{gap:"middle",children:(0,n.jsx)(l.zxk,{size:"small",onClick:()=>t.push("".concat(c.WC,"/").concat(i.id)),"data-testid":"edit-btn",children:"Edit"})}),hidden:!u,width:96}],[r,t,u,e.searchQuery,u]),searchQuery:e.searchQuery,updateSearch:e.updateSearch,onAddClick:()=>t.push("".concat(c.WC,"/new"))}},b=()=>{let{tableProps:e,columns:t,searchQuery:i,updateSearch:a,onAddClick:s}=A();return(0,n.jsxs)(l.kCb,{vertical:!0,gap:"middle","data-testid":"custom-fields-management",children:[(0,n.jsxs)(l.kCb,{justify:"space-between",className:"sticky -top-6 z-10 bg-white py-4",children:[(0,n.jsx)(o.f,{value:i,onChange:a,placeholder:"Search custom fields..."}),(0,n.jsx)(l.zxk,{onClick:s,type:"primary","data-testid":"add-custom-field-btn",children:"Add custom field"})]}),(0,n.jsx)(l.iA_,{...e,columns:t,className:"-mt-4"})]})},E=()=>(0,n.jsxs)(a.Z,{title:"Custom fields",children:[(0,n.jsx)(r.Z,{heading:"Custom fields",isSticky:!1,className:"pb-0",children:(0,n.jsx)(l.Typography.Paragraph,{className:"max-w-screen-md",children:"Custom fields provide organizations with the capability to capture metrics that are unique to their specific needs, allowing them to create customized reports. These fields can be added to either systems or elements within a taxonomy, and once added, they become reportable fields that are visible on the data map."})}),(0,n.jsx)(b,{})]})}},function(e){e.O(0,[431,7245,7552,4899,2888,9774,179],function(){return e(e.s=1770)}),_N_E=e.O()}]);