(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7984],{69453:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/notifications/digests",function(){return s(80181)}])},129:function(e,t,s){"use strict";var i=s(24246),a=s(10034),n=s(86677),r=s(16134),l=s(25980),d=s(77830),o=s(60240),c=s(31793);t.Z=()=>{let e=(0,n.useRouter)(),t=e.pathname,{plus:s}=(0,l.hz)(),u="providers";t.startsWith(d.AD)?u="providers":t.startsWith(d.Wi)?u="templates":t.startsWith(d.DN)&&(u="digests");let h=[{key:"templates",label:"Templates",requiresPlus:!0,scopes:[o.Sh.MESSAGING_TEMPLATE_UPDATE],path:d.Wi},{key:"digests",label:"Digests",requiresPlus:!0,scopes:[o.Sh.DIGEST_CONFIG_READ],path:d.DN},{key:"providers",label:"Providers",requiresPlus:!1,scopes:[o.Sh.MESSAGING_CREATE_OR_UPDATE],path:d.AD}];s||(h=h.filter(e=>!e.requiresPlus));let p=(0,r.C)(c.uu);h=h.filter(e=>e.scopes.some(e=>p.includes(e)));let _=t=>{let s=h.find(e=>e.key===t);s&&e.push(s.path)},g=h.map(e=>({label:e.label,key:e.key}));return(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsx)(a.v2r,{mode:"horizontal",selectedKeys:[u],onClick:e=>{let{key:t}=e;return _(t)},items:g})})}},80181:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var i=s(24246),a=s(10034),n=s(77213),r=s(129),l=s(58754),d=s(86677),o=s(812),c=s(77830),u=s(19904),h=s(26917),p=s(60240),_=s(35493),g=s(40822),m=s(81179),x=s(27378);let y=()=>{var e;let t=(0,d.useRouter)(),[s,i]=(0,x.useState)(""),[a,n]=(0,x.useState)(1),[r,l]=(0,x.useState)(50),o=p.tB.MANUAL_TASKS,h=(0,u.Tg)([p.Sh.DIGEST_CONFIG_CREATE,p.Sh.DIGEST_CONFIG_UPDATE]),_=(0,u.Tg)([p.Sh.DIGEST_CONFIG_DELETE]),{data:m,isLoading:y,refetch:E}=(0,g.Q6)({digest_config_type:o,page:a,size:r}),[f,{isLoading:T}]=(0,g.yG)(),[j,C]=(0,x.useState)(!1),[S,v]=(0,x.useState)(null),N=(0,x.useMemo)(()=>{if(!(null==m?void 0:m.items))return[];if(!s)return m.items;let e=s.toLowerCase();return m.items.filter(t=>{var s;return t.name.toLowerCase().includes(e)||(null===(s=t.description)||void 0===s?void 0:s.toLowerCase().includes(e))})},[null==m?void 0:m.items,s]),b=async()=>{S&&(await f({config_id:S.id,digest_config_type:o}),C(!1),v(null),E())};return{data:N,total:null!==(e=null==m?void 0:m.total)&&void 0!==e?e:0,isLoading:y,page:a,pageSize:r,searchQuery:s,setPage:n,setPageSize:l,setSearchQuery:i,refetch:E,handleEdit:e=>{t.push(c.xn.replace("[id]",e.id))},handleDeleteClick:e=>{v(e),C(!0)},deleteModalOpen:j,configToDelete:S,confirmDelete:b,cancelDelete:()=>{C(!1),v(null)},isDeleting:T,canUpdate:h,canDelete:_}};var E=()=>{let e=(0,d.useRouter)(),t=(0,a.UD8)(),{data:s,total:n,isLoading:r,page:l,pageSize:x,searchQuery:E,setPage:f,setPageSize:T,setSearchQuery:j,handleEdit:C,canUpdate:S}=y(),[v]=(0,g.zb)(),N=(0,u.Tg)([p.Sh.DIGEST_CONFIG_CREATE]),b=async e=>{let s=await v({config_id:e.id,digest_config_type:p.tB.MANUAL_TASKS,data:{name:e.name,description:e.description,digest_type:e.digest_type,enabled:!e.enabled,messaging_service_type:e.messaging_service_type,cron_expression:e.cron_expression,timezone:e.timezone,config_metadata:e.config_metadata}});if((0,o.D4)(s)){t.error((0,o.e$)(s.error));return}t.success('Digest "'.concat(e.name,'" ').concat(e.enabled?"disabled":"enabled"," successfully"))};return(0,i.jsxs)("div",{children:[(0,i.jsxs)(a.kCb,{justify:"space-between",align:"center",className:"mb-4",children:[(0,i.jsx)("div",{className:"w-1/3",children:(0,i.jsx)(h.Z,{value:E,onChange:e=>j(e)})}),N&&(0,i.jsx)(a.zxk,{type:"primary",onClick:()=>{e.push(c.dx)},"data-testid":"add-digest-btn",children:"Create digest"})]}),(0,i.jsx)(a.aVo,{loading:r,itemLayout:"horizontal",dataSource:s,locale:{emptyText:(0,i.jsx)("div",{className:"px-4 py-8 text-center",children:(0,i.jsxs)(a.Typography.Paragraph,{type:"secondary",children:["No digest configurations yet. ",(0,i.jsx)("br",{}),(0,i.jsx)(u.ZP,{scopes:[p.Sh.DIGEST_CONFIG_CREATE],children:'Click "Create digest" to get started.'})]})})},renderItem:e=>(0,i.jsxs)(a.aVo.Item,{actions:S?[(0,i.jsx)(a.zxk,{type:"link",onClick:()=>C(e),"data-testid":"edit-list-btn",className:"px-1",children:"Edit"},"edit")]:[],children:[(0,i.jsx)(a.aVo.Item.Meta,{title:e.name,description:(0,i.jsx)(a.TaI,{direction:"vertical",size:4,children:(0,i.jsxs)(a.TaI,{size:4,children:[(0,i.jsx)(a.Vp9,{children:_.Um[e.digest_type]}),(0,i.jsx)(a.Vp9,{children:_.oU[e.messaging_service_type]})]})})}),(0,i.jsxs)(a.kCb,{align:"center",gap:24,children:[(0,i.jsx)(a.Typography.Text,{children:(0,m.uw)(e.cron_expression)}),S&&(0,i.jsx)(a.rsf,{checked:e.enabled,onChange:()=>b(e),size:"small","data-testid":"toggle-enabled-switch"})]})]},e.id)}),n>x&&(0,i.jsx)(a.kCb,{justify:"end",className:"mt-4",children:(0,i.jsx)(a.tlE,{current:l,total:n,pageSize:x,onChange:(e,t)=>{f(e),t!==x&&T(t)},showSizeChanger:!0,showTotal:e=>"Total ".concat(e," items")})})]})},f=()=>(0,i.jsx)(n.Z,{title:"Notifications",children:(0,i.jsxs)(a.kCb,{vertical:!0,"data-testid":"digests-management",children:[(0,i.jsx)(l.Z,{heading:"Notifications"}),(0,i.jsx)(r.Z,{}),(0,i.jsx)(E,{})]})})}},function(e){e.O(0,[8212,2888,9774,179],function(){return e(e.s=69453)}),_N_E=e.O()}]);