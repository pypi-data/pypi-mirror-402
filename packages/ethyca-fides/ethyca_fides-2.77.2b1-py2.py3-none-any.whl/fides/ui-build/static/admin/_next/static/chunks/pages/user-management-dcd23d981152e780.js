(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{7873:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-management",function(){return n(32802)}])},30952:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var i=n(24246),r=n(26917);let s=e=>{let{...t}=e;return(0,i.jsx)(r.Z,{debounce:!0,...t})}},35287:function(e,t,n){"use strict";var i=n(24246),r=n(10034),s=n(88038),a=n.n(s);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:s,fullWidth:l,mainProps:o}=e;return(0,i.jsxs)(r.ad9,{"data-testid":n,direction:"column",height:s?"100vh":"calc(100vh - 48px)",width:l?"100vw":"calc(100vw - 240px)",children:[(0,i.jsxs)(a(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsx)(r.ad9,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...o,children:t})]})}},58754:function(e,t,n){"use strict";var i=n(24246),r=n(10034),s=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:a=!0,children:l,rightContent:o,style:d,...c}=e;return(0,i.jsxs)("div",{...c,style:a?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,i.jsxs)(r.kCb,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(r.Dxz,{className:n||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!n&&(0,i.jsx)(s.m,{className:l?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),l]})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return a}});var i=n(24246),r=n(16134),s=n(31793);let a=e=>(0,r.C)(s.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return a(t)?(0,i.jsx)(i.Fragment,{children:n}):null}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var i=n(24246),r=n(10034),s=n(79894),a=n.n(s),l=n(27378);let{Text:o}=r.Typography,d=e=>{let{items:t,...n}=e,s=(0,l.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let s=n===t.length-1,l={...e},d=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,i.jsx)(o,{style:{color:"inherit",maxWidth:s?void 0:400},ellipsis:!s,id:s?"breadcrumb-current-page":void 0,children:l.title})),d)?l.title=(0,i.jsx)(r.zxk,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,i.jsx)(a(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,i.jsx)(r.aGc,{items:s,...n})}},99640:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(24246),r=n(10034),s=n(79894),a=n.n(s);let{Link:l,Text:o}=r.Typography,d=e=>{let{href:t,children:n,containerProps:s,strong:d=!0,...c}=e;return n&&(0,i.jsx)(r.kCb,{...s,children:t?(0,i.jsx)(a(),{href:t,passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(l,{strong:d,ellipsis:!0,onClick:e=>e.stopPropagation(),variant:"primary",...c,children:(0,i.jsx)(o,{unStyled:!0,ellipsis:{tooltip:n},children:n})})}):(0,i.jsx)(o,{strong:d,ellipsis:!0,...c,children:n})})}},8125:function(e,t,n){"use strict";n.d(t,{V:function(){return s},o:function(){return d}});var i=n(27378),r=n(32735);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enableSelection:n=!1,getRowKey:s,bulkActions:a,isLoading:l=!1,isFetching:o=!1,dataSource:d=[],totalRows:c=0,currentPage:u,pageSize:p,customTableProps:m={}}=t,h=(0,i.useCallback)(e=>{if(e&&"object"==typeof e){if(e.id)return String(e.id);if(e.key)return String(e.key)}return String(e)},[]),g=s||h,[x,f]=(0,i.useState)([]),[v,b]=(0,i.useState)([]),j=(0,i.useCallback)(()=>{f([]),b([])},[]),y=(0,i.useMemo)(()=>({selectedRowKeys:x,selectedRows:v,resetSelections:j}),[x,v,j]),w=(0,i.useMemo)(()=>{if(n)return{selectedRowKeys:x,onChange:(e,t)=>{f(e),b(t)}}},[n,x]),k=(0,i.useCallback)((t,n,i)=>{var r,s;let a=null!==(r=t.current)&&void 0!==r?r:e.pageIndex,l=null!==(s=t.pageSize)&&void 0!==s?s:e.pageSize,o=a!==e.pageIndex||l!==e.pageSize;o?(t.current&&t.current!==e.pageIndex&&e.updatePageIndex(t.current),t.pageSize&&t.pageSize!==e.pageSize&&e.updatePageSize(t.pageSize)):e.updateFilters(n||{});let d=i&&!Array.isArray(i)?i.field:void 0,c=i&&!Array.isArray(i)&&null!==i.order?i.order:void 0;o||e.updateSorting(d,c)},[e]),S=(0,i.useMemo)(()=>{var t,n,i,s,a;return{current:null!=u?u:e.pageIndex,pageSize:null!=p?p:e.pageSize,total:c,showSizeChanger:null===(s=null===(t=e.paginationConfig)||void 0===t?void 0:t.showSizeChanger)||void 0===s||s,pageSizeOptions:null!==(a=null===(i=e.paginationConfig)||void 0===i?void 0:null===(n=i.pageSizeOptions)||void 0===n?void 0:n.map(String))&&void 0!==a?a:r.VZ}},[u,e.pageIndex,p,e.pageSize,c,e.paginationConfig]),C=(0,i.useMemo)(()=>({dataSource:d,loading:l||o,pagination:S,onChange:k,rowKey:g,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},size:"small",bordered:!0,...m}),[d,l,o,S,k,g,m]),E=x.map(String),_=v.length>0,z=(0,i.useCallback)(e=>{let t=null==a?void 0:a.actions.find(t=>t.key===e);return t?{disabled:!_||!!t.disabled&&t.disabled(v),loading:t.loading||!1,onClick:()=>t.onClick(v)}:{disabled:!0,loading:!1}},[a,_,v]);return(0,i.useMemo)(()=>({tableProps:C,selectionProps:w,selectionState:y,selectedRows:v,selectedKeys:E,hasSelectedRows:_,resetSelections:j,getBulkActionProps:z,isLoadingOrFetching:l||o,hasData:d.length>0}),[C,w,y,v,E,_,j,z,l,o,d.length])};var a=n(40431),l=n(17245);let o=()=>({filters:(0,a.WJ)(e=>e).withDefault({})}),d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{pagination:t={},sorting:n={},search:r={},onStateChange:s,disableUrlState:d=!1}=e,{pageIndex:c,pageSize:u,resetPagination:p,updatePageIndex:m,updatePageSize:h,pageSizeOptions:g,showSizeChanger:x}=(0,l.h0)({...t,disableUrlState:d}),{sortKey:f,sortOrder:v,updateSorting:b,resetSorting:j}=(0,l.rK)({...n,disableUrlState:d}),{searchQuery:y,updateSearch:w,resetSearch:k}=(0,l.Rx)({...r,disableUrlState:d}),[S,C]=(0,i.useState)({}),E=(0,i.useMemo)(()=>d?null:o(),[d]),[_,z]=(0,a.XI)(null!=E?E:{},{history:"push"}),R=(0,i.useMemo)(()=>{var e;return{pageIndex:c,pageSize:u,sortKey:f,sortOrder:v,columnFilters:d?S:null!==(e=_.filters)&&void 0!==e?e:{},searchQuery:y}},[d,S,_,c,u,f,v,y]),A=(0,i.useCallback)((e,t)=>{b(e,t),p()},[b,p]),I=(0,i.useCallback)(e=>{if(d)C(e);else{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return null!=t}));z({filters:Object.keys(t).length>0?t:null})}p()},[d,z,p]),O=(0,i.useCallback)(e=>{w(e),p()},[w,p]),T=(0,i.useCallback)(()=>{d?C({}):z({filters:null}),p(),j(),k()},[d,z,p,j,k]);return(0,i.useEffect)(()=>{s&&s(R)},[R,s]),{state:R,pageIndex:R.pageIndex,pageSize:R.pageSize,updatePageIndex:m,updatePageSize:h,sortKey:R.sortKey,sortOrder:R.sortOrder,updateSorting:A,columnFilters:R.columnFilters,updateFilters:I,searchQuery:R.searchQuery,updateSearch:O,resetState:T,paginationConfig:{pageSizeOptions:g,showSizeChanger:x}}}},61038:function(e,t,n){"use strict";var i=n(24246),r=n(10034),s=n(34090),a=n(86677);n(27378);var l=n(55484),o=n(16134),d=n(40324),c=n(812),u=n(77830),p=n(46628),m=n(65497);let h={username:"",usernameConfirmation:""},g=e=>{let{id:t,username:n,onClose:i}=e,s=(0,r.p8r)(),d=(0,a.useRouter)(),h=(0,o.T)(),[g]=(0,m.I1)();return{handleDeleteUser:async()=>{let e=await g(t);(0,c.D4)(e)?s((0,p.Vo)((0,c.e$)(e.error))):(s((0,p.t5)("Successfully deleted user")),i()),h((0,m.Vv)(void 0)),d.push(u.e3)},validationSchema:l.Ry().shape({usernameConfirmation:l.Z_().required().oneOf([n],"Confirmation input must match the username").label("Username confirmation")})}};t.Z=e=>{let{user:t,...n}=e,{isOpen:a,onClose:l}=n,{handleDeleteUser:o,validationSchema:c}=g({id:t.id,username:t.username,onClose:l});return(0,i.jsxs)(r.TGG,{isCentered:!0,isOpen:a,onClose:l,children:[(0,i.jsx)(r.T5Q,{}),(0,i.jsx)(r.Z8H,{"data-testid":"delete-user-modal",children:(0,i.jsx)(s.J9,{initialValues:h,validationSchema:c,onSubmit:o,children:e=>{let{isSubmitting:n,dirty:a,isValid:o}=e;return(0,i.jsxs)(s.l0,{children:[(0,i.jsx)(r.geD,{children:"Delete User"}),(0,i.jsx)(r.fpf,{}),(0,i.jsxs)(r.zOL,{children:[(0,i.jsxs)(r.Bwi,{status:"warning",overflow:"visible",colorScheme:"warn",marginBottom:4,children:[(0,i.jsx)(r.Pid,{}),(0,i.jsxs)(r.Gdf,{children:[(0,i.jsx)(r.Bjg,{as:"span",mb:2,children:"You are about to delete the user\xa0"}),(0,i.jsxs)(r.Bjg,{as:"span",mb:2,fontStyle:"italic",fontWeight:"semibold",children:[t.username,"."]}),(0,i.jsx)(r.Bjg,{mb:2,children:"This action cannot be undone. To confirm, please enter the userâ€™s username below."})]})]}),(0,i.jsx)(r.EO$,{direction:"column",spacing:4,children:(0,i.jsx)(d.j0,{name:"usernameConfirmation",label:"Confirm username",placeholder:"Type the username to delete"})})]}),(0,i.jsx)(r.NGc,{children:(0,i.jsxs)("div",{className:"flex w-full gap-2",children:[(0,i.jsx)(r.zxk,{onClick:l,className:"w-1/2",children:"Cancel"}),(0,i.jsx)(r.zxk,{type:"primary",disabled:!a||!o,loading:n,htmlType:"submit",className:"w-1/2","data-testid":"submit-btn",children:"Delete User"})]})})]})}})})]})}},91437:function(e,t,n){"use strict";n.d(t,{K:function(){return r}});var i=n(60240);let r=[{label:"Owner",permissions_label:"Owner",roleKey:i.A7.OWNER,description:"Owners have view and edit access to the whole organization and can create new users"},{label:"Contributor",permissions_label:"Contributor",roleKey:i.A7.CONTRIBUTOR,description:"Contributors can create new users and have view and edit access to the whole organization. Contributors cannot configure storage and messaging services"},{label:"Viewer",permissions_label:"Viewer",roleKey:i.A7.VIEWER,description:"Viewers have view access to the Data Map and all systems"},{label:"Viewer & Approver",permissions_label:"Viewer & Approver",roleKey:i.A7.VIEWER_AND_APPROVER,description:"Viewer & Approvers have view access to the Data Map but can also manage Privacy Requests"},{label:"Approver",permissions_label:"Approver",roleKey:i.A7.APPROVER,description:"Approvers can only access the Privacy Requests portal to review, approve, and create new requests"},{label:"Internal respondent",permissions_label:"Internal respondent",roleKey:i.A7.RESPONDENT,description:"Internal respondents have limited access and can only view and complete manual DSR tasks assigned to them"},{label:"External respondent",permissions_label:"External respondent",roleKey:i.A7.EXTERNAL_RESPONDENT,description:"External respondents can only access the external task portal to complete manual DSR tasks assigned to them"}]},32802:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var i=n(24246),r=n(27378),s=n(10034),a=n(79894),l=n.n(a),o=n(16134),d=n(30952),c=n(77830),u=n(19904),p=n(60240),m=n(65497),h=n(91317),g=n(99640),x=n(8125),f=n(91437),v=n(61038);let b=e=>{let{userId:t}=e,{data:n}=(0,m.gU)(t,{skip:!t}),r=[];return n&&n.roles&&n.roles.forEach(e=>{let t=f.K.find(t=>t.roleKey===e);t&&r.push(t.permissions_label)}),(0,i.jsx)(i.Fragment,{children:r.map(e=>(0,i.jsx)(s.Vp9,{"data-testid":"user-permissions-badge",children:e},e))})},j=e=>{let{userId:t}=e,{data:n}=(0,m.d6)(t,{skip:!t});return(0,i.jsx)(s.Vp9,{className:"text-center","data-testid":"user-systems-badge",children:n?n.length:0})},y=e=>{let{user:t}=e,n=(0,s.E2M)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.zxk,{size:"small","aria-label":"delete",icon:(0,i.jsx)(s.PJP.ZNm,{}),onClick:e=>{e.stopPropagation(),n.onOpen()},"data-testid":"delete-user-btn"}),(0,i.jsx)(v.Z,{user:t,...n})]})};var w=()=>{let e=(0,o.C)(h.dy),t=(0,u.Tg)([p.Sh.USER_DELETE]),n=(0,u.Tg)([p.Sh.USER_UPDATE]),a=(0,x.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},search:{defaultSearchQuery:""}}),{pageIndex:l,pageSize:d,searchQuery:f,updateSearch:v}=a,{data:w,isLoading:k,isFetching:S}=(0,m.wv)({page:l,size:d,username:f||void 0}),C=(0,r.useMemo)(()=>{var e,t;return{dataSource:null!==(e=null==w?void 0:w.items)&&void 0!==e?e:[],totalRows:null!==(t=null==w?void 0:w.total)&&void 0!==t?t:0,isLoading:k,isFetching:S,getRowKey:e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""}}},[null==w?void 0:w.items,null==w?void 0:w.total,k,S]),{tableProps:E}=(0,x.V)(a,C);return{tableProps:E,columns:(0,r.useMemo)(()=>[{title:"Username",dataIndex:"username",key:"username",fixed:"left",render:(t,r)=>{let a=!!e&&e.id===r.id,l=n||a;return(0,i.jsxs)(s.kCb,{gap:"small",children:[(0,i.jsx)(g.Z,{href:l?"".concat(c.e3,"/profile/").concat(r.id):void 0,"data-testid":"user-link-".concat(r.id),children:t})," ",r.disabled&&(0,i.jsx)(s.Vp9,{color:"success","data-testid":"invite-sent-badge",children:"Invite sent"})]})}},{title:"Email",dataIndex:"email_address",key:"email_address"},{title:"First name",dataIndex:"first_name",key:"first_name"},{title:"Last name",dataIndex:"last_name",key:"last_name"},{title:"Permissions",key:"permissions",render:(e,t)=>{var n;return(0,i.jsx)(b,{userId:null!==(n=t.id)&&void 0!==n?n:""})}},{title:"Assigned systems",key:"systems",render:(e,t)=>{var n;return(0,i.jsx)(j,{userId:null!==(n=t.id)&&void 0!==n?n:""})}},{title:"Created at",dataIndex:"created_at",key:"created_at",render:e=>e?new Date(e).toUTCString():null},...t?[{title:"",key:"actions",width:80,render:(e,t)=>(0,i.jsx)(y,{user:t})}]:[]],[t,n,e]),searchQuery:f,updateSearch:v}},k=()=>{let{tableProps:e,columns:t,searchQuery:n,updateSearch:a}=w(),h=(0,o.T)();return(0,r.useEffect)(()=>{h((0,m.Vv)(void 0))},[h]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.kCb,{justify:"space-between",className:"mb-4",children:[(0,i.jsx)(d.f,{value:n,onChange:a,placeholder:"Search by username","data-testid":"user-search"}),(0,i.jsx)(u.ZP,{scopes:[p.Sh.USER_CREATE],children:(0,i.jsx)(l(),{href:"".concat(c.e3,"/new"),passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(s.zxk,{type:"primary","data-testid":"add-new-user-btn",children:"Add new user"})})})]}),(0,i.jsx)(s.iA_,{...e,columns:t,"data-testid":"user-management-table",onRow:e=>({"data-testid":"row-".concat(e.id)})})]})},S=n(35287),C=n(58754),E=()=>(0,i.jsxs)(S.Z,{title:"User Management",children:[(0,i.jsx)(C.Z,{heading:"Users",breadcrumbItems:[{title:"All users"}],isSticky:!1}),(0,i.jsx)(k,{})]})}},function(e){e.O(0,[431,7245,2888,9774,179],function(){return e(e.s=7873)}),_N_E=e.O()}]);