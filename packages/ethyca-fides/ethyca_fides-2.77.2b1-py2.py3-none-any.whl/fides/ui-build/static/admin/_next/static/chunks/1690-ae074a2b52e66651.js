"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1690],{58754:function(e,t,r){var n=r(24246),s=r(10034),o=r(70788);t.Z=e=>{let{heading:t,breadcrumbItems:r,isSticky:i=!0,children:a,rightContent:u,style:l,...c}=e;return(0,n.jsxs)("div",{...c,style:i?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...l}:{paddingBottom:"24px",...l},children:[(0,n.jsxs)(s.kCb,{justify:"space-between",children:["string"==typeof t?(0,n.jsx)(s.Dxz,{className:r||a?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,u&&(0,n.jsx)("div",{"data-testid":"page-header-right-content",children:u})]}),!!r&&(0,n.jsx)(o.m,{className:a?"pb-4":void 0,items:r,"data-testid":"page-breadcrumb"}),a]})}},70788:function(e,t,r){r.d(t,{m:function(){return l}});var n=r(24246),s=r(10034),o=r(79894),i=r.n(o),a=r(27378);let{Text:u}=s.Typography,l=e=>{let{items:t,...r}=e,o=(0,a.useMemo)(()=>null==t?void 0:t.map((e,r)=>{let o=r===t.length-1,a={...e},l=a.onClick&&!a.href;return("string"==typeof a.title&&(a.title=(0,n.jsx)(u,{style:{color:"inherit",maxWidth:o?void 0:400},ellipsis:!o,id:o?"breadcrumb-current-page":void 0,children:a.title})),l)?a.title=(0,n.jsx)(s.zxk,{type:"text",size:"small",icon:a.icon,onClick:a.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:a.title}):(a.icon&&(a.title=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"anticon align-text-bottom",children:a.icon}),a.title]})),a.href&&a.title&&(a.title=(0,n.jsx)(i(),{href:a.href,className:"ant-breadcrumb-link",children:a.title}),delete a.href)),a}),[t]);return(0,n.jsx)(s.aGc,{items:o,...r})}},14908:function(e,t,r){var n=r(86677),s=r(27378);let o=e=>e.startsWith("#")?e.slice(1):e;t.Z=e=>{let{tabKeys:t,initialTab:r}=e,i=(0,n.useRouter)(),a=i.asPath.split("#")[1]||t[0],[u,l]=(0,s.useState)(a);return(0,s.useEffect)(()=>{r&&t.includes(r)&&l(r)},[r,t,i.isReady]),{activeTab:u,onTabChange:(0,s.useCallback)(async e=>{if(!t.includes(e)){await i.replace({pathname:i.pathname,query:i.query,hash:void 0}),l(t[0]);return}i.isReady&&(await i.replace({pathname:i.pathname,query:i.query,hash:o(e)},void 0,{shallow:!0}),l(e))},[i,t]),setActiveTab:l}}},37059:function(e,t,r){r.d(t,{$h:function(){return E},Ak:function(){return T},Av:function(){return C},EY:function(){return p},IC:function(){return q},M8:function(){return O},QC:function(){return A},RV:function(){return N},S0:function(){return I},Tj:function(){return y},Ud:function(){return u},Vr:function(){return f},WJ:function(){return c},mL:function(){return R},mi:function(){return h},n7:function(){return b},nP:function(){return m},nS:function(){return g},rs:function(){return d},sX:function(){return v},ut:function(){return _},vc:function(){return D},wi:function(){return l}});var n=r(78780),s=r(16394),o=r(60240),i=r(98145),a=r(71985);let{useGetAggregateMonitorResultsQuery:u,useGetDiscoveredSystemAggregateQuery:l,useGetDiscoveredAssetsQuery:c,useAddMonitorResultSystemsMutation:d,useIgnoreMonitorResultSystemsMutation:m,useAddMonitorResultAssetsMutation:p,useIgnoreMonitorResultAssetsMutation:g,useRestoreMonitorResultAssetsMutation:y,useUpdateAssetsSystemMutation:v,useUpdateAssetsDataUseMutation:T,useUpdateAssetsMutation:f,useGetConsentBreakdownQuery:h,useGetWebsiteMonitorResourceFiltersQuery:_,useGetInProgressMonitorTasksQuery:E,useRetryMonitorTaskMutation:R,useDismissMonitorTaskMutation:A,useUndismissMonitorTaskMutation:S,useGetMonitorTreeQuery:M,useLazyGetMonitorTreeQuery:N,useLazyGetMonitorTreeAncestorsStatusesQuery:O,useGetMonitorConfigQuery:D,useGetDatastoreFiltersQuery:I,useClassifyStagedResourcesMutation:C,useGetStagedResourceDetailsQuery:q,useLazyGetStagedResourceDetailsQuery:w,usePromoteRemovalStagedResourcesMutation:b}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:r=20,search:n,monitor_type:o}=e,i=(0,s.$J)({monitor_type:o});return{url:"/plus/discovery-monitor/aggregate-results?".concat(i.toString()),params:{page:t,size:r,search:n,diff_status:"addition"}}},transformResponse:e=>({...e,items:e.items.map(e=>({...e,monitorType:(0,a.G)(e.connection_type),isTestMonitor:e.connection_type===o.Rj.TEST_WEBSITE||e.connection_type===o.Rj.TEST_DATASTORE}))}),providesTags:["Discovery Monitor Results"]}),getMonitorConfig:e.query({query:e=>{let{monitor_config_id:t}=e;return{url:"/plus/discovery-monitor/".concat(t)}}}),getDatastoreFilters:e.query({query:e=>{let{monitor_config_id:t,staged_resource_urn:r}=e;return{url:"/plus/filters/datastore_monitor_resources?monitor_config_id=".concat(t,"&").concat((0,s.du)(r,"staged_resource_urn"))}}}),getMonitorTree:e.query({query:e=>{let{page:t=1,size:r=20,monitor_config_id:n,staged_resource_urn:s,include_descendant_details:o}=e;return{url:"/plus/discovery-monitor/".concat(n,"/tree"),params:{staged_resource_urn:s,include_descendant_details:o,page:t,size:r}}}}),getMonitorTreeAncestorsStatuses:e.query({query:e=>{let{monitor_config_id:t,staged_resource_urn:r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/tree/ancestors-statuses"),params:{staged_resource_urn:r}}}}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,resolved_system_id:r,page:n=1,size:s=20,search:o,diff_status:i}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,resolved_system_id:r,page:n,size:s,search:o,diff_status:i}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:r,page:n=1,size:a=20,search:u,diff_status:l=[o.LL.ADDITION],sort_by:c=[i.r6.NAME],sort_asc:d=!0,resource_type:m,data_uses:p,locations:g,consent_aggregated:y}=e,v=Array.isArray(c)?c:[c],T=(0,s.$J)({sort_by:v,resource_type:m,data_uses:p,locations:g,consent_aggregated:y});return{url:"/plus/discovery-monitor/".concat(t,"/results?").concat(T.toString()),params:{resolved_system_id:r,page:n,size:a,search:u,diff_status:l,sort_asc:d}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:r}=e,n=(0,s.du)(r,"resolved_system_ids");return{url:"/plus/discovery-monitor/".concat(t,"/promote"),method:"POST",params:n?new URLSearchParams(n):new URLSearchParams}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:r}=e,n=(0,s.du)(r,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let r=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>r.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(r)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>({method:"POST",url:"/plus/discovery-monitor/mute",body:{staged_resource_urns:e.urnList}}),invalidatesTags:["Discovery Monitor Results","Monitor Field Results","Monitor Field Details"]}),restoreMonitorResultAssets:e.mutation({query:e=>{var t;let r=new URLSearchParams({status_to_set:o.LL.ADDITION});return null===(t=e.urnList)||void 0===t||t.forEach(e=>r.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/un-mute?".concat(r)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]}),getConsentBreakdown:e.query({query:e=>{let{stagedResourceUrn:t,statuses:r,page:n=1,size:s=20}=e,o=new URLSearchParams;return o.append("page",String(n)),o.append("size",String(s)),r.forEach(e=>{o.append("status",e)}),{url:"/plus/discovery-monitor/staged_resource/".concat(encodeURIComponent(t),"/consent"),params:o}}}),getStagedResourceDetails:e.query({query:e=>{let{stagedResourceUrn:t}=e;return{url:"/plus/discovery-monitor/staged_resource/".concat(t?encodeURIComponent(t):"")}},providesTags:["Monitor Field Details"]}),getWebsiteMonitorResourceFilters:e.query({query:e=>{let{monitor_config_id:t,resolved_system_id:r,diff_status:n=[o.LL.ADDITION],search:i,resource_type:a,data_uses:u,locations:l,consent_aggregated:c}=e,d={monitor_config_id:t,resolved_system_id:r,diff_status:n};i&&(d.search=i);let m=(0,s.$J)({resource_type:a,data_uses:u,locations:l,consent_aggregated:c}).toString();return{url:m?"/plus/filters/website_monitor_resources?".concat(m):"/plus/filters/website_monitor_resources",params:d}},providesTags:["Discovery Monitor Results"]}),getInProgressMonitorTasks:e.query({query:e=>{let{page:t=1,size:r=20,search:n,task_types:s,statuses:o,return_dismissed:i=!1}=e,a=new URLSearchParams({page:t.toString(),size:r.toString(),return_dismissed:i.toString()});return n&&a.append("search",n),(null==s?void 0:s.length)&&s.forEach(e=>a.append("action_type",e)),(null==o?void 0:o.length)&&o.forEach(e=>a.append("status",e)),{url:"/plus/discovery-monitor/tasks?".concat(a.toString())}},providesTags:["Monitor Tasks"]}),retryMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/retry"),method:"POST"}},invalidatesTags:["Monitor Tasks"]}),dismissMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/dismissed"),method:"POST"}},invalidatesTags:["Monitor Tasks"]}),undismissMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/dismissed"),method:"DELETE"}},invalidatesTags:["Monitor Tasks"]}),classifyStagedResources:e.mutation({query:e=>{let{monitor_config_key:t,...r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/classify"),method:"POST",body:r}},invalidatesTags:["Monitor Field Results","Monitor Field Details","Discovery Monitor Results"]}),promoteRemovalStagedResources:e.mutation({query:e=>{let{monitor_config_key:t,...r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/promote-removal"),method:"POST",body:r}},invalidatesTags:["Monitor Field Results","Monitor Field Details"]})})})},98145:function(e,t,r){r.d(t,{$Q:function(){return M},EI:function(){return c},EP:function(){return f},H6:function(){return _},LM:function(){return T},Lh:function(){return N},Qk:function(){return m},Vq:function(){return v},X1:function(){return y},bE:function(){return A},bI:function(){return d},hc:function(){return E},oq:function(){return S},r6:function(){return u},sv:function(){return R},v8:function(){return h},vQ:function(){return l}});var n,s,o,i,a,u,l,c,d,m,p=r(60240),g=r(88708);let y={[p.lg.WITH_CONSENT]:"Consent respected",[p.lg.WITHOUT_CONSENT]:"Consent ignored",[p.lg.EXEMPT]:"Exempt",[p.lg.UNKNOWN]:"Unknown",[p.lg.PRE_CONSENT]:"Pre-Consent",[p.lg.CMP_ERROR]:"CMP failure",[p.lg.NOT_APPLICABLE]:"Not applicable"},v={[p.lg.WITH_CONSENT]:"Asset was detected after the user gave consent",[p.lg.WITHOUT_CONSENT]:"The user explicitly opted out, but this asset still loaded. This is a serious compliance issue and may indicate that consent settings are not being enforced.",[p.lg.EXEMPT]:"Asset is valid regardless of consent",[p.lg.UNKNOWN]:"Did not find consent information for this asset. You may need to re-run the monitor.",[p.lg.PRE_CONSENT]:"Assets loaded before the user had a chance to give consent. This violates opt-in compliance requirements if your CMP is configured for explicit consent.",[p.lg.CMP_ERROR]:"The Consent Management Platform (CMP) was not detected when the service ran. It likely failed to load or wasn't available.",[p.lg.NOT_APPLICABLE]:"No privacy notices apply to this asset"},T=[p.lg.WITHOUT_CONSENT,p.lg.PRE_CONSENT,p.lg.CMP_ERROR];(n=u||(u={})).NAME="name",n.RESOURCE_TYPE="resource_type",n.SYSTEM="system",n.DATA_USES="data_uses",n.LOCATIONS="locations",n.DOMAIN="domain",n.PAGE="page",n.CONSENT_AGGREGATED="consent_aggregated",n.ACTIONS="actions",(s=l||(l={})).SYSTEM_NAME="system_name",s.TOTAL_UPDATES="total_updates",s.DATA_USE="data_use",s.LOCATIONS="locations",s.DOMAINS="domains",s.ACTIONS="actions",(o=c||(c={})).LOCATION="location",o.PAGE="page",o.STATUS="status";let f=["classified_low_confidence","classified_medium_confidence","classified_high_confidence"],h=new Map([["cookie",["Cookie","Cookies"]],["browser_request",["Browser request","Browser requests"]],["image",["Image","Images"]],["iframe",["iFrame","iFrames"]],["javascript_tag",["JavaScript tag","JavaScript tags"]],["unlabeled",["Unlabeled","Unlabeled"]],["in_review",["Classified","Classified"]],["classifying",["Classifying","Classifying"]],["removals",["Removal","Removals"]],["reviewed",["Reviewed","Reviewed"]]]),_=["cookie","image","javascript_tag","iframe","browser_request","unlabeled","classifying","in_review","reviewed","removals"];(i=d||(d={})).HIGH="High confidence",i.MEDIUM="Medium confidence",i.LOW="Low confidence",(a=m||(m={})).ADD="add",a.IGNORE="ignore",a.RESTORE="restore";let E=[{key:g.A.ATTENTION_REQUIRED,label:"Attention required"},{key:g.A.ADDED,label:"Activity"},{key:g.A.IGNORED,label:"Ignored"}],R=["all","new","active","inactive","known","unknown","removed"],A={all:"All apps",new:"New apps",active:"Active",inactive:"Inactive",known:"Known Vendors",unknown:"Unknown Vendors",removed:"Removed"},S={STATUS:"status-section",VENDOR:"vendor-section"},M=e=>{switch(e){case"new":return p.LL.ADDITION;case"removed":return p.LL.REMOVAL;default:return null}},N=e=>{switch(e){case"active":return"ACTIVE";case"inactive":return"INACTIVE";default:return null}}},88708:function(e,t,r){r.d(t,{A:function(){return s}});var n,s,o=r(27378),i=r(14908),a=r(60240);(n=s||(s={})).ATTENTION_REQUIRED="attention-required",n.ADDED="added",n.IGNORED="ignored",t.Z=e=>{let{activeTab:t,onTabChange:r}=(0,i.Z)({tabKeys:Object.values(s)}),n=(0,o.useMemo)(()=>[{label:"Attention required",params:{diff_status:[a.LL.ADDITION],system:e},hash:"attention-required"},{label:"Added",params:{diff_status:[a.LL.MONITORED]},hash:"added"},{label:"Ignored",params:{diff_status:[a.LL.MUTED],system:e},hash:"ignored"}],[e]),{diff_status:u,system:l}=(0,o.useMemo)(()=>{var e;return null!==(e=n.find(e=>e.hash===t))&&void 0!==e?e:n[0]},[n,t]).params,c=(0,o.useMemo)(()=>u.includes(a.LL.MONITORED),[u]);return{filterTabs:n,activeTab:t,onTabChange:r,activeParams:(0,o.useMemo)(()=>e?{diff_status:u,system:l}:{diff_status:u},[e,u,l]),actionsDisabled:c}}},71985:function(e,t,r){r.d(t,{G:function(){return i},w:function(){return s}});var n,s,o=r(60240);(n=s||(s={})).WEBSITE="website",n.DATASTORE="datastore",n.INFRASTRUCTURE="infrastructure";let i=e=>e===o.Rj.WEBSITE||e===o.Rj.TEST_WEBSITE?"website":e===o.Rj.OKTA?"infrastructure":"datastore"}}]);