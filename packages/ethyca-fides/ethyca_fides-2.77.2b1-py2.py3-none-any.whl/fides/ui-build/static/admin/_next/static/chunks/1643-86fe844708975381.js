(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1643],{77213:function(e,n,t){"use strict";t.d(n,{Z:function(){return f}});var i=t(24246),s=t(10034),r=t(88038),o=t.n(r),a=t(86677);t(27378);var l=t(25980),c=t(90867),u=t(42478),d=t(77830),g=()=>{let e=(0,a.useRouter)();return(0,i.jsx)(s.TJV,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(s.TJV,{children:[(0,i.jsxs)(s.EO$,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(s.Bjg,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(s.zxk,{onClick:()=>{e.push(d.AD)},children:"Configure"})]}),(0,i.jsxs)(s.Bjg,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},f=e=>{let{children:n,title:t,padded:r=!0,mainProps:d}=e,f=(0,l.hz)(),m=(0,a.useRouter)(),y="/privacy-requests"===m.pathname||"/datastore-connection"===m.pathname,p=!(f.flags.messagingConfiguration&&y),{data:x}=(0,u.JE)(void 0,{skip:p}),{data:h}=(0,c.PW)(void 0,{skip:p}),v=f.flags.messagingConfiguration&&(!x||!h)&&y;return(0,i.jsxs)(s.ad9,{"data-testid":t,direction:"column",h:"100vh",children:[(0,i.jsxs)(o(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",t]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(s.ad9,{as:"main",direction:"column",py:r?6:0,px:r?10:0,h:r?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...d,children:[v?(0,i.jsx)(g,{}):null,n]})]})}},54762:function(e,n,t){"use strict";t.d(n,{l:function(){return a}});var i=t(24246),s=t(10034),r=t(62165),o=t(60240);let a=e=>{let{consentStatus:n}=e,{flags:t}=(0,r.hz)(),{assetConsentStatusLabels:a}=t;return a&&(null==n?void 0:n.status)===o.pF.ALERT?(0,i.jsx)(s.ua7,{title:null==n?void 0:n.message,"data-testid":"discovery-status-icon-alert-tooltip",children:(0,i.jsx)("div",{className:"mb-px","data-testid":"discovery-status-icon-alert",children:(0,i.jsx)(s.PJP.OdJ,{style:{color:"var(--fidesui-error)"}})})}):null}},42478:function(e,n,t){"use strict";t.d(n,{FU:function(){return c},JE:function(){return s},Ki:function(){return d},SU:function(){return g},W:function(){return f},h9:function(){return r},jc:function(){return i},qt:function(){return l},sn:function(){return u}});let{useGetEmailInviteStatusQuery:i,useGetActiveMessagingProviderQuery:s,useCreateMessagingConfigurationMutation:r,useCreateMessagingConfigurationSecretsMutation:o,useGetMessagingConfigurationDetailsQuery:a,useGetMessagingConfigurationsQuery:l,useGetMessagingConfigurationByKeyQuery:c,useUpdateMessagingConfigurationByKeyMutation:u,useUpdateMessagingConfigurationSecretsByKeyMutation:d,useCreateTestConnectionMessageMutation:g,useDeleteMessagingConfigurationByKeyMutation:f}=t(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,n,t,i)=>{let s=await i({url:"messaging/default/active"});return s.error&&404===s.error.status?{data:null}:s},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},35887:function(e,n,t){"use strict";t.r(n),t.d(n,{ROOT_ACTION_CENTER_CONFIG:function(){return J},default:function(){return F}});var i=t(24246),s=t(77830),r=t(9431),o=t(15878),a=t(10034),l=t(27378),c=t(30952),u=t(25980),d=t(9270),g=t(37059),f=t(49744),m=t(79894),y=t.n(m);let p=()=>(0,i.jsx)(a.HYy,{image:a.HYy.PRESENTED_IMAGE_SIMPLE,description:"All caught up! Set up an integration monitor to track your infrastructure in greater detail.",children:(0,i.jsx)(y(),{href:s.KH,passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(a.zxk,{type:"primary",children:"Visit integrations"})})});var x=t(40262),h=t(16394),v=t(41337),j=t(83158),C=t(9110),T=t(62678),_=t(31883),E=t(99824),w=t(99089),b=t(63537);let S=e=>{let n=(0,a.ddY)(),[t]=(0,w.rL)(),i=(0,a.UD8)();return{confirmAll:async(s,r)=>{let o=T.FieldActionType.PROMOTE,a=Date.now();if(!await n.confirm((0,b.nB)(E.Me[o],E.e_[o](r))))return;i.open({key:a,type:"loading",content:"".concat(E.T0[o]," ").concat(r," ").concat((0,h._6)(r,"field","fields"),"..."),duration:0});let l=await t({query:{confidence_bucket:[s]},path:{monitor_config_id:e,action_type:o},body:{excluded_resource_urns:[]}});if((0,_.D4)(l)){i.open({key:a,type:"error",content:(0,b.v_)(o),duration:5});return}i.open({key:a,type:"success",content:"".concat(r," ").concat((0,h._6)(r,"field","fields")," approved â€” stronger governance, less busywork."),duration:10})}}},M=e=>{let{item:n,reviewHref:t,onConfirmAll:s}=e,r=[(0,i.jsx)(y(),{href:{pathname:t,query:{confidenceBucket:n.severity}},passHref:!0,children:(0,i.jsx)(a.zxk,{type:"text",size:"small",icon:(0,i.jsx)(a.PJP.ejL,{}),"aria-label":"Review ".concat(n.label," fields"),children:"Review"})},n.label)];return n.severity===j.$.HIGH&&s&&r.push((0,i.jsx)(a.zxk,{type:"text",size:"small",icon:(0,i.jsx)(a.PJP.WzW,{}),"aria-label":"Approve all ".concat(n.label," fields"),onClick:s,children:"Approve"},"confirm")),r},k=e=>{let{item:n,reviewHref:t,monitorId:s}=e,r=(0,b.Oq)(n.severity),{confirmAll:o}=S(s);return(0,i.jsx)(a.Zbd,{size:"small",styles:{body:{display:"none"}},title:(0,i.jsxs)(a.TaI,{children:[(0,i.jsx)(a.qEK,{size:24,icon:(0,i.jsx)(a.QMR,{color:"black"})}),(0,i.jsxs)(a.xvT,{type:"secondary",className:"font-normal",children:[(0,h.pF)(n.count)," ",(0,h._6)(n.count,"field","fields")]}),(0,i.jsx)(a.xvT,{children:n.label}),r&&(0,i.jsx)(C.D,{severity:r,format:()=>null})]}),actions:M({item:n,reviewHref:t,onConfirmAll:()=>{o(n.severity,n.count)}})})};var I=t(98145);let N=e=>{let{confidenceCounts:n,reviewHref:t,monitorId:s,...r}=e,o=(0,l.useMemo)(()=>[{label:I.bI.HIGH,count:n.highConfidenceCount,severity:j.$.HIGH},{label:I.bI.MEDIUM,count:n.mediumConfidenceCount,severity:j.$.MEDIUM},{label:I.bI.LOW,count:n.lowConfidenceCount,severity:j.$.LOW}].filter(e=>e.count>0),[n]);return(0,i.jsx)(a.nxd,{dataSource:o,itemKey:e=>e.severity,columns:3,gutter:4,renderItem:e=>(0,i.jsx)(k,{item:e,reviewHref:t,monitorId:s}),...r})};var R=t(54762),D=t(42905),O=t.n(D);let A=(e,n)=>{let t=I.v8.get(e);return t?(0,h._6)(n,t[0],t[1]):e},H=e=>{let{updates:n,isAssetList:t}=e,s=(0,l.useMemo)(()=>n?Object.entries(n).filter(e=>{let[n,t]=e;return null!==t&&t>0&&!I.EP.includes(n)}).sort((e,n)=>{let t=I.H6.indexOf(e[0]),i=I.H6.indexOf(n[0]);return -1===t&&-1===i?0:-1===t?1:-1===i?-1:t-i}).map(e=>{let[n,t]=e;return"".concat((0,h.pF)(null!=t?t:0)," ").concat(A(n,null!=t?t:0))}):[],[n]);if(!n)return null;if(t){let e=s.join(", ");return(0,i.jsxs)("span",{children:[e," detected."]})}let r=s.join(", ");return(0,i.jsx)("span",{children:r})};var P=t(71985);let{Text:q}=a.Typography,z={[P.w.WEBSITE]:["asset","assets"],[P.w.DATASTORE]:["field","fields"],[P.w.INFRASTRUCTURE]:["system","systems"]},U=e=>{let n,{monitorSummary:t,href:s,...r}=e,{flags:o}=(0,u.hz)(),{heliosV2:c}=o,{name:d,consent_status:g,total_updates:f,updates:m,last_monitored:p,secrets:j,key:C,connection_type:T,saas_config:_,monitorType:E,isTestMonitor:w}=t;if(E===P.w.DATASTORE){var b,S,M;n={highConfidenceCount:null!==(b=null==m?void 0:m.classified_high_confidence)&&void 0!==b?b:0,mediumConfidenceCount:null!==(S=null==m?void 0:m.classified_medium_confidence)&&void 0!==S?S:0,lowConfidenceCount:null!==(M=null==m?void 0:m.classified_low_confidence)&&void 0!==M?M:0}}let[k,I]=(0,l.useState)(!1),D=!!n&&(n.highConfidenceCount>0||n.mediumConfidenceCount>0||n.lowConfidenceCount>0),A=E===P.w.DATASTORE&&D&&!!C,U=p?(0,h.p6)(new Date(p)):void 0,B=p?(0,x.H)(new Date(p),new Date,{addSuffix:!0}):void 0,J=(0,h._6)(null!=f?f:0,z[E][0],z[E][1]);return(0,i.jsx)(a.aVo.Item,{"data-testid":"monitor-result-".concat(C),...r,children:(0,i.jsxs)(a.kCb,{vertical:!0,className:"grow",children:[(0,i.jsxs)(a.X2j,{gutter:{xs:6,lg:12},className:"items-center",children:[(0,i.jsx)(a.JXS,{span:c?14:17,children:(0,i.jsx)(a.aVo.Item.Meta,{avatar:(0,i.jsx)(v.ZP,{data:{kind:v.hY.CONNECTION,connectionType:T,name:d,key:C,saasType:null==_?void 0:_.type,websiteUrl:null==j?void 0:j.url}}),title:(0,i.jsxs)(a.kCb,{align:"center",gap:4,className:O()["monitor-result__title"],children:[(0,i.jsx)(y(),{href:s,"data-testid":"monitor-link",children:d}),(0,i.jsxs)(q,{type:"secondary",children:[(0,h.pF)(null!=f?f:0)," ",J]}),g&&(0,i.jsx)(R.l,{consentStatus:g}),w&&(0,i.jsx)(a.Vp9,{color:"nectar",children:"test monitor"})]}),description:!!m&&(0,i.jsx)(H,{updates:m,isAssetList:E===P.w.WEBSITE})})}),(0,i.jsx)(a.JXS,{span:5,className:"flex justify-end",children:!!B&&(0,i.jsx)(a.ua7,{title:U,children:(0,i.jsxs)(q,{type:"secondary","data-testid":"monitor-date",children:[(0,i.jsx)("span",{className:"hidden lg:inline",children:"Last scan: "}),B]})})}),(0,i.jsxs)(a.JXS,{span:c?5:2,className:"flex items-center justify-end",children:[c&&A&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.zxk,{type:"link",className:"p-0",icon:(0,i.jsx)(a.CHo,{isOpen:k}),iconPosition:"end",onClick:()=>I(!k),"aria-haspopup":"true","aria-expanded":k,"aria-controls":"confidence-row-".concat(C),"aria-label":"".concat(k?"Collapse":"Expand"," findings"),children:(0,i.jsxs)(a.TaI,{children:[(0,i.jsx)(a.QMR,{}),"Findings"]})}),(0,i.jsx)(a.izJ,{type:"vertical",orientationMargin:0})]}),(0,i.jsx)(y(),{href:s,passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(a.zxk,{type:"link",className:"p-0","data-testid":"review-button-".concat(t.key),children:"Review"})},"review")]})]}),c&&A&&n&&(0,i.jsx)(a.RrR,{isExpanded:k,motionKey:"confidence-row-".concat(C),children:(0,i.jsx)(N,{confidenceCounts:n,reviewHref:s,monitorId:C,className:"mt-6",id:"confidence-row-".concat(C)})})]})})};var B=()=>{var e,n,t;let r=(0,a.p8r)(),{flags:{webMonitor:o,heliosV2:m,oktaMonitor:y}}=(0,u.hz)(),{paginationProps:x,pageIndex:h,pageSize:v,resetPagination:j}=(0,d.S)(),[C,T]=(0,l.useState)(""),_=[...o?[P.w.WEBSITE]:[],...m?[P.w.DATASTORE]:[],...y?[P.w.INFRASTRUCTURE]:[]],{data:E,isError:w,isLoading:b}=(0,g.Ud)({page:h,size:v,search:C,monitor_type:_.length>0?[..._]:void 0});(0,l.useEffect)(()=>{j()},[C]),(0,l.useEffect)(()=>{w&&r({title:"Error fetching data",description:"Please try again later",status:"error"})},[w,r]);let S=(null==E?void 0:null===(e=E.items)||void 0===e?void 0:e.flatMap(e=>e.key&&void 0!==e.key?[e]:[]))||[];return o||m||y?(0,i.jsxs)(a.kCb,{className:"h-[calc(100%-48px)] overflow-hidden",gap:"middle",vertical:!0,children:[(0,i.jsx)(a.kCb,{className:"justify-between ",children:(0,i.jsx)(c.f,{value:C,onChange:T})}),(0,i.jsx)(a.aVo,{loading:b,dataSource:S,locale:{emptyText:(0,i.jsx)(p,{})},className:"h-full overflow-y-auto overflow-x-clip",renderItem:e=>{let n=e.key&&e.monitorType?"".concat(s.vi,"/").concat(e.monitorType,"/").concat(e.key):"";return!!(null==e?void 0:e.key)&&(0,i.jsx)(U,{monitorSummary:e,href:n},e.key)}}),(0,i.jsx)(a.tlE,{...x,total:(null==E?void 0:E.total)||0,showSizeChanger:{suffixIcon:(0,i.jsx)(a.PJP._ME,{})},hideOnSinglePage:(null===(n=x.pageSize)||void 0===n?void 0:n.toString())===(null===(t=x.pageSizeOptions)||void 0===t?void 0:t[0])})]}):(0,i.jsx)(f.n,{})};let J={[o.em.ACTIVITY]:s.Bp,[o.em.ATTENTION_REQUIRED]:s.vi};var F=()=>(0,i.jsx)(r.Z,{routeConfig:J,children:(0,i.jsx)(B,{})})},42905:function(e){e.exports={"monitor-result__title":"MonitorResult_monitor-result__title__Wqv_l"}},40262:function(e,n,t){"use strict";t.d(n,{H:function(){return u}});var i=t(10969),s=t(60145),r=t(11558),o=t(70641),a=t(7317),l=t(85302),c=t(64892);function u(e,n,t){let u;let d=(0,s.j)(),g=t?.locale??d.locale??i._,f=(0,l.U)(e,n);if(isNaN(f))throw RangeError("Invalid time value");let m=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:f}),[y,p]=(0,a.d)(t?.in,...f>0?[n,e]:[e,n]),x=(0,r.u)(t?.roundingMethod??"round"),h=p.getTime()-y.getTime(),v=h/c.yJ,j=(h-((0,o.D)(p)-(0,o.D)(y)))/c.yJ,C=t?.unit;if("second"===(u=C||(v<1?"second":v<60?"minute":v<c.H_?"hour":j<c.fH?"day":j<c.UU?"month":"year"))){let e=x(h/1e3);return g.formatDistance("xSeconds",e,m)}if("minute"===u){let e=x(v);return g.formatDistance("xMinutes",e,m)}if("hour"===u){let e=x(v/60);return g.formatDistance("xHours",e,m)}if("day"===u){let e=x(j/c.H_);return g.formatDistance("xDays",e,m)}if("month"===u){let e=x(j/c.fH);return 12===e&&"month"!==C?g.formatDistance("xYears",1,m):g.formatDistance("xMonths",e,m)}{let e=x(j/c.UU);return g.formatDistance("xYears",e,m)}}}}]);