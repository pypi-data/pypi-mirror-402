[package]
name = "pybond"
version = { workspace = true }
edition = { workspace = true }

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html
[lib]
name = "pybond"
crate-type = ["cdylib"]

[features]
default = ["download", "pnl", "batch", "persist"]
# numpy = ["dep:numpy", "tevec/ndarray"]
download = ["tea-bond/download"]
duckdb = ["tea-bond/duckdb"]
pnl = [
    "tea-bond/pnl",
    "tevec/polars",
    "tevec/polars-struct",
    "tevec/time",
    "pyo3-polars",
]
batch = ["serde", "itertools"]
persist = ["tevec/polars", "pyo3-polars"]

[dependencies]
tea-time = { workspace = true }
bincode = {version = "2"}
pyo3 = { version = "0.26", features = [
    "chrono",
    "extension-module",
    "abi3-py38",
    "anyhow",
    "multiple-pymethods",
] }
tea-bond = { path = "../tea-bond", default-features = false}
bond-ffi = { path = "../bond-ffi", default-features = false}
chrono = { version = "0.4", default-features = false }
serde = { version = "1.0", features = ["derive"], optional = true }
itertools = { version = "0.14", optional = true }
tevec = { git = "https://github.com/teamon9161/tevec.git", rev = "db7a7b8", optional = true, default-features = false}
pyo3-polars = { version = "0.25", optional = true, features = ["derive"] }
anyhow = "1"
serde_json = "1.0.148"
