"""tesserapiv1.

This file was automatically generated by APIMATIC v3.0 ( https://www.apimatic.io ).
"""

# ruff: noqa: D410, E501, E101, D206
from apimatic_core.authentication.multiple.single_auth import (
    Single,
)
from apimatic_core.request_builder import RequestBuilder
from apimatic_core.response_handler import ResponseHandler
from apimatic_core.types.parameter import Parameter

from tesserapiv1.api_helper import APIHelper
from tesserapiv1.configuration import Server
from tesserapiv1.controllers.base_controller import (
    BaseController,
)
from tesserapiv1.http.http_method_enum import (
    HttpMethodEnum,
)
from tesserapiv1.models.payment_response import (
    PaymentResponse,
)


class ExperimentalController(BaseController):
    """A Controller to access Endpoints in the tesserapiv1 API."""

    def __init__(self, config):
        """Initialize ExperimentalController object."""
        super(ExperimentalController, self).__init__(config)

    def execute_payment(self,
                        payment_id,
                        step_id,
                        authorization,
                        body):
        """Perform a POST request to /payments/{payment_id}/steps/{step_id}.

        Accepts a signature for a payment step. Currently echoes the request,
        structured for future execution logic.

        Args:
            payment_id (str): Payment ID to execute.
            step_id (str): Transfer step ID to execute.
            authorization (str): Bearer token for authentication.   To obtain a
                token, make a request to Auth0:  ```bash curl --request POST \
                --url https://dev-awqy75wdabpsnsvu.us.auth0.com/oauth/token \
                --header 'content-type: application/json' \   --data '{
                "client_id":"YOUR_CLIENT_ID",
                "client_secret":"YOUR_CLIENT_SECRET",
                "audience":"https://sandbox.tesserx.co",
                "grant_type":"client_credentials"   }' ```  The response will contain
                an `access_token` field which should be used as the Bearer token.
            body (ExecutePaymentRequestDto): The request body parameter.

        Returns:
            PaymentResponse: Response from the API. Payment execution accepted

        Raises:
            APIException: When an error occurs while fetching the data from the
                remote API. This exception includes the HTTP Response code, an error
                message, and the HTTP body that was received in the request.

        """
        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.DEFAULT)
            .path("/payments/{payment_id}/steps/{step_id}")
            .http_method(HttpMethodEnum.POST)
            .template_param(Parameter()
                .key("payment_id")
                .value(payment_id)
                .should_encode(True))
            .template_param(Parameter()
                .key("step_id")
                .value(step_id)
                .should_encode(True))
            .header_param(Parameter()
                .key("Authorization")
                .value(authorization))
            .header_param(Parameter()
                .key("Content-Type")
                .value("application/json"))
            .body_param(Parameter()
                .value(body))
            .header_param(Parameter()
                .key("accept")
                .value("application/json"))
            .body_serializer(APIHelper.json_serialize)
            .auth(Single("bearer")),
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(PaymentResponse.from_dictionary),
        ).execute()
