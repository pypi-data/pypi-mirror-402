"""Default prompts for analysis pipeline steps.

These prompts are used when no custom prompts are provided in the configuration.
They are designed for Japanese language analysis.
"""

EXTRACTION_PROMPT = """あなたは専門的なリサーチアシスタントです。与えられたテキストから、意見を抽出して整理してください。

# 指示
* 入出力の例に記載したような形式で文字列のリストを返してください
  * 必要な場合は2つの別個の意見に分割してください。多くの場合は1つの議論にまとめる方が望ましいです。
* 整理した意見は日本語で出力してください

## 入出力の例
/human

AIテクノロジーは、そのライフサイクル全体における環境負荷を削減することに焦点を当てて開発されるべきです。

/ai

{
  "extractedOpinionList": [
    "AIテクノロジーは、そのライフサイクル全体における環境負荷を削減することに焦点を当てて開発されるべきです。"
  ]
}

/human

AIの能力、限界、倫理的考慮事項について、市民を教育する必要がある。また、教育できる人材を養成する必要がある。

/ai

{
  "extractedOpinionList": [
    "AIの能力、限界、倫理的考慮事項について、市民を教育すべき",
    "AIに関する教育をできる人材を養成すべき"
  ]
}

/human

AIはエネルギーグリッドを最適化し、無駄や炭素排出を削減できます。

/ai

{
  "extractedOpinionList": [
    "AIはエネルギーグリッドを最適化して炭素排出を削減できる"
  ]
}
"""

INITIAL_LABELLING_PROMPT = """あなたはKJ法が得意なデータ分析者です。userのinputはグループに集まったラベルです。なぜそのラベルが一つのグループであるか解説し、表札（label）をつけてください。
表札については、グループ内の具体的な論点や特徴を反映した、具体性の高い名称を考案してください。
出力はJSONとし、フォーマットは以下のサンプルを参考にしてください。


# サンプルの入出力
## 入力例
- 手作業での意見分析は時間がかかりすぎる。AIで効率化できると嬉しい
- 今のやり方だと分析に工数がかかりすぎるけど、AIならコストをかけずに分析できそう
- AIが自動で意見を整理してくれると楽になって嬉しい


## 出力例
{
    "label": "AIによる業務効率の大幅向上とコスト効率化",
    "description": "この意見グループは、従来の手作業による意見分析と比較して、AIによる自動化で分析プロセスが効率化され、作業時間の短縮や運用コストの効率化が実現される点に対する前向きな評価が中心です。"
}
"""

MERGE_LABELLING_PROMPT = """あなたはデータ分析のエキスパートです。
現在、テキストデータの階層クラスタリングを行っています。
下層のクラスタ（意見グループ）のタイトルと説明、およびそれらのクラスタが所属する上層のクラスタのテキストのサンプルを与えるので、上層のクラスタのタイトルと説明を作成してください。

# 指示
- 統合後のクラスタ名は、統合前のクラスタ名称をそのまま引用せず、内容に基づいた新たな名称にしてください。
- タイトルには、具体的な事象・行動（例：地域ごとの迅速対応、復興計画の着実な進展、効果的な情報共有・地域協力など）を含めてください
  - 可能な限り具体的な表現を用いるようにし、抽象的な表現は避けてください
    - 「多様な意見」などの抽象的な表現は避けてください
- 出力例に示したJSON形式で出力してください


# サンプルの入出力
## 入力例
- 「顧客フィードバックの自動集約」: この意見グループは、SNSやオンラインレビューなどから集めた大量の意見をAIが瞬時に解析し、企業が市場のトレンドや顧客の要望を即時に把握できる点についての期待を示しています。
- 「AIによる業務効率の大幅向上とコスト効率化」: この意見グループは、従来の手作業による意見分析と比較して、AIによる自動化で分析プロセスが効率化され、作業時間の短縮や運用コストの効率化が実現される点に対する前向きな評価が中心です。

## 出力例
{
    "label": "AI技術の導入による意見分析の効率化への期待",
    "description": "大量の意見やフィードバックから迅速に洞察を抽出できるため、企業や自治体が消費者や市民の声を的確に把握し、戦略的な意思決定やサービス改善が可能になります。また、従来の手法と比べて作業負荷が軽減され、業務効率の向上やコスト削減といった実際の便益が得られると期待されています。"
}
"""

OVERVIEW_PROMPT = """/system

あなたはシンクタンクで働く専門のリサーチアシスタントです。
チームは特定のテーマに関してパブリック・コンサルテーションを実施し、異なる選択肢の意見グループを分析し始めています。
これから意見グループのリストとその簡単な分析が提供されます。
あなたの仕事は、調査結果の簡潔な要約を返すことです。要約は非常に簡潔に（最大で1段落、最大4文）まとめ、無意味な言葉を避けてください。
出力は日本語で行ってください。
"""


# Mapping from step names to default prompts
DEFAULT_PROMPTS = {
    "extraction": EXTRACTION_PROMPT,
    "hierarchical_initial_labelling": INITIAL_LABELLING_PROMPT,
    "hierarchical_merge_labelling": MERGE_LABELLING_PROMPT,
    "hierarchical_overview": OVERVIEW_PROMPT,
}


def get_default_prompt(step_name: str) -> str | None:
    """Get the default prompt for a step.

    Args:
        step_name: Name of the pipeline step

    Returns:
        Default prompt string, or None if no default exists
    """
    return DEFAULT_PROMPTS.get(step_name)
