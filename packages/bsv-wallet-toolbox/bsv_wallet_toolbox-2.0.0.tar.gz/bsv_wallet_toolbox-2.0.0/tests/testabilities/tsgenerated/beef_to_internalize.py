"""TS-generated BEEF for internalization testing.

This module provides the parent BEEF transaction that can be internalized,
used to test the Internalize -> Create -> Process flow.

Reference: go-wallet-toolbox/pkg/internal/testabilities/tsgenerated/beef_to_internalize.go

ParentBEEF contains a transaction on testnet that sends funds to testusers.Alice
(identityKey: 0320bbfb879bbd6761ecd2962badbb41ba9d60ca88327d78b07ae7141af6b6c810)
Address: mvpQZzaN5wMBeMtDjvDTLy8HJd7boN5hf2
DerivationPrefix: Pr==
DerivationSuffix: Su==
SenderIdentityKey: fixtures.AnyoneIdentityKey (0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798)
OutputIndex: 0

https://test.whatsonchain.com/tx/756754d5ad8f00e05c36d89a852971c0a1dc0c10f20cd7840ead347aff475ef6
"""

# Parent BEEF hex (exact copy from Go version)
# Reference: go-wallet-toolbox/pkg/internal/testabilities/tsgenerated/beef_to_internalize.go
PARENT_BEEF = (
    "0200beef01fead3c1900010200008a6540c8a5fa38e3d9b3490265349c70530afd29d05476856fdfcaeed2382de20102febb"
    "adb847cde73a1194ffc0546ca9f89b3b3a9c3f06351dbccae1ac850d0d8e0201000100000003ea3699e936e903adf9ea7927"
    "701a489416b7b7a8253839566cf346cefd223f66640000006b483045022100eba68131ae2bd182406060c6b18c299e6ba36e"
    "464808077aecdbcea12f6bb9300220069bc510a74853e9abb795e2a1819638616046a8d48f8cce46c7a7b3ec77c85a412102"
    "92acdb57c788c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4ffffffff197a8fdaea1dc1229459b8754416"
    "478ed66a2dc65c223d5aba5227017b90dca3000000006a47304402203119abdf58803d3d42632f989e5f6d0f22da94b0773f"
    "ce0ec8317a175164f07c0220015433c37fac0295bf48562ab3888b8530321ab099b32655c3bcb26af3d0e82d41210292acdb"
    "57c788c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4ffffffff05c3b833d3e0adc7d55e76d051a5532d84"
    "feb50997a54038b2e0bbd78482eae9000000006a4730440220662a339d988c2cffd27a99c6e15566589a37a9478fb79f0f3c"
    "1d0ec95147c7db02206e7b8e62e769dec656f1886caa2f61fcaa82034ffada81b3196085159c6ffadf41210292acdb57c788"
    "c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4ffffffff65a0860100000000001976a9144d7eb7ce5ce099"
    "dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0"
    "860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5c"
    "e099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88"
    "aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7"
    "ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e4811"
    "3f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d"
    "7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e"
    "48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9"
    "144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c"
    "2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601000000000019"
    "76a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f8"
    "1d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000"
    "001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383"
    "f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca086010000"
    "0000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd21"
    "8383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601"
    "00000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099"
    "dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0"
    "860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5c"
    "e099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88"
    "aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7"
    "ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e4811"
    "3f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d"
    "7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e"
    "48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9"
    "144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c"
    "2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601000000000019"
    "76a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f8"
    "1d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000"
    "001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383"
    "f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca086010000"
    "0000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd21"
    "8383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601"
    "00000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099"
    "dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0"
    "860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5c"
    "e099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88"
    "aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7"
    "ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e4811"
    "3f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d"
    "7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e"
    "48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9"
    "144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c"
    "2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601000000000019"
    "76a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f8"
    "1d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000"
    "001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383"
    "f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca086010000"
    "0000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd21"
    "8383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601"
    "00000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099"
    "dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0"
    "860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5c"
    "e099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88"
    "aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7"
    "ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e4811"
    "3f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d"
    "7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e"
    "48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9"
    "144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c"
    "2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601000000000019"
    "76a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f8"
    "1d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000"
    "001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383"
    "f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca086010000"
    "0000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd21"
    "8383f3f81d3c2f1e48113f88aca0860100000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88aca08601"
    "00000000001976a9144d7eb7ce5ce099dd218383f3f81d3c2f1e48113f88acd0b54b69300000001976a9144d7eb7ce5ce099"
    "dd218383f3f81d3c2f1e48113f88ac00000000000100000001febbadb847cde73a1194ffc0546ca9f89b3b3a9c3f06351dbc"
    "cae1ac850d0d8e440000006a47304402202d8ce7a2132e07881518ce9534dc97a9363c1a8a1e860e72ca1528214ade7bf502"
    "20791b22bd40f9a0ef960dd1175a2ffe40132496ffefe61e9175e77b9c3ef1c1ca41210292acdb57c788c1e8c83cdb0ae8f2"
    "3e079139ba7ba1bccf67b31653c7af12c4b4ffffffff0140860100000000001976a914a7d6e4270f5c90cc9e272586a6a509"
    "9663572d5988ac00000000"
)

# Transaction ID of the parent BEEF
PARENT_BEEF_TXID = "756754d5ad8f00e05c36d89a852971c0a1dc0c10f20cd7840ead347aff475ef6"

# Block height where this transaction was mined
BEEF_TO_INTERNALIZE_HEIGHT = 1653933

# Merkle root at this height
BEEF_TO_INTERNALIZE_MERKLE_ROOT = "6ee2e72ad8ca8db54d8272875d4b6a53f3afe194d82c1f71369a2983f6a343c8"

# Derivation info for the internalized output
DERIVATION_PREFIX = "Pr=="
DERIVATION_SUFFIX = "Su=="

# Sender identity key (anyone key)
SENDER_IDENTITY_KEY = "0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"


def parent_beef_bytes() -> bytes:
    """Get the parent BEEF as bytes.

    Returns:
        bytes: The BEEF raw bytes
    """
    return bytes.fromhex(PARENT_BEEF)


def parent_transaction_atomic_beef() -> bytes:
    """Get the parent transaction as AtomicBEEF bytes.

    This is equivalent to Go's ParentTransactionAtomicBeef(t) function.
    It converts the BEEF V2 format to AtomicBEEF format for the target transaction.

    Returns:
        bytes: The AtomicBEEF bytes for internalization

    Note:
        This imports bsv lazily to avoid circular imports.
    """
    from bsv.transaction.beef import new_beef_from_bytes

    beef_bytes = parent_beef_bytes()
    beef = new_beef_from_bytes(beef_bytes)

    # Find the parent transaction
    beef_tx = beef.find_transaction(PARENT_BEEF_TXID)
    if beef_tx is None:
        raise ValueError(f"Parent transaction {PARENT_BEEF_TXID} not found in BEEF")

    # Convert to AtomicBEEF format for the target transaction
    atomic_bytes = beef.to_binary_atomic(PARENT_BEEF_TXID)
    return atomic_bytes


# Expected internalization result
EXPECTED_INTERNALIZE_RESULT = {
    "accepted": True,
    "isMerge": False,
    "txid": PARENT_BEEF_TXID,
    "satoshis": 99904,
}
