"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .manualfeedbackinfo import ManualFeedbackInfo, ManualFeedbackInfoTypedDict
from .manualfeedbacksidebysideinfo import (
    ManualFeedbackSideBySideInfo,
    ManualFeedbackSideBySideInfoTypedDict,
)
from .seenfeedbackinfo import SeenFeedbackInfo, SeenFeedbackInfoTypedDict
from .sessioninfo import SessionInfo, SessionInfoTypedDict
from .user import User, UserTypedDict
from .userviewinfo import UserViewInfo, UserViewInfoTypedDict
from .workflowfeedbackinfo import WorkflowFeedbackInfo, WorkflowFeedbackInfoTypedDict
from datetime import datetime
from enum import Enum
from glean.api_client.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import model_serializer
from typing import List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


class FeedbackCategory(str, Enum):
    r"""The feature category to which the feedback applies. These should be broad product areas such as Announcements, Answers, Search, etc. rather than specific components or UI treatments within those areas."""

    ANNOUNCEMENT = "ANNOUNCEMENT"
    AUTOCOMPLETE = "AUTOCOMPLETE"
    COLLECTIONS = "COLLECTIONS"
    FEED = "FEED"
    SEARCH = "SEARCH"
    CHAT = "CHAT"
    NTP = "NTP"
    WORKFLOWS = "WORKFLOWS"
    SUMMARY = "SUMMARY"
    GENERAL = "GENERAL"
    PRISM = "PRISM"
    PROMPTS = "PROMPTS"


class Event(str, Enum):
    r"""The action the user took within a Glean client with respect to the object referred to by the given `trackingToken`."""

    # The object's primary link was clicked with the intent to view its full representation. Depending on the object type, this may imply an external navigation or navigating to a new page or view within the Glean app.
    CLICK = "CLICK"
    # A link to the object's parent container (e.g. the folder in which it's located) was clicked.
    CONTAINER_CLICK = "CONTAINER_CLICK"
    # The user copied a link to the primary link.
    COPY_LINK = "COPY_LINK"
    # The user creates a document.
    CREATE = "CREATE"
    # The user dismissed the object such that it was hidden from view.
    DISMISS = "DISMISS"
    # The user gave feedback that the object was not useful.
    DOWNVOTE = "DOWNVOTE"
    # The user attempted to send an email.
    EMAIL = "EMAIL"
    # The user executed the object (e.g. ran a workflow).
    EXECUTE = "EXECUTE"
    # The user applied a filter.
    FILTER = "FILTER"
    # The first token of a streaming response is received.
    FIRST_TOKEN = "FIRST_TOKEN"
    # The user clicked into an interactive element, e.g. the search box.
    FOCUS_IN = "FOCUS_IN"
    # The final token of a streaming response is received.
    LAST_TOKEN = "LAST_TOKEN"
    # The user submitted textual manual feedback regarding the object.
    MANUAL_FEEDBACK = "MANUAL_FEEDBACK"
    # The user submitted comparative feedback for multiple side-by-side implementations.
    MANUAL_FEEDBACK_SIDE_BY_SIDE = "MANUAL_FEEDBACK_SIDE_BY_SIDE"
    # The user explicitly marked the content as read.
    MARK_AS_READ = "MARK_AS_READ"
    # The user attempted to send a message using their default messaing app.
    MESSAGE = "MESSAGE"
    # The user middle clicked the object's primary link with the intent to open its full representation in a new tab.
    MIDDLE_CLICK = "MIDDLE_CLICK"
    # The user puts a page out of focus but keeps it in the background.
    PAGE_BLUR = "PAGE_BLUR"
    # The user puts a page in focus, meaning it is the first to receive keyboard events.
    PAGE_FOCUS = "PAGE_FOCUS"
    # The user leaves a page and it is unloaded (by clicking a link, closing the tab/window, etc).
    PAGE_LEAVE = "PAGE_LEAVE"
    # The user clicked the object's inline preview affordance.
    PREVIEW = "PREVIEW"
    RELATED_CLICK = "RELATED_CLICK"
    # The user right clicked the object's primary link. This may indicate an intent to open it in a new tab or copy it.
    RIGHT_CLICK = "RIGHT_CLICK"
    # The user clicked a link to a subsection of the primary object.
    SECTION_CLICK = "SECTION_CLICK"
    # The user has likely seen the object (e.g. took action to make the object visible within the user's viewport).
    SEEN = "SEEN"
    # The user explicitly selected something, eg. a chat response variant they prefer.
    SELECT = "SELECT"
    # The user shared the object with another user.
    SHARE = "SHARE"
    # The user clicked the object's show more affordance.
    SHOW_MORE = "SHOW_MORE"
    # The user gave feedback that the object was useful.
    UPVOTE = "UPVOTE"
    # The object was visible within the user's viewport.
    VIEW = "VIEW"
    # The object was visible within the user's viewport.
    VISIBLE = "VISIBLE"


class FeedbackChannel(str, Enum):
    COMPANY = "COMPANY"
    GLEAN = "GLEAN"


class FeedbackTypedDict(TypedDict):
    tracking_tokens: List[str]
    r"""A list of server-generated trackingTokens to which this event applies."""
    event: Event
    r"""The action the user took within a Glean client with respect to the object referred to by the given `trackingToken`."""
    id: NotRequired[str]
    r"""Universally unique identifier of the event. To allow for reliable retransmission, only the earliest received event of a given UUID is considered valid by the server and subsequent are ignored."""
    category: NotRequired[FeedbackCategory]
    r"""The feature category to which the feedback applies. These should be broad product areas such as Announcements, Answers, Search, etc. rather than specific components or UI treatments within those areas."""
    position: NotRequired[int]
    r"""Position of the element in the case that the client controls order (such as feed and autocomplete)."""
    payload: NotRequired[str]
    r"""For type MANUAL_FEEDBACK, contains string of user feedback. For autocomplete, partial query string. For feed, string of user feedback in addition to manual feedback signals extracted from all suggested content."""
    session_info: NotRequired[SessionInfoTypedDict]
    timestamp: NotRequired[datetime]
    r"""The ISO 8601 timestamp when the event occured."""
    user: NotRequired[UserTypedDict]
    pathname: NotRequired[str]
    r"""The path the client was at when the feedback event triggered."""
    channels: NotRequired[List[FeedbackChannel]]
    r"""Where the feedback will be sent, e.g. to Glean, the user's company, or both. If no channels are specified, feedback will go only to Glean."""
    url: NotRequired[str]
    r"""The URL the client was at when the feedback event triggered."""
    ui_tree: NotRequired[List[str]]
    r"""The UI element tree associated with the event, if any."""
    ui_element: NotRequired[str]
    r"""The UI element associated with the event, if any."""
    manual_feedback_info: NotRequired[ManualFeedbackInfoTypedDict]
    manual_feedback_side_by_side_info: NotRequired[
        ManualFeedbackSideBySideInfoTypedDict
    ]
    seen_feedback_info: NotRequired[SeenFeedbackInfoTypedDict]
    user_view_info: NotRequired[UserViewInfoTypedDict]
    workflow_feedback_info: NotRequired[WorkflowFeedbackInfoTypedDict]
    application_id: NotRequired[str]
    r"""The application ID of the client that sent the feedback event."""
    agent_id: NotRequired[str]
    r"""The agent ID of the client that sent the feedback event."""


class Feedback(BaseModel):
    tracking_tokens: Annotated[List[str], pydantic.Field(alias="trackingTokens")]
    r"""A list of server-generated trackingTokens to which this event applies."""

    event: Event
    r"""The action the user took within a Glean client with respect to the object referred to by the given `trackingToken`."""

    id: Optional[str] = None
    r"""Universally unique identifier of the event. To allow for reliable retransmission, only the earliest received event of a given UUID is considered valid by the server and subsequent are ignored."""

    category: Optional[FeedbackCategory] = None
    r"""The feature category to which the feedback applies. These should be broad product areas such as Announcements, Answers, Search, etc. rather than specific components or UI treatments within those areas."""

    position: Optional[int] = None
    r"""Position of the element in the case that the client controls order (such as feed and autocomplete)."""

    payload: Optional[str] = None
    r"""For type MANUAL_FEEDBACK, contains string of user feedback. For autocomplete, partial query string. For feed, string of user feedback in addition to manual feedback signals extracted from all suggested content."""

    session_info: Annotated[
        Optional[SessionInfo], pydantic.Field(alias="sessionInfo")
    ] = None

    timestamp: Optional[datetime] = None
    r"""The ISO 8601 timestamp when the event occured."""

    user: Optional[User] = None

    pathname: Optional[str] = None
    r"""The path the client was at when the feedback event triggered."""

    channels: Optional[List[FeedbackChannel]] = None
    r"""Where the feedback will be sent, e.g. to Glean, the user's company, or both. If no channels are specified, feedback will go only to Glean."""

    url: Optional[str] = None
    r"""The URL the client was at when the feedback event triggered."""

    ui_tree: Annotated[Optional[List[str]], pydantic.Field(alias="uiTree")] = None
    r"""The UI element tree associated with the event, if any."""

    ui_element: Annotated[Optional[str], pydantic.Field(alias="uiElement")] = None
    r"""The UI element associated with the event, if any."""

    manual_feedback_info: Annotated[
        Optional[ManualFeedbackInfo], pydantic.Field(alias="manualFeedbackInfo")
    ] = None

    manual_feedback_side_by_side_info: Annotated[
        Optional[ManualFeedbackSideBySideInfo],
        pydantic.Field(alias="manualFeedbackSideBySideInfo"),
    ] = None

    seen_feedback_info: Annotated[
        Optional[SeenFeedbackInfo], pydantic.Field(alias="seenFeedbackInfo")
    ] = None

    user_view_info: Annotated[
        Optional[UserViewInfo], pydantic.Field(alias="userViewInfo")
    ] = None

    workflow_feedback_info: Annotated[
        Optional[WorkflowFeedbackInfo], pydantic.Field(alias="workflowFeedbackInfo")
    ] = None

    application_id: Annotated[Optional[str], pydantic.Field(alias="applicationId")] = (
        None
    )
    r"""The application ID of the client that sent the feedback event."""

    agent_id: Annotated[Optional[str], pydantic.Field(alias="agentId")] = None
    r"""The agent ID of the client that sent the feedback event."""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "id",
                "category",
                "position",
                "payload",
                "sessionInfo",
                "timestamp",
                "user",
                "pathname",
                "channels",
                "url",
                "uiTree",
                "uiElement",
                "manualFeedbackInfo",
                "manualFeedbackSideBySideInfo",
                "seenFeedbackInfo",
                "userViewInfo",
                "workflowFeedbackInfo",
                "applicationId",
                "agentId",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
