import motor.motor_asyncio
from _typeshed import Incomplete
from csp_lib.core import get_logger as get_logger
from csp_lib.mongo.config import UploaderConfig as UploaderConfig
from csp_lib.mongo.queue import BatchQueue as BatchQueue
from csp_lib.mongo.writer import MongoWriter as MongoWriter

class MongoBatchUploader:
    def __init__(self, mongo_db: motor.motor_asyncio.AsyncIOMotorDatabase, config: Incomplete = ...) -> None: ...
    def register_collection(self, collection_name: str) -> None: ...
    def enqueue(self, collection_name: str, document: dict) -> None: ...
    def start(self) -> MongoBatchUploader: ...
    def stop(self) -> None: ...
    def flush_all(self) -> None: ...
    def _flush_collection(self, collection_name: str) -> None: ...
    def _handle_write_failure(self, collection_name: str, documents: list) -> None: ...
    def _flush_loop(self) -> None: ...
