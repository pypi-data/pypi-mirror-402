import _abc
import csp_lib.manager.alarm.schema
import datetime
import motor.motor_asyncio
import typing
from csp_lib.manager.alarm.schema import AlarmRecord as AlarmRecord, AlarmStatus as AlarmStatus
from typing import ClassVar

class AlarmRepository(typing.Protocol):
    __parameters__: ClassVar[tuple] = ...
    _is_protocol: ClassVar[bool] = ...
    __abstractmethods__: ClassVar[frozenset] = ...
    _abc_impl: ClassVar[_abc._abc_data] = ...
    __protocol_attrs__: ClassVar[set] = ...
    def upsert(self, record: csp_lib.manager.alarm.schema.AlarmRecord) -> tuple: ...
    def resolve(self, alarm_key: str, resolved_at: datetime.datetime) -> bool: ...
    def get_active_alarms(self) -> list: ...
    def get_active_by_device(self, device_id: str) -> list: ...
    @classmethod
    def __subclasshook__(cls, other): ...
    def __init__(self, *args, **kwargs) -> None: ...

class MongoAlarmRepository:
    COLLECTION_NAME: ClassVar[str] = ...
    def __init__(self, db: motor.motor_asyncio.AsyncIOMotorDatabase, collection_name: str = ...) -> None: ...
    def ensure_indexes(self) -> None: ...
    def upsert(self, record: csp_lib.manager.alarm.schema.AlarmRecord) -> tuple: ...
    def resolve(self, alarm_key: str, resolved_at: datetime.datetime) -> bool: ...
    def get_active_alarms(self) -> list: ...
    def get_active_by_device(self, device_id: str) -> list: ...
