import{t as e,x as F,B as q,w as G,v as H,C as R}from"./index-Dnn6g2C-.js";import{e as M,p as u,y as J,u as Q,B as V,a as O,b as y,r as P,s as B,c as W,z as X}from"./api-jJhccEct.js";import{C as Y,B as S}from"./code-block-BIa9jDUN.js";import{b as Z,D as A,S as j}from"./data-table-DJCdmYte.js";import"./index-Cq-h8E2r.js";const ee=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],se=M("chevron-left",ee);const ae=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],ne=M("ellipsis",ae);function te({className:s,...a}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:u("mx-auto flex w-full justify-center",s),...a})}function re({className:s,...a}){return e.jsx("ul",{"data-slot":"pagination-content",className:u("flex flex-row items-center gap-1",s),...a})}function g({...s}){return e.jsx("li",{"data-slot":"pagination-item",...s})}function C({className:s,isActive:a,size:n="icon",...t}){return e.jsx("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:u(Z({variant:a?"outline":"ghost",size:n}),s),...t})}function ie({className:s,...a}){return e.jsxs(C,{"aria-label":"Go to previous page",size:"default",className:u("gap-1 px-2.5 sm:pl-2.5",s),...a,children:[e.jsx(se,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function oe({className:s,...a}){return e.jsxs(C,{"aria-label":"Go to next page",size:"default",className:u("gap-1 px-2.5 sm:pr-2.5",s),...a,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(J,{})]})}function ce({className:s,...a}){return e.jsxs("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:u("flex size-9 items-center justify-center",s),...a,children:[e.jsx(ne,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]})}function le({reward:s}){const a=Math.max(0,Math.min(1,s)),n=Math.round(a*100);return e.jsx(S,{variant:"outline",className:"tabular-nums border-transparent rounded-none",style:{backgroundColor:`color-mix(in oklab, var(--foreground) ${n}%, transparent)`,color:a>.5?"var(--background)":void 0},children:s.toFixed(2)})}function de(s,a){if(!s)return"-";const n=new Date(s).getTime(),r=(a?new Date(a).getTime():Date.now())-n,o=Math.floor(r/1e3),c=Math.floor(o/60),l=Math.floor(c/60);return l>0?`${l}h ${c%60}m`:c>0?`${c}m ${o%60}s`:`${o}s`}const me=[{accessorKey:"name",header:({column:s})=>e.jsx(j,{column:s,children:"Trial"})},{id:"duration",accessorFn:s=>{if(!s.started_at)return null;const a=new Date(s.started_at).getTime();return(s.finished_at?new Date(s.finished_at).getTime():Date.now())-a},header:({column:s})=>e.jsx(j,{column:s,children:"Duration"}),cell:({row:s})=>{const{started_at:a,finished_at:n}=s.original,t=de(a,n);return!n&&a?e.jsxs("span",{className:"text-muted-foreground",children:[t,"..."]}):t}},{accessorKey:"started_at",header:({column:s})=>e.jsx(j,{column:s,children:"Started"}),cell:({row:s})=>{const a=s.original.started_at;return a?new Date(a).toLocaleString():"-"}},{accessorKey:"reward",header:({column:s})=>e.jsx("div",{className:"text-right",children:e.jsx(j,{column:s,children:"Reward"})}),cell:({row:s})=>{const a=s.original.reward,n=s.original.error_type;return n?e.jsx("div",{className:"text-right",children:e.jsx(S,{variant:"destructive",children:n})}):a===null?e.jsx("div",{className:"text-right text-muted-foreground",children:"-"}):e.jsx("div",{className:"text-right",children:e.jsx(le,{reward:a})})}}];function $(s,a){const n=new URLSearchParams(s);return n.set("page",a.toString()),`?${n.toString()}`}function ue(s,a,n,t){const r=["harbor run"];return a&&r.push(`-d ${a}`),r.push(`-t ${s}`),n&&r.push(`-a ${n}`),t&&r.push(`-m ${t}`),r.join(" ")}function he(s,a){const n=[];if(a<=7)for(let t=1;t<=a;t++)n.push(t);else{n.push(1),s>3&&n.push("ellipsis");const t=Math.max(2,s-1),r=Math.min(a-1,s+1);for(let o=t;o<=r;o++)n.push(o);s<a-2&&n.push("ellipsis"),n.push(a)}return n}const ve=F(function(){const{jobName:a,taskName:n,source:t,agent:r,modelProvider:o,modelName:c}=q(),[l]=G(),D=H(),k=parseInt(l.get("page")||"1",10),_=parseInt(l.get("pageSize")||"100",10),h=t==="_"?void 0:t,m=r==="_"?void 0:r,v=o==="_"?void 0:o,b=c==="_"?void 0:c,x=v?b?`${v}/${b}`:v:b,{data:w,isLoading:z}=Q({queryKey:["trials",a,n,k,_,h,m,x],queryFn:()=>X(a,k,_,{taskName:n,source:h,agentName:m,modelName:x}),enabled:!!a&&!!n});if(z||!w)return e.jsx("div",{className:"container mx-auto py-10",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})});const{items:L,total:N,page:i,page_size:I,total_pages:p}=w,U=N>0?(i-1)*I+1:0,T=Math.min(i*I,N),K=he(i,p),f=[];return m&&f.push(x?`${m} (${x})`:m),h&&f.push(h),e.jsxs("div",{className:"container mx-auto py-10",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(V,{className:"mb-4",children:e.jsxs(O,{children:[e.jsx(y,{children:e.jsx(P,{asChild:!0,children:e.jsx(R,{to:"/",children:"Jobs"})})}),e.jsx(B,{}),e.jsx(y,{children:e.jsx(P,{asChild:!0,children:e.jsx(R,{to:`/jobs/${encodeURIComponent(a)}`,children:a})})}),e.jsx(B,{}),e.jsx(y,{children:e.jsx(W,{children:n})})]})}),e.jsx("h1",{className:"text-4xl font-medium mb-2",children:n}),f.length>0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:f.join(" / ")})]}),e.jsx(Y,{code:ue(n,h,m,x),lang:"bash",className:"-mb-px"}),e.jsx(A,{columns:me,data:L,onRowClick:d=>D(`/jobs/${encodeURIComponent(a)}/tasks/${encodeURIComponent(t)}/${encodeURIComponent(r)}/${encodeURIComponent(o)}/${encodeURIComponent(c)}/${encodeURIComponent(n)}/trials/${encodeURIComponent(d.name)}`)}),p>1&&e.jsxs("div",{className:"flex items-center mt-4",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:["Showing ",U,"-",T," of ",N," trials"]}),e.jsx(te,{className:"flex-1 justify-center",children:e.jsxs(re,{children:[e.jsx(g,{children:e.jsx(ie,{href:i>1?$(l,i-1):"#","aria-disabled":i<=1,className:i<=1?"pointer-events-none opacity-50":""})}),K.map((d,E)=>d==="ellipsis"?e.jsx(g,{children:e.jsx(ce,{})},`ellipsis-${E}`):e.jsx(g,{children:e.jsx(C,{href:$(l,d),isActive:d===i,children:d})},d)),e.jsx(g,{children:e.jsx(oe,{href:i<p?$(l,i+1):"#","aria-disabled":i>=p,className:i>=p?"pointer-events-none opacity-50":""})})]})}),e.jsx("div",{className:"flex-1"})]})]})});export{ve as default};
