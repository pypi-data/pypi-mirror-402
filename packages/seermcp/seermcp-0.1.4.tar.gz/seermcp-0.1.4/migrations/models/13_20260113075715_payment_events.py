from tortoise import BaseDBAsyncClient

RUN_IN_TRANSACTION = True


async def upgrade(db: BaseDBAsyncClient) -> str:
    return """
        CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
    "id" SERIAL NOT NULL PRIMARY KEY,
    "event_id" VARCHAR(255) NOT NULL UNIQUE,
    "type" VARCHAR(255) NOT NULL,
    "payload" JSONB NOT NULL,
    "status" VARCHAR(10) NOT NULL DEFAULT 'received',
    "attempts" INT NOT NULL DEFAULT 0,
    "last_error" TEXT,
    "created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP
);
COMMENT ON COLUMN "stripe_webhook_events"."status" IS 'RECEIVED: received\nPROCESSING: processing\nPROCESSED: processed\nFAILED: failed';
COMMENT ON TABLE "stripe_webhook_events" IS 'Durable storage for Stripe webhook events to enable idempotent processing.';"""


async def downgrade(db: BaseDBAsyncClient) -> str:
    return """
        DROP TABLE IF EXISTS "stripe_webhook_events";"""


MODELS_STATE = (
    "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"
)
