"use strict";
(self["webpackChunk_jupytercad_jupytercad_urdf"] = self["webpackChunk_jupytercad_jupytercad_urdf"] || []).push([["vendors-node_modules_jupyter_collaboration_lib_index_js"],{

/***/ "./node_modules/@jupyter/collaboration/lib/collaboratorspanel.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/collaboratorspanel.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Collaborator: () => (/* binding */ Collaborator),
/* harmony export */   CollaboratorsBody: () => (/* binding */ CollaboratorsBody),
/* harmony export */   CollaboratorsPanel: () => (/* binding */ CollaboratorsPanel)
/* harmony export */ });
/* harmony import */ var _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @jupyterlab/apputils */ "webpack/sharing/consume/default/@jupyterlab/apputils");
/* harmony import */ var _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @jupyterlab/ui-components */ "webpack/sharing/consume/default/@jupyterlab/ui-components");
/* harmony import */ var _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _lumino_signaling__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @lumino/signaling */ "webpack/sharing/consume/default/@lumino/signaling");
/* harmony import */ var _lumino_signaling__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_lumino_signaling__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @lumino/widgets */ "webpack/sharing/consume/default/@lumino/widgets");
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_lumino_widgets__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "webpack/sharing/consume/default/react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.





/**
 * The CSS class added to collaborators panel.
 */
const COLLABORATORS_PANEL_CLASS = 'jp-CollaboratorsPanel';
/**
 * The CSS class added to collaborators list container.
 */
const COLLABORATORS_LIST_CLASS = 'jp-CollaboratorsList';
/**
 * The CSS class added to each collaborator element.
 */
const COLLABORATOR_CLASS = 'jp-Collaborator';
/**
 * The CSS class added to each collaborator header.
 */
const COLLABORATOR_HEADER_CLASS = 'jp-CollaboratorHeader';
/**
 * The CSS class added to each collaborator header collapser.
 */
const COLLABORATOR_HEADER_COLLAPSER_CLASS = 'jp-CollaboratorHeaderCollapser';
/**
 * The CSS class added to each collaborator header with document.
 */
const CLICKABLE_COLLABORATOR_CLASS = 'jp-ClickableCollaborator';
/**
 * The CSS class added to each collaborator icon.
 */
const COLLABORATOR_ICON_CLASS = 'jp-CollaboratorIcon';
/**
 * The CSS class added to the files list.
 */
const COLLABORATOR_FILES_CLASS = 'jp-CollaboratorFiles';
/**
 * The CSS class added to the files in the list.
 */
const COLLABORATOR_FILE_CLASS = 'jp-CollaboratorFile';
class CollaboratorsPanel extends _lumino_widgets__WEBPACK_IMPORTED_MODULE_3__.Panel {
    constructor(currentUser, awareness, fileopener, docRegistry) {
        super({});
        /**
         * Handle collaborator change.
         */
        this._onAwarenessChanged = () => {
            const state = this._awareness.getStates();
            const collaborators = [];
            state.forEach((value, key) => {
                if (this._currentUser.isReady &&
                    value.user &&
                    value.user.username !== this._currentUser.identity.username) {
                    collaborators.push(value);
                }
            });
            this._collaboratorsChanged.emit(collaborators);
        };
        this._collaboratorsChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_2__.Signal(this);
        this._awareness = awareness;
        this._currentUser = currentUser;
        this.addClass(COLLABORATORS_PANEL_CLASS);
        this.addWidget(_jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__.ReactWidget.create(react__WEBPACK_IMPORTED_MODULE_4___default().createElement(CollaboratorsBody, { fileopener: fileopener, collaboratorsChanged: this._collaboratorsChanged, docRegistry: docRegistry })));
        this._awareness.on('change', this._onAwarenessChanged);
    }
}
function CollaboratorsBody(props) {
    const [collaborators, setCollaborators] = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]);
    props.collaboratorsChanged.connect((_, value) => {
        setCollaborators(value);
    });
    return (react__WEBPACK_IMPORTED_MODULE_4___default().createElement("div", { className: COLLABORATORS_LIST_CLASS }, collaborators.map((collaborator, i) => {
        return (react__WEBPACK_IMPORTED_MODULE_4___default().createElement(Collaborator, { collaborator: collaborator, fileopener: props.fileopener, docRegistry: props.docRegistry }));
    })));
}
function Collaborator(props) {
    const [open, setOpen] = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(false);
    const { collaborator, fileopener } = props;
    let currentMain = '';
    if (collaborator.current) {
        const path = collaborator.current.split(':');
        currentMain = `${path[1]}:${path[2]}`;
    }
    const documents = collaborator.documents || [];
    const docs = documents.map(document => {
        var _a, _b;
        const path = document.split(':');
        const fileTypes = (_b = (_a = props.docRegistry) === null || _a === void 0 ? void 0 : _a.getFileTypesForPath(path[1])) === null || _b === void 0 ? void 0 : _b.filter(ft => ft.icon !== undefined);
        const icon = (fileTypes === null || fileTypes === void 0 ? void 0 : fileTypes.length) ? fileTypes[0].icon : _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1__.fileIcon;
        const iconClass = fileTypes
            ? fileTypes[0].iconClass
            : undefined;
        return {
            filepath: path[1],
            filename: path[1].length > 40
                ? path[1]
                    .slice(0, 10)
                    .concat('…')
                    .concat(path[1].slice(path[1].length - 15))
                : path[1],
            fileLocation: document,
            icon,
            iconClass
        };
    });
    const onClick = () => {
        if (docs.length) {
            setOpen(!open);
        }
    };
    return (react__WEBPACK_IMPORTED_MODULE_4___default().createElement("div", { className: COLLABORATOR_CLASS },
        react__WEBPACK_IMPORTED_MODULE_4___default().createElement("div", { className: docs.length
                ? `${CLICKABLE_COLLABORATOR_CLASS} ${COLLABORATOR_HEADER_CLASS}`
                : COLLABORATOR_HEADER_CLASS, onClick: documents ? onClick : undefined },
            react__WEBPACK_IMPORTED_MODULE_4___default().createElement(_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1__.LabIcon.resolveReact, { icon: _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1__.caretDownIcon, className: COLLABORATOR_HEADER_COLLAPSER_CLASS +
                    (open ? ' jp-mod-expanded' : ''), tag: 'div' }),
            react__WEBPACK_IMPORTED_MODULE_4___default().createElement("div", { className: COLLABORATOR_ICON_CLASS, style: { backgroundColor: collaborator.user.color } },
                react__WEBPACK_IMPORTED_MODULE_4___default().createElement("span", null, collaborator.user.initials)),
            react__WEBPACK_IMPORTED_MODULE_4___default().createElement("span", null, collaborator.user.display_name)),
        react__WEBPACK_IMPORTED_MODULE_4___default().createElement("div", { className: `${COLLABORATOR_FILES_CLASS} jp-DirListing`, style: open ? {} : { display: 'none' } },
            react__WEBPACK_IMPORTED_MODULE_4___default().createElement("ul", { className: 'jp-DirListing-content' }, docs.map(doc => {
                return (react__WEBPACK_IMPORTED_MODULE_4___default().createElement("li", { className: 'jp-DirListing-item ' +
                        (doc.fileLocation === currentMain
                            ? `${COLLABORATOR_FILE_CLASS} jp-mod-running`
                            : COLLABORATOR_FILE_CLASS), key: doc.filename, onClick: () => fileopener(doc.fileLocation) },
                    react__WEBPACK_IMPORTED_MODULE_4___default().createElement(_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_1__.LabIcon.resolveReact, { icon: doc.icon, iconClass: doc.iconClass, tag: 'span', className: 'jp-DirListing-itemIcon', stylesheet: 'listing' }),
                    react__WEBPACK_IMPORTED_MODULE_4___default().createElement("span", { className: 'jp-DirListing-itemText', title: doc.filepath }, doc.filename)));
            })))));
}


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/components.js":
/*!***************************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/components.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   UserIconComponent: () => (/* binding */ UserIconComponent)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "webpack/sharing/consume/default/react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.

/**
 * React component for the user icon.
 *
 * @returns The React component
 */
const UserIconComponent = props => {
    const { user } = props;
    return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: "jp-UserInfo-Container" },
        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { title: user.display_name, className: "jp-UserInfo-Icon", style: { backgroundColor: user.color } },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, user.initials)),
        react__WEBPACK_IMPORTED_MODULE_0__.createElement("h3", null, user.display_name)));
};


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/cursors.js":
/*!************************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/cursors.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   remoteUserCursors: () => (/* binding */ remoteUserCursors)
/* harmony export */ });
/* harmony import */ var _codemirror_state__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @codemirror/state */ "webpack/sharing/consume/default/@codemirror/state");
/* harmony import */ var _codemirror_state__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_codemirror_state__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _codemirror_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @codemirror/view */ "webpack/sharing/consume/default/@codemirror/view");
/* harmony import */ var _codemirror_view__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_codemirror_view__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @lumino/coreutils */ "webpack/sharing/consume/default/@lumino/coreutils");
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_lumino_coreutils__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var yjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! yjs */ "webpack/sharing/consume/default/yjs");
/* harmony import */ var yjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(yjs__WEBPACK_IMPORTED_MODULE_3__);
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.




/**
 * Facet storing the Yjs document objects
 */
const editorAwarenessFacet = _codemirror_state__WEBPACK_IMPORTED_MODULE_0__.Facet.define({
    combine(configs) {
        return configs[configs.length - 1];
    }
});
/**
 * Remote selection theme
 */
const remoteSelectionTheme = _codemirror_view__WEBPACK_IMPORTED_MODULE_1__.EditorView.baseTheme({
    '.jp-remote-cursor': {
        borderLeft: '1px solid black',
        marginLeft: '-1px'
    },
    '.jp-remote-cursor.jp-mod-primary': {
        borderLeftWidth: '2px'
    },
    '.jp-remote-selection': {
        opacity: 0.5
    },
    '.cm-tooltip': {
        border: 'none'
    },
    '.cm-tooltip .jp-remote-userInfo': {
        color: 'var(--jp-ui-inverse-font-color0)',
        padding: '0px 2px'
    }
});
// TODO fix which user needs update
const remoteSelectionsAnnotation = _codemirror_state__WEBPACK_IMPORTED_MODULE_0__.Annotation.define();
/**
 * Wrapper around RectangleMarker to be able to set the user color for the remote cursor and selection ranges.
 */
class RemoteMarker {
    /**
     * Constructor
     *
     * @param style Specific user style to be applied on the marker element
     * @param marker {@link RectangleMarker} to wrap
     */
    constructor(style, marker) {
        this.style = style;
        this.marker = marker;
    }
    draw() {
        const elt = this.marker.draw();
        for (const [key, value] of Object.entries(this.style)) {
            // @ts-expect-error Unknown key
            elt.style[key] = value;
        }
        return elt;
    }
    eq(other) {
        return (this.marker.eq(other.marker) && _lumino_coreutils__WEBPACK_IMPORTED_MODULE_2__.JSONExt.deepEqual(this.style, other.style));
    }
    update(dom, oldMarker) {
        for (const [key, value] of Object.entries(this.style)) {
            // @ts-expect-error Unknown key
            dom.style[key] = value;
        }
        return this.marker.update(dom, oldMarker.marker);
    }
}
/**
 * Extension defining a new editor layer storing the remote user cursors
 */
const remoteCursorsLayer = (0,_codemirror_view__WEBPACK_IMPORTED_MODULE_1__.layer)({
    above: true,
    markers(view) {
        const { awareness, ytext } = view.state.facet(editorAwarenessFacet);
        const ydoc = ytext.doc;
        const cursors = [];
        awareness.getStates().forEach((state, clientID) => {
            var _a, _b, _c;
            if (clientID === awareness.doc.clientID) {
                return;
            }
            const cursors_ = state.cursors;
            for (const cursor of cursors_ !== null && cursors_ !== void 0 ? cursors_ : []) {
                if (!(cursor === null || cursor === void 0 ? void 0 : cursor.anchor) || !(cursor === null || cursor === void 0 ? void 0 : cursor.head)) {
                    return;
                }
                const anchor = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createAbsolutePositionFromRelativePosition)(cursor.anchor, ydoc);
                const head = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createAbsolutePositionFromRelativePosition)(cursor.head, ydoc);
                if ((anchor === null || anchor === void 0 ? void 0 : anchor.type) !== ytext || (head === null || head === void 0 ? void 0 : head.type) !== ytext) {
                    return;
                }
                const className = ((_a = cursor.primary) !== null && _a !== void 0 ? _a : true)
                    ? 'jp-remote-cursor jp-mod-primary'
                    : 'jp-remote-cursor';
                const cursor_ = _codemirror_state__WEBPACK_IMPORTED_MODULE_0__.EditorSelection.cursor(head.index, head.index > anchor.index ? -1 : 1);
                for (const piece of _codemirror_view__WEBPACK_IMPORTED_MODULE_1__.RectangleMarker.forRange(view, className, cursor_)) {
                    // Wrap the rectangle marker to set the user color
                    cursors.push(new RemoteMarker({ borderLeftColor: (_c = (_b = state.user) === null || _b === void 0 ? void 0 : _b.color) !== null && _c !== void 0 ? _c : 'black' }, piece));
                }
            }
        });
        return cursors;
    },
    update(update, layer) {
        return !!update.transactions.find(t => t.annotation(remoteSelectionsAnnotation));
    },
    class: 'jp-remote-cursors'
});
/**
 * Tooltip extension to display user display name at cursor position
 */
const userHover = (0,_codemirror_view__WEBPACK_IMPORTED_MODULE_1__.hoverTooltip)((view, pos) => {
    var _a;
    const { awareness, ytext } = view.state.facet(editorAwarenessFacet);
    const ydoc = ytext.doc;
    for (const [clientID, state] of awareness.getStates()) {
        if (clientID === awareness.doc.clientID) {
            continue;
        }
        for (const cursor of (_a = state.cursors) !== null && _a !== void 0 ? _a : []) {
            if (!(cursor === null || cursor === void 0 ? void 0 : cursor.head)) {
                continue;
            }
            const head = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createAbsolutePositionFromRelativePosition)(cursor.head, ydoc);
            if ((head === null || head === void 0 ? void 0 : head.type) !== ytext) {
                continue;
            }
            // Use some margin around the cursor to display the user.
            if (head.index - 3 <= pos && pos <= head.index + 3) {
                return {
                    pos: head.index,
                    above: true,
                    create: () => {
                        var _a, _b, _c, _d;
                        const dom = document.createElement('div');
                        dom.classList.add('jp-remote-userInfo');
                        dom.style.backgroundColor = (_b = (_a = state.user) === null || _a === void 0 ? void 0 : _a.color) !== null && _b !== void 0 ? _b : 'darkgrey';
                        dom.textContent =
                            (_d = (_c = state.user) === null || _c === void 0 ? void 0 : _c.display_name) !== null && _d !== void 0 ? _d : 'Anonymous';
                        return { dom };
                    }
                };
            }
        }
    }
    return null;
}, {
    hideOn: (tr, tooltip) => !!tr.annotation(remoteSelectionsAnnotation),
    hoverTime: 0
});
/**
 * Extension defining a new editor layer storing the remote selections
 */
const remoteSelectionLayer = (0,_codemirror_view__WEBPACK_IMPORTED_MODULE_1__.layer)({
    above: false,
    markers(view) {
        const { awareness, ytext } = view.state.facet(editorAwarenessFacet);
        const ydoc = ytext.doc;
        const cursors = [];
        awareness.getStates().forEach((state, clientID) => {
            var _a, _b, _c;
            if (clientID === awareness.doc.clientID) {
                return;
            }
            const cursors_ = state.cursors;
            for (const cursor of cursors_ !== null && cursors_ !== void 0 ? cursors_ : []) {
                if (((_a = cursor.empty) !== null && _a !== void 0 ? _a : true) || !(cursor === null || cursor === void 0 ? void 0 : cursor.anchor) || !(cursor === null || cursor === void 0 ? void 0 : cursor.head)) {
                    return;
                }
                const anchor = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createAbsolutePositionFromRelativePosition)(cursor.anchor, ydoc);
                const head = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createAbsolutePositionFromRelativePosition)(cursor.head, ydoc);
                if ((anchor === null || anchor === void 0 ? void 0 : anchor.type) !== ytext || (head === null || head === void 0 ? void 0 : head.type) !== ytext) {
                    return;
                }
                const className = 'jp-remote-selection';
                for (const piece of _codemirror_view__WEBPACK_IMPORTED_MODULE_1__.RectangleMarker.forRange(view, className, _codemirror_state__WEBPACK_IMPORTED_MODULE_0__.EditorSelection.range(anchor.index, head.index))) {
                    // Wrap the rectangle marker to set the user color
                    cursors.push(new RemoteMarker({ backgroundColor: (_c = (_b = state.user) === null || _b === void 0 ? void 0 : _b.color) !== null && _c !== void 0 ? _c : 'black' }, piece));
                }
            }
        });
        return cursors;
    },
    update(update, layer) {
        return !!update.transactions.find(t => t.annotation(remoteSelectionsAnnotation));
    },
    class: 'jp-remote-selections'
});
/**
 * CodeMirror extension exchanging and displaying remote user selection ranges (including cursors)
 */
const showCollaborators = _codemirror_view__WEBPACK_IMPORTED_MODULE_1__.ViewPlugin.fromClass(class {
    constructor(view) {
        this.editorAwareness = view.state.facet(editorAwarenessFacet);
        this._listener = ({ added, updated, removed }) => {
            const clients = added.concat(updated).concat(removed);
            if (clients.findIndex(id => id !== this.editorAwareness.awareness.doc.clientID) >= 0) {
                // Trick to get the remoteCursorLayers to be updated
                view.dispatch({ annotations: [remoteSelectionsAnnotation.of([])] });
            }
        };
        this.editorAwareness.awareness.on('change', this._listener);
    }
    destroy() {
        this.editorAwareness.awareness.off('change', this._listener);
    }
    /**
     * Communicate the current user cursor position to all remotes
     */
    update(update) {
        var _a;
        if (!update.docChanged && !update.selectionSet) {
            return;
        }
        const { awareness, ytext } = this.editorAwareness;
        const localAwarenessState = awareness.getLocalState();
        // set local awareness state (update cursors)
        if (localAwarenessState) {
            const hasFocus = update.view.hasFocus && update.view.dom.ownerDocument.hasFocus();
            const selection = update.state.selection;
            const cursors = new Array();
            if (hasFocus && selection) {
                for (const r of selection.ranges) {
                    const primary = r === selection.main;
                    const anchor = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createRelativePositionFromTypeIndex)(ytext, r.anchor);
                    const head = (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createRelativePositionFromTypeIndex)(ytext, r.head);
                    cursors.push({
                        anchor,
                        head,
                        primary,
                        empty: r.empty
                    });
                }
                if (!localAwarenessState.cursors || cursors.length > 0) {
                    const oldCursors = (_a = localAwarenessState.cursors) === null || _a === void 0 ? void 0 : _a.map(cursor => {
                        return {
                            ...cursor,
                            anchor: (cursor === null || cursor === void 0 ? void 0 : cursor.anchor)
                                ? (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createRelativePositionFromJSON)(cursor.anchor)
                                : null,
                            head: (cursor === null || cursor === void 0 ? void 0 : cursor.head)
                                ? (0,yjs__WEBPACK_IMPORTED_MODULE_3__.createRelativePositionFromJSON)(cursor.head)
                                : null
                        };
                    });
                    if (!_lumino_coreutils__WEBPACK_IMPORTED_MODULE_2__.JSONExt.deepEqual(cursors, oldCursors)) {
                        // Update cursors
                        awareness.setLocalStateField('cursors', cursors);
                    }
                }
            }
        }
    }
}, {
    provide: () => {
        return [
            remoteSelectionTheme,
            remoteCursorsLayer,
            remoteSelectionLayer,
            userHover,
            // As we use relative positioning of widget, the tooltip must be positioned absolutely
            // And we attach the tooltip to the body to avoid overflow rules
            (0,_codemirror_view__WEBPACK_IMPORTED_MODULE_1__.tooltips)({ position: 'absolute', parent: document.body })
        ];
    }
});
/**
 * CodeMirror extension to display remote users cursors
 *
 * @param config Editor source and awareness
 * @returns CodeMirror extension
 */
function remoteUserCursors(config) {
    return [editorAwarenessFacet.of(config), showCollaborators];
}


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Collaborator: () => (/* reexport safe */ _collaboratorspanel__WEBPACK_IMPORTED_MODULE_1__.Collaborator),
/* harmony export */   CollaboratorsBody: () => (/* reexport safe */ _collaboratorspanel__WEBPACK_IMPORTED_MODULE_1__.CollaboratorsBody),
/* harmony export */   CollaboratorsPanel: () => (/* reexport safe */ _collaboratorspanel__WEBPACK_IMPORTED_MODULE_1__.CollaboratorsPanel),
/* harmony export */   DefaultIconRenderer: () => (/* reexport safe */ _users_item__WEBPACK_IMPORTED_MODULE_6__.DefaultIconRenderer),
/* harmony export */   IUserMenu: () => (/* reexport safe */ _tokens__WEBPACK_IMPORTED_MODULE_0__.IUserMenu),
/* harmony export */   RendererUserMenu: () => (/* reexport safe */ _menu__WEBPACK_IMPORTED_MODULE_3__.RendererUserMenu),
/* harmony export */   UserInfoBody: () => (/* reexport safe */ _userinfopanel__WEBPACK_IMPORTED_MODULE_5__.UserInfoBody),
/* harmony export */   UserInfoPanel: () => (/* reexport safe */ _userinfopanel__WEBPACK_IMPORTED_MODULE_5__.UserInfoPanel),
/* harmony export */   UserMenu: () => (/* reexport safe */ _menu__WEBPACK_IMPORTED_MODULE_3__.UserMenu),
/* harmony export */   UsersItem: () => (/* reexport safe */ _users_item__WEBPACK_IMPORTED_MODULE_6__.UsersItem),
/* harmony export */   remoteUserCursors: () => (/* reexport safe */ _cursors__WEBPACK_IMPORTED_MODULE_2__.remoteUserCursors),
/* harmony export */   showSharedLinkDialog: () => (/* reexport safe */ _sharedlink__WEBPACK_IMPORTED_MODULE_4__.showSharedLinkDialog)
/* harmony export */ });
/* harmony import */ var _tokens__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tokens */ "./node_modules/@jupyter/collaboration/lib/tokens.js");
/* harmony import */ var _collaboratorspanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./collaboratorspanel */ "./node_modules/@jupyter/collaboration/lib/collaboratorspanel.js");
/* harmony import */ var _cursors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cursors */ "./node_modules/@jupyter/collaboration/lib/cursors.js");
/* harmony import */ var _menu__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./menu */ "./node_modules/@jupyter/collaboration/lib/menu.js");
/* harmony import */ var _sharedlink__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./sharedlink */ "./node_modules/@jupyter/collaboration/lib/sharedlink.js");
/* harmony import */ var _userinfopanel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./userinfopanel */ "./node_modules/@jupyter/collaboration/lib/userinfopanel.js");
/* harmony import */ var _users_item__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./users-item */ "./node_modules/@jupyter/collaboration/lib/users-item.js");
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.
/**
 * @packageDocumentation
 * @module collaboration
 */









/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/menu.js":
/*!*********************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/menu.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RendererUserMenu: () => (/* binding */ RendererUserMenu),
/* harmony export */   UserMenu: () => (/* binding */ UserMenu)
/* harmony export */ });
/* harmony import */ var _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @jupyterlab/ui-components */ "webpack/sharing/consume/default/@jupyterlab/ui-components");
/* harmony import */ var _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @lumino/widgets */ "webpack/sharing/consume/default/@lumino/widgets");
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lumino_widgets__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @lumino/virtualdom */ "webpack/sharing/consume/default/@lumino/virtualdom");
/* harmony import */ var _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__);
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.



/**
 * Custom renderer for the user menu.
 */
class RendererUserMenu extends _lumino_widgets__WEBPACK_IMPORTED_MODULE_1__.MenuBar.Renderer {
    /**
     * Constructor of the class RendererUserMenu.
     *
     * @argument user Current user object.
     */
    constructor(user) {
        super();
        this._user = user;
    }
    /**
     * Render the virtual element for a menu bar item.
     *
     * @param data - The data to use for rendering the item.
     *
     * @returns A virtual element representing the item.
     */
    renderItem(data) {
        const className = this.createItemClass(data);
        const dataset = this.createItemDataset(data);
        const aria = this.createItemARIA(data);
        return _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.li({ className, dataset, tabindex: '0', onfocus: data.onfocus, ...aria }, this._createUserIcon(), this.renderLabel(data), this.renderIcon(data));
    }
    /**
     * Render the label element for a menu item.
     *
     * @param data - The data to use for rendering the label.
     *
     * @returns A virtual element representing the item label.
     */
    renderLabel(data) {
        const content = this.formatLabel(data);
        return _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.div({ className: 'lm-MenuBar-itemLabel jp-MenuBar-label' }, content);
    }
    /**
     * Render the user icon element for a menu item.
     *
     * @returns A virtual element representing the item label.
     */
    _createUserIcon() {
        if (this._user.isReady && this._user.identity.avatar_url) {
            return _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.div({
                className: 'lm-MenuBar-itemIcon jp-MenuBar-imageIcon'
            }, _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.img({ src: this._user.identity.avatar_url }));
        }
        else if (this._user.isReady) {
            return _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.div({
                className: 'lm-MenuBar-itemIcon jp-MenuBar-anonymousIcon',
                style: { backgroundColor: this._user.identity.color }
            }, _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.span({}, this._user.identity.initials));
        }
        else {
            return _lumino_virtualdom__WEBPACK_IMPORTED_MODULE_2__.h.div({
                className: 'lm-MenuBar-itemIcon jp-MenuBar-anonymousIcon'
            }, _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__.userIcon);
        }
    }
}
/**
 * This menu does not contain anything but we keep it around in case someone uses it.
 * Custom lumino Menu for the user menu.
 */
class UserMenu extends _lumino_widgets__WEBPACK_IMPORTED_MODULE_1__.Menu {
    constructor(options) {
        super(options);
    }
}


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/sharedlink.js":
/*!***************************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/sharedlink.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   showSharedLinkDialog: () => (/* binding */ showSharedLinkDialog)
/* harmony export */ });
/* harmony import */ var _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @jupyterlab/apputils */ "webpack/sharing/consume/default/@jupyterlab/apputils");
/* harmony import */ var _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @jupyterlab/coreutils */ "webpack/sharing/consume/default/@jupyterlab/coreutils");
/* harmony import */ var _jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _jupyterlab_translation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @jupyterlab/translation */ "webpack/sharing/consume/default/@jupyterlab/translation");
/* harmony import */ var _jupyterlab_translation__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_translation__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @lumino/widgets */ "webpack/sharing/consume/default/@lumino/widgets");
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_lumino_widgets__WEBPACK_IMPORTED_MODULE_3__);
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.




/**
 * Show the shared link dialog
 *
 * @param options Shared link dialog options
 * @returns Dialog result
 */
async function showSharedLinkDialog({ translator }) {
    const trans = (translator !== null && translator !== void 0 ? translator : _jupyterlab_translation__WEBPACK_IMPORTED_MODULE_2__.nullTranslator).load('collaboration');
    const token = _jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__.PageConfig.getToken();
    const url = new URL(_jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__.URLExt.normalize(_jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__.PageConfig.getUrl({
        workspace: _jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__.PageConfig.defaultWorkspace
    })));
    return (0,_jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__.showDialog)({
        title: trans.__('Share Jupyter Server Link'),
        body: new SharedLinkBody(url.toString(), token, _jupyterlab_coreutils__WEBPACK_IMPORTED_MODULE_1__.PageConfig.getOption('hubUser') !== '', trans),
        buttons: [
            _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__.Dialog.cancelButton(),
            _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__.Dialog.okButton({
                label: trans.__('Copy Link'),
                caption: trans.__('Copy the link to the Jupyter Server')
            })
        ]
    });
}
class SharedLinkBody extends _lumino_widgets__WEBPACK_IMPORTED_MODULE_3__.Widget {
    constructor(_url, _token, _behindHub, _trans) {
        super();
        this._url = _url;
        this._token = _token;
        this._behindHub = _behindHub;
        this._trans = _trans;
        this._tokenCheckbox = null;
        this.onTokenChange = (e) => {
            const target = e.target;
            this.updateContent(target === null || target === void 0 ? void 0 : target.checked);
        };
        this._warning = document.createElement('div');
        this.populateBody(this.node);
        this.addClass('jp-shared-link-body');
    }
    /**
     * Returns the input value.
     */
    getValue() {
        var _a;
        const withToken = ((_a = this._tokenCheckbox) === null || _a === void 0 ? void 0 : _a.checked) === true;
        if (withToken) {
            const url_ = new URL(this._url);
            url_.searchParams.set('token', this._token);
            return url_.toString();
        }
        else {
            return this._url;
        }
    }
    onAfterAttach(msg) {
        var _a;
        super.onAfterAttach(msg);
        (_a = this._tokenCheckbox) === null || _a === void 0 ? void 0 : _a.addEventListener('change', this.onTokenChange);
    }
    onBeforeDetach(msg) {
        var _a;
        (_a = this._tokenCheckbox) === null || _a === void 0 ? void 0 : _a.removeEventListener('change', this.onTokenChange);
        super.onBeforeDetach(msg);
    }
    updateContent(withToken) {
        this._warning.innerHTML = '';
        const urlInput = this.node.querySelector('input[readonly]');
        if (withToken) {
            if (urlInput) {
                const url_ = new URL(this._url);
                url_.searchParams.set('token', this._token.slice(0, 5));
                urlInput.value = url_.toString() + '…';
            }
            this._warning.appendChild(document.createElement('h3')).textContent =
                this._trans.__('Security warning!');
            this._warning.insertAdjacentText('beforeend', this._trans.__('Anyone with this link has full access to your notebook server, including all your files!'));
            this._warning.insertAdjacentHTML('beforeend', '<br>');
            this._warning.insertAdjacentText('beforeend', this._trans.__('Please be careful who you share it with.'));
            this._warning.insertAdjacentHTML('beforeend', '<br>');
            if (this._behindHub) {
                this._warning.insertAdjacentText('beforeend', // You can restart the server to revoke the token in a JupyterHub
                this._trans.__('They will be able to access this server AS YOU.'));
                this._warning.insertAdjacentHTML('beforeend', '<br>');
                this._warning.insertAdjacentText('beforeend', this._trans.__('To revoke access, go to File -> Hub Control Panel, and restart your server.'));
            }
            else {
                this._warning.insertAdjacentText('beforeend', 
                // Elsewhere, you *must* shut down your server - no way to revoke it
                this._trans.__('Currently, there is no way to revoke access other than shutting down your server.'));
            }
        }
        else {
            if (urlInput) {
                urlInput.value = this._url;
            }
            if (this._behindHub) {
                this._warning.insertAdjacentText('beforeend', this._trans.__('Only users with `access:servers` permissions for this server will be able to use this link.'));
            }
            else {
                this._warning.insertAdjacentText('beforeend', this._trans.__('Only authenticated users will be able to use this link.'));
            }
        }
    }
    populateBody(dialogBody) {
        dialogBody.insertAdjacentHTML('afterbegin', `<input readonly value="${this._url}">`);
        if (this._token) {
            const label = dialogBody.appendChild(document.createElement('label'));
            label.insertAdjacentHTML('beforeend', '<input type="checkbox">');
            this._tokenCheckbox = label.firstChild;
            label.insertAdjacentText('beforeend', this._trans.__('Include token in URL'));
            dialogBody.insertAdjacentElement('beforeend', this._warning);
            this.updateContent(false);
        }
    }
}


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/tokens.js":
/*!***********************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/tokens.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IUserMenu: () => (/* binding */ IUserMenu)
/* harmony export */ });
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @lumino/coreutils */ "webpack/sharing/consume/default/@lumino/coreutils");
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__);
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.

/**
 * The user menu token.
 *
 * NOTE: Require this token in your extension to access the user menu
 * (top-right menu in JupyterLab's interface).
 */
const IUserMenu = new _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__.Token('@jupyter/collaboration:IUserMenu');


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/userinfopanel.js":
/*!******************************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/userinfopanel.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   UserInfoBody: () => (/* binding */ UserInfoBody),
/* harmony export */   UserInfoPanel: () => (/* binding */ UserInfoPanel)
/* harmony export */ });
/* harmony import */ var _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @jupyterlab/apputils */ "webpack/sharing/consume/default/@jupyterlab/apputils");
/* harmony import */ var _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @lumino/widgets */ "webpack/sharing/consume/default/@lumino/widgets");
/* harmony import */ var _lumino_widgets__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lumino_widgets__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "webpack/sharing/consume/default/react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _components__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components */ "./node_modules/@jupyter/collaboration/lib/components.js");
// Copyright (c) Jupyter Development Team.
// Distributed under the terms of the Modified BSD License.




class UserInfoPanel extends _lumino_widgets__WEBPACK_IMPORTED_MODULE_1__.Panel {
    constructor(user) {
        super({});
        this.addClass('jp-UserInfoPanel');
        this._profile = user;
        this._body = null;
        if (this._profile.isReady) {
            this._body = new UserInfoBody(this._profile.identity);
            this.addWidget(this._body);
            this.update();
        }
        else {
            this._profile.ready
                .then(() => {
                this._body = new UserInfoBody(this._profile.identity);
                this.addWidget(this._body);
                this.update();
            })
                .catch(e => console.error(e));
        }
    }
}
/**
 * A SettingsWidget for the user.
 */
class UserInfoBody extends _jupyterlab_apputils__WEBPACK_IMPORTED_MODULE_0__.ReactWidget {
    /**
     * Constructs a new settings widget.
     */
    constructor(user) {
        super();
        this._user = user;
    }
    get user() {
        return this._user;
    }
    set user(user) {
        this._user = user;
        this.update();
    }
    render() {
        return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components__WEBPACK_IMPORTED_MODULE_3__.UserIconComponent, { user: this._user });
    }
}


/***/ }),

/***/ "./node_modules/@jupyter/collaboration/lib/users-item.js":
/*!***************************************************************!*\
  !*** ./node_modules/@jupyter/collaboration/lib/users-item.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DefaultIconRenderer: () => (/* binding */ DefaultIconRenderer),
/* harmony export */   UsersItem: () => (/* binding */ UsersItem)
/* harmony export */ });
/* harmony import */ var _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @jupyterlab/ui-components */ "webpack/sharing/consume/default/@jupyterlab/ui-components");
/* harmony import */ var _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "webpack/sharing/consume/default/react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */


const USERS_ITEM_CLASS = 'jp-toolbar-users-item';
/**
 * A component displaying the collaborative users of a document.
 */
class UsersItem extends react__WEBPACK_IMPORTED_MODULE_1__.Component {
    constructor(props) {
        var _a;
        super(props);
        /**
         * Triggered when a change occurs in the document awareness, to build again the users list.
         */
        this._awarenessChange = () => {
            var _a;
            const clients = (_a = this._model) === null || _a === void 0 ? void 0 : _a.sharedModel.awareness.getStates();
            const users = [];
            if (clients) {
                clients.forEach((val, key) => {
                    if (val.user) {
                        users.push({ userId: key, userData: val.user });
                    }
                });
            }
            this.setState(old => ({ ...old, usersList: users }));
        };
        this._model = props.model;
        this._iconRenderer = (_a = props.iconRenderer) !== null && _a !== void 0 ? _a : null;
        this.state = { usersList: [] };
    }
    /**
     * Static method to create a widget.
     */
    static createWidget(options) {
        return _jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__.ReactWidget.create(react__WEBPACK_IMPORTED_MODULE_1__.createElement(UsersItem, { ...options }));
    }
    componentDidMount() {
        var _a;
        (_a = this._model) === null || _a === void 0 ? void 0 : _a.sharedModel.awareness.on('change', this._awarenessChange);
        this._awarenessChange();
    }
    /**
     * Filter out the duplicated users, which can happen temporary on reload.
     */
    filterDuplicated(usersList) {
        var _a;
        const newList = [];
        const selected = new Set();
        for (const element of usersList) {
            if (((_a = element === null || element === void 0 ? void 0 : element.userData) === null || _a === void 0 ? void 0 : _a.username) &&
                !selected.has(element.userData.username)) {
                selected.add(element.userData.username);
                newList.push(element);
            }
        }
        return newList;
    }
    render() {
        var _a;
        const IconRenderer = (_a = this._iconRenderer) !== null && _a !== void 0 ? _a : DefaultIconRenderer;
        return (react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", { className: USERS_ITEM_CLASS }, this.filterDuplicated(this.state.usersList).map(user => {
            if (this._model &&
                user.userId !== this._model.sharedModel.awareness.clientID) {
                return IconRenderer({ user, model: this._model });
            }
        })));
    }
}
/**
 * Default renderer for the user icon.
 */
function DefaultIconRenderer(props) {
    let el;
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    const { user, model, ...htmlProps } = props;
    const iconClasses = (0,_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__.classes)('lm-MenuBar-itemIcon', props.className || '');
    if (user.userData.avatar_url) {
        el = (react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", { ...htmlProps, key: user.userId, title: user.userData.display_name, className: (0,_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__.classes)(iconClasses, 'jp-MenuBar-imageIcon') },
            react__WEBPACK_IMPORTED_MODULE_1__.createElement("img", { src: user.userData.avatar_url, alt: "" })));
    }
    else {
        el = (react__WEBPACK_IMPORTED_MODULE_1__.createElement("div", { ...htmlProps, key: user.userId, title: user.userData.display_name, className: (0,_jupyterlab_ui_components__WEBPACK_IMPORTED_MODULE_0__.classes)(iconClasses, 'jp-MenuBar-anonymousIcon'), style: { backgroundColor: user.userData.color } },
            react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", null, user.userData.initials)));
    }
    return el;
}


/***/ })

}]);
//# sourceMappingURL=vendors-node_modules_jupyter_collaboration_lib_index_js.d0bb5b6cabf0db9a5956.js.map