"use strict";
(self["webpackChunk_jupytercad_jupytercad_urdf"] = self["webpackChunk_jupytercad_jupytercad_urdf"] || []).push([["vendors-node_modules_jupytercad_schema_lib_index_js"],{

/***/ "./node_modules/@jupytercad/schema/lib/_interface/version.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/_interface/version.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SCHEMA_VERSION: () => (/* binding */ SCHEMA_VERSION)
/* harmony export */ });
const SCHEMA_VERSION = '3.0.0';


/***/ }),

/***/ "./node_modules/@jupytercad/schema/lib/doc.js":
/*!****************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/doc.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   JupyterCadDoc: () => (/* binding */ JupyterCadDoc)
/* harmony export */ });
/* harmony import */ var _jupyter_ydoc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @jupyter/ydoc */ "webpack/sharing/consume/default/@jupyter/ydoc");
/* harmony import */ var _jupyter_ydoc__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jupyter_ydoc__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @lumino/coreutils */ "webpack/sharing/consume/default/@lumino/coreutils");
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _lumino_signaling__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @lumino/signaling */ "webpack/sharing/consume/default/@lumino/signaling");
/* harmony import */ var _lumino_signaling__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_lumino_signaling__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var yjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! yjs */ "webpack/sharing/consume/default/yjs");
/* harmony import */ var yjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(yjs__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _interface_version__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_interface/version */ "./node_modules/@jupytercad/schema/lib/_interface/version.js");





class JupyterCadDoc extends _jupyter_ydoc__WEBPACK_IMPORTED_MODULE_0__.YDocument {
    constructor() {
        super();
        this.editable = true;
        this._objectsObserver = (events) => {
            const changes = [];
            let needEmit = false;
            events.forEach(event => {
                const name = event.target.get('name');
                if (name) {
                    event.keys.forEach((change, key) => {
                        if (!needEmit && key !== 'shapeMetadata') {
                            needEmit = true;
                        }
                        changes.push({
                            name,
                            key: key,
                            newValue: _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(event.target.toJSON())
                        });
                    });
                }
            });
            needEmit = changes.length === 0 ? true : needEmit;
            if (needEmit) {
                this._objectsChanged.emit({ objectChange: changes });
            }
            this._changed.emit({ objectChange: changes });
        };
        this._metaObserver = (event) => {
            this._metadataChanged.emit(event.keys);
        };
        this._optionsObserver = (event) => {
            this._optionsChanged.emit(event.keys);
        };
        this._metadataChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_2__.Signal(this);
        this._optionsChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_2__.Signal(this);
        this._objectsChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_2__.Signal(this);
        this._options = this.ydoc.getMap('options');
        this._objects = this.ydoc.getArray('objects');
        this._metadata = this.ydoc.getMap('metadata');
        this._outputs = this.ydoc.getMap('outputs');
        this.undoManager.addToScope(this._objects);
        this._objects.observeDeep(this._objectsObserver);
        this._metadata.observe(this._metaObserver);
        this._options.observe(this._optionsObserver);
    }
    dispose() {
        super.dispose();
    }
    get version() {
        return _interface_version__WEBPACK_IMPORTED_MODULE_4__.SCHEMA_VERSION;
    }
    get objects() {
        const objs = this._objects.map(obj => _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(obj.toJSON()));
        return objs;
    }
    get options() {
        return _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(this._options.toJSON());
    }
    get metadata() {
        return _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(this._metadata.toJSON());
    }
    get outputs() {
        return _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(this._outputs.toJSON());
    }
    get objectsChanged() {
        return this._objectsChanged;
    }
    get optionsChanged() {
        return this._optionsChanged;
    }
    getSource() {
        const objects = this._objects.toJSON();
        const options = this._options.toJSON();
        const metadata = this._metadata.toJSON();
        const outputs = this._outputs.toJSON();
        return { objects, options, metadata, outputs };
    }
    setSource(source) {
        if (!source) {
            return;
        }
        let value;
        if (typeof source === 'string') {
            value = JSON.parse(source);
        }
        else {
            value = source;
        }
        this.transact(() => {
            var _a, _b, _c, _d;
            const objects = ((_a = value['objects']) !== null && _a !== void 0 ? _a : []);
            objects.forEach(obj => {
                this._objects.push([new yjs__WEBPACK_IMPORTED_MODULE_3__.Map(Object.entries(obj))]);
            });
            const options = (_b = value['options']) !== null && _b !== void 0 ? _b : {};
            Object.entries(options).forEach(([key, val]) => this._options.set(key, val));
            const metadata = (_c = value['metadata']) !== null && _c !== void 0 ? _c : {};
            Object.entries(metadata).forEach(([key, val]) => this._metadata.set(key, val));
            const outputs = (_d = value['outputs']) !== null && _d !== void 0 ? _d : {};
            Object.entries(outputs).forEach(([key, val]) => this._outputs.set(key, val));
        });
    }
    get metadataChanged() {
        return this._metadataChanged;
    }
    objectExists(name) {
        return Boolean(this._getObjectAsYMapByName(name));
    }
    getObjectByName(name) {
        const obj = this._getObjectAsYMapByName(name);
        if (obj) {
            return _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(obj.toJSON());
        }
        return undefined;
    }
    getDependants(name) {
        const dependants = [];
        const dependantMap = new Map();
        for (const obj of this._objects) {
            const deps = obj.get('dependencies') || [];
            const objName = obj.get('name');
            deps.forEach(dep => {
                const currentSet = dependantMap.get(dep);
                if (currentSet) {
                    currentSet.add(objName);
                }
                else {
                    dependantMap.set(dep, new Set([objName]));
                }
            });
        }
        const selectedDeps = dependantMap.get(name);
        if (!selectedDeps) {
            return [];
        }
        while (selectedDeps.size) {
            const depsList = [...selectedDeps];
            depsList.forEach(it => {
                var _a;
                dependants.push(it);
                selectedDeps.delete(it);
                (_a = dependantMap.get(it)) === null || _a === void 0 ? void 0 : _a.forEach(newIt => selectedDeps.add(newIt));
            });
        }
        return dependants;
    }
    removeObjects(names) {
        this.transact(() => {
            for (const name of names) {
                this.removeObjectByName(name);
            }
        });
    }
    removeObjectByName(name) {
        // Get object index
        let index = 0;
        for (const obj of this._objects) {
            if (obj.get('name') === name) {
                break;
            }
            index++;
        }
        if (this._objects.length > index) {
            this._objects.delete(index);
            this.removeOutput(name);
        }
    }
    addObject(value) {
        this.addObjects([value]);
    }
    addObjects(value) {
        this.transact(() => {
            value.map(obj => {
                if (!this.objectExists(obj.name)) {
                    this._objects.push([new yjs__WEBPACK_IMPORTED_MODULE_3__.Map(Object.entries(obj))]);
                }
                else {
                    console.error('There is already an object with the name:', obj.name);
                }
            });
        });
    }
    updateObjectByName(name, payload) {
        const obj = this._getObjectAsYMapByName(name);
        if (!obj) {
            return;
        }
        const { key, value } = payload.data;
        this.transact(() => {
            // Special case for changing parameters, we may need to update dependencies
            if (key === 'parameters') {
                switch (obj.get('shape')) {
                    case 'Part::Cut': {
                        obj.set('dependencies', [value['Base'], value['Tool']]);
                        break;
                    }
                    case 'Part::Extrusion':
                    case 'Part::Fillet':
                    case 'Part::Chamfer': {
                        obj.set('dependencies', [value['Base']]);
                        break;
                    }
                    case 'Part::MultiCommon':
                    case 'Part::MultiFuse': {
                        obj.set('dependencies', value['Shapes']);
                        break;
                    }
                    default:
                        break;
                }
            }
            obj.set(key, value);
            if (payload.meta) {
                obj.set('shapeMetadata', payload.meta);
            }
        });
    }
    getOption(key) {
        const content = this._options.get(key);
        if (!content) {
            return;
        }
        return _lumino_coreutils__WEBPACK_IMPORTED_MODULE_1__.JSONExt.deepCopy(content);
    }
    setOption(key, value) {
        this.transact(() => void this._options.set(key, value));
    }
    setOptions(options) {
        this.transact(() => {
            for (const [key, value] of Object.entries(options)) {
                this._options.set(key, value);
            }
        });
    }
    getMetadata(key) {
        return this._metadata.get(key);
    }
    setMetadata(key, value) {
        this.transact(() => void this._metadata.set(key, value));
    }
    removeMetadata(key) {
        if (this._metadata.has(key)) {
            this._metadata.delete(key);
        }
    }
    getOutput(key) {
        return this._outputs.get(key);
    }
    setOutput(key, value) {
        this.transact(() => void this._outputs.set(key, value));
    }
    removeOutput(key) {
        if (this._outputs.has(key)) {
            this._outputs.delete(key);
        }
    }
    setShapeMeta(name, meta) {
        const obj = this._getObjectAsYMapByName(name);
        if (meta && obj) {
            this.transact(() => void obj.set('shapeMetadata', meta));
        }
    }
    static create() {
        return new JupyterCadDoc();
    }
    _getObjectAsYMapByName(name) {
        for (const obj of this._objects) {
            if (obj.get('name') === name) {
                return obj;
            }
        }
        return undefined;
    }
}


/***/ }),

/***/ "./node_modules/@jupytercad/schema/lib/index.js":
/*!******************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/index.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IAnnotationToken: () => (/* reexport safe */ _token__WEBPACK_IMPORTED_MODULE_2__.IAnnotationToken),
/* harmony export */   IJCadExternalCommandRegistryToken: () => (/* reexport safe */ _token__WEBPACK_IMPORTED_MODULE_2__.IJCadExternalCommandRegistryToken),
/* harmony export */   IJCadFormSchemaRegistryToken: () => (/* reexport safe */ _token__WEBPACK_IMPORTED_MODULE_2__.IJCadFormSchemaRegistryToken),
/* harmony export */   IJCadWorkerRegistryToken: () => (/* reexport safe */ _token__WEBPACK_IMPORTED_MODULE_2__.IJCadWorkerRegistryToken),
/* harmony export */   IJupyterCadDocTracker: () => (/* reexport safe */ _token__WEBPACK_IMPORTED_MODULE_2__.IJupyterCadDocTracker),
/* harmony export */   JCadWorkerSupportedFormat: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.JCadWorkerSupportedFormat),
/* harmony export */   JupyterCadDoc: () => (/* reexport safe */ _doc__WEBPACK_IMPORTED_MODULE_3__.JupyterCadDoc),
/* harmony export */   JupyterCadModel: () => (/* reexport safe */ _model__WEBPACK_IMPORTED_MODULE_1__.JupyterCadModel),
/* harmony export */   MainAction: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.MainAction),
/* harmony export */   SCHEMA_VERSION: () => (/* reexport safe */ _interface_version__WEBPACK_IMPORTED_MODULE_4__.SCHEMA_VERSION),
/* harmony export */   WorkerAction: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.WorkerAction)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./interfaces */ "./node_modules/@jupytercad/schema/lib/interfaces.js");
/* harmony import */ var _model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./model */ "./node_modules/@jupytercad/schema/lib/model.js");
/* harmony import */ var _token__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./token */ "./node_modules/@jupytercad/schema/lib/token.js");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./node_modules/@jupytercad/schema/lib/doc.js");
/* harmony import */ var _interface_version__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_interface/version */ "./node_modules/@jupytercad/schema/lib/_interface/version.js");







/***/ }),

/***/ "./node_modules/@jupytercad/schema/lib/interfaces.js":
/*!***********************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/interfaces.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   JCadWorkerSupportedFormat: () => (/* binding */ JCadWorkerSupportedFormat),
/* harmony export */   MainAction: () => (/* binding */ MainAction),
/* harmony export */   WorkerAction: () => (/* binding */ WorkerAction)
/* harmony export */ });
/**
 * Action definitions for worker
 */
var WorkerAction;
(function (WorkerAction) {
    WorkerAction["DRY_RUN"] = "DRY_RUN";
    WorkerAction["LOAD_FILE"] = "LOAD_FILE";
    WorkerAction["SAVE_FILE"] = "SAVE_FILE";
    WorkerAction["REGISTER"] = "REGISTER";
    WorkerAction["POSTPROCESS"] = "POSTPROCESS";
})(WorkerAction || (WorkerAction = {}));
/**
 * Action definitions for main thread
 */
var MainAction;
(function (MainAction) {
    MainAction["DISPLAY_SHAPE"] = "DISPLAY_SHAPE";
    MainAction["INITIALIZED"] = "INITIALIZED";
    MainAction["DISPLAY_POST"] = "DISPLAY_POST";
    MainAction["DRY_RUN_RESPONSE"] = "DRY_RUN_RESPONSE";
})(MainAction || (MainAction = {}));
var JCadWorkerSupportedFormat;
(function (JCadWorkerSupportedFormat) {
    JCadWorkerSupportedFormat["BREP"] = "BREP";
    JCadWorkerSupportedFormat["GLTF"] = "GLTF";
    JCadWorkerSupportedFormat["STL"] = "STL";
})(JCadWorkerSupportedFormat || (JCadWorkerSupportedFormat = {}));


/***/ }),

/***/ "./node_modules/@jupytercad/schema/lib/model.js":
/*!******************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/model.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   JupyterCadModel: () => (/* binding */ JupyterCadModel)
/* harmony export */ });
/* harmony import */ var _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @lumino/signaling */ "webpack/sharing/consume/default/@lumino/signaling");
/* harmony import */ var _lumino_signaling__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_lumino_signaling__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ajv__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ajv */ "./node_modules/ajv/dist/ajv.js");
/* harmony import */ var ajv__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(ajv__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./node_modules/@jupytercad/schema/lib/doc.js");
/* harmony import */ var _schema_jcad_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./schema/jcad.json */ "./node_modules/@jupytercad/schema/lib/schema/jcad.json");




const SETTINGS_ID = '@jupytercad/jupytercad-core:jupytercad-settings';
class JupyterCadModel {
    constructor(options) {
        this.collaborative = true;
        this._onSharedModelChanged = (sender, changes) => {
            var _a;
            if (changes && ((_a = changes === null || changes === void 0 ? void 0 : changes.objectChange) === null || _a === void 0 ? void 0 : _a.length)) {
                this._contentChanged.emit(void 0);
                this.dirty = true;
            }
        };
        this._onClientStateChanged = changed => {
            const clients = this.sharedModel.awareness.getStates();
            this._clientStateChanged.emit(clients);
            if (changed.added.length || changed.removed.length) {
                this._userChanged.emit(this.users);
            }
        };
        this.defaultKernelName = '';
        this.defaultKernelLanguage = '';
        this._dirty = false;
        this._readOnly = false;
        this._isDisposed = false;
        this._jcadSettings = {
            showAxesHelper: false,
            cameraType: 'Perspective'
        };
        this._userChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._disposed = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._contentChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._stateChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._themeChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._clientStateChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._sharedMetadataChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._sharedOptionsChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._sharedObjectsChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._sharedModelSwapped = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        const { annotationModel, sharedModel, settingRegistry } = options;
        if (sharedModel) {
            this._sharedModel = sharedModel;
        }
        else {
            this._sharedModel = this.createSharedModel();
        }
        this._connectSignal();
        this.annotationModel = annotationModel;
        this.settingRegistry = settingRegistry;
        this._copiedObject = null;
        this._pathChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
        this._settingsChanged = new _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal(this);
    }
    /**
     * Initialize custom settings for JupyterLab.
     */
    async initSettings() {
        if (this.settingRegistry) {
            try {
                const setting = await this.settingRegistry.load(SETTINGS_ID);
                this._settings = setting;
                this._updateLocalSettings();
                setting.changed.connect(this._onSettingsChanged, this);
            }
            catch (error) {
                console.error(`Failed to load settings for ${SETTINGS_ID}:`, error);
                this._jcadSettings = {
                    showAxesHelper: false,
                    cameraType: 'Perspective'
                };
            }
        }
        else {
            this._jcadSettings = {
                showAxesHelper: false,
                cameraType: 'Perspective'
            };
        }
    }
    _onSettingsChanged() {
        const oldSettings = this._jcadSettings;
        this._updateLocalSettings();
        const newSettings = this._jcadSettings;
        if (oldSettings.showAxesHelper !== newSettings.showAxesHelper) {
            this._settingsChanged.emit('showAxesHelper');
        }
        if (oldSettings.cameraType !== newSettings.cameraType) {
            this._settingsChanged.emit('cameraType');
        }
    }
    _updateLocalSettings() {
        var _a, _b;
        const composite = this._settings.composite;
        this._jcadSettings = {
            showAxesHelper: (_a = composite.showAxesHelper) !== null && _a !== void 0 ? _a : false,
            cameraType: (_b = composite.cameraType) !== null && _b !== void 0 ? _b : 'Perspective'
        };
    }
    get jcadSettings() {
        return this._jcadSettings;
    }
    /**
     * Expose the settingsChanged signal for external use.
     */
    get settingsChanged() {
        return this._settingsChanged;
    }
    emitSettingChanged(settingName) {
        this._settingsChanged.emit(settingName);
    }
    /**
     * Return stored settings.
     */
    async getSettings() {
        return this._settings;
    }
    get sharedModel() {
        return this._sharedModel;
    }
    get isDisposed() {
        return this._isDisposed;
    }
    get contentChanged() {
        return this._contentChanged;
    }
    get stateChanged() {
        return this._stateChanged;
    }
    get themeChanged() {
        return this._themeChanged;
    }
    get currentUserId() {
        var _a;
        return (_a = this.sharedModel) === null || _a === void 0 ? void 0 : _a.awareness.clientID;
    }
    get users() {
        var _a;
        this._usersMap = (_a = this.sharedModel) === null || _a === void 0 ? void 0 : _a.awareness.getStates();
        const users = [];
        if (this._usersMap) {
            this._usersMap.forEach((val, key) => {
                users.push({ userId: key, userData: val.user });
            });
        }
        return users;
    }
    get userChanged() {
        return this._userChanged;
    }
    get dirty() {
        return this._dirty;
    }
    set dirty(value) {
        this._dirty = value;
    }
    get readOnly() {
        return this._readOnly;
    }
    set readOnly(value) {
        this._readOnly = value;
    }
    get localState() {
        return this.sharedModel.awareness.getLocalState();
    }
    /**
     * Getter for the contents manager.
     */
    get contentsManager() {
        return this._contentsManager;
    }
    /**
     * Setter for the contents manager.
     * Also updates the file path.
     */
    set contentsManager(manager) {
        this._contentsManager = manager;
    }
    get clientStateChanged() {
        return this._clientStateChanged;
    }
    get sharedMetadataChanged() {
        return this._sharedMetadataChanged;
    }
    get sharedOptionsChanged() {
        return this._sharedOptionsChanged;
    }
    get sharedObjectsChanged() {
        return this._sharedObjectsChanged;
    }
    get sharedModelSwapped() {
        return this._sharedModelSwapped;
    }
    /**
     * Getter for the file path associated with the contents manager.
     */
    get filePath() {
        return this._filePath;
    }
    /**
     * Setter for the file path associated with the contents manager.
     */
    set filePath(path) {
        this._filePath = path;
        this._pathChanged.emit(path);
    }
    get pathChanged() {
        return this._pathChanged;
    }
    get disposed() {
        return this._disposed;
    }
    swapSharedModel(newSharedModel) {
        this._disconnectSignal();
        this._sharedModel.dispose();
        this._sharedModel = newSharedModel;
        this._connectSignal();
        this._sharedObjectsChanged.emit({ objectChange: [] });
        this._sharedModelSwapped.emit();
    }
    dispose() {
        if (this._isDisposed) {
            return;
        }
        this._isDisposed = true;
        this._disconnectSignal();
        this._sharedModel.dispose();
        this._disposed.emit();
        _lumino_signaling__WEBPACK_IMPORTED_MODULE_0__.Signal.clearData(this);
    }
    toString() {
        return JSON.stringify(this.getContent(), null, 2);
    }
    fromString(data) {
        const jsonData = JSON.parse(data);
        const ajv = new (ajv__WEBPACK_IMPORTED_MODULE_1___default())();
        const validate = ajv.compile(_schema_jcad_json__WEBPACK_IMPORTED_MODULE_3__);
        const valid = validate(jsonData);
        if (!valid) {
            let errorMsg = 'JupyterCAD File format invalid:\n';
            for (const error of validate.errors || []) {
                errorMsg = `${errorMsg}- ${error.instancePath} ${error.message}\n`;
            }
            console.warn(errorMsg);
        }
        this.sharedModel.transact(() => {
            var _a;
            this.sharedModel.addObjects(jsonData.objects);
            this.sharedModel.setOptions((_a = jsonData.options) !== null && _a !== void 0 ? _a : {});
        });
        this.dirty = true;
    }
    toJSON() {
        return JSON.parse(this.toString());
    }
    fromJSON(data) {
        // nothing to do
    }
    initialize() {
        //
    }
    getWorker() {
        return JupyterCadModel.worker;
    }
    getContent() {
        return {
            objects: this.sharedModel.objects,
            options: this.sharedModel.options
        };
    }
    getAllObject() {
        return this.sharedModel.objects;
    }
    syncPointer(pointer, emitter) {
        this.sharedModel.awareness.setLocalStateField('pointer', {
            value: pointer,
            emitter: emitter
        });
    }
    syncCamera(camera, emitter) {
        this.sharedModel.awareness.setLocalStateField('camera', {
            value: camera,
            emitter: emitter
        });
    }
    syncSelected(value, emitter) {
        this.sharedModel.awareness.setLocalStateField('selected', {
            value,
            emitter: emitter
        });
    }
    syncSelectedPropField(data) {
        this.sharedModel.awareness.setLocalStateField('selectedPropField', data);
    }
    setUserToFollow(userId) {
        if (this.sharedModel) {
            this.sharedModel.awareness.setLocalStateField('remoteUser', userId);
        }
    }
    syncFormData(form) {
        if (this.sharedModel) {
            this.sharedModel.awareness.setLocalStateField('toolbarForm', form);
        }
    }
    getClientId() {
        return this.sharedModel.awareness.clientID;
    }
    addMetadata(key, value) {
        this.sharedModel.setMetadata(key, value);
    }
    removeMetadata(key) {
        this.sharedModel.removeMetadata(key);
    }
    setCopiedObject(object) {
        this._copiedObject = object ? Object.assign({}, object) : null;
    }
    getCopiedObject() {
        return this._copiedObject ? Object.assign({}, this._copiedObject) : null;
    }
    createSharedModel() {
        return _doc__WEBPACK_IMPORTED_MODULE_2__.JupyterCadDoc.create();
    }
    _connectSignal() {
        this._sharedModel.changed.connect(this._onSharedModelChanged);
        this._sharedModel.awareness.on('change', this._onClientStateChanged);
        this._sharedModel.metadataChanged.connect(this._metadataChangedHandler, this);
        this._sharedModel.optionsChanged.connect(this._optionsChangedHandler, this);
        this._sharedModel.objectsChanged.connect(this._objectsChangedHandler, this);
    }
    _disconnectSignal() {
        this._sharedModel.changed.disconnect(this._onSharedModelChanged);
        this._sharedModel.awareness.off('change', this._onClientStateChanged);
        this._sharedModel.metadataChanged.disconnect(this._metadataChangedHandler, this);
        this._sharedModel.optionsChanged.disconnect(this._optionsChangedHandler, this);
        this._sharedModel.objectsChanged.disconnect(this._objectsChangedHandler, this);
    }
    _metadataChangedHandler(_, args) {
        this._sharedMetadataChanged.emit(args);
    }
    _optionsChangedHandler(_, args) {
        this._sharedOptionsChanged.emit(args);
    }
    _objectsChangedHandler(_, args) {
        this._sharedObjectsChanged.emit(args);
    }
}


/***/ }),

/***/ "./node_modules/@jupytercad/schema/lib/schema/jcad.json":
/*!**************************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/schema/jcad.json ***!
  \**************************************************************/
/***/ ((module) => {

module.exports = /*#__PURE__*/JSON.parse('{"type":"object","title":"IJCadContent","required":["objects"],"additionalProperties":false,"properties":{"schemaVersion":{"type":"string","default":"3.0.0"},"objects":{"$ref":"#/definitions/jcadModel"},"options":{"$ref":"#/definitions/jcadOptions"},"metadata":{"type":"object","patternProperties":{"^.*$":{"type":"string"}},"additionalProperties":false},"outputs":{"type":"object","additionalProperties":false,"patternProperties":{"^.*$":{"type":"string"}}}},"definitions":{"parts":{"type":"string","enum":["Part::Any","Part::Box","Part::Cylinder","Part::Sphere","Part::Cone","Part::Torus","Part::Cut","Part::MultiFuse","Part::MultiCommon","Part::Extrusion","Part::Chamfer","Part::Fillet","Sketcher::SketchObject","Post::Operator"]},"shapeMetadata":{"title":"IShapeMetadata","type":"object","additionalProperties":false,"properties":{"shapeFormat":{"type":"string"},"workerId":{"type":"string"},"mass":{"type":"number"},"centerOfMass":{"type":"array","items":{"type":"number"}},"matrixOfInertia":{"type":"array","items":{"type":"array","items":{"type":"number"}}}}},"jcadObject":{"title":"IJCadObject","type":"object","additionalProperties":false,"required":["name","visible"],"properties":{"name":{"type":"string"},"visible":{"type":"boolean"},"shape":{"$ref":"#/definitions/parts"},"parameters":{"type":"object"},"shapeMetadata":{"$ref":"#/definitions/shapeMetadata"},"operators":{"type":"array","items":{"type":"object"}},"dependencies":{"type":"array","items":{"type":"string"}}}},"jcadModel":{"title":"IJCadModel","type":"array","default":[],"items":{"$ref":"#/definitions/jcadObject"}},"jcadOptions":{"title":"IJCadOptions","type":"object","default":{},"additionalProperties":false,"properties":{}}}}');

/***/ }),

/***/ "./node_modules/@jupytercad/schema/lib/token.js":
/*!******************************************************!*\
  !*** ./node_modules/@jupytercad/schema/lib/token.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IAnnotationToken: () => (/* binding */ IAnnotationToken),
/* harmony export */   IJCadExternalCommandRegistryToken: () => (/* binding */ IJCadExternalCommandRegistryToken),
/* harmony export */   IJCadFormSchemaRegistryToken: () => (/* binding */ IJCadFormSchemaRegistryToken),
/* harmony export */   IJCadWorkerRegistryToken: () => (/* binding */ IJCadWorkerRegistryToken),
/* harmony export */   IJupyterCadDocTracker: () => (/* binding */ IJupyterCadDocTracker)
/* harmony export */ });
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @lumino/coreutils */ "webpack/sharing/consume/default/@lumino/coreutils");
/* harmony import */ var _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__);

const IJupyterCadDocTracker = new _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__.Token('jupyterCadDocTracker');
const IAnnotationToken = new _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__.Token('jupytercadAnnotationModel');
const IJCadWorkerRegistryToken = new _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__.Token('jupytercadWorkerRegistry');
const IJCadFormSchemaRegistryToken = new _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__.Token('jupytercadFormSchemaRegistry');
const IJCadExternalCommandRegistryToken = new _lumino_coreutils__WEBPACK_IMPORTED_MODULE_0__.Token('jupytercadExternalCommandRegistry');


/***/ })

}]);
//# sourceMappingURL=vendors-node_modules_jupytercad_schema_lib_index_js.7d5ac4d504853ad08f29.js.map