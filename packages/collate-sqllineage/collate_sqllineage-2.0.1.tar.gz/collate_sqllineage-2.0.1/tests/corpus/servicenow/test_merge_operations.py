"""Tests for complex MERGE operations with subqueries and multiple WHEN clauses."""

from tests.helpers import assert_table_lineage_equal


def test_merge_dynamics365_audits():
    """
    ServiceNow Query ID 40 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.audits TARGET USING ( SELECT * FROM DYNAMICS365.stg_audits WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."AUDITID"="INPUT"."AUDITID" WHEN MATCHED THEN UPDATE SET "TARGET"."CHANGEDATA"="INPUT"."CHANGEDATA","TARGET"."OBJECTIDNAME"="INPUT"."OBJECTIDNAME","TARGET"."OPERATION"="INPUT"."OPERATION","TARGET"."AUDITID"="INPUT"."AUDITID","TARGET"."ACTION"="INPUT"."ACTION","TARGET"."REGARDINGOBJECTIDNAME"="INPUT"."REGARDINGOBJECTIDNAME","TARGET"."USERID"="INPUT"."USERID","TARGET"."CALLINGUSERIDNAME"="INPUT"."CALLINGUSERIDNAME","TARGET"."OPERATIONNAME"="INPUT"."OPERATIONNAME","TARGET"."ATTRIBUTEMASK"="INPUT"."ATTRIBUTEMASK","TARGET"."CALLINGUSERID"="INPUT"."CALLINGUSERID","TARGET"."OBJECTTYPECODENAME"="INPUT"."OBJECTTYPECODENAME","TARGET"."USERIDNAME"="INPUT"."USERIDNAME","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."USERADDITIONALINFO"="INPUT"."USERADDITIONALINFO","TARGET"."TRANSACTIONID"="INPUT"."TRANSACTIONID","TARGET"."OBJECTTYPECODE"="INPUT"."OBJECTTYPECODE","TARGET"."REGARDINGOBJECTID"="INPUT"."REGARDINGOBJECTID","TARGET"."ACTIONNAME"="INPUT"."ACTIONNAME","TARGET"."OBJECTID"="INPUT"."OBJECTID","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CHANGEDATA","OBJECTIDNAME","OPERATION","AUDITID","ACTION","REGARDINGOBJECTIDNAME","USERID","CALLINGUSERIDNAME","OPERATIONNAME","ATTRIBUTEMASK","CALLINGUSERID","OBJECTTYPECODENAME","USERIDNAME","CREATEDON","USERADDITIONALINFO","TRANSACTIONID","OBJECTTYPECODE","REGARDINGOBJECTID","ACTIONNAME","OBJECTID","ETL_UPDATE_DATE") VALUES ("INPUT"."CHANGEDATA","INPUT"."OBJECTIDNAME","INPUT"."OPERATION","INPUT"."AUDITID","INPUT"."ACTION","INPUT"."REGARDINGOBJECTIDNAME","INPUT"."USERID","INPUT"."CALLINGUSERIDNAME","INPUT"."OPERATIONNAME","INPUT"."ATTRIBUTEMASK","INPUT"."CALLINGUSERID","INPUT"."OBJECTTYPECODENAME","INPUT"."USERIDNAME","INPUT"."CREATEDON","INPUT"."USERADDITIONALINFO","INPUT"."TRANSACTIONID","INPUT"."OBJECTTYPECODE","INPUT"."REGARDINGOBJECTID","INPUT"."ACTIONNAME","INPUT"."OBJECTID",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_audits"},
        {"dynamics365.audits"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_subproducts():
    """
    ServiceNow Query ID 263 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitysubproductses TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitysubproductses WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID" WHEN MATCHED THEN UPDATE SET "TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_AUTOCREATED"="INPUT"."SN_AUTOCREATED","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_PERCENTAGE"="INPUT"."SN_PERCENTAGE","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPPORTUNITYPRODUCT"="INPUT"."SN_OPPORTUNITYPRODUCT","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_ANNUALRATEAMOUNT_BASE"="INPUT"."SN_ANNUALRATEAMOUNT_BASE","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_AMOUNT"="INPUT"."SN_AMOUNT","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_OPPORTUNITYPRODUCTNAME"="INPUT"."SN_OPPORTUNITYPRODUCTNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."SN_AMOUNT_BASE"="INPUT"."SN_AMOUNT_BASE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_ANNUALEXCHANGERATE"="INPUT"."SN_ANNUALEXCHANGERATE","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."SN_ANNUALRATEAMOUNT"="INPUT"."SN_ANNUALRATEAMOUNT","TARGET"."SN_AUTOCREATEDNAME"="INPUT"."SN_AUTOCREATEDNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_CUSTOMEXCHANGERATE"="INPUT"."SN_CUSTOMEXCHANGERATE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CREATEDONBEHALFBY","OWNINGTEAM","TRANSACTIONCURRENCYIDNAME","STATUSCODE","IMPORTSEQUENCENUMBER","OWNINGBUSINESSUNITNAME","VERSIONNUMBER","SN_OPPORTUNITYSUBPRODUCTSID","MODIFIEDONBEHALFBY","CREATEDBYYOMINAME","OWNINGBUSINESSUNIT","STATUSCODENAME","SN_NAME","STATECODE","SN_AUTOCREATED","OWNERIDYOMINAME","SN_PERCENTAGE","OWNERID","CREATEDBY","MODIFIEDONBEHALFBYYOMINAME","SN_SUBPRODUCTNAME","SN_OPPORTUNITYPRODUCT","UTCCONVERSIONTIMEZONECODE","SN_ANNUALRATEAMOUNT_BASE","CREATEDONBEHALFBYYOMINAME","SN_AMOUNT","CREATEDONBEHALFBYNAME","MODIFIEDON","STATECODENAME","MODIFIEDBYYOMINAME","MODIFIEDBY","SN_OPPORTUNITYPRODUCTNAME","CREATEDBYNAME","OWNERIDNAME","OWNINGUSER","MODIFIEDONBEHALFBYNAME","SN_CURRENCYCODE","SN_AMOUNT_BASE","EXCHANGERATE","SN_SUBPRODUCT","MODIFIEDBYNAME","OWNERIDTYPE","CREATEDON","TIMEZONERULEVERSIONNUMBER","SN_ANNUALEXCHANGERATE","OVERRIDDENCREATEDON","SN_ANNUALRATEAMOUNT","SN_AUTOCREATEDNAME","TRANSACTIONCURRENCYID","SN_CUSTOMEXCHANGERATE","ETL_UPDATE_DATE") VALUES ("INPUT"."CREATEDONBEHALFBY","INPUT"."OWNINGTEAM","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."STATUSCODE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","INPUT"."MODIFIEDONBEHALFBY","INPUT"."CREATEDBYYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."STATUSCODENAME","INPUT"."SN_NAME","INPUT"."STATECODE","INPUT"."SN_AUTOCREATED","INPUT"."OWNERIDYOMINAME","INPUT"."SN_PERCENTAGE","INPUT"."OWNERID","INPUT"."CREATEDBY","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPPORTUNITYPRODUCT","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_ANNUALRATEAMOUNT_BASE","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_AMOUNT","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MODIFIEDON","INPUT"."STATECODENAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."MODIFIEDBY","INPUT"."SN_OPPORTUNITYPRODUCTNAME","INPUT"."CREATEDBYNAME","INPUT"."OWNERIDNAME","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_CURRENCYCODE","INPUT"."SN_AMOUNT_BASE","INPUT"."EXCHANGERATE","INPUT"."SN_SUBPRODUCT","INPUT"."MODIFIEDBYNAME","INPUT"."OWNERIDTYPE","INPUT"."CREATEDON","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_ANNUALEXCHANGERATE","INPUT"."OVERRIDDENCREATEDON","INPUT"."SN_ANNUALRATEAMOUNT","INPUT"."SN_AUTOCREATEDNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_CUSTOMEXCHANGERATE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitysubproductses"},
        {"dynamics365.sn_opportunitysubproductses"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_collaboration_teams():
    """
    ServiceNow Query ID 775 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitycollaborationteams TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitycollaborationteams WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYCOLLABORATIONTEAMID"="INPUT"."SN_OPPORTUNITYCOLLABORATIONTEAMID" WHEN MATCHED THEN UPDATE SET "TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_OPPORTUNITYHEADERNAME"="INPUT"."SN_OPPORTUNITYHEADERNAME","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."SN_ROLENAME"="INPUT"."SN_ROLENAME","TARGET"."SN_USERNAME"="INPUT"."SN_USERNAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_ACTIVE"="INPUT"."SN_ACTIVE","TARGET"."SN_SELECTONLYACCOUNTCOLLABORATIONUSERS"="INPUT"."SN_SELECTONLYACCOUNTCOLLABORATIONUSERS","TARGET"."SN_OPPORTUNITY"="INPUT"."SN_OPPORTUNITY","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."SN_USER"="INPUT"."SN_USER","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."SN_USERYOMINAME"="INPUT"."SN_USERYOMINAME","TARGET"."SN_SELECTONLYACCOUNTCOLLABORATIONUSERSNAME"="INPUT"."SN_SELECTONLYACCOUNTCOLLABORATIONUSERSNAME","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."SN_ACTIVENAME"="INPUT"."SN_ACTIVENAME","TARGET"."SN_COLLABORATIONROLENAME"="INPUT"."SN_COLLABORATIONROLENAME","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."SN_OPPORTUNITYCOLLABORATIONTEAMID"="INPUT"."SN_OPPORTUNITYCOLLABORATIONTEAMID","TARGET"."SN_MANUALASSIGNMENT"="INPUT"."SN_MANUALASSIGNMENT","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."SN_COLLABORATIONROLE"="INPUT"."SN_COLLABORATIONROLE","TARGET"."SN_ROLE"="INPUT"."SN_ROLE","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_OPPORTUNITYHEADER"="INPUT"."SN_OPPORTUNITYHEADER","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_MANUALASSIGNMENTNAME"="INPUT"."SN_MANUALASSIGNMENTNAME","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYNAME"="INPUT"."SN_OPPORTUNITYNAME","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP,"TARGET"."SN_JOBROLEID"="INPUT"."SN_JOBROLEID","TARGET"."SN_ISPRIMARY"="INPUT"."SN_ISPRIMARY" WHEN NOT MATCHED THEN INSERT ("OWNINGBUSINESSUNIT","CREATEDBYNAME","MODIFIEDBY","TIMEZONERULEVERSIONNUMBER","SN_OPPORTUNITYHEADERNAME","CREATEDON","STATUSCODE","SN_ROLENAME","SN_USERNAME","STATECODE","SN_ACTIVE","SN_SELECTONLYACCOUNTCOLLABORATIONUSERS","SN_OPPORTUNITY","OWNERIDTYPE","CREATEDBYYOMINAME","SN_USER","SN_NAME","MODIFIEDONBEHALFBY","OWNERIDYOMINAME","OWNERID","CREATEDONBEHALFBY","STATECODENAME","SN_USERYOMINAME","SN_SELECTONLYACCOUNTCOLLABORATIONUSERSNAME","IMPORTSEQUENCENUMBER","OWNERIDNAME","MODIFIEDBYYOMINAME","SN_ACTIVENAME","SN_COLLABORATIONROLENAME","OWNINGTEAM","SN_OPPORTUNITYCOLLABORATIONTEAMID","SN_MANUALASSIGNMENT","CREATEDBY","OVERRIDDENCREATEDON","MODIFIEDBYNAME","MODIFIEDON","SN_COLLABORATIONROLE","SN_ROLE","OWNINGUSER","MODIFIEDONBEHALFBYYOMINAME","SN_OPPORTUNITYHEADER","CREATEDONBEHALFBYYOMINAME","SN_MANUALASSIGNMENTNAME","MODIFIEDONBEHALFBYNAME","CREATEDONBEHALFBYNAME","STATUSCODENAME","VERSIONNUMBER","SN_OPPORTUNITYNAME","UTCCONVERSIONTIMEZONECODE","ETL_UPDATE_DATE","SN_JOBROLEID","SN_ISPRIMARY") VALUES ("INPUT"."OWNINGBUSINESSUNIT","INPUT"."CREATEDBYNAME","INPUT"."MODIFIEDBY","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_OPPORTUNITYHEADERNAME","INPUT"."CREATEDON","INPUT"."STATUSCODE","INPUT"."SN_ROLENAME","INPUT"."SN_USERNAME","INPUT"."STATECODE","INPUT"."SN_ACTIVE","INPUT"."SN_SELECTONLYACCOUNTCOLLABORATIONUSERS","INPUT"."SN_OPPORTUNITY","INPUT"."OWNERIDTYPE","INPUT"."CREATEDBYYOMINAME","INPUT"."SN_USER","INPUT"."SN_NAME","INPUT"."MODIFIEDONBEHALFBY","INPUT"."OWNERIDYOMINAME","INPUT"."OWNERID","INPUT"."CREATEDONBEHALFBY","INPUT"."STATECODENAME","INPUT"."SN_USERYOMINAME","INPUT"."SN_SELECTONLYACCOUNTCOLLABORATIONUSERSNAME","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNERIDNAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."SN_ACTIVENAME","INPUT"."SN_COLLABORATIONROLENAME","INPUT"."OWNINGTEAM","INPUT"."SN_OPPORTUNITYCOLLABORATIONTEAMID","INPUT"."SN_MANUALASSIGNMENT","INPUT"."CREATEDBY","INPUT"."OVERRIDDENCREATEDON","INPUT"."MODIFIEDBYNAME","INPUT"."MODIFIEDON","INPUT"."SN_COLLABORATIONROLE","INPUT"."SN_ROLE","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_OPPORTUNITYHEADER","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_MANUALASSIGNMENTNAME","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."STATUSCODENAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYNAME","INPUT"."UTCCONVERSIONTIMEZONECODE",CURRENT_TIMESTAMP,"INPUT"."SN_JOBROLEID","INPUT"."SN_ISPRIMARY")
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitycollaborationteams"},
        {"dynamics365.sn_opportunitycollaborationteams"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_subproducts_variant():
    """
    ServiceNow Query ID 900 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitysubproductses TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitysubproductses WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID" WHEN MATCHED THEN UPDATE SET "TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_AUTOCREATED"="INPUT"."SN_AUTOCREATED","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_PERCENTAGE"="INPUT"."SN_PERCENTAGE","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPPORTUNITYPRODUCT"="INPUT"."SN_OPPORTUNITYPRODUCT","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_ANNUALRATEAMOUNT_BASE"="INPUT"."SN_ANNUALRATEAMOUNT_BASE","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_AMOUNT"="INPUT"."SN_AMOUNT","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_OPPORTUNITYPRODUCTNAME"="INPUT"."SN_OPPORTUNITYPRODUCTNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."SN_AMOUNT_BASE"="INPUT"."SN_AMOUNT_BASE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_ANNUALEXCHANGERATE"="INPUT"."SN_ANNUALEXCHANGERATE","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."SN_ANNUALRATEAMOUNT"="INPUT"."SN_ANNUALRATEAMOUNT","TARGET"."SN_AUTOCREATEDNAME"="INPUT"."SN_AUTOCREATEDNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_CUSTOMEXCHANGERATE"="INPUT"."SN_CUSTOMEXCHANGERATE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CREATEDONBEHALFBY","OWNINGTEAM","TRANSACTIONCURRENCYIDNAME","STATUSCODE","IMPORTSEQUENCENUMBER","OWNINGBUSINESSUNITNAME","VERSIONNUMBER","SN_OPPORTUNITYSUBPRODUCTSID","MODIFIEDONBEHALFBY","CREATEDBYYOMINAME","OWNINGBUSINESSUNIT","STATUSCODENAME","SN_NAME","STATECODE","SN_AUTOCREATED","OWNERIDYOMINAME","SN_PERCENTAGE","OWNERID","CREATEDBY","MODIFIEDONBEHALFBYYOMINAME","SN_SUBPRODUCTNAME","SN_OPPORTUNITYPRODUCT","UTCCONVERSIONTIMEZONECODE","SN_ANNUALRATEAMOUNT_BASE","CREATEDONBEHALFBYYOMINAME","SN_AMOUNT","CREATEDONBEHALFBYNAME","MODIFIEDON","STATECODENAME","MODIFIEDBYYOMINAME","MODIFIEDBY","SN_OPPORTUNITYPRODUCTNAME","CREATEDBYNAME","OWNERIDNAME","OWNINGUSER","MODIFIEDONBEHALFBYNAME","SN_CURRENCYCODE","SN_AMOUNT_BASE","EXCHANGERATE","SN_SUBPRODUCT","MODIFIEDBYNAME","OWNERIDTYPE","CREATEDON","TIMEZONERULEVERSIONNUMBER","SN_ANNUALEXCHANGERATE","OVERRIDDENCREATEDON","SN_ANNUALRATEAMOUNT","SN_AUTOCREATEDNAME","TRANSACTIONCURRENCYID","SN_CUSTOMEXCHANGERATE","ETL_UPDATE_DATE") VALUES ("INPUT"."CREATEDONBEHALFBY","INPUT"."OWNINGTEAM","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."STATUSCODE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","INPUT"."MODIFIEDONBEHALFBY","INPUT"."CREATEDBYYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."STATUSCODENAME","INPUT"."SN_NAME","INPUT"."STATECODE","INPUT"."SN_AUTOCREATED","INPUT"."OWNERIDYOMINAME","INPUT"."SN_PERCENTAGE","INPUT"."OWNERID","INPUT"."CREATEDBY","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPPORTUNITYPRODUCT","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_ANNUALRATEAMOUNT_BASE","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_AMOUNT","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MODIFIEDON","INPUT"."STATECODENAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."MODIFIEDBY","INPUT"."SN_OPPORTUNITYPRODUCTNAME","INPUT"."CREATEDBYNAME","INPUT"."OWNERIDNAME","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_CURRENCYCODE","INPUT"."SN_AMOUNT_BASE","INPUT"."EXCHANGERATE","INPUT"."SN_SUBPRODUCT","INPUT"."MODIFIEDBYNAME","INPUT"."OWNERIDTYPE","INPUT"."CREATEDON","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_ANNUALEXCHANGERATE","INPUT"."OVERRIDDENCREATEDON","INPUT"."SN_ANNUALRATEAMOUNT","INPUT"."SN_AUTOCREATEDNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_CUSTOMEXCHANGERATE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitysubproductses"},
        {"dynamics365.sn_opportunitysubproductses"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_leads_large_query():
    """
    ServiceNow Query ID 988 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.leads TARGET USING ( SELECT * FROM DYNAMICS365.stg_leads WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."LEADID"="INPUT"."LEADID" AND "TARGET"."ADDRESS1_ADDRESSID"="INPUT"."ADDRESS1_ADDRESSID"  AND
"TARGET"."ADDRESS2_ADDRESSID"="INPUT"."ADDRESS2_ADDRESSID" WHEN MATCHED THEN UPDATE SET "TARGET"."PREFERREDCONTACTMETHODCODENAME"="INPUT"."PREFERREDCONTACTMETHODCODENAME","TARGET"."EMAILADDRESS3"="INPUT"."EMAILADDRESS3","TARGET"."EMAILADDRESS2"="INPUT"."EMAILADDRESS2","TARGET"."EMAILADDRESS1"="INPUT"."EMAILADDRESS1","TARGET"."ADDRESS1_CITY"="INPUT"."ADDRESS1_CITY","TARGET"."BUDGETAMOUNT_BASE"="INPUT"."BUDGETAMOUNT_BASE","TARGET"."ADDRESS1_LINE1"="INPUT"."ADDRESS1_LINE1","TARGET"."BUDGETSTATUS"="INPUT"."BUDGETSTATUS","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."WEBSITEURL"="INPUT"."WEBSITEURL","TARGET"."YOMIFIRSTNAME"="INPUT"."YOMIFIRSTNAME","TARGET"."ADDRESS1_LONGITUDE"="INPUT"."ADDRESS1_LONGITUDE","TARGET"."DONOTPOSTALMAIL"="INPUT"."DONOTPOSTALMAIL","TARGET"."YOMIFULLNAME"="INPUT"."YOMIFULLNAME","TARGET"."ADDRESS1_ADDRESSTYPECODE"="INPUT"."ADDRESS1_ADDRESSTYPECODE","TARGET"."ENTITYIMAGE_TIMESTAMP"="INPUT"."ENTITYIMAGE_TIMESTAMP","TARGET"."CONTACTIDNAME"="INPUT"."CONTACTIDNAME","TARGET"."EVALUATEFITNAME"="INPUT"."EVALUATEFITNAME","TARGET"."TELEPHONE3"="INPUT"."TELEPHONE3","TARGET"."QUALIFYINGOPPORTUNITYID"="INPUT"."QUALIFYINGOPPORTUNITYID","TARGET"."CONFIRMINTEREST"="INPUT"."CONFIRMINTEREST","TARGET"."PURCHASETIMEFRAMENAME"="INPUT"."PURCHASETIMEFRAMENAME","TARGET"."DONOTSENDMM"="INPUT"."DONOTSENDMM","TARGET"."ADDRESS2_COUNTY"="INPUT"."ADDRESS2_COUNTY","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."ENTITYIMAGE_URL"="INPUT"."ENTITYIMAGE_URL","TARGET"."SALESSTAGENAME"="INPUT"."SALESSTAGENAME","TARGET"."SN_STATE"="INPUT"."SN_STATE","TARGET"."ADDRESS1_SHIPPINGMETHODCODE"="INPUT"."ADDRESS1_SHIPPINGMETHODCODE","TARGET"."ESTIMATEDAMOUNT"="INPUT"."ESTIMATEDAMOUNT","TARGET"."ACCOUNTIDNAME"="INPUT"."ACCOUNTIDNAME","TARGET"."RELATEDOBJECTIDNAME"="INPUT"."RELATEDOBJECTIDNAME","TARGET"."SLAINVOKEDID"="INPUT"."SLAINVOKEDID","TARGET"."ADDRESS1_SHIPPINGMETHODCODENAME"="INPUT"."ADDRESS1_SHIPPINGMETHODCODENAME","TARGET"."MASTERLEADIDYOMINAME"="INPUT"."MASTERLEADIDYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."SN_PROJECTEDMEETINGDATE"="INPUT"."SN_PROJECTEDMEETINGDATE","TARGET"."ADDRESS2_STATEORPROVINCE"="INPUT"."ADDRESS2_STATEORPROVINCE","TARGET"."PARTICIPATESINWORKFLOWNAME"="INPUT"."PARTICIPATESINWORKFLOWNAME","TARGET"."SN_LEADNUMBER"="INPUT"."SN_LEADNUMBER","TARGET"."MOBILEPHONE"="INPUT"."MOBILEPHONE","TARGET"."ADDRESS2_COUNTRY"="INPUT"."ADDRESS2_COUNTRY","TARGET"."YOMICOMPANYNAME"="INPUT"."YOMICOMPANYNAME","TARGET"."ADDRESS2_LINE2"="INPUT"."ADDRESS2_LINE2","TARGET"."ACCOUNTID"="INPUT"."ACCOUNTID","TARGET"."RELATEDOBJECTID"="INPUT"."RELATEDOBJECTID","TARGET"."SLAID"="INPUT"."SLAID","TARGET"."MSDYN_LEADSCORETREND"="INPUT"."MSDYN_LEADSCORETREND","TARGET"."PARENTCONTACTID"="INPUT"."PARENTCONTACTID","TARGET"."ADDRESS1_LINE3"="INPUT"."ADDRESS1_LINE3","TARGET"."ESTIMATEDCLOSEDATE"="INPUT"."ESTIMATEDCLOSEDATE","TARGET"."CONTACTID"="INPUT"."CONTACTID","TARGET"."SN_MEETINGFORECASTSTAGE"="INPUT"."SN_MEETINGFORECASTSTAGE","TARGET"."SN_STATENAME"="INPUT"."SN_STATENAME","TARGET"."CONTACTIDYOMINAME"="INPUT"."CONTACTIDYOMINAME","TARGET"."PARENTACCOUNTIDNAME"="INPUT"."PARENTACCOUNTIDNAME","TARGET"."INDUSTRYCODENAME"="INPUT"."INDUSTRYCODENAME","TARGET"."ADDRESS1_UTCOFFSET"="INPUT"."ADDRESS1_UTCOFFSET","TARGET"."DONOTSENDMARKETINGMATERIALNAME"="INPUT"."DONOTSENDMARKETINGMATERIALNAME","TARGET"."NUMBEROFEMPLOYEES"="INPUT"."NUMBEROFEMPLOYEES","TARGET"."INITIALCOMMUNICATION"="INPUT"."INITIALCOMMUNICATION","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."REVENUE"="INPUT"."REVENUE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."ISPRIVATE"="INPUT"."ISPRIVATE","TARGET"."COMPANYNAME"="INPUT"."COMPANYNAME","TARGET"."PARENTACCOUNTID"="INPUT"."PARENTACCOUNTID","TARGET"."ADDRESS2_CITY"="INPUT"."ADDRESS2_CITY","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."ADDRESS1_ADDRESSTYPECODENAME"="INPUT"."ADDRESS1_ADDRESSTYPECODENAME","TARGET"."ADDRESS2_LATITUDE"="INPUT"."ADDRESS2_LATITUDE","TARGET"."PRIORITYCODENAME"="INPUT"."PRIORITYCODENAME","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."DONOTBULKEMAIL"="INPUT"."DONOTBULKEMAIL","TARGET"."SLANAME"="INPUT"."SLANAME","TARGET"."MSDYN_LEADKPIID"="INPUT"."MSDYN_LEADKPIID","TARGET"."DONOTFAX"="INPUT"."DONOTFAX","TARGET"."PURCHASEPROCESSNAME"="INPUT"."PURCHASEPROCESSNAME","TARGET"."YOMIMIDDLENAME"="INPUT"."YOMIMIDDLENAME","TARGET"."TIMESPENTBYMEONEMAILANDMEETINGS"="INPUT"."TIMESPENTBYMEONEMAILANDMEETINGS","TARGET"."ADDRESS1_COMPOSITE"="INPUT"."ADDRESS1_COMPOSITE","TARGET"."FIRSTNAME"="INPUT"."FIRSTNAME","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SALESSTAGE"="INPUT"."SALESSTAGE","TARGET"."MSDYN_SCOREHISTORY"="INPUT"."MSDYN_SCOREHISTORY","TARGET"."QUALIFICATIONCOMMENTS"="INPUT"."QUALIFICATIONCOMMENTS","TARGET"."BUDGETSTATUSNAME"="INPUT"."BUDGETSTATUSNAME","TARGET"."ADDRESS2_POSTALCODE"="INPUT"."ADDRESS2_POSTALCODE","TARGET"."CUSTOMERIDTYPE"="INPUT"."CUSTOMERIDTYPE","TARGET"."EVALUATEFIT"="INPUT"."EVALUATEFIT","TARGET"."MSDYN_GDPROPTOUTNAME"="INPUT"."MSDYN_GDPROPTOUTNAME","TARGET"."ONHOLDTIME"="INPUT"."ONHOLDTIME","TARGET"."MSDYN_LEADGRADE"="INPUT"."MSDYN_LEADGRADE","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."ISAUTOCREATE"="INPUT"."ISAUTOCREATE","TARGET"."TEAMSFOLLOWED"="INPUT"."TEAMSFOLLOWED","TARGET"."ADDRESS2_SHIPPINGMETHODCODENAME"="INPUT"."ADDRESS2_SHIPPINGMETHODCODENAME","TARGET"."ADDRESS2_LINE3"="INPUT"."ADDRESS2_LINE3","TARGET"."DESCRIPTION"="INPUT"."DESCRIPTION","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."ADDRESS1_COUNTY"="INPUT"."ADDRESS1_COUNTY","TARGET"."PREFERREDCONTACTMETHODCODE"="INPUT"."PREFERREDCONTACTMETHODCODE","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."SUBJECT"="INPUT"."SUBJECT","TARGET"."DONOTEMAIL"="INPUT"."DONOTEMAIL","TARGET"."DONOTPHONENAME"="INPUT"."DONOTPHONENAME","TARGET"."PAGER"="INPUT"."PAGER","TARGET"."SN_PRIMARYSALESREPYOMINAME"="INPUT"."SN_PRIMARYSALESREPYOMINAME","TARGET"."ADDRESS2_POSTOFFICEBOX"="INPUT"."ADDRESS2_POSTOFFICEBOX","TARGET"."ADDRESS2_TELEPHONE1"="INPUT"."ADDRESS2_TELEPHONE1","TARGET"."ADDRESS2_TELEPHONE2"="INPUT"."ADDRESS2_TELEPHONE2","TARGET"."ADDRESS2_TELEPHONE3"="INPUT"."ADDRESS2_TELEPHONE3","TARGET"."ADDRESS1_ADDRESSID"="INPUT"."ADDRESS1_ADDRESSID","TARGET"."TRAVERSEDPATH"="INPUT"."TRAVERSEDPATH","TARGET"."FOLLOWEMAILNAME"="INPUT"."FOLLOWEMAILNAME","TARGET"."ESTIMATEDVALUE"="INPUT"."ESTIMATEDVALUE","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."INDUSTRYCODE"="INPUT"."INDUSTRYCODE","TARGET"."SALESSTAGECODE"="INPUT"."SALESSTAGECODE","TARGET"."ADDRESS2_NAME"="INPUT"."ADDRESS2_NAME","TARGET"."SCHEDULEFOLLOWUP_QUALIFY"="INPUT"."SCHEDULEFOLLOWUP_QUALIFY","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."ESTIMATEDAMOUNT_BASE"="INPUT"."ESTIMATEDAMOUNT_BASE","TARGET"."ENTITYIMAGEID"="INPUT"."ENTITYIMAGEID","TARGET"."FOLLOWEMAIL"="INPUT"."FOLLOWEMAIL","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."ENTITYIMAGE"="INPUT"."ENTITYIMAGE","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."ADDRESS2_COMPOSITE"="INPUT"."ADDRESS2_COMPOSITE","TARGET"."CUSTOMERID"="INPUT"."CUSTOMERID","TARGET"."ADDRESS1_COUNTRY"="INPUT"."ADDRESS1_COUNTRY","TARGET"."BUSINESSCARDATTRIBUTES"="INPUT"."BUSINESSCARDATTRIBUTES","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."ADDRESS1_STATEORPROVINCE"="INPUT"."ADDRESS1_STATEORPROVINCE","TARGET"."ISPRIVATENAME"="INPUT"."ISPRIVATENAME","TARGET"."LEADQUALITYCODENAME"="INPUT"."LEADQUALITYCODENAME","TARGET"."PROCESSID"="INPUT"."PROCESSID","TARGET"."DECISIONMAKER"="INPUT"."DECISIONMAKER","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."SALESSTAGECODENAME"="INPUT"."SALESSTAGECODENAME","TARGET"."JOBTITLE"="INPUT"."JOBTITLE","TARGET"."SN_COUNTRYNAME"="INPUT"."SN_COUNTRYNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."ADDRESS1_TELEPHONE1"="INPUT"."ADDRESS1_TELEPHONE1","TARGET"."ADDRESS1_TELEPHONE2"="INPUT"."ADDRESS1_TELEPHONE2","TARGET"."ADDRESS1_TELEPHONE3"="INPUT"."ADDRESS1_TELEPHONE3","TARGET"."CUSTOMERIDYOMINAME"="INPUT"."CUSTOMERIDYOMINAME","TARGET"."ADDRESS1_POSTOFFICEBOX"="INPUT"."ADDRESS1_POSTOFFICEBOX","TARGET"."PARENTCONTACTIDYOMINAME"="INPUT"."PARENTCONTACTIDYOMINAME","TARGET"."ORIGINATINGCASEID"="INPUT"."ORIGINATINGCASEID","TARGET"."DONOTEMAILNAME"="INPUT"."DONOTEMAILNAME","TARGET"."SLAINVOKEDIDNAME"="INPUT"."SLAINVOKEDIDNAME","TARGET"."MSDYN_LEADKPIIDNAME"="INPUT"."MSDYN_LEADKPIIDNAME","TARGET"."FAX"="INPUT"."FAX","TARGET"."MASTERID"="INPUT"."MASTERID","TARGET"."TELEPHONE1"="INPUT"."TELEPHONE1","TARGET"."SIC"="INPUT"."SIC","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."LASTUSEDINCAMPAIGN"="INPUT"."LASTUSEDINCAMPAIGN","TARGET"."ADDRESS2_UTCOFFSET"="INPUT"."ADDRESS2_UTCOFFSET","TARGET"."PARTICIPATESINWORKFLOW"="INPUT"."PARTICIPATESINWORKFLOW","TARGET"."MSDYN_LEADGRADENAME"="INPUT"."MSDYN_LEADGRADENAME","TARGET"."MSDYN_LEADSCORETRENDNAME"="INPUT"."MSDYN_LEADSCORETRENDNAME","TARGET"."ADDRESS2_FAX"="INPUT"."ADDRESS2_FAX","TARGET"."REVENUE_BASE"="INPUT"."REVENUE_BASE","TARGET"."MERGED"="INPUT"."MERGED","TARGET"."LEADQUALITYCODE"="INPUT"."LEADQUALITYCODE","TARGET"."PURCHASETIMEFRAME"="INPUT"."PURCHASETIMEFRAME","TARGET"."BUDGETAMOUNT"="INPUT"."BUDGETAMOUNT","TARGET"."ADDRESS2_LONGITUDE"="INPUT"."ADDRESS2_LONGITUDE","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."MSDYN_LEADSCORE"="INPUT"."MSDYN_LEADSCORE","TARGET"."DONOTPHONE"="INPUT"."DONOTPHONE","TARGET"."ISAUTOCREATENAME"="INPUT"."ISAUTOCREATENAME","TARGET"."NEEDNAME"="INPUT"."NEEDNAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."LASTONHOLDTIME"="INPUT"."LASTONHOLDTIME","TARGET"."SCHEDULEFOLLOWUP_PROSPECT"="INPUT"."SCHEDULEFOLLOWUP_PROSPECT","TARGET"."ADDRESS1_LINE2"="INPUT"."ADDRESS1_LINE2","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."ADDRESS2_ADDRESSTYPECODE"="INPUT"."ADDRESS2_ADDRESSTYPECODE","TARGET"."ADDRESS2_UPSZONE"="INPUT"."ADDRESS2_UPSZONE","TARGET"."CONFIRMINTERESTNAME"="INPUT"."CONFIRMINTERESTNAME","TARGET"."SN_MEETINGFORECASTSTAGENAME"="INPUT"."SN_MEETINGFORECASTSTAGENAME","TARGET"."DONOTFAXNAME"="INPUT"."DONOTFAXNAME","TARGET"."MSDYN_SCOREREASONS"="INPUT"."MSDYN_SCOREREASONS","TARGET"."ADDRESS2_ADDRESSTYPECODENAME"="INPUT"."ADDRESS2_ADDRESSTYPECODENAME","TARGET"."SALUTATION"="INPUT"."SALUTATION","TARGET"."PRIORITYCODE"="INPUT"."PRIORITYCODE","TARGET"."ADDRESS1_POSTALCODE"="INPUT"."ADDRESS1_POSTALCODE","TARGET"."LEADSOURCECODENAME"="INPUT"."LEADSOURCECODENAME","TARGET"."STAGEID"="INPUT"."STAGEID","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."DONOTBULKEMAILNAME"="INPUT"."DONOTBULKEMAILNAME","TARGET"."SN_COUNTRY"="INPUT"."SN_COUNTRY","TARGET"."CAMPAIGNID"="INPUT"."CAMPAIGNID","TARGET"."QUALIFYINGOPPORTUNITYIDNAME"="INPUT"."QUALIFYINGOPPORTUNITYIDNAME","TARGET"."MSDYN_GDPROPTOUT"="INPUT"."MSDYN_GDPROPTOUT","TARGET"."ADDRESS2_ADDRESSID"="INPUT"."ADDRESS2_ADDRESSID","TARGET"."SN_PRIMARYSALESREP"="INPUT"."SN_PRIMARYSALESREP","TARGET"."BUSINESSCARD"="INPUT"."BUSINESSCARD","TARGET"."CUSTOMERIDNAME"="INPUT"."CUSTOMERIDNAME","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."MASTERLEADIDNAME"="INPUT"."MASTERLEADIDNAME","TARGET"."TELEPHONE2"="INPUT"."TELEPHONE2","TARGET"."MERGEDNAME"="INPUT"."MERGEDNAME","TARGET"."YOMILASTNAME"="INPUT"."YOMILASTNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."CAMPAIGNIDNAME"="INPUT"."CAMPAIGNIDNAME","TARGET"."MIDDLENAME"="INPUT"."MIDDLENAME","TARGET"."ADDRESS1_NAME"="INPUT"."ADDRESS1_NAME","TARGET"."ADDRESS1_FAX"="INPUT"."ADDRESS1_FAX","TARGET"."ADDRESS1_LATITUDE"="INPUT"."ADDRESS1_LATITUDE","TARGET"."ADDRESS2_SHIPPINGMETHODCODE"="INPUT"."ADDRESS2_SHIPPINGMETHODCODE","TARGET"."SN_PRIMARYSALESREPNAME"="INPUT"."SN_PRIMARYSALESREPNAME","TARGET"."ORIGINATINGCASEIDNAME"="INPUT"."ORIGINATINGCASEIDNAME","TARGET"."PARENTCONTACTIDNAME"="INPUT"."PARENTCONTACTIDNAME","TARGET"."PURCHASEPROCESS"="INPUT"."PURCHASEPROCESS","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."LEADSOURCECODE"="INPUT"."LEADSOURCECODE","TARGET"."ADDRESS2_LINE1"="INPUT"."ADDRESS2_LINE1","TARGET"."ADDRESS1_UPSZONE"="INPUT"."ADDRESS1_UPSZONE","TARGET"."LASTNAME"="INPUT"."LASTNAME","TARGET"."ACCOUNTIDYOMINAME"="INPUT"."ACCOUNTIDYOMINAME","TARGET"."LEADID"="INPUT"."LEADID","TARGET"."DONOTPOSTALMAILNAME"="INPUT"."DONOTPOSTALMAILNAME","TARGET"."INITIALCOMMUNICATIONNAME"="INPUT"."INITIALCOMMUNICATIONNAME","TARGET"."NEED"="INPUT"."NEED","TARGET"."PARENTACCOUNTIDYOMINAME"="INPUT"."PARENTACCOUNTIDYOMINAME","TARGET"."DECISIONMAKERNAME"="INPUT"."DECISIONMAKERNAME","TARGET"."FULLNAME"="INPUT"."FULLNAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP,"TARGET"."MSDYN_PREDICTIVESCOREID"="INPUT"."MSDYN_PREDICTIVESCOREID","TARGET"."MSDYN_PREDICTIVESCOREIDNAME"="INPUT"."MSDYN_PREDICTIVESCOREIDNAME","TARGET"."MSDYN_SALESASSIGNMENTRESULT"="INPUT"."MSDYN_SALESASSIGNMENTRESULT","TARGET"."MSDYN_SALESASSIGNMENTRESULTNAME"="INPUT"."MSDYN_SALESASSIGNMENTRESULTNAME","TARGET"."MSDYN_SEGMENTID"="INPUT"."MSDYN_SEGMENTID","TARGET"."MSDYN_SEGMENTIDNAME"="INPUT"."MSDYN_SEGMENTIDNAME","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."SL_MOST_RECENT_CADENCE_CADENCE_NAME"="INPUT"."SL_MOST_RECENT_CADENCE_CADENCE_NAME","TARGET"."SL_MOST_RECENT_CADENCE_LAST_COMPLETED_STEP"="INPUT"."SL_MOST_RECENT_CADENCE_LAST_COMPLETED_STEP","TARGET"."SL_MOST_RECENT_CADENCE_NEXT_DUE_DATE"="INPUT"."SL_MOST_RECENT_CADENCE_NEXT_DUE_DATE","TARGET"."SN_ACCOUNTCHANGEDBYUSER"="INPUT"."SN_ACCOUNTCHANGEDBYUSER","TARGET"."SN_ACCOUNTCHANGEDBYUSERNAME"="INPUT"."SN_ACCOUNTCHANGEDBYUSERNAME","TARGET"."SN_ACCOUNTMATCHEDBYSYSTEM"="INPUT"."SN_ACCOUNTMATCHEDBYSYSTEM","TARGET"."SN_ACCOUNTMATCHEDBYSYSTEMNAME"="INPUT"."SN_ACCOUNTMATCHEDBYSYSTEMNAME","TARGET"."SN_ACCOUNTMATCHEDUSING"="INPUT"."SN_ACCOUNTMATCHEDUSING","TARGET"."SN_ACCOUNTMATCHEDUSINGNAME"="INPUT"."SN_ACCOUNTMATCHEDUSINGNAME","TARGET"."SN_ACCOUNTREQUESTSTATUS"="INPUT"."SN_ACCOUNTREQUESTSTATUS","TARGET"."SN_ACCOUNTREQUESTSTATUSNAME"="INPUT"."SN_ACCOUNTREQUESTSTATUSNAME","TARGET"."SN_ACTIVATIONDEACTIVATIONTIME"="INPUT"."SN_ACTIVATIONDEACTIVATIONTIME","TARGET"."SN_ACTIVITYTYPEID"="INPUT"."SN_ACTIVITYTYPEID","TARGET"."SN_ACTIVITYTYPEIDNAME"="INPUT"."SN_ACTIVITYTYPEIDNAME","TARGET"."SN_ANONYMIZEFLAG"="INPUT"."SN_ANONYMIZEFLAG","TARGET"."SN_ANONYMIZEFLAGNAME"="INPUT"."SN_ANONYMIZEFLAGNAME","TARGET"."SN_CADENCESLAFLAG"="INPUT"."SN_CADENCESLAFLAG","TARGET"."SN_CADENCESLAFLAGNAME"="INPUT"."SN_CADENCESLAFLAGNAME","TARGET"."SN_CADENCESLAID"="INPUT"."SN_CADENCESLAID","TARGET"."SN_CADENCESLAIDNAME"="INPUT"."SN_CADENCESLAIDNAME","TARGET"."SN_CONVERSATIONSTAGE"="INPUT"."SN_CONVERSATIONSTAGE","TARGET"."SN_CONVERSATIONSTAGENAME"="INPUT"."SN_CONVERSATIONSTAGENAME","TARGET"."SN_CONVERSATIONSTATUS"="INPUT"."SN_CONVERSATIONSTATUS","TARGET"."SN_CONVERSATIONSTATUSNAME"="INPUT"."SN_CONVERSATIONSTATUSNAME","TARGET"."SN_CONVERSICAACTIONREQUIRED"="INPUT"."SN_CONVERSICAACTIONREQUIRED","TARGET"."SN_CONVERSICAACTIONREQUIREDNAME"="INPUT"."SN_CONVERSICAACTIONREQUIREDNAME","TARGET"."SN_CONVERSICACONVERSATIONS"="INPUT"."SN_CONVERSICACONVERSATIONS","TARGET"."SN_CONVERSICADATEADDED"="INPUT"."SN_CONVERSICADATEADDED","TARGET"."SN_CONVERSICADISCOVEREDPHONE1"="INPUT"."SN_CONVERSICADISCOVEREDPHONE1","TARGET"."SN_CONVERSICADISCOVEREDPHONE2"="INPUT"."SN_CONVERSICADISCOVEREDPHONE2","TARGET"."SN_CONVERSICAHOTLEAD"="INPUT"."SN_CONVERSICAHOTLEAD","TARGET"."SN_CONVERSICAHOTLEADNAME"="INPUT"."SN_CONVERSICAHOTLEADNAME","TARGET"."SN_CONVERSICALEADATRISK"="INPUT"."SN_CONVERSICALEADATRISK","TARGET"."SN_CONVERSICALEADATRISKDATE"="INPUT"."SN_CONVERSICALEADATRISKDATE","TARGET"."SN_CONVERSICALEADATRISKNAME"="INPUT"."SN_CONVERSICALEADATRISKNAME","TARGET"."SN_CONVERSICALEADSTATUS"="INPUT"."SN_CONVERSICALEADSTATUS","TARGET"."SN_CONVERSICALEADSTATUSNAME"="INPUT"."SN_CONVERSICALEADSTATUSNAME","TARGET"."SN_CONVERSICAMOSTRECENTRESPONSES"="INPUT"."SN_CONVERSICAMOSTRECENTRESPONSES","TARGET"."SN_CONVERSICASTOP"="INPUT"."SN_CONVERSICASTOP","TARGET"."SN_CONVERSICASTOPNAME"="INPUT"."SN_CONVERSICASTOPNAME","TARGET"."SN_CONVERSICATHREADURL"="INPUT"."SN_CONVERSICATHREADURL","TARGET"."SN_CURRENTTOUCHES"="INPUT"."SN_CURRENTTOUCHES","TARGET"."SN_DONOTSYNCTOMARKETO"="INPUT"."SN_DONOTSYNCTOMARKETO","TARGET"."SN_DONOTSYNCTOMARKETONAME"="INPUT"."SN_DONOTSYNCTOMARKETONAME","TARGET"."SN_DRIFTCONVERSATIONURL"="INPUT"."SN_DRIFTCONVERSATIONURL","TARGET"."SN_EAEMAIL"="INPUT"."SN_EAEMAIL","TARGET"."SN_EAFULLNAME"="INPUT"."SN_EAFULLNAME","TARGET"."SN_EAPHONENUMBER"="INPUT"."SN_EAPHONENUMBER","TARGET"."SN_FIRSTTOUCHSLAID"="INPUT"."SN_FIRSTTOUCHSLAID","TARGET"."SN_FIRSTTOUCHSLAIDNAME"="INPUT"."SN_FIRSTTOUCHSLAIDNAME","TARGET"."SN_GEO"="INPUT"."SN_GEO","TARGET"."SN_GEONAME"="INPUT"."SN_GEONAME","TARGET"."SN_IAMINTERESTEDIN"="INPUT"."SN_IAMINTERESTEDIN","TARGET"."SN_IAMINTERESTEDINNAME"="INPUT"."SN_IAMINTERESTEDINNAME","TARGET"."SN_ISHOTLEADSCAMPAIGN"="INPUT"."SN_ISHOTLEADSCAMPAIGN","TARGET"."SN_ISHOTLEADSCAMPAIGNNAME"="INPUT"."SN_ISHOTLEADSCAMPAIGNNAME","TARGET"."SN_JOBFUNCTION"="INPUT"."SN_JOBFUNCTION","TARGET"."SN_JOBFUNCTIONCLEVEL"="INPUT"."SN_JOBFUNCTIONCLEVEL","TARGET"."SN_JOBFUNCTIONCLEVELNAME"="INPUT"."SN_JOBFUNCTIONCLEVELNAME","TARGET"."SN_JOBFUNCTIONNAME"="INPUT"."SN_JOBFUNCTIONNAME","TARGET"."SN_JOBLEVEL"="INPUT"."SN_JOBLEVEL","TARGET"."SN_JOBLEVELNAME"="INPUT"."SN_JOBLEVELNAME","TARGET"."SN_JOBROLE"="INPUT"."SN_JOBROLE","TARGET"."SN_JOBROLECLEVEL"="INPUT"."SN_JOBROLECLEVEL","TARGET"."SN_JOBROLECLEVELNAME"="INPUT"."SN_JOBROLECLEVELNAME","TARGET"."SN_JOBROLENAME"="INPUT"."SN_JOBROLENAME","TARGET"."SN_LEADASSIGNEDUSING"="INPUT"."SN_LEADASSIGNEDUSING","TARGET"."SN_LEADASSIGNEDUSINGNAME"="INPUT"."SN_LEADASSIGNEDUSINGNAME","TARGET"."SN_LEADRATING"="INPUT"."SN_LEADRATING","TARGET"."SN_LEADRATINGNAME"="INPUT"."SN_LEADRATINGNAME","TARGET"."SN_LEADROUTINGSTATE"="INPUT"."SN_LEADROUTINGSTATE","TARGET"."SN_LEADSOURCEMOSTRECENT"="INPUT"."SN_LEADSOURCEMOSTRECENT","TARGET"."SN_LEADSOURCEMOSTRECENTDATE"="INPUT"."SN_LEADSOURCEMOSTRECENTDATE","TARGET"."SN_LEADSOURCEMOSTRECENTNAME"="INPUT"."SN_LEADSOURCEMOSTRECENTNAME","TARGET"."SN_LEADSOURCEMOSTRECENTNOTES"="INPUT"."SN_LEADSOURCEMOSTRECENTNOTES","TARGET"."SN_LISTSOURCE"="INPUT"."SN_LISTSOURCE","TARGET"."SN_LSDONOTCALL"="INPUT"."SN_LSDONOTCALL","TARGET"."SN_LSDONOTCALLNAME"="INPUT"."SN_LSDONOTCALLNAME","TARGET"."SN_LSDONOTEMAIL"="INPUT"."SN_LSDONOTEMAIL","TARGET"."SN_LSDONOTEMAILNAME"="INPUT"."SN_LSDONOTEMAILNAME","TARGET"."SN_MEMBERSTATUS"="INPUT"."SN_MEMBERSTATUS","TARGET"."SN_MEMBERSTATUSNAME"="INPUT"."SN_MEMBERSTATUSNAME","TARGET"."SN_MOSTRECENTBU"="INPUT"."SN_MOSTRECENTBU","TARGET"."SN_MOSTRECENTBUNAME"="INPUT"."SN_MOSTRECENTBUNAME","TARGET"."SN_NEWBUSINESSPHONE"="INPUT"."SN_NEWBUSINESSPHONE","TARGET"."SN_NEWMOBILEPHONE"="INPUT"."SN_NEWMOBILEPHONE","TARGET"."SN_OWNERCHANGEDATE"="INPUT"."SN_OWNERCHANGEDATE","TARGET"."SN_PEPURL"="INPUT"."SN_PEPURL","TARGET"."SN_PREVIOUSASSIGNEDTO"="INPUT"."SN_PREVIOUSASSIGNEDTO","TARGET"."SN_PREVIOUSASSIGNEDTONAME"="INPUT"."SN_PREVIOUSASSIGNEDTONAME","TARGET"."SN_PREVIOUSASSIGNEDTOYOMINAME"="INPUT"."SN_PREVIOUSASSIGNEDTOYOMINAME","TARGET"."SN_PREVIOUSLYASSIGNEDTO"="INPUT"."SN_PREVIOUSLYASSIGNEDTO","TARGET"."SN_REASONCODE"="INPUT"."SN_REASONCODE","TARGET"."SN_REASONCODENAME"="INPUT"."SN_REASONCODENAME","TARGET"."SN_REASONINACTIVE"="INPUT"."SN_REASONINACTIVE","TARGET"."SN_REASONINACTIVENAME"="INPUT"."SN_REASONINACTIVENAME","TARGET"."SN_REJECTNOTES"="INPUT"."SN_REJECTNOTES","TARGET"."SN_SALESREPNAME"="INPUT"."SN_SALESREPNAME","TARGET"."SN_SLADUEDATE"="INPUT"."SN_SLADUEDATE","TARGET"."SN_SURFSTATUS"="INPUT"."SN_SURFSTATUS","TARGET"."SN_SURFSTATUSNAME"="INPUT"."SN_SURFSTATUSNAME","TARGET"."SN_SURFSYSID"="INPUT"."SN_SURFSYSID","TARGET"."SN_DLRRULE"="INPUT"."SN_DLRRULE" WHEN NOT MATCHED THEN INSERT ("PREFERREDCONTACTMETHODCODENAME","EMAILADDRESS3","EMAILADDRESS2","EMAILADDRESS1","ADDRESS1_CITY","BUDGETAMOUNT_BASE","ADDRESS1_LINE1","BUDGETSTATUS","MODIFIEDON","OVERRIDDENCREATEDON","WEBSITEURL","YOMIFIRSTNAME","ADDRESS1_LONGITUDE","DONOTPOSTALMAIL","YOMIFULLNAME","ADDRESS1_ADDRESSTYPECODE","ENTITYIMAGE_TIMESTAMP","CONTACTIDNAME","EVALUATEFITNAME","TELEPHONE3","QUALIFYINGOPPORTUNITYID","CONFIRMINTEREST","PURCHASETIMEFRAMENAME","DONOTSENDMM","ADDRESS2_COUNTY","TRANSACTIONCURRENCYIDNAME","ENTITYIMAGE_URL","SALESSTAGENAME","SN_STATE","ADDRESS1_SHIPPINGMETHODCODE","ESTIMATEDAMOUNT","ACCOUNTIDNAME","RELATEDOBJECTIDNAME","SLAINVOKEDID","ADDRESS1_SHIPPINGMETHODCODENAME","MASTERLEADIDYOMINAME","OWNINGBUSINESSUNIT","SN_PROJECTEDMEETINGDATE","ADDRESS2_STATEORPROVINCE","PARTICIPATESINWORKFLOWNAME","SN_LEADNUMBER","MOBILEPHONE","ADDRESS2_COUNTRY","YOMICOMPANYNAME","ADDRESS2_LINE2","ACCOUNTID","RELATEDOBJECTID","SLAID","MSDYN_LEADSCORETREND","PARENTCONTACTID","ADDRESS1_LINE3","ESTIMATEDCLOSEDATE","CONTACTID","SN_MEETINGFORECASTSTAGE","SN_STATENAME","CONTACTIDYOMINAME","PARENTACCOUNTIDNAME","INDUSTRYCODENAME","ADDRESS1_UTCOFFSET","DONOTSENDMARKETINGMATERIALNAME","NUMBEROFEMPLOYEES","INITIALCOMMUNICATION","STATECODENAME","REVENUE","EXCHANGERATE","ISPRIVATE","COMPANYNAME","PARENTACCOUNTID","ADDRESS2_CITY","STATUSCODE","ADDRESS1_ADDRESSTYPECODENAME","ADDRESS2_LATITUDE","PRIORITYCODENAME","CREATEDON","DONOTBULKEMAIL","SLANAME","MSDYN_LEADKPIID","DONOTFAX","PURCHASEPROCESSNAME","YOMIMIDDLENAME","TIMESPENTBYMEONEMAILANDMEETINGS","ADDRESS1_COMPOSITE","FIRSTNAME","STATUSCODENAME","SALESSTAGE","MSDYN_SCOREHISTORY","QUALIFICATIONCOMMENTS","BUDGETSTATUSNAME","ADDRESS2_POSTALCODE","CUSTOMERIDTYPE","EVALUATEFIT","MSDYN_GDPROPTOUTNAME","ONHOLDTIME","MSDYN_LEADGRADE","OWNERIDYOMINAME","ISAUTOCREATE","TEAMSFOLLOWED","ADDRESS2_SHIPPINGMETHODCODENAME","ADDRESS2_LINE3","DESCRIPTION","MODIFIEDBY","TIMEZONERULEVERSIONNUMBER","ADDRESS1_COUNTY","PREFERREDCONTACTMETHODCODE","MODIFIEDONBEHALFBY","SUBJECT","DONOTEMAIL","DONOTPHONENAME","PAGER","SN_PRIMARYSALESREPYOMINAME","ADDRESS2_POSTOFFICEBOX","ADDRESS2_TELEPHONE1","ADDRESS2_TELEPHONE2","ADDRESS2_TELEPHONE3","ADDRESS1_ADDRESSID","TRAVERSEDPATH","FOLLOWEMAILNAME","ESTIMATEDVALUE","CREATEDONBEHALFBYNAME","OWNINGUSER","INDUSTRYCODE","SALESSTAGECODE","ADDRESS2_NAME","SCHEDULEFOLLOWUP_QUALIFY","OWNERIDTYPE","ESTIMATEDAMOUNT_BASE","ENTITYIMAGEID","FOLLOWEMAIL","OWNERIDNAME","ENTITYIMAGE","MODIFIEDONBEHALFBYNAME","CREATEDONBEHALFBYYOMINAME","ADDRESS2_COMPOSITE","CUSTOMERID","ADDRESS1_COUNTRY","BUSINESSCARDATTRIBUTES","OWNINGTEAM","ADDRESS1_STATEORPROVINCE","ISPRIVATENAME","LEADQUALITYCODENAME","PROCESSID","DECISIONMAKER","CREATEDONBEHALFBY","SALESSTAGECODENAME","JOBTITLE","SN_COUNTRYNAME","TRANSACTIONCURRENCYID","ADDRESS1_TELEPHONE1","ADDRESS1_TELEPHONE2","ADDRESS1_TELEPHONE3","CUSTOMERIDYOMINAME","ADDRESS1_POSTOFFICEBOX","PARENTCONTACTIDYOMINAME","ORIGINATINGCASEID","DONOTEMAILNAME","SLAINVOKEDIDNAME","MSDYN_LEADKPIIDNAME","FAX","MASTERID","TELEPHONE1","SIC","OWNERID","LASTUSEDINCAMPAIGN","ADDRESS2_UTCOFFSET","PARTICIPATESINWORKFLOW","MSDYN_LEADGRADENAME","MSDYN_LEADSCORETRENDNAME","ADDRESS2_FAX","REVENUE_BASE","MERGED","LEADQUALITYCODE","PURCHASETIMEFRAME","BUDGETAMOUNT","ADDRESS2_LONGITUDE","CREATEDBYNAME","MSDYN_LEADSCORE","DONOTPHONE","ISAUTOCREATENAME","NEEDNAME","MODIFIEDBYYOMINAME","LASTONHOLDTIME","SCHEDULEFOLLOWUP_PROSPECT","ADDRESS1_LINE2","MODIFIEDONBEHALFBYYOMINAME","CREATEDBY","ADDRESS2_ADDRESSTYPECODE","ADDRESS2_UPSZONE","CONFIRMINTERESTNAME","SN_MEETINGFORECASTSTAGENAME","DONOTFAXNAME","MSDYN_SCOREREASONS","ADDRESS2_ADDRESSTYPECODENAME","SALUTATION","PRIORITYCODE","ADDRESS1_POSTALCODE","LEADSOURCECODENAME","STAGEID","UTCCONVERSIONTIMEZONECODE","DONOTBULKEMAILNAME","SN_COUNTRY","CAMPAIGNID","QUALIFYINGOPPORTUNITYIDNAME","MSDYN_GDPROPTOUT","ADDRESS2_ADDRESSID","SN_PRIMARYSALESREP","BUSINESSCARD","CUSTOMERIDNAME","IMPORTSEQUENCENUMBER","MASTERLEADIDNAME","TELEPHONE2","MERGEDNAME","YOMILASTNAME","VERSIONNUMBER","CAMPAIGNIDNAME","MIDDLENAME","ADDRESS1_NAME","ADDRESS1_FAX","ADDRESS1_LATITUDE","ADDRESS2_SHIPPINGMETHODCODE","SN_PRIMARYSALESREPNAME","ORIGINATINGCASEIDNAME","PARENTCONTACTIDNAME","PURCHASEPROCESS","MODIFIEDBYNAME","CREATEDBYYOMINAME","LEADSOURCECODE","ADDRESS2_LINE1","ADDRESS1_UPSZONE","LASTNAME","ACCOUNTIDYOMINAME","LEADID","DONOTPOSTALMAILNAME","INITIALCOMMUNICATIONNAME","NEED","PARENTACCOUNTIDYOMINAME","DECISIONMAKERNAME","FULLNAME","STATECODE","ETL_UPDATE_DATE","MSDYN_PREDICTIVESCOREID","MSDYN_PREDICTIVESCOREIDNAME","MSDYN_SALESASSIGNMENTRESULT","MSDYN_SALESASSIGNMENTRESULTNAME","MSDYN_SEGMENTID","MSDYN_SEGMENTIDNAME","OWNINGBUSINESSUNITNAME","SL_MOST_RECENT_CADENCE_CADENCE_NAME","SL_MOST_RECENT_CADENCE_LAST_COMPLETED_STEP","SL_MOST_RECENT_CADENCE_NEXT_DUE_DATE","SN_ACCOUNTCHANGEDBYUSER","SN_ACCOUNTCHANGEDBYUSERNAME","SN_ACCOUNTMATCHEDBYSYSTEM","SN_ACCOUNTMATCHEDBYSYSTEMNAME","SN_ACCOUNTMATCHEDUSING","SN_ACCOUNTMATCHEDUSINGNAME","SN_ACCOUNTREQUESTSTATUS","SN_ACCOUNTREQUESTSTATUSNAME","SN_ACTIVATIONDEACTIVATIONTIME","SN_ACTIVITYTYPEID","SN_ACTIVITYTYPEIDNAME","SN_ANONYMIZEFLAG","SN_ANONYMIZEFLAGNAME","SN_CADENCESLAFLAG","SN_CADENCESLAFLAGNAME","SN_CADENCESLAID","SN_CADENCESLAIDNAME","SN_CONVERSATIONSTAGE","SN_CONVERSATIONSTAGENAME","SN_CONVERSATIONSTATUS","SN_CONVERSATIONSTATUSNAME","SN_CONVERSICAACTIONREQUIRED","SN_CONVERSICAACTIONREQUIREDNAME","SN_CONVERSICACONVERSATIONS","SN_CONVERSICADATEADDED","SN_CONVERSICADISCOVEREDPHONE1","SN_CONVERSICADISCOVEREDPHONE2","SN_CONVERSICAHOTLEAD","SN_CONVERSICAHOTLEADNAME","SN_CONVERSICALEADATRISK","SN_CONVERSICALEADATRISKDATE","SN_CONVERSICALEADATRISKNAME","SN_CONVERSICALEADSTATUS","SN_CONVERSICALEADSTATUSNAME","SN_CONVERSICAMOSTRECENTRESPONSES","SN_CONVERSICASTOP","SN_CONVERSICASTOPNAME","SN_CONVERSICATHREADURL","SN_CURRENTTOUCHES","SN_DONOTSYNCTOMARKETO","SN_DONOTSYNCTOMARKETONAME","SN_DRIFTCONVERSATIONURL","SN_EAEMAIL","SN_EAFULLNAME","SN_EAPHONENUMBER","SN_FIRSTTOUCHSLAID","SN_FIRSTTOUCHSLAIDNAME","SN_GEO","SN_GEONAME","SN_IAMINTERESTEDIN","SN_IAMINTERESTEDINNAME","SN_ISHOTLEADSCAMPAIGN","SN_ISHOTLEADSCAMPAIGNNAME","SN_JOBFUNCTION","SN_JOBFUNCTIONCLEVEL","SN_JOBFUNCTIONCLEVELNAME","SN_JOBFUNCTIONNAME","SN_JOBLEVEL","SN_JOBLEVELNAME","SN_JOBROLE","SN_JOBROLECLEVEL","SN_JOBROLECLEVELNAME","SN_JOBROLENAME","SN_LEADASSIGNEDUSING","SN_LEADASSIGNEDUSINGNAME","SN_LEADRATING","SN_LEADRATINGNAME","SN_LEADROUTINGSTATE","SN_LEADSOURCEMOSTRECENT","SN_LEADSOURCEMOSTRECENTDATE","SN_LEADSOURCEMOSTRECENTNAME","SN_LEADSOURCEMOSTRECENTNOTES","SN_LISTSOURCE","SN_LSDONOTCALL","SN_LSDONOTCALLNAME","SN_LSDONOTEMAIL","SN_LSDONOTEMAILNAME","SN_MEMBERSTATUS","SN_MEMBERSTATUSNAME","SN_MOSTRECENTBU","SN_MOSTRECENTBUNAME","SN_NEWBUSINESSPHONE","SN_NEWMOBILEPHONE","SN_OWNERCHANGEDATE","SN_PEPURL","SN_PREVIOUSASSIGNEDTO","SN_PREVIOUSASSIGNEDTONAME","SN_PREVIOUSASSIGNEDTOYOMINAME","SN_PREVIOUSLYASSIGNEDTO","SN_REASONCODE","SN_REASONCODENAME","SN_REASONINACTIVE","SN_REASONINACTIVENAME","SN_REJECTNOTES","SN_SALESREPNAME","SN_SLADUEDATE","SN_SURFSTATUS","SN_SURFSTATUSNAME","SN_SURFSYSID","SN_DLRRULE") VALUES ("INPUT"."PREFERREDCONTACTMETHODCODENAME","INPUT"."EMAILADDRESS3","INPUT"."EMAILADDRESS2","INPUT"."EMAILADDRESS1","INPUT"."ADDRESS1_CITY","INPUT"."BUDGETAMOUNT_BASE","INPUT"."ADDRESS1_LINE1","INPUT"."BUDGETSTATUS","INPUT"."MODIFIEDON","INPUT"."OVERRIDDENCREATEDON","INPUT"."WEBSITEURL","INPUT"."YOMIFIRSTNAME","INPUT"."ADDRESS1_LONGITUDE","INPUT"."DONOTPOSTALMAIL","INPUT"."YOMIFULLNAME","INPUT"."ADDRESS1_ADDRESSTYPECODE","INPUT"."ENTITYIMAGE_TIMESTAMP","INPUT"."CONTACTIDNAME","INPUT"."EVALUATEFITNAME","INPUT"."TELEPHONE3","INPUT"."QUALIFYINGOPPORTUNITYID","INPUT"."CONFIRMINTEREST","INPUT"."PURCHASETIMEFRAMENAME","INPUT"."DONOTSENDMM","INPUT"."ADDRESS2_COUNTY","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."ENTITYIMAGE_URL","INPUT"."SALESSTAGENAME","INPUT"."SN_STATE","INPUT"."ADDRESS1_SHIPPINGMETHODCODE","INPUT"."ESTIMATEDAMOUNT","INPUT"."ACCOUNTIDNAME","INPUT"."RELATEDOBJECTIDNAME","INPUT"."SLAINVOKEDID","INPUT"."ADDRESS1_SHIPPINGMETHODCODENAME","INPUT"."MASTERLEADIDYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."SN_PROJECTEDMEETINGDATE","INPUT"."ADDRESS2_STATEORPROVINCE","INPUT"."PARTICIPATESINWORKFLOWNAME","INPUT"."SN_LEADNUMBER","INPUT"."MOBILEPHONE","INPUT"."ADDRESS2_COUNTRY","INPUT"."YOMICOMPANYNAME","INPUT"."ADDRESS2_LINE2","INPUT"."ACCOUNTID","INPUT"."RELATEDOBJECTID","INPUT"."SLAID","INPUT"."MSDYN_LEADSCORETREND","INPUT"."PARENTCONTACTID","INPUT"."ADDRESS1_LINE3","INPUT"."ESTIMATEDCLOSEDATE","INPUT"."CONTACTID","INPUT"."SN_MEETINGFORECASTSTAGE","INPUT"."SN_STATENAME","INPUT"."CONTACTIDYOMINAME","INPUT"."PARENTACCOUNTIDNAME","INPUT"."INDUSTRYCODENAME","INPUT"."ADDRESS1_UTCOFFSET","INPUT"."DONOTSENDMARKETINGMATERIALNAME","INPUT"."NUMBEROFEMPLOYEES","INPUT"."INITIALCOMMUNICATION","INPUT"."STATECODENAME","INPUT"."REVENUE","INPUT"."EXCHANGERATE","INPUT"."ISPRIVATE","INPUT"."COMPANYNAME","INPUT"."PARENTACCOUNTID","INPUT"."ADDRESS2_CITY","INPUT"."STATUSCODE","INPUT"."ADDRESS1_ADDRESSTYPECODENAME","INPUT"."ADDRESS2_LATITUDE","INPUT"."PRIORITYCODENAME","INPUT"."CREATEDON","INPUT"."DONOTBULKEMAIL","INPUT"."SLANAME","INPUT"."MSDYN_LEADKPIID","INPUT"."DONOTFAX","INPUT"."PURCHASEPROCESSNAME","INPUT"."YOMIMIDDLENAME","INPUT"."TIMESPENTBYMEONEMAILANDMEETINGS","INPUT"."ADDRESS1_COMPOSITE","INPUT"."FIRSTNAME","INPUT"."STATUSCODENAME","INPUT"."SALESSTAGE","INPUT"."MSDYN_SCOREHISTORY","INPUT"."QUALIFICATIONCOMMENTS","INPUT"."BUDGETSTATUSNAME","INPUT"."ADDRESS2_POSTALCODE","INPUT"."CUSTOMERIDTYPE","INPUT"."EVALUATEFIT","INPUT"."MSDYN_GDPROPTOUTNAME","INPUT"."ONHOLDTIME","INPUT"."MSDYN_LEADGRADE","INPUT"."OWNERIDYOMINAME","INPUT"."ISAUTOCREATE","INPUT"."TEAMSFOLLOWED","INPUT"."ADDRESS2_SHIPPINGMETHODCODENAME","INPUT"."ADDRESS2_LINE3","INPUT"."DESCRIPTION","INPUT"."MODIFIEDBY","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."ADDRESS1_COUNTY","INPUT"."PREFERREDCONTACTMETHODCODE","INPUT"."MODIFIEDONBEHALFBY","INPUT"."SUBJECT","INPUT"."DONOTEMAIL","INPUT"."DONOTPHONENAME","INPUT"."PAGER","INPUT"."SN_PRIMARYSALESREPYOMINAME","INPUT"."ADDRESS2_POSTOFFICEBOX","INPUT"."ADDRESS2_TELEPHONE1","INPUT"."ADDRESS2_TELEPHONE2","INPUT"."ADDRESS2_TELEPHONE3","INPUT"."ADDRESS1_ADDRESSID","INPUT"."TRAVERSEDPATH","INPUT"."FOLLOWEMAILNAME","INPUT"."ESTIMATEDVALUE","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."OWNINGUSER","INPUT"."INDUSTRYCODE","INPUT"."SALESSTAGECODE","INPUT"."ADDRESS2_NAME","INPUT"."SCHEDULEFOLLOWUP_QUALIFY","INPUT"."OWNERIDTYPE","INPUT"."ESTIMATEDAMOUNT_BASE","INPUT"."ENTITYIMAGEID","INPUT"."FOLLOWEMAIL","INPUT"."OWNERIDNAME","INPUT"."ENTITYIMAGE","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."ADDRESS2_COMPOSITE","INPUT"."CUSTOMERID","INPUT"."ADDRESS1_COUNTRY","INPUT"."BUSINESSCARDATTRIBUTES","INPUT"."OWNINGTEAM","INPUT"."ADDRESS1_STATEORPROVINCE","INPUT"."ISPRIVATENAME","INPUT"."LEADQUALITYCODENAME","INPUT"."PROCESSID","INPUT"."DECISIONMAKER","INPUT"."CREATEDONBEHALFBY","INPUT"."SALESSTAGECODENAME","INPUT"."JOBTITLE","INPUT"."SN_COUNTRYNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."ADDRESS1_TELEPHONE1","INPUT"."ADDRESS1_TELEPHONE2","INPUT"."ADDRESS1_TELEPHONE3","INPUT"."CUSTOMERIDYOMINAME","INPUT"."ADDRESS1_POSTOFFICEBOX","INPUT"."PARENTCONTACTIDYOMINAME","INPUT"."ORIGINATINGCASEID","INPUT"."DONOTEMAILNAME","INPUT"."SLAINVOKEDIDNAME","INPUT"."MSDYN_LEADKPIIDNAME","INPUT"."FAX","INPUT"."MASTERID","INPUT"."TELEPHONE1","INPUT"."SIC","INPUT"."OWNERID","INPUT"."LASTUSEDINCAMPAIGN","INPUT"."ADDRESS2_UTCOFFSET","INPUT"."PARTICIPATESINWORKFLOW","INPUT"."MSDYN_LEADGRADENAME","INPUT"."MSDYN_LEADSCORETRENDNAME","INPUT"."ADDRESS2_FAX","INPUT"."REVENUE_BASE","INPUT"."MERGED","INPUT"."LEADQUALITYCODE","INPUT"."PURCHASETIMEFRAME","INPUT"."BUDGETAMOUNT","INPUT"."ADDRESS2_LONGITUDE","INPUT"."CREATEDBYNAME","INPUT"."MSDYN_LEADSCORE","INPUT"."DONOTPHONE","INPUT"."ISAUTOCREATENAME","INPUT"."NEEDNAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."LASTONHOLDTIME","INPUT"."SCHEDULEFOLLOWUP_PROSPECT","INPUT"."ADDRESS1_LINE2","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."CREATEDBY","INPUT"."ADDRESS2_ADDRESSTYPECODE","INPUT"."ADDRESS2_UPSZONE","INPUT"."CONFIRMINTERESTNAME","INPUT"."SN_MEETINGFORECASTSTAGENAME","INPUT"."DONOTFAXNAME","INPUT"."MSDYN_SCOREREASONS","INPUT"."ADDRESS2_ADDRESSTYPECODENAME","INPUT"."SALUTATION","INPUT"."PRIORITYCODE","INPUT"."ADDRESS1_POSTALCODE","INPUT"."LEADSOURCECODENAME","INPUT"."STAGEID","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."DONOTBULKEMAILNAME","INPUT"."SN_COUNTRY","INPUT"."CAMPAIGNID","INPUT"."QUALIFYINGOPPORTUNITYIDNAME","INPUT"."MSDYN_GDPROPTOUT","INPUT"."ADDRESS2_ADDRESSID","INPUT"."SN_PRIMARYSALESREP","INPUT"."BUSINESSCARD","INPUT"."CUSTOMERIDNAME","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."MASTERLEADIDNAME","INPUT"."TELEPHONE2","INPUT"."MERGEDNAME","INPUT"."YOMILASTNAME","INPUT"."VERSIONNUMBER","INPUT"."CAMPAIGNIDNAME","INPUT"."MIDDLENAME","INPUT"."ADDRESS1_NAME","INPUT"."ADDRESS1_FAX","INPUT"."ADDRESS1_LATITUDE","INPUT"."ADDRESS2_SHIPPINGMETHODCODE","INPUT"."SN_PRIMARYSALESREPNAME","INPUT"."ORIGINATINGCASEIDNAME","INPUT"."PARENTCONTACTIDNAME","INPUT"."PURCHASEPROCESS","INPUT"."MODIFIEDBYNAME","INPUT"."CREATEDBYYOMINAME","INPUT"."LEADSOURCECODE","INPUT"."ADDRESS2_LINE1","INPUT"."ADDRESS1_UPSZONE","INPUT"."LASTNAME","INPUT"."ACCOUNTIDYOMINAME","INPUT"."LEADID","INPUT"."DONOTPOSTALMAILNAME","INPUT"."INITIALCOMMUNICATIONNAME","INPUT"."NEED","INPUT"."PARENTACCOUNTIDYOMINAME","INPUT"."DECISIONMAKERNAME","INPUT"."FULLNAME","INPUT"."STATECODE",CURRENT_TIMESTAMP,"INPUT"."MSDYN_PREDICTIVESCOREID","INPUT"."MSDYN_PREDICTIVESCOREIDNAME","INPUT"."MSDYN_SALESASSIGNMENTRESULT","INPUT"."MSDYN_SALESASSIGNMENTRESULTNAME","INPUT"."MSDYN_SEGMENTID","INPUT"."MSDYN_SEGMENTIDNAME","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."SL_MOST_RECENT_CADENCE_CADENCE_NAME","INPUT"."SL_MOST_RECENT_CADENCE_LAST_COMPLETED_STEP","INPUT"."SL_MOST_RECENT_CADENCE_NEXT_DUE_DATE","INPUT"."SN_ACCOUNTCHANGEDBYUSER","INPUT"."SN_ACCOUNTCHANGEDBYUSERNAME","INPUT"."SN_ACCOUNTMATCHEDBYSYSTEM","INPUT"."SN_ACCOUNTMATCHEDBYSYSTEMNAME","INPUT"."SN_ACCOUNTMATCHEDUSING","INPUT"."SN_ACCOUNTMATCHEDUSINGNAME","INPUT"."SN_ACCOUNTREQUESTSTATUS","INPUT"."SN_ACCOUNTREQUESTSTATUSNAME","INPUT"."SN_ACTIVATIONDEACTIVATIONTIME","INPUT"."SN_ACTIVITYTYPEID","INPUT"."SN_ACTIVITYTYPEIDNAME","INPUT"."SN_ANONYMIZEFLAG","INPUT"."SN_ANONYMIZEFLAGNAME","INPUT"."SN_CADENCESLAFLAG","INPUT"."SN_CADENCESLAFLAGNAME","INPUT"."SN_CADENCESLAID","INPUT"."SN_CADENCESLAIDNAME","INPUT"."SN_CONVERSATIONSTAGE","INPUT"."SN_CONVERSATIONSTAGENAME","INPUT"."SN_CONVERSATIONSTATUS","INPUT"."SN_CONVERSATIONSTATUSNAME","INPUT"."SN_CONVERSICAACTIONREQUIRED","INPUT"."SN_CONVERSICAACTIONREQUIREDNAME","INPUT"."SN_CONVERSICACONVERSATIONS","INPUT"."SN_CONVERSICADATEADDED","INPUT"."SN_CONVERSICADISCOVEREDPHONE1","INPUT"."SN_CONVERSICADISCOVEREDPHONE2","INPUT"."SN_CONVERSICAHOTLEAD","INPUT"."SN_CONVERSICAHOTLEADNAME","INPUT"."SN_CONVERSICALEADATRISK","INPUT"."SN_CONVERSICALEADATRISKDATE","INPUT"."SN_CONVERSICALEADATRISKNAME","INPUT"."SN_CONVERSICALEADSTATUS","INPUT"."SN_CONVERSICALEADSTATUSNAME","INPUT"."SN_CONVERSICAMOSTRECENTRESPONSES","INPUT"."SN_CONVERSICASTOP","INPUT"."SN_CONVERSICASTOPNAME","INPUT"."SN_CONVERSICATHREADURL","INPUT"."SN_CURRENTTOUCHES","INPUT"."SN_DONOTSYNCTOMARKETO","INPUT"."SN_DONOTSYNCTOMARKETONAME","INPUT"."SN_DRIFTCONVERSATIONURL","INPUT"."SN_EAEMAIL","INPUT"."SN_EAFULLNAME","INPUT"."SN_EAPHONENUMBER","INPUT"."SN_FIRSTTOUCHSLAID","INPUT"."SN_FIRSTTOUCHSLAIDNAME","INPUT"."SN_GEO","INPUT"."SN_GEONAME","INPUT"."SN_IAMINTERESTEDIN","INPUT"."SN_IAMINTERESTEDINNAME","INPUT"."SN_ISHOTLEADSCAMPAIGN","INPUT"."SN_ISHOTLEADSCAMPAIGNNAME","INPUT"."SN_JOBFUNCTION","INPUT"."SN_JOBFUNCTIONCLEVEL","INPUT"."SN_JOBFUNCTIONCLEVELNAME","INPUT"."SN_JOBFUNCTIONNAME","INPUT"."SN_JOBLEVEL","INPUT"."SN_JOBLEVELNAME","INPUT"."SN_JOBROLE","INPUT"."SN_JOBROLECLEVEL","INPUT"."SN_JOBROLECLEVELNAME","INPUT"."SN_JOBROLENAME","INPUT"."SN_LEADASSIGNEDUSING","INPUT"."SN_LEADASSIGNEDUSINGNAME","INPUT"."SN_LEADRATING","INPUT"."SN_LEADRATINGNAME","INPUT"."SN_LEADROUTINGSTATE","INPUT"."SN_LEADSOURCEMOSTRECENT","INPUT"."SN_LEADSOURCEMOSTRECENTDATE","INPUT"."SN_LEADSOURCEMOSTRECENTNAME","INPUT"."SN_LEADSOURCEMOSTRECENTNOTES","INPUT"."SN_LISTSOURCE","INPUT"."SN_LSDONOTCALL","INPUT"."SN_LSDONOTCALLNAME","INPUT"."SN_LSDONOTEMAIL","INPUT"."SN_LSDONOTEMAILNAME","INPUT"."SN_MEMBERSTATUS","INPUT"."SN_MEMBERSTATUSNAME","INPUT"."SN_MOSTRECENTBU","INPUT"."SN_MOSTRECENTBUNAME","INPUT"."SN_NEWBUSINESSPHONE","INPUT"."SN_NEWMOBILEPHONE","INPUT"."SN_OWNERCHANGEDATE","INPUT"."SN_PEPURL","INPUT"."SN_PREVIOUSASSIGNEDTO","INPUT"."SN_PREVIOUSASSIGNEDTONAME","INPUT"."SN_PREVIOUSASSIGNEDTOYOMINAME","INPUT"."SN_PREVIOUSLYASSIGNEDTO","INPUT"."SN_REASONCODE","INPUT"."SN_REASONCODENAME","INPUT"."SN_REASONINACTIVE","INPUT"."SN_REASONINACTIVENAME","INPUT"."SN_REJECTNOTES","INPUT"."SN_SALESREPNAME","INPUT"."SN_SLADUEDATE","INPUT"."SN_SURFSTATUS","INPUT"."SN_SURFSTATUSNAME","INPUT"."SN_SURFSYSID","INPUT"."SN_DLRRULE")
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_leads"},
        {"dynamics365.leads"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_system_users():
    """
    ServiceNow Query ID 1114 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.systemusers TARGET USING ( SELECT * FROM DYNAMICS365.stg_systemusers WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SYSTEMUSERID"="INPUT"."SYSTEMUSERID" WHEN MATCHED THEN UPDATE SET "TARGET"."FULLNAME"="INPUT"."FULLNAME","TARGET"."ADDRESS1_POSTOFFICEBOX"="INPUT"."ADDRESS1_POSTOFFICEBOX","TARGET"."SETUPUSER"="INPUT"."SETUPUSER","TARGET"."IDENTITYID"="INPUT"."IDENTITYID","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."ADDRESS1_LINE1"="INPUT"."ADDRESS1_LINE1","TARGET"."ADDRESS2_STATEORPROVINCE"="INPUT"."ADDRESS2_STATEORPROVINCE","TARGET"."QUEUEID"="INPUT"."QUEUEID","TARGET"."INCOMINGEMAILDELIVERYMETHODNAME"="INPUT"."INCOMINGEMAILDELIVERYMETHODNAME","TARGET"."ISLICENSEDNAME"="INPUT"."ISLICENSEDNAME","TARGET"."YOMIFULLNAME"="INPUT"."YOMIFULLNAME","TARGET"."SN_ISDISABLED_PROXYNAME"="INPUT"."SN_ISDISABLED_PROXYNAME","TARGET"."MSDYN_GDPROPTOUT"="INPUT"."MSDYN_GDPROPTOUT","TARGET"."ADDRESS1_LINE3"="INPUT"."ADDRESS1_LINE3","TARGET"."ADDRESS1_ADDRESSTYPECODENAME"="INPUT"."ADDRESS1_ADDRESSTYPECODENAME","TARGET"."SALUTATION"="INPUT"."SALUTATION","TARGET"."ISDISABLEDNAME"="INPUT"."ISDISABLEDNAME","TARGET"."ADDRESS2_TELEPHONE3"="INPUT"."ADDRESS2_TELEPHONE3","TARGET"."ORGANIZATIONID"="INPUT"."ORGANIZATIONID","TARGET"."ADDRESS2_COUNTY"="INPUT"."ADDRESS2_COUNTY","TARGET"."PREFERREDEMAILCODENAME"="INPUT"."PREFERREDEMAILCODENAME","TARGET"."OUTGOINGEMAILDELIVERYMETHODNAME"="INPUT"."OUTGOINGEMAILDELIVERYMETHODNAME","TARGET"."ENTITYIMAGE_URL"="INPUT"."ENTITYIMAGE_URL","TARGET"."CALENDARID"="INPUT"."CALENDARID","TARGET"."ADDRESS2_SHIPPINGMETHODCODE"="INPUT"."ADDRESS2_SHIPPINGMETHODCODE","TARGET"."ADDRESS1_SHIPPINGMETHODCODENAME"="INPUT"."ADDRESS1_SHIPPINGMETHODCODENAME","TARGET"."ACCESSMODE"="INPUT"."ACCESSMODE","TARGET"."SHAREPOINTEMAILADDRESS"="INPUT"."SHAREPOINTEMAILADDRESS","TARGET"."ADDRESS1_POSTALCODE"="INPUT"."ADDRESS1_POSTALCODE","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."ADDRESS2_FAX"="INPUT"."ADDRESS2_FAX","TARGET"."ORGANIZATIONIDNAME"="INPUT"."ORGANIZATIONIDNAME","TARGET"."ADDRESS2_POSTOFFICEBOX"="INPUT"."ADDRESS2_POSTOFFICEBOX","TARGET"."ADDRESS1_UTCOFFSET"="INPUT"."ADDRESS1_UTCOFFSET","TARGET"."ADDRESS2_POSTALCODE"="INPUT"."ADDRESS2_POSTALCODE","TARGET"."ADDRESS1_SHIPPINGMETHODCODE"="INPUT"."ADDRESS1_SHIPPINGMETHODCODE","TARGET"."SITEID"="INPUT"."SITEID","TARGET"."YOMIFIRSTNAME"="INPUT"."YOMIFIRSTNAME","TARGET"."POSITIONIDNAME"="INPUT"."POSITIONIDNAME","TARGET"."ADDRESS2_LINE1"="INPUT"."ADDRESS2_LINE1","TARGET"."PASSPORTHI"="INPUT"."PASSPORTHI","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."SN_REGIONNAME"="INPUT"."SN_REGIONNAME","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."ADDRESS2_UPSZONE"="INPUT"."ADDRESS2_UPSZONE","TARGET"."EMPLOYEEID"="INPUT"."EMPLOYEEID","TARGET"."PREFERREDADDRESSCODE"="INPUT"."PREFERREDADDRESSCODE","TARGET"."PREFERREDEMAILCODE"="INPUT"."PREFERREDEMAILCODE","TARGET"."USERLICENSETYPE"="INPUT"."USERLICENSETYPE","TARGET"."PASSPORTLO"="INPUT"."PASSPORTLO","TARGET"."SN_USERPERSONA"="INPUT"."SN_USERPERSONA","TARGET"."WINDOWSLIVEID"="INPUT"."WINDOWSLIVEID","TARGET"."QUEUEIDNAME"="INPUT"."QUEUEIDNAME","TARGET"."GOVERNMENTID"="INPUT"."GOVERNMENTID","TARGET"."ADDRESS2_TELEPHONE1"="INPUT"."ADDRESS2_TELEPHONE1","TARGET"."MOBILEPHONE"="INPUT"."MOBILEPHONE","TARGET"."ADDRESS1_TELEPHONE2"="INPUT"."ADDRESS1_TELEPHONE2","TARGET"."ADDRESS1_TELEPHONE3"="INPUT"."ADDRESS1_TELEPHONE3","TARGET"."DEFAULTFILTERSPOPULATED"="INPUT"."DEFAULTFILTERSPOPULATED","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."ADDRESS2_UTCOFFSET"="INPUT"."ADDRESS2_UTCOFFSET","TARGET"."PERSONALEMAILADDRESS"="INPUT"."PERSONALEMAILADDRESS","TARGET"."CALTYPE"="INPUT"."CALTYPE","TARGET"."ADDRESS1_COUNTY"="INPUT"."ADDRESS1_COUNTY","TARGET"."ADDRESS2_COMPOSITE"="INPUT"."ADDRESS2_COMPOSITE","TARGET"."STAGEID"="INPUT"."STAGEID","TARGET"."ISINTEGRATIONUSER"="INPUT"."ISINTEGRATIONUSER","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."ADDRESS2_ADDRESSTYPECODENAME"="INPUT"."ADDRESS2_ADDRESSTYPECODENAME","TARGET"."ACCESSMODENAME"="INPUT"."ACCESSMODENAME","TARGET"."HOMEPHONE"="INPUT"."HOMEPHONE","TARGET"."ADDRESS1_ADDRESSTYPECODE"="INPUT"."ADDRESS1_ADDRESSTYPECODE","TARGET"."ISSYNCWITHDIRECTORY"="INPUT"."ISSYNCWITHDIRECTORY","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."ADDRESS2_LONGITUDE"="INPUT"."ADDRESS2_LONGITUDE","TARGET"."DEFAULTMAILBOX"="INPUT"."DEFAULTMAILBOX","TARGET"."JOBTITLE"="INPUT"."JOBTITLE","TARGET"."ADDRESS1_TELEPHONE1"="INPUT"."ADDRESS1_TELEPHONE1","TARGET"."DISPLAYINSERVICEVIEWSNAME"="INPUT"."DISPLAYINSERVICEVIEWSNAME","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."MOBILEOFFLINEPROFILEIDNAME"="INPUT"."MOBILEOFFLINEPROFILEIDNAME","TARGET"."ENTITYIMAGE_TIMESTAMP"="INPUT"."ENTITYIMAGE_TIMESTAMP","TARGET"."BUSINESSUNITID"="INPUT"."BUSINESSUNITID","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."ADDRESS1_LATITUDE"="INPUT"."ADDRESS1_LATITUDE","TARGET"."DOMAINNAME"="INPUT"."DOMAINNAME","TARGET"."CALTYPENAME"="INPUT"."CALTYPENAME","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."APPLICATIONID"="INPUT"."APPLICATIONID","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."ADDRESS1_UPSZONE"="INPUT"."ADDRESS1_UPSZONE","TARGET"."POSITIONID"="INPUT"."POSITIONID","TARGET"."ADDRESS2_LINE2"="INPUT"."ADDRESS2_LINE2","TARGET"."ISACTIVEDIRECTORYUSER"="INPUT"."ISACTIVEDIRECTORYUSER","TARGET"."SETUPUSERNAME"="INPUT"."SETUPUSERNAME","TARGET"."ENTITYIMAGE"="INPUT"."ENTITYIMAGE","TARGET"."SITEIDNAME"="INPUT"."SITEIDNAME","TARGET"."YOMILASTNAME"="INPUT"."YOMILASTNAME","TARGET"."FIRSTNAME"="INPUT"."FIRSTNAME","TARGET"."PARENTSYSTEMUSERIDYOMINAME"="INPUT"."PARENTSYSTEMUSERIDYOMINAME","TARGET"."PHOTOURL"="INPUT"."PHOTOURL","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."YAMMERUSERID"="INPUT"."YAMMERUSERID","TARGET"."USERPUID"="INPUT"."USERPUID","TARGET"."ADDRESS2_TELEPHONE2"="INPUT"."ADDRESS2_TELEPHONE2","TARGET"."INCOMINGEMAILDELIVERYMETHOD"="INPUT"."INCOMINGEMAILDELIVERYMETHOD","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_ISDISABLED_PROXY"="INPUT"."SN_ISDISABLED_PROXY","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."ADDRESS2_NAME"="INPUT"."ADDRESS2_NAME","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."PROCESSID"="INPUT"."PROCESSID","TARGET"."TITLE"="INPUT"."TITLE","TARGET"."PARENTSYSTEMUSERID"="INPUT"."PARENTSYSTEMUSERID","TARGET"."YAMMEREMAILADDRESS"="INPUT"."YAMMEREMAILADDRESS","TARGET"."ADDRESS1_COMPOSITE"="INPUT"."ADDRESS1_COMPOSITE","TARGET"."MOBILEALERTEMAIL"="INPUT"."MOBILEALERTEMAIL","TARGET"."ADDRESS1_LINE2"="INPUT"."ADDRESS1_LINE2","TARGET"."PREFERREDADDRESSCODENAME"="INPUT"."PREFERREDADDRESSCODENAME","TARGET"."ADDRESS1_CITY"="INPUT"."ADDRESS1_CITY","TARGET"."MOBILEOFFLINEPROFILEID"="INPUT"."MOBILEOFFLINEPROFILEID","TARGET"."ADDRESS2_SHIPPINGMETHODCODENAME"="INPUT"."ADDRESS2_SHIPPINGMETHODCODENAME","TARGET"."ENTITYIMAGEID"="INPUT"."ENTITYIMAGEID","TARGET"."MIDDLENAME"="INPUT"."MIDDLENAME","TARGET"."PREFERREDPHONECODE"="INPUT"."PREFERREDPHONECODE","TARGET"."SYSTEMUSERID"="INPUT"."SYSTEMUSERID","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OUTGOINGEMAILDELIVERYMETHOD"="INPUT"."OUTGOINGEMAILDELIVERYMETHOD","TARGET"."ISINTEGRATIONUSERNAME"="INPUT"."ISINTEGRATIONUSERNAME","TARGET"."INVITESTATUSCODE"="INPUT"."INVITESTATUSCODE","TARGET"."EMAILROUTERACCESSAPPROVALNAME"="INPUT"."EMAILROUTERACCESSAPPROVALNAME","TARGET"."ADDRESS1_ADDRESSID"="INPUT"."ADDRESS1_ADDRESSID","TARGET"."DEFAULTMAILBOXNAME"="INPUT"."DEFAULTMAILBOXNAME","TARGET"."ADDRESS2_CITY"="INPUT"."ADDRESS2_CITY","TARGET"."EMAILROUTERACCESSAPPROVAL"="INPUT"."EMAILROUTERACCESSAPPROVAL","TARGET"."SN_REGION"="INPUT"."SN_REGION","TARGET"."PARENTSYSTEMUSERIDNAME"="INPUT"."PARENTSYSTEMUSERIDNAME","TARGET"."ADDRESS2_LATITUDE"="INPUT"."ADDRESS2_LATITUDE","TARGET"."TERRITORYIDNAME"="INPUT"."TERRITORYIDNAME","TARGET"."LATESTUPDATETIME"="INPUT"."LATESTUPDATETIME","TARGET"."INVITESTATUSCODENAME"="INPUT"."INVITESTATUSCODENAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_TERRITORYLIST"="INPUT"."SN_TERRITORYLIST","TARGET"."ADDRESS1_FAX"="INPUT"."ADDRESS1_FAX","TARGET"."BUSINESSUNITIDNAME"="INPUT"."BUSINESSUNITIDNAME","TARGET"."AZUREACTIVEDIRECTORYOBJECTID"="INPUT"."AZUREACTIVEDIRECTORYOBJECTID","TARGET"."ADDRESS2_ADDRESSID"="INPUT"."ADDRESS2_ADDRESSID","TARGET"."ADDRESS1_COUNTRY"="INPUT"."ADDRESS1_COUNTRY","TARGET"."MSDYN_GDPROPTOUTNAME"="INPUT"."MSDYN_GDPROPTOUTNAME","TARGET"."ISLICENSED"="INPUT"."ISLICENSED","TARGET"."DISPLAYINSERVICEVIEWS"="INPUT"."DISPLAYINSERVICEVIEWS","TARGET"."DEFAULTODBFOLDERNAME"="INPUT"."DEFAULTODBFOLDERNAME","TARGET"."ISEMAILADDRESSAPPROVEDBYO365ADMIN"="INPUT"."ISEMAILADDRESSAPPROVEDBYO365ADMIN","TARGET"."INTERNALEMAILADDRESS"="INPUT"."INTERNALEMAILADDRESS","TARGET"."ADDRESS2_ADDRESSTYPECODE"="INPUT"."ADDRESS2_ADDRESSTYPECODE","TARGET"."ADDRESS2_LINE3"="INPUT"."ADDRESS2_LINE3","TARGET"."NICKNAME"="INPUT"."NICKNAME","TARGET"."PREFERREDPHONECODENAME"="INPUT"."PREFERREDPHONECODENAME","TARGET"."ADDRESS1_LONGITUDE"="INPUT"."ADDRESS1_LONGITUDE","TARGET"."APPLICATIONIDURI"="INPUT"."APPLICATIONIDURI","TARGET"."TERRITORYID"="INPUT"."TERRITORYID","TARGET"."ADDRESS2_COUNTRY"="INPUT"."ADDRESS2_COUNTRY","TARGET"."LASTNAME"="INPUT"."LASTNAME","TARGET"."ACTIVEDIRECTORYGUID"="INPUT"."ACTIVEDIRECTORYGUID","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."ISDISABLED"="INPUT"."ISDISABLED","TARGET"."TRAVERSEDPATH"="INPUT"."TRAVERSEDPATH","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."DISABLEDREASON"="INPUT"."DISABLEDREASON","TARGET"."YOMIMIDDLENAME"="INPUT"."YOMIMIDDLENAME","TARGET"."ADDRESS1_NAME"="INPUT"."ADDRESS1_NAME","TARGET"."SKILLS"="INPUT"."SKILLS","TARGET"."ADDRESS1_STATEORPROVINCE"="INPUT"."ADDRESS1_STATEORPROVINCE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP,"TARGET"."SN_JOBROLEID"="INPUT"."SN_JOBROLEID","TARGET"."AZUREDELETEDON"="INPUT"."AZUREDELETEDON","TARGET"."AZURESTATE"="INPUT"."AZURESTATE","TARGET"."AZURESTATENAME"="INPUT"."AZURESTATENAME","TARGET"."DELETEDSTATE"="INPUT"."DELETEDSTATE","TARGET"."DELETEDSTATENAME"="INPUT"."DELETEDSTATENAME","TARGET"."ICM_ICMAUTHTOKEN"="INPUT"."ICM_ICMAUTHTOKEN","TARGET"."SN_COSTCENTER"="INPUT"."SN_COSTCENTER","TARGET"."SN_DEPARTMENT"="INPUT"."SN_DEPARTMENT","TARGET"."SN_ELEGIBLEFORP4MEMBER"="INPUT"."SN_ELEGIBLEFORP4MEMBER","TARGET"."SN_ELEGIBLEFORP4MEMBERNAME"="INPUT"."SN_ELEGIBLEFORP4MEMBERNAME","TARGET"."SN_EMPLOYEENUMBER"="INPUT"."SN_EMPLOYEENUMBER","TARGET"."SN_JOBROLEIDNAME"="INPUT"."SN_JOBROLEIDNAME" WHEN NOT MATCHED THEN INSERT ("FULLNAME","ADDRESS1_POSTOFFICEBOX","SETUPUSER","IDENTITYID","VERSIONNUMBER","ADDRESS1_LINE1","ADDRESS2_STATEORPROVINCE","QUEUEID","INCOMINGEMAILDELIVERYMETHODNAME","ISLICENSEDNAME","YOMIFULLNAME","SN_ISDISABLED_PROXYNAME","MSDYN_GDPROPTOUT","ADDRESS1_LINE3","ADDRESS1_ADDRESSTYPECODENAME","SALUTATION","ISDISABLEDNAME","ADDRESS2_TELEPHONE3","ORGANIZATIONID","ADDRESS2_COUNTY","PREFERREDEMAILCODENAME","OUTGOINGEMAILDELIVERYMETHODNAME","ENTITYIMAGE_URL","CALENDARID","ADDRESS2_SHIPPINGMETHODCODE","ADDRESS1_SHIPPINGMETHODCODENAME","ACCESSMODE","SHAREPOINTEMAILADDRESS","ADDRESS1_POSTALCODE","UTCCONVERSIONTIMEZONECODE","ADDRESS2_FAX","ORGANIZATIONIDNAME","ADDRESS2_POSTOFFICEBOX","ADDRESS1_UTCOFFSET","ADDRESS2_POSTALCODE","ADDRESS1_SHIPPINGMETHODCODE","SITEID","YOMIFIRSTNAME","POSITIONIDNAME","ADDRESS2_LINE1","PASSPORTHI","MODIFIEDBYYOMINAME","CREATEDONBEHALFBYNAME","SN_REGIONNAME","MODIFIEDONBEHALFBY","ADDRESS2_UPSZONE","EMPLOYEEID","PREFERREDADDRESSCODE","PREFERREDEMAILCODE","USERLICENSETYPE","PASSPORTLO","SN_USERPERSONA","WINDOWSLIVEID","QUEUEIDNAME","GOVERNMENTID","ADDRESS2_TELEPHONE1","MOBILEPHONE","ADDRESS1_TELEPHONE2","ADDRESS1_TELEPHONE3","DEFAULTFILTERSPOPULATED","MODIFIEDONBEHALFBYYOMINAME","ADDRESS2_UTCOFFSET","PERSONALEMAILADDRESS","CALTYPE","ADDRESS1_COUNTY","ADDRESS2_COMPOSITE","STAGEID","ISINTEGRATIONUSER","MODIFIEDON","ADDRESS2_ADDRESSTYPECODENAME","ACCESSMODENAME","HOMEPHONE","ADDRESS1_ADDRESSTYPECODE","ISSYNCWITHDIRECTORY","CREATEDBYNAME","ADDRESS2_LONGITUDE","DEFAULTMAILBOX","JOBTITLE","ADDRESS1_TELEPHONE1","DISPLAYINSERVICEVIEWSNAME","CREATEDONBEHALFBY","CREATEDON","MOBILEOFFLINEPROFILEIDNAME","ENTITYIMAGE_TIMESTAMP","BUSINESSUNITID","OVERRIDDENCREATEDON","ADDRESS1_LATITUDE","DOMAINNAME","CALTYPENAME","CREATEDBYYOMINAME","APPLICATIONID","MODIFIEDONBEHALFBYNAME","ADDRESS1_UPSZONE","POSITIONID","ADDRESS2_LINE2","ISACTIVEDIRECTORYUSER","SETUPUSERNAME","ENTITYIMAGE","SITEIDNAME","YOMILASTNAME","FIRSTNAME","PARENTSYSTEMUSERIDYOMINAME","PHOTOURL","CREATEDONBEHALFBYYOMINAME","YAMMERUSERID","USERPUID","ADDRESS2_TELEPHONE2","INCOMINGEMAILDELIVERYMETHOD","TRANSACTIONCURRENCYID","SN_ISDISABLED_PROXY","MODIFIEDBYNAME","ADDRESS2_NAME","TRANSACTIONCURRENCYIDNAME","EXCHANGERATE","PROCESSID","TITLE","PARENTSYSTEMUSERID","YAMMEREMAILADDRESS","ADDRESS1_COMPOSITE","MOBILEALERTEMAIL","ADDRESS1_LINE2","PREFERREDADDRESSCODENAME","ADDRESS1_CITY","MOBILEOFFLINEPROFILEID","ADDRESS2_SHIPPINGMETHODCODENAME","ENTITYIMAGEID","MIDDLENAME","PREFERREDPHONECODE","SYSTEMUSERID","IMPORTSEQUENCENUMBER","OUTGOINGEMAILDELIVERYMETHOD","ISINTEGRATIONUSERNAME","INVITESTATUSCODE","EMAILROUTERACCESSAPPROVALNAME","ADDRESS1_ADDRESSID","DEFAULTMAILBOXNAME","ADDRESS2_CITY","EMAILROUTERACCESSAPPROVAL","SN_REGION","PARENTSYSTEMUSERIDNAME","ADDRESS2_LATITUDE","TERRITORYIDNAME","LATESTUPDATETIME","INVITESTATUSCODENAME","MODIFIEDBY","SN_TERRITORYLIST","ADDRESS1_FAX","BUSINESSUNITIDNAME","AZUREACTIVEDIRECTORYOBJECTID","ADDRESS2_ADDRESSID","ADDRESS1_COUNTRY","MSDYN_GDPROPTOUTNAME","ISLICENSED","DISPLAYINSERVICEVIEWS","DEFAULTODBFOLDERNAME","ISEMAILADDRESSAPPROVEDBYO365ADMIN","INTERNALEMAILADDRESS","ADDRESS2_ADDRESSTYPECODE","ADDRESS2_LINE3","NICKNAME","PREFERREDPHONECODENAME","ADDRESS1_LONGITUDE","APPLICATIONIDURI","TERRITORYID","ADDRESS2_COUNTRY","LASTNAME","ACTIVEDIRECTORYGUID","TIMEZONERULEVERSIONNUMBER","ISDISABLED","TRAVERSEDPATH","CREATEDBY","DISABLEDREASON","YOMIMIDDLENAME","ADDRESS1_NAME","SKILLS","ADDRESS1_STATEORPROVINCE","ETL_UPDATE_DATE","SN_JOBROLEID","AZUREDELETEDON","AZURESTATE","AZURESTATENAME","DELETEDSTATE","DELETEDSTATENAME","ICM_ICMAUTHTOKEN","SN_COSTCENTER","SN_DEPARTMENT","SN_ELEGIBLEFORP4MEMBER","SN_ELEGIBLEFORP4MEMBERNAME","SN_EMPLOYEENUMBER","SN_JOBROLEIDNAME") VALUES ("INPUT"."FULLNAME","INPUT"."ADDRESS1_POSTOFFICEBOX","INPUT"."SETUPUSER","INPUT"."IDENTITYID","INPUT"."VERSIONNUMBER","INPUT"."ADDRESS1_LINE1","INPUT"."ADDRESS2_STATEORPROVINCE","INPUT"."QUEUEID","INPUT"."INCOMINGEMAILDELIVERYMETHODNAME","INPUT"."ISLICENSEDNAME","INPUT"."YOMIFULLNAME","INPUT"."SN_ISDISABLED_PROXYNAME","INPUT"."MSDYN_GDPROPTOUT","INPUT"."ADDRESS1_LINE3","INPUT"."ADDRESS1_ADDRESSTYPECODENAME","INPUT"."SALUTATION","INPUT"."ISDISABLEDNAME","INPUT"."ADDRESS2_TELEPHONE3","INPUT"."ORGANIZATIONID","INPUT"."ADDRESS2_COUNTY","INPUT"."PREFERREDEMAILCODENAME","INPUT"."OUTGOINGEMAILDELIVERYMETHODNAME","INPUT"."ENTITYIMAGE_URL","INPUT"."CALENDARID","INPUT"."ADDRESS2_SHIPPINGMETHODCODE","INPUT"."ADDRESS1_SHIPPINGMETHODCODENAME","INPUT"."ACCESSMODE","INPUT"."SHAREPOINTEMAILADDRESS","INPUT"."ADDRESS1_POSTALCODE","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."ADDRESS2_FAX","INPUT"."ORGANIZATIONIDNAME","INPUT"."ADDRESS2_POSTOFFICEBOX","INPUT"."ADDRESS1_UTCOFFSET","INPUT"."ADDRESS2_POSTALCODE","INPUT"."ADDRESS1_SHIPPINGMETHODCODE","INPUT"."SITEID","INPUT"."YOMIFIRSTNAME","INPUT"."POSITIONIDNAME","INPUT"."ADDRESS2_LINE1","INPUT"."PASSPORTHI","INPUT"."MODIFIEDBYYOMINAME","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."SN_REGIONNAME","INPUT"."MODIFIEDONBEHALFBY","INPUT"."ADDRESS2_UPSZONE","INPUT"."EMPLOYEEID","INPUT"."PREFERREDADDRESSCODE","INPUT"."PREFERREDEMAILCODE","INPUT"."USERLICENSETYPE","INPUT"."PASSPORTLO","INPUT"."SN_USERPERSONA","INPUT"."WINDOWSLIVEID","INPUT"."QUEUEIDNAME","INPUT"."GOVERNMENTID","INPUT"."ADDRESS2_TELEPHONE1","INPUT"."MOBILEPHONE","INPUT"."ADDRESS1_TELEPHONE2","INPUT"."ADDRESS1_TELEPHONE3","INPUT"."DEFAULTFILTERSPOPULATED","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."ADDRESS2_UTCOFFSET","INPUT"."PERSONALEMAILADDRESS","INPUT"."CALTYPE","INPUT"."ADDRESS1_COUNTY","INPUT"."ADDRESS2_COMPOSITE","INPUT"."STAGEID","INPUT"."ISINTEGRATIONUSER","INPUT"."MODIFIEDON","INPUT"."ADDRESS2_ADDRESSTYPECODENAME","INPUT"."ACCESSMODENAME","INPUT"."HOMEPHONE","INPUT"."ADDRESS1_ADDRESSTYPECODE","INPUT"."ISSYNCWITHDIRECTORY","INPUT"."CREATEDBYNAME","INPUT"."ADDRESS2_LONGITUDE","INPUT"."DEFAULTMAILBOX","INPUT"."JOBTITLE","INPUT"."ADDRESS1_TELEPHONE1","INPUT"."DISPLAYINSERVICEVIEWSNAME","INPUT"."CREATEDONBEHALFBY","INPUT"."CREATEDON","INPUT"."MOBILEOFFLINEPROFILEIDNAME","INPUT"."ENTITYIMAGE_TIMESTAMP","INPUT"."BUSINESSUNITID","INPUT"."OVERRIDDENCREATEDON","INPUT"."ADDRESS1_LATITUDE","INPUT"."DOMAINNAME","INPUT"."CALTYPENAME","INPUT"."CREATEDBYYOMINAME","INPUT"."APPLICATIONID","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."ADDRESS1_UPSZONE","INPUT"."POSITIONID","INPUT"."ADDRESS2_LINE2","INPUT"."ISACTIVEDIRECTORYUSER","INPUT"."SETUPUSERNAME","INPUT"."ENTITYIMAGE","INPUT"."SITEIDNAME","INPUT"."YOMILASTNAME","INPUT"."FIRSTNAME","INPUT"."PARENTSYSTEMUSERIDYOMINAME","INPUT"."PHOTOURL","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."YAMMERUSERID","INPUT"."USERPUID","INPUT"."ADDRESS2_TELEPHONE2","INPUT"."INCOMINGEMAILDELIVERYMETHOD","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_ISDISABLED_PROXY","INPUT"."MODIFIEDBYNAME","INPUT"."ADDRESS2_NAME","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."EXCHANGERATE","INPUT"."PROCESSID","INPUT"."TITLE","INPUT"."PARENTSYSTEMUSERID","INPUT"."YAMMEREMAILADDRESS","INPUT"."ADDRESS1_COMPOSITE","INPUT"."MOBILEALERTEMAIL","INPUT"."ADDRESS1_LINE2","INPUT"."PREFERREDADDRESSCODENAME","INPUT"."ADDRESS1_CITY","INPUT"."MOBILEOFFLINEPROFILEID","INPUT"."ADDRESS2_SHIPPINGMETHODCODENAME","INPUT"."ENTITYIMAGEID","INPUT"."MIDDLENAME","INPUT"."PREFERREDPHONECODE","INPUT"."SYSTEMUSERID","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OUTGOINGEMAILDELIVERYMETHOD","INPUT"."ISINTEGRATIONUSERNAME","INPUT"."INVITESTATUSCODE","INPUT"."EMAILROUTERACCESSAPPROVALNAME","INPUT"."ADDRESS1_ADDRESSID","INPUT"."DEFAULTMAILBOXNAME","INPUT"."ADDRESS2_CITY","INPUT"."EMAILROUTERACCESSAPPROVAL","INPUT"."SN_REGION","INPUT"."PARENTSYSTEMUSERIDNAME","INPUT"."ADDRESS2_LATITUDE","INPUT"."TERRITORYIDNAME","INPUT"."LATESTUPDATETIME","INPUT"."INVITESTATUSCODENAME","INPUT"."MODIFIEDBY","INPUT"."SN_TERRITORYLIST","INPUT"."ADDRESS1_FAX","INPUT"."BUSINESSUNITIDNAME","INPUT"."AZUREACTIVEDIRECTORYOBJECTID","INPUT"."ADDRESS2_ADDRESSID","INPUT"."ADDRESS1_COUNTRY","INPUT"."MSDYN_GDPROPTOUTNAME","INPUT"."ISLICENSED","INPUT"."DISPLAYINSERVICEVIEWS","INPUT"."DEFAULTODBFOLDERNAME","INPUT"."ISEMAILADDRESSAPPROVEDBYO365ADMIN","INPUT"."INTERNALEMAILADDRESS","INPUT"."ADDRESS2_ADDRESSTYPECODE","INPUT"."ADDRESS2_LINE3","INPUT"."NICKNAME","INPUT"."PREFERREDPHONECODENAME","INPUT"."ADDRESS1_LONGITUDE","INPUT"."APPLICATIONIDURI","INPUT"."TERRITORYID","INPUT"."ADDRESS2_COUNTRY","INPUT"."LASTNAME","INPUT"."ACTIVEDIRECTORYGUID","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."ISDISABLED","INPUT"."TRAVERSEDPATH","INPUT"."CREATEDBY","INPUT"."DISABLEDREASON","INPUT"."YOMIMIDDLENAME","INPUT"."ADDRESS1_NAME","INPUT"."SKILLS","INPUT"."ADDRESS1_STATEORPROVINCE",CURRENT_TIMESTAMP,"INPUT"."SN_JOBROLEID","INPUT"."AZUREDELETEDON","INPUT"."AZURESTATE","INPUT"."AZURESTATENAME","INPUT"."DELETEDSTATE","INPUT"."DELETEDSTATENAME","INPUT"."ICM_ICMAUTHTOKEN","INPUT"."SN_COSTCENTER","INPUT"."SN_DEPARTMENT","INPUT"."SN_ELEGIBLEFORP4MEMBER","INPUT"."SN_ELEGIBLEFORP4MEMBERNAME","INPUT"."SN_EMPLOYEENUMBER","INPUT"."SN_JOBROLEIDNAME")
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_systemusers"},
        {"dynamics365.systemusers"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunities_massive_query():
    """
    ServiceNow Query ID 1365 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.opportunities TARGET USING ( SELECT * FROM DYNAMICS365.stg_opportunities WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."OPPORTUNITYID"="INPUT"."OPPORTUNITYID" WHEN MATCHED THEN UPDATE SET "TARGET"."SALESSTAGECODENAME"="INPUT"."SALESSTAGECODENAME","TARGET"."SN_PURCHASEHISTORYREVIEW"="INPUT"."SN_PURCHASEHISTORYREVIEW","TARGET"."CUSTOMERIDYOMINAME"="INPUT"."CUSTOMERIDYOMINAME","TARGET"."SN_COMPLIANCECHECKNAME"="INPUT"."SN_COMPLIANCECHECKNAME","TARGET"."PARENTACCOUNTID"="INPUT"."PARENTACCOUNTID","TARGET"."SN_SURFCTTPRECEDENCENAME"="INPUT"."SN_SURFCTTPRECEDENCENAME","TARGET"."SN_CPQMASTERLINES"="INPUT"."SN_CPQMASTERLINES","TARGET"."SN_NUMBER"="INPUT"."SN_NUMBER","TARGET"."STAGEID"="INPUT"."STAGEID","TARGET"."SN_RECORDURL"="INPUT"."SN_RECORDURL","TARGET"."SN_BUSINESSOUTCOMESEXPLORATION"="INPUT"."SN_BUSINESSOUTCOMESEXPLORATION","TARGET"."SN_DIDMARKETINGHELP"="INPUT"."SN_DIDMARKETINGHELP","TARGET"."SN_TRAININGPLANAGREEDNAME"="INPUT"."SN_TRAININGPLANAGREEDNAME","TARGET"."CAPTUREPROPOSALFEEDBACK"="INPUT"."CAPTUREPROPOSALFEEDBACK","TARGET"."EVALUATEFIT"="INPUT"."EVALUATEFIT","TARGET"."SN_OPPORTUNITYSOURCENAME"="INPUT"."SN_OPPORTUNITYSOURCENAME","TARGET"."PRESENTFINALPROPOSALNAME"="INPUT"."PRESENTFINALPROPOSALNAME","TARGET"."SN_BUSINESSISSUESTAGECOMPLETE"="INPUT"."SN_BUSINESSISSUESTAGECOMPLETE","TARGET"."SN_SALESALLOCATIONPERCENTAGE"="INPUT"."SN_SALESALLOCATIONPERCENTAGE","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."SN_WINLOSSNODECISIONREASON"="INPUT"."SN_WINLOSSNODECISIONREASON","TARGET"."SN_SPLITTHISOPPORTUNITYNAME"="INPUT"."SN_SPLITTHISOPPORTUNITYNAME","TARGET"."SN_SOLUTIONCONSULTANTNAME"="INPUT"."SN_SOLUTIONCONSULTANTNAME","TARGET"."TOTALDISCOUNTAMOUNT_BASE"="INPUT"."TOTALDISCOUNTAMOUNT_BASE","TARGET"."PRESENTPROPOSAL"="INPUT"."PRESENTPROPOSAL","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."CAMPAIGNID"="INPUT"."CAMPAIGNID","TARGET"."SN_FIELDTERRITORY"="INPUT"."SN_FIELDTERRITORY","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."SN_BUSINESSVALUEASSESSMENT"="INPUT"."SN_BUSINESSVALUEASSESSMENT","TARGET"."SN_RENEWALRISKCODESNAME"="INPUT"."SN_RENEWALRISKCODESNAME","TARGET"."RESOLVEFEEDBACK"="INPUT"."RESOLVEFEEDBACK","TARGET"."SN_ACTIVATESEQUENCESNAME"="INPUT"."SN_ACTIVATESEQUENCESNAME","TARGET"."SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENTNAME"="INPUT"."SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENTNAME","TARGET"."SN_SOLUTIONDIFFERENTIATEDNAME"="INPUT"."SN_SOLUTIONDIFFERENTIATEDNAME","TARGET"."SN_SERVICENOWCONTACT"="INPUT"."SN_SERVICENOWCONTACT","TARGET"."SN_ENGAGECUSTOMEROUTCOMESNAME"="INPUT"."SN_ENGAGECUSTOMEROUTCOMESNAME","TARGET"."SN_POWERVALIDATIONSTAGECOMPLETE"="INPUT"."SN_POWERVALIDATIONSTAGECOMPLETE","TARGET"."SN_POWERVALIDATIONSTAGECOMPLETENAME"="INPUT"."SN_POWERVALIDATIONSTAGECOMPLETENAME","TARGET"."STEPNAME"="INPUT"."STEPNAME","TARGET"."SN_RISKTYPE"="INPUT"."SN_RISKTYPE","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_TRAININGREVENUE_BASE"="INPUT"."SN_TRAININGREVENUE_BASE","TARGET"."DISCOUNTAMOUNT_BASE"="INPUT"."DISCOUNTAMOUNT_BASE","TARGET"."MSDYN_GDPROPTOUTNAME"="INPUT"."MSDYN_GDPROPTOUTNAME","TARGET"."SN_HASBUSINESSCASENAME"="INPUT"."SN_HASBUSINESSCASENAME","TARGET"."OPPORTUNITYID"="INPUT"."OPPORTUNITYID","TARGET"."TOTALAMOUNTLESSFREIGHT"="INPUT"."TOTALAMOUNTLESSFREIGHT","TARGET"."PURCHASETIMEFRAMENAME"="INPUT"."PURCHASETIMEFRAMENAME","TARGET"."SN_SOLUTIONPRESENTEDTOCUSTOMER"="INPUT"."SN_SOLUTIONPRESENTEDTOCUSTOMER","TARGET"."SN_CURRENTCONTRACTENDDATE"="INPUT"."SN_CURRENTCONTRACTENDDATE","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."NEW_DATELASTUPDATED"="INPUT"."NEW_DATELASTUPDATED","TARGET"."SN_VALUEMGMTENGAGEDNAME"="INPUT"."SN_VALUEMGMTENGAGEDNAME","TARGET"."SN_NNACVNETFINANCIALS"="INPUT"."SN_NNACVNETFINANCIALS","TARGET"."SN_BUSINESSISSUESTAGECOMPLETENAME"="INPUT"."SN_BUSINESSISSUESTAGECOMPLETENAME","TARGET"."SN_DEALVALIDATION"="INPUT"."SN_DEALVALIDATION","TARGET"."SN_ENDCUSTOMERIDNAME"="INPUT"."SN_ENDCUSTOMERIDNAME","TARGET"."SN_TOTALNNACV"="INPUT"."SN_TOTALNNACV","TARGET"."SN_NNACVFUTURENETFINANCIALS"="INPUT"."SN_NNACVFUTURENETFINANCIALS","TARGET"."SN_PSREVENUE"="INPUT"."SN_PSREVENUE","TARGET"."SN_CONTRACTSNAME"="INPUT"."SN_CONTRACTSNAME","TARGET"."SN_SPLITOPPTYEVERYONE"="INPUT"."SN_SPLITOPPTYEVERYONE","TARGET"."ORIGINATINGLEADID"="INPUT"."ORIGINATINGLEADID","TARGET"."SN_TAEENGAGEDTRAINING"="INPUT"."SN_TAEENGAGEDTRAINING","TARGET"."SN_ACTIVESTRATEGIC"="INPUT"."SN_ACTIVESTRATEGIC","TARGET"."QUALIFICATIONCOMMENTS"="INPUT"."QUALIFICATIONCOMMENTS","TARGET"."FREIGHTAMOUNT"="INPUT"."FREIGHTAMOUNT","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."SN_OTHERREVENUE_BASE"="INPUT"."SN_OTHERREVENUE_BASE","TARGET"."SN_CHAMPIONFUNDINGIDENTIFIEDNAME"="INPUT"."SN_CHAMPIONFUNDINGIDENTIFIEDNAME","TARGET"."SN_TRANSACTINGPARTNERIDNAME"="INPUT"."SN_TRANSACTINGPARTNERIDNAME","TARGET"."SN_RECONFIRMCLOSEPLANNAME"="INPUT"."SN_RECONFIRMCLOSEPLANNAME","TARGET"."ACCOUNTIDYOMINAME"="INPUT"."ACCOUNTIDYOMINAME","TARGET"."SN_TAEENGAGEDTRAININGNAME"="INPUT"."SN_TAEENGAGEDTRAININGNAME","TARGET"."TOTALAMOUNT"="INPUT"."TOTALAMOUNT","TARGET"."MSDYN_OPPORTUNITYGRADE"="INPUT"."MSDYN_OPPORTUNITYGRADE","TARGET"."SN_DISCOVERYSTAGECOMPLETENAME"="INPUT"."SN_DISCOVERYSTAGECOMPLETENAME","TARGET"."SN_SURF_SYSID"="INPUT"."SN_SURF_SYSID","TARGET"."SN_RISKMITIGATIONSTEPS"="INPUT"."SN_RISKMITIGATIONSTEPS","TARGET"."SN_RECEIVEDOFNAME"="INPUT"."SN_RECEIVEDOFNAME","TARGET"."SN_DOUBLECOMPTERRITORYNAME"="INPUT"."SN_DOUBLECOMPTERRITORYNAME","TARGET"."SN_REQUESTSUBSCRIPTIONREMINDERSNAME"="INPUT"."SN_REQUESTSUBSCRIPTIONREMINDERSNAME","TARGET"."SN_FXRATE"="INPUT"."SN_FXRATE","TARGET"."SN_TCSPRESENTED"="INPUT"."SN_TCSPRESENTED","TARGET"."SN_RENEWALENGAGEMENTNAME"="INPUT"."SN_RENEWALENGAGEMENTNAME","TARGET"."SN_REVIEWPARTNERSPROPOSALNAME"="INPUT"."SN_REVIEWPARTNERSPROPOSALNAME","TARGET"."BUDGETTYPENAME"="INPUT"."BUDGETTYPENAME","TARGET"."SN_POWERBUYERSINQUIRYNAME"="INPUT"."SN_POWERBUYERSINQUIRYNAME","TARGET"."MSDYN_SCOREREASONS"="INPUT"."MSDYN_SCOREREASONS","TARGET"."SN_CONTRACTREVIEWNAME"="INPUT"."SN_CONTRACTREVIEWNAME","TARGET"."SN_TRANSACTINGPARTNERID"="INPUT"."SN_TRANSACTINGPARTNERID","TARGET"."SN_SUBSCRIPTIONGUIDENAME"="INPUT"."SN_SUBSCRIPTIONGUIDENAME","TARGET"."IDENTIFYCOMPETITORS"="INPUT"."IDENTIFYCOMPETITORS","TARGET"."SN_RECEIVEDOF"="INPUT"."SN_RECEIVEDOF","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."DECISIONMAKER"="INPUT"."DECISIONMAKER","TARGET"."SN_PIPELINESOURCECODE"="INPUT"."SN_PIPELINESOURCECODE","TARGET"."MSDYN_FORECASTCATEGORYNAME"="INPUT"."MSDYN_FORECASTCATEGORYNAME","TARGET"."SN_OVERVIEWPRESENTEDNAME"="INPUT"."SN_OVERVIEWPRESENTEDNAME","TARGET"."SN_LEAD_NUMBERNAME"="INPUT"."SN_LEAD_NUMBERNAME","TARGET"."ACTUALVALUE_BASE"="INPUT"."ACTUALVALUE_BASE","TARGET"."SN_NNACVFUTURENETFINANCIALS_BASE"="INPUT"."SN_NNACVFUTURENETFINANCIALS_BASE","TARGET"."SN_DIFFERENTIATEDVALUEIDENTIFIEDNAME"="INPUT"."SN_DIFFERENTIATEDVALUEIDENTIFIEDNAME","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."SN_TOTALNNACV_BASE"="INPUT"."SN_TOTALNNACV_BASE","TARGET"."SN_MOACOMPLETED"="INPUT"."SN_MOACOMPLETED","TARGET"."FILEDEBRIEF"="INPUT"."FILEDEBRIEF","TARGET"."SN_SOURCESYSTEMNAME"="INPUT"."SN_SOURCESYSTEMNAME","TARGET"."SN_OPPORTUNITYTYPENAME"="INPUT"."SN_OPPORTUNITYTYPENAME","TARGET"."SN_POWERBUYERSENGAGED"="INPUT"."SN_POWERBUYERSENGAGED","TARGET"."ACTUALVALUE"="INPUT"."ACTUALVALUE","TARGET"."SN_SOURCE_MEETINGNAME"="INPUT"."SN_SOURCE_MEETINGNAME","TARGET"."ONHOLDTIME"="INPUT"."ONHOLDTIME","TARGET"."CUSTOMERIDNAME"="INPUT"."CUSTOMERIDNAME","TARGET"."SN_FXRATEUSD"="INPUT"."SN_FXRATEUSD","TARGET"."PRIORITYCODE"="INPUT"."PRIORITYCODE","TARGET"."SN_ENDCUSTOMERID"="INPUT"."SN_ENDCUSTOMERID","TARGET"."SN_OPPORTUNITYSOURCE"="INPUT"."SN_OPPORTUNITYSOURCE","TARGET"."ISPRIVATE"="INPUT"."ISPRIVATE","TARGET"."SN_FORECASTCATEGORY"="INPUT"."SN_FORECASTCATEGORY","TARGET"."SN_RENEWALENGAGEMENT"="INPUT"."SN_RENEWALENGAGEMENT","TARGET"."SN_CUSTOMERCONTACT"="INPUT"."SN_CUSTOMERCONTACT","TARGET"."SN_SC_WORKSHOPS"="INPUT"."SN_SC_WORKSHOPS","TARGET"."SN_PARTNERECOSYSTEMUNDERSTOODNAME"="INPUT"."SN_PARTNERECOSYSTEMUNDERSTOODNAME","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_SUBMITSIGNEDDOCUMENTSFORCLOSURENAME"="INPUT"."SN_SUBMITSIGNEDDOCUMENTSFORCLOSURENAME","TARGET"."SN_PREVIOUSFORECASTCATEGORYVALUENAME"="INPUT"."SN_PREVIOUSFORECASTCATEGORYVALUENAME","TARGET"."SN_ACEALLOCATIONPERCENTAGE"="INPUT"."SN_ACEALLOCATIONPERCENTAGE","TARGET"."SN_PURCHASEHISTORYREVIEWNAME"="INPUT"."SN_PURCHASEHISTORYREVIEWNAME","TARGET"."SN_NNACVNETFINANCIALS_BASE"="INPUT"."SN_NNACVNETFINANCIALS_BASE","TARGET"."SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPION"="INPUT"."SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPION","TARGET"."SN_SERVICENOWCONTACTNAME"="INPUT"."SN_SERVICENOWCONTACTNAME","TARGET"."PURSUITDECISION"="INPUT"."PURSUITDECISION","TARGET"."PRIORITYCODENAME"="INPUT"."PRIORITYCODENAME","TARGET"."SN_SCOPEDEVELOPMENTCREATEPROPOSALNAME"="INPUT"."SN_SCOPEDEVELOPMENTCREATEPROPOSALNAME","TARGET"."ORIGINATINGLEADIDNAME"="INPUT"."ORIGINATINGLEADIDNAME","TARGET"."SN_ENDCUSTOMERIDYOMINAME"="INPUT"."SN_ENDCUSTOMERIDYOMINAME","TARGET"."SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINED"="INPUT"."SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINED","TARGET"."COMPLETEFINALPROPOSAL"="INPUT"."COMPLETEFINALPROPOSAL","TARGET"."TOTALAMOUNTLESSFREIGHT_BASE"="INPUT"."TOTALAMOUNTLESSFREIGHT_BASE","TARGET"."SN_PRESENTSOLUTIONSTAGECOMPLETENAME"="INPUT"."SN_PRESENTSOLUTIONSTAGECOMPLETENAME","TARGET"."PARENTACCOUNTIDYOMINAME"="INPUT"."PARENTACCOUNTIDYOMINAME","TARGET"."ESTIMATEDCLOSEDATE"="INPUT"."ESTIMATEDCLOSEDATE","TARGET"."SN_SERVICESSALESAPPROVALSNAME"="INPUT"."SN_SERVICESSALESAPPROVALSNAME","TARGET"."SN_ENVIRONMENTTYPE"="INPUT"."SN_ENVIRONMENTTYPE","TARGET"."SLAID"="INPUT"."SLAID","TARGET"."SN_ALIGNMENTWITHINSPIREBVA"="INPUT"."SN_ALIGNMENTWITHINSPIREBVA","TARGET"."SN_CUSTOMERCONTACTNAME"="INPUT"."SN_CUSTOMERCONTACTNAME","TARGET"."SN_ALIGNMENTWITHINSPIREBVANAME"="INPUT"."SN_ALIGNMENTWITHINSPIREBVANAME","TARGET"."OPPORTUNITYRATINGCODE"="INPUT"."OPPORTUNITYRATINGCODE","TARGET"."TOTALDISCOUNTAMOUNT"="INPUT"."TOTALDISCOUNTAMOUNT","TARGET"."SN_POWERBUYERCOMMITMENTNAME"="INPUT"."SN_POWERBUYERCOMMITMENTNAME","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."IDENTIFYCUSTOMERCONTACTS"="INPUT"."IDENTIFYCUSTOMERCONTACTS","TARGET"."SN_ORDERFORMCONTRACTREVIEWCOMPLETED"="INPUT"."SN_ORDERFORMCONTRACTREVIEWCOMPLETED","TARGET"."CAPTUREPROPOSALFEEDBACKNAME"="INPUT"."CAPTUREPROPOSALFEEDBACKNAME","TARGET"."INITIALCOMMUNICATIONNAME"="INPUT"."INITIALCOMMUNICATIONNAME","TARGET"."SN_CONTRACTREVIEW"="INPUT"."SN_CONTRACTREVIEW","TARGET"."SN_VALIDATESKUSFORRENEWALNAME"="INPUT"."SN_VALIDATESKUSFORRENEWALNAME","TARGET"."SN_SUBMITSIGNEDDOCUMENTSFORCLOSURE"="INPUT"."SN_SUBMITSIGNEDDOCUMENTSFORCLOSURE","TARGET"."SN_OPPORTUNITYBULIST"="INPUT"."SN_OPPORTUNITYBULIST","TARGET"."SN_PARTNERACCOUNTFORIMPLEMENTATIONMODE"="INPUT"."SN_PARTNERACCOUNTFORIMPLEMENTATIONMODE","TARGET"."SN_NETNEWACV"="INPUT"."SN_NETNEWACV","TARGET"."SN_DIDMARKETINGHELPNAME"="INPUT"."SN_DIDMARKETINGHELPNAME","TARGET"."CONFIRMINTEREST"="INPUT"."CONFIRMINTEREST","TARGET"."SN_WHICHMARKETINGPROGRAMEVENT"="INPUT"."SN_WHICHMARKETINGPROGRAMEVENT","TARGET"."SN_ORDERFROMSUBMITTEDAPPROVED"="INPUT"."SN_ORDERFROMSUBMITTEDAPPROVED","TARGET"."SN_SCHEDULEIPKTCUSTOMERHANDOFFNAME"="INPUT"."SN_SCHEDULEIPKTCUSTOMERHANDOFFNAME","TARGET"."SN_CUSTOMERLEGALANDPROCUREMENTENGAGED"="INPUT"."SN_CUSTOMERLEGALANDPROCUREMENTENGAGED","TARGET"."SN_FIELDSALESREPNAME"="INPUT"."SN_FIELDSALESREPNAME","TARGET"."SN_SPLITTHISOPPORTUNITY"="INPUT"."SN_SPLITTHISOPPORTUNITY","TARGET"."PRESENTFINALPROPOSAL"="INPUT"."PRESENTFINALPROPOSAL","TARGET"."PROCESSID"="INPUT"."PROCESSID","TARGET"."SN_SOURCE_MEETING"="INPUT"."SN_SOURCE_MEETING","TARGET"."MSDYN_SCOREHISTORY"="INPUT"."MSDYN_SCOREHISTORY","TARGET"."SN_SCHEDULEIPKTCUSTOMERHANDOFF"="INPUT"."SN_SCHEDULEIPKTCUSTOMERHANDOFF","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."MSDYN_PREDICTIVESCOREID"="INPUT"."MSDYN_PREDICTIVESCOREID","TARGET"."SN_OPPORTUNITYQUALIFIEDNAME"="INPUT"."SN_OPPORTUNITYQUALIFIEDNAME","TARGET"."NEW_CREATEDBY"="INPUT"."NEW_CREATEDBY","TARGET"."SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORM"="INPUT"."SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORM","TARGET"."SN_OPPORTUNITYBULISTNAME"="INPUT"."SN_OPPORTUNITYBULISTNAME","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MSDYN_PREDICTIVESCOREIDNAME"="INPUT"."MSDYN_PREDICTIVESCOREIDNAME","TARGET"."SN_SC_POV"="INPUT"."SN_SC_POV","TARGET"."PROPOSEDSOLUTION"="INPUT"."PROPOSEDSOLUTION","TARGET"."PARENTCONTACTIDNAME"="INPUT"."PARENTCONTACTIDNAME","TARGET"."IDENTIFYPURSUITTEAM"="INPUT"."IDENTIFYPURSUITTEAM","TARGET"."SN_PREVIOUSSALESSTAGENAME"="INPUT"."SN_PREVIOUSSALESSTAGENAME","TARGET"."SN_BVANAME"="INPUT"."SN_BVANAME","TARGET"."SN_FLAGFORCREATETASKMEMBERS"="INPUT"."SN_FLAGFORCREATETASKMEMBERS","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMERNAME"="INPUT"."SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMERNAME","TARGET"."SN_REQUESTSUBSCRIPTIONREMINDERS"="INPUT"."SN_REQUESTSUBSCRIPTIONREMINDERS","TARGET"."SN_RENEWALRISKCODES"="INPUT"."SN_RENEWALRISKCODES","TARGET"."SN_RENEWALACV_BASE"="INPUT"."SN_RENEWALACV_BASE","TARGET"."BUDGETAMOUNT"="INPUT"."BUDGETAMOUNT","TARGET"."SN_SC_DEMO"="INPUT"."SN_SC_DEMO","TARGET"."SN_CLOSEPLANDEFINEDANDMUTUALLYAGREED"="INPUT"."SN_CLOSEPLANDEFINEDANDMUTUALLYAGREED","TARGET"."SN_VALIDATIONSTAGECOMPLETENAME"="INPUT"."SN_VALIDATIONSTAGECOMPLETENAME","TARGET"."SN_CUSTOMERDASHBOARDREVIEW"="INPUT"."SN_CUSTOMERDASHBOARDREVIEW","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_FLAGFORCREATETASKMEMBERSNAME"="INPUT"."SN_FLAGFORCREATETASKMEMBERSNAME","TARGET"."SN_SURFMASTERSLINES"="INPUT"."SN_SURFMASTERSLINES","TARGET"."SN_OVERVIEWPRESENTED"="INPUT"."SN_OVERVIEWPRESENTED","TARGET"."SKIPPRICECALCULATION"="INPUT"."SKIPPRICECALCULATION","TARGET"."TOTALLINEITEMAMOUNT_BASE"="INPUT"."TOTALLINEITEMAMOUNT_BASE","TARGET"."ORIGINATINGLEADIDYOMINAME"="INPUT"."ORIGINATINGLEADIDYOMINAME","TARGET"."SN_ROUTETOMARKETLABEL"="INPUT"."SN_ROUTETOMARKETLABEL","TARGET"."COMPLETEINTERNALREVIEWNAME"="INPUT"."COMPLETEINTERNALREVIEWNAME","TARGET"."MSDYN_SEGMENTIDNAME"="INPUT"."MSDYN_SEGMENTIDNAME","TARGET"."SN_TRAININGCHAMPIONFUNDINGIDENTIFIEDNAME"="INPUT"."SN_TRAININGCHAMPIONFUNDINGIDENTIFIEDNAME","TARGET"."SN_ESTIMATESVALIDATEDNAME"="INPUT"."SN_ESTIMATESVALIDATEDNAME","TARGET"."SN_PARTNERHASASIGNEDCONTRACTCHANGEORDERNAME"="INPUT"."SN_PARTNERHASASIGNEDCONTRACTCHANGEORDERNAME","TARGET"."ACTUALCLOSEDATE"="INPUT"."ACTUALCLOSEDATE","TARGET"."SN_RENEWALTIMING"="INPUT"."SN_RENEWALTIMING","TARGET"."SN_RENEWALRISKREASONCODESNAME"="INPUT"."SN_RENEWALRISKREASONCODESNAME","TARGET"."CONTACTID"="INPUT"."CONTACTID","TARGET"."SN_BUSINESSOUTCOMESIDENTIFIED"="INPUT"."SN_BUSINESSOUTCOMESIDENTIFIED","TARGET"."SN_OPPORTUNITYSTAGECOMPLETENAME"="INPUT"."SN_OPPORTUNITYSTAGECOMPLETENAME","TARGET"."SN_BUSINESSOUTCOMESIDENTIFIEDNAME"="INPUT"."SN_BUSINESSOUTCOMESIDENTIFIEDNAME","TARGET"."SN_DOUBLECOMPTERRITORY"="INPUT"."SN_DOUBLECOMPTERRITORY","TARGET"."SN_OPPORTUNITYTYPE"="INPUT"."SN_OPPORTUNITYTYPE","TARGET"."SN_PROBABILITY"="INPUT"."SN_PROBABILITY","TARGET"."CONFIRMINTERESTNAME"="INPUT"."CONFIRMINTERESTNAME","TARGET"."SN_TRAININGCHAMPIONFUNDINGIDENTIFIED"="INPUT"."SN_TRAININGCHAMPIONFUNDINGIDENTIFIED","TARGET"."MSDYN_SEGMENTID"="INPUT"."MSDYN_SEGMENTID","TARGET"."SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENT"="INPUT"."SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENT","TARGET"."SN_CLOSEPLANAGREEDNOMOANAME"="INPUT"."SN_CLOSEPLANAGREEDNOMOANAME","TARGET"."SN_CLOSEPLANDEFINEDANDMUTUALLYAGREEDNAME"="INPUT"."SN_CLOSEPLANDEFINEDANDMUTUALLYAGREEDNAME","TARGET"."MSDYN_OPPORTUNITYKPIID"="INPUT"."MSDYN_OPPORTUNITYKPIID","TARGET"."SN_SNAPPRESENTEDTOCUSTOMER"="INPUT"."SN_SNAPPRESENTEDTOCUSTOMER","TARGET"."SN_TRAININGPLANAGREED"="INPUT"."SN_TRAININGPLANAGREED","TARGET"."SN_VALIDATIONSTAGECOMPLETE"="INPUT"."SN_VALIDATIONSTAGECOMPLETE","TARGET"."SN_EXECUTIVESPONSORYOMINAME"="INPUT"."SN_EXECUTIVESPONSORYOMINAME","TARGET"."SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMER"="INPUT"."SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMER","TARGET"."SN_SPLITOPPTYEVERYONENAME"="INPUT"."SN_SPLITOPPTYEVERYONENAME","TARGET"."SN_CHANNELTRANSACTIONTYPENAME"="INPUT"."SN_CHANNELTRANSACTIONTYPENAME","TARGET"."SN_SC_DEMONAME"="INPUT"."SN_SC_DEMONAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."TIMESPENTBYMEONEMAILANDMEETINGS"="INPUT"."TIMESPENTBYMEONEMAILANDMEETINGS","TARGET"."SN_RENEWALTIMINGCODES"="INPUT"."SN_RENEWALTIMINGCODES","TARGET"."SN_SOLUTIONCONSULTANT"="INPUT"."SN_SOLUTIONCONSULTANT","TARGET"."SN_DEALVALIDATIONNAME"="INPUT"."SN_DEALVALIDATIONNAME","TARGET"."SN_SERVICESSALESAPPROVALS"="INPUT"."SN_SERVICESSALESAPPROVALS","TARGET"."DESCRIPTION"="INPUT"."DESCRIPTION","TARGET"."SN_SUBMITTEDFORBOOKINGNAME"="INPUT"."SN_SUBMITTEDFORBOOKINGNAME","TARGET"."SN_VALIDATESKUSFORRENEWAL"="INPUT"."SN_VALIDATESKUSFORRENEWAL","TARGET"."SN_CLOSEPLANAGREED"="INPUT"."SN_CLOSEPLANAGREED","TARGET"."SENDTHANKYOUNOTENAME"="INPUT"."SENDTHANKYOUNOTENAME","TARGET"."SN_APPROVEDDOCUMENTSSENTTOCHAMPION"="INPUT"."SN_APPROVEDDOCUMENTSSENTTOCHAMPION","TARGET"."SN_SC_POVNAME"="INPUT"."SN_SC_POVNAME","TARGET"."SN_SOURCESYSTEM"="INPUT"."SN_SOURCESYSTEM","TARGET"."SN_STAKEHOLDERIDD"="INPUT"."SN_STAKEHOLDERIDD","TARGET"."SN_SUBMITTEDFORBOOKING"="INPUT"."SN_SUBMITTEDFORBOOKING","TARGET"."DISCOUNTPERCENTAGE"="INPUT"."DISCOUNTPERCENTAGE","TARGET"."PURSUITDECISIONNAME"="INPUT"."PURSUITDECISIONNAME","TARGET"."SN_SERVICENOWCONTACTYOMINAME"="INPUT"."SN_SERVICENOWCONTACTYOMINAME","TARGET"."SN_DEFAULTMETRICOPPORTUNITY"="INPUT"."SN_DEFAULTMETRICOPPORTUNITY","TARGET"."SN_SPLITOPPTY"="INPUT"."SN_SPLITOPPTY","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_OPPORTUNITYFLAVORNAME"="INPUT"."SN_OPPORTUNITYFLAVORNAME","TARGET"."SN_DISCOVERYSTAGECOMPLETE"="INPUT"."SN_DISCOVERYSTAGECOMPLETE","TARGET"."SN_DETERMINECODELIVERYMODELNAME"="INPUT"."SN_DETERMINECODELIVERYMODELNAME","TARGET"."SN_CHAMPIONFUNDINGIDENTIFIED"="INPUT"."SN_CHAMPIONFUNDINGIDENTIFIED","TARGET"."SN_OPPORTUNITYBUSINESSUNITLIST"="INPUT"."SN_OPPORTUNITYBUSINESSUNITLIST","TARGET"."DEVELOPPROPOSAL"="INPUT"."DEVELOPPROPOSAL","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_COMANAGEDWITHD365"="INPUT"."SN_COMANAGEDWITHD365","TARGET"."PARENTACCOUNTIDNAME"="INPUT"."PARENTACCOUNTIDNAME","TARGET"."ISREVENUESYSTEMCALCULATED"="INPUT"."ISREVENUESYSTEMCALCULATED","TARGET"."SN_CUSTOMERVALUEDEFINED"="INPUT"."SN_CUSTOMERVALUEDEFINED","TARGET"."SN_STRATEGIC"="INPUT"."SN_STRATEGIC","TARGET"."SN_CLOSEQUARTER"="INPUT"."SN_CLOSEQUARTER","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."SN_IMPLEMENTATIONMODECODENAME"="INPUT"."SN_IMPLEMENTATIONMODECODENAME","TARGET"."FILEDEBRIEFNAME"="INPUT"."FILEDEBRIEFNAME","TARGET"."CLOSEPROBABILITY"="INPUT"."CLOSEPROBABILITY","TARGET"."SN_SC_TECHNICALWIN"="INPUT"."SN_SC_TECHNICALWIN","TARGET"."SN_SOLUTIONPRESENTEDTOCUSTOMERNAME"="INPUT"."SN_SOLUTIONPRESENTEDTOCUSTOMERNAME","TARGET"."SN_ACTIVATESEQUENCES"="INPUT"."SN_ACTIVATESEQUENCES","TARGET"."IDENTIFYPURSUITTEAMNAME"="INPUT"."IDENTIFYPURSUITTEAMNAME","TARGET"."SN_STRATEGICNAME"="INPUT"."SN_STRATEGICNAME","TARGET"."SN_FIELDSALESREP"="INPUT"."SN_FIELDSALESREP","TARGET"."SN_SOLUTIONDIFFERENTIATED"="INPUT"."SN_SOLUTIONDIFFERENTIATED","TARGET"."SN_SECURITYSTAKEHOLDERSIGNEDOFF"="INPUT"."SN_SECURITYSTAKEHOLDERSIGNEDOFF","TARGET"."FREIGHTAMOUNT_BASE"="INPUT"."FREIGHTAMOUNT_BASE","TARGET"."SCHEDULEFOLLOWUP_QUALIFY"="INPUT"."SCHEDULEFOLLOWUP_QUALIFY","TARGET"."SN_DEALIMMINENTSTAGECOMPLETENAME"="INPUT"."SN_DEALIMMINENTSTAGECOMPLETENAME","TARGET"."PURCHASEPROCESS"="INPUT"."PURCHASEPROCESS","TARGET"."SKIPPRICECALCULATIONNAME"="INPUT"."SKIPPRICECALCULATIONNAME","TARGET"."SN_BUSINESSOUTCOMESEXPLORATIONNAME"="INPUT"."SN_BUSINESSOUTCOMESEXPLORATIONNAME","TARGET"."ACCOUNTID"="INPUT"."ACCOUNTID","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_ALERTJSON"="INPUT"."SN_ALERTJSON","TARGET"."SN_DOYOUWANTTOASSOCIATEALEADMEETING"="INPUT"."SN_DOYOUWANTTOASSOCIATEALEADMEETING","TARGET"."SN_BVA"="INPUT"."SN_BVA","TARGET"."SN_SC_TECHNICALWINNAME"="INPUT"."SN_SC_TECHNICALWINNAME","TARGET"."SN_CONTRACTS"="INPUT"."SN_CONTRACTS","TARGET"."SALESSTAGE"="INPUT"."SALESSTAGE","TARGET"."SN_PARTNERHASASIGNEDCONTRACTCHANGEORDER"="INPUT"."SN_PARTNERHASASIGNEDCONTRACTCHANGEORDER","TARGET"."TOTALTAX"="INPUT"."TOTALTAX","TARGET"."SN_PROBABILITYTOCLOSEINQUARTER"="INPUT"."SN_PROBABILITYTOCLOSEINQUARTER","TARGET"."SN_RISKMGMTREVIEWNAME"="INPUT"."SN_RISKMGMTREVIEWNAME","TARGET"."SALESSTAGECODE"="INPUT"."SALESSTAGECODE","TARGET"."SN_RENEWALRISKREASON"="INPUT"."SN_RENEWALRISKREASON","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."ISREVENUESYSTEMCALCULATEDNAME"="INPUT"."ISREVENUESYSTEMCALCULATEDNAME","TARGET"."SALESSTAGENAME"="INPUT"."SALESSTAGENAME","TARGET"."SN_OFREQUESTED"="INPUT"."SN_OFREQUESTED","TARGET"."TOTALTAX_BASE"="INPUT"."TOTALTAX_BASE","TARGET"."SN_POWERBUYERSINQUIRY"="INPUT"."SN_POWERBUYERSINQUIRY","TARGET"."SN_PROPOSALSUPPORTSBVAREALIZATION"="INPUT"."SN_PROPOSALSUPPORTSBVAREALIZATION","TARGET"."TIMELINE"="INPUT"."TIMELINE","TARGET"."PRICINGERRORCODE"="INPUT"."PRICINGERRORCODE","TARGET"."SN_VALUEPROMPTERCREATEDNAME_DEPRECATED"="INPUT"."SN_VALUEPROMPTERCREATEDNAME_DEPRECATED","TARGET"."SN_PRICINGAGREED"="INPUT"."SN_PRICINGAGREED","TARGET"."SN_REQUESTDEALSCOPINGSUPPORTNAME"="INPUT"."SN_REQUESTDEALSCOPINGSUPPORTNAME","TARGET"."SN_FORECASTCATEGORYNAME"="INPUT"."SN_FORECASTCATEGORYNAME","TARGET"."SN_P4MEMBERSYOMINAME"="INPUT"."SN_P4MEMBERSYOMINAME","TARGET"."SN_RENEWALACVNETFINANCIALS_BASE"="INPUT"."SN_RENEWALACVNETFINANCIALS_BASE","TARGET"."NEW_DOCUMENTNAME"="INPUT"."NEW_DOCUMENTNAME","TARGET"."FINALDECISIONDATE"="INPUT"."FINALDECISIONDATE","TARGET"."SN_SERVICEPROVIDERUSAGETYPENAME"="INPUT"."SN_SERVICEPROVIDERUSAGETYPENAME","TARGET"."TEAMSFOLLOWED"="INPUT"."TEAMSFOLLOWED","TARGET"."SN_VALUEPROMPTERSCREATED_DEPRECATED"="INPUT"."SN_VALUEPROMPTERSCREATED_DEPRECATED","TARGET"."SN_SNAPPRESENTEDTOCUSTOMERNAME"="INPUT"."SN_SNAPPRESENTEDTOCUSTOMERNAME","TARGET"."SN_OFROUTINGFORAPPROVALS"="INPUT"."SN_OFROUTINGFORAPPROVALS","TARGET"."SN_PREVIOUSPCLVALUE"="INPUT"."SN_PREVIOUSPCLVALUE","TARGET"."SN_OPPORTUNITYQUALIFIED"="INPUT"."SN_OPPORTUNITYQUALIFIED","TARGET"."QUOTECOMMENTS"="INPUT"."QUOTECOMMENTS","TARGET"."DEVELOPPROPOSALNAME"="INPUT"."DEVELOPPROPOSALNAME","TARGET"."SN_DEALIMMINENTSTAGECOMPLETE"="INPUT"."SN_DEALIMMINENTSTAGECOMPLETE","TARGET"."SN_CPQMASTERQUOTENAME"="INPUT"."SN_CPQMASTERQUOTENAME","TARGET"."SN_RECEIVEDPONAME"="INPUT"."SN_RECEIVEDPONAME","TARGET"."SN_MUTUALSUCCESSPLANAGREED_DEPRECATED"="INPUT"."SN_MUTUALSUCCESSPLANAGREED_DEPRECATED","TARGET"."SN_ORDERFORMCONTRACTREVIEWCOMPLETEDNAME"="INPUT"."SN_ORDERFORMCONTRACTREVIEWCOMPLETEDNAME","TARGET"."SN_VALUEPERSPECTIVENAME"="INPUT"."SN_VALUEPERSPECTIVENAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_RISKTYPENAME"="INPUT"."SN_RISKTYPENAME","TARGET"."SN_COMANAGEDWITHD365NAME"="INPUT"."SN_COMANAGEDWITHD365NAME","TARGET"."SN_BUDGETCOMMITMENTNAME"="INPUT"."SN_BUDGETCOMMITMENTNAME","TARGET"."NEED"="INPUT"."NEED","TARGET"."SN_HASBUSINESSCASE"="INPUT"."SN_HASBUSINESSCASE","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."SN_COMPLIANCECHECK"="INPUT"."SN_COMPLIANCECHECK","TARGET"."SN_SC_WORKSHOPSNAME"="INPUT"."SN_SC_WORKSHOPSNAME","TARGET"."OPPORTUNITYRATINGCODENAME"="INPUT"."OPPORTUNITYRATINGCODENAME","TARGET"."SN_RECONFIRMCLOSEPLAN"="INPUT"."SN_RECONFIRMCLOSEPLAN","TARGET"."SN_BUSINESSVALUEASSESSMENTNAME"="INPUT"."SN_BUSINESSVALUEASSESSMENTNAME","TARGET"."PARENTCONTACTIDYOMINAME"="INPUT"."PARENTCONTACTIDYOMINAME","TARGET"."SN_P4MEMBERSNAME"="INPUT"."SN_P4MEMBERSNAME","TARGET"."SN_PRICINGAGREEDNAME"="INPUT"."SN_PRICINGAGREEDNAME","TARGET"."MSDYN_OPPORTUNITYSCORETRENDNAME"="INPUT"."MSDYN_OPPORTUNITYSCORETRENDNAME","TARGET"."ACCOUNTIDNAME"="INPUT"."ACCOUNTIDNAME","TARGET"."SN_DETERMINECODELIVERYMODEL"="INPUT"."SN_DETERMINECODELIVERYMODEL","TARGET"."SLAINVOKEDID"="INPUT"."SLAINVOKEDID","TARGET"."SN_CPQMASTERQUOTE"="INPUT"."SN_CPQMASTERQUOTE","TARGET"."SN_MUTUALSUCCESSPLANAGREEDNAME_DEPRECATED"="INPUT"."SN_MUTUALSUCCESSPLANAGREEDNAME_DEPRECATED","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."SN_MARKETINGALLOCATIONPERCENTAGE"="INPUT"."SN_MARKETINGALLOCATIONPERCENTAGE","TARGET"."PURCHASEPROCESSNAME"="INPUT"."PURCHASEPROCESSNAME","TARGET"."TRAVERSEDPATH"="INPUT"."TRAVERSEDPATH","TARGET"."IDENTIFYCUSTOMERCONTACTSNAME"="INPUT"."IDENTIFYCUSTOMERCONTACTSNAME","TARGET"."SN_LEAD_NUMBERYOMINAME"="INPUT"."SN_LEAD_NUMBERYOMINAME","TARGET"."SN_CURRENTPCLVALUE"="INPUT"."SN_CURRENTPCLVALUE","TARGET"."SN_ENVIRONMENTTYPENAME"="INPUT"."SN_ENVIRONMENTTYPENAME","TARGET"."SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDERNAME"="INPUT"."SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDERNAME","TARGET"."SCHEDULEPROPOSALMEETING"="INPUT"."SCHEDULEPROPOSALMEETING","TARGET"."SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPE"="INPUT"."SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPE","TARGET"."SN_PRODUCTCATEGORYLIST"="INPUT"."SN_PRODUCTCATEGORYLIST","TARGET"."SN_PRESENTSOLUTIONSTAGECOMPLETE"="INPUT"."SN_PRESENTSOLUTIONSTAGECOMPLETE","TARGET"."SN_CUSTOMERDASHBOARDREVIEWNAME"="INPUT"."SN_CUSTOMERDASHBOARDREVIEWNAME","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MSDYN_OPPORTUNITYKPIIDNAME"="INPUT"."MSDYN_OPPORTUNITYKPIIDNAME","TARGET"."PURCHASETIMEFRAME"="INPUT"."PURCHASETIMEFRAME","TARGET"."ESTIMATEDVALUE_BASE"="INPUT"."ESTIMATEDVALUE_BASE","TARGET"."SN_RENEWALRISKREASONCODES"="INPUT"."SN_RENEWALRISKREASONCODES","TARGET"."MSDYN_GDPROPTOUT"="INPUT"."MSDYN_GDPROPTOUT","TARGET"."SN_PARTNERACCOUNTFORIMPLEMENTATIONMODENAME"="INPUT"."SN_PARTNERACCOUNTFORIMPLEMENTATIONMODENAME","TARGET"."SN_PARTNERECOSYSTEMUNDERSTOOD"="INPUT"."SN_PARTNERECOSYSTEMUNDERSTOOD","TARGET"."SN_VALUEPROMPTERSCREATED_DATE_DEPRECATED"="INPUT"."SN_VALUEPROMPTERSCREATED_DATE_DEPRECATED","TARGET"."MSDYN_SIMILAROPPORTUNITIES"="INPUT"."MSDYN_SIMILAROPPORTUNITIES","TARGET"."SN_SOLUTIONCONSULTANTYOMINAME"="INPUT"."SN_SOLUTIONCONSULTANTYOMINAME","TARGET"."CONTACTIDNAME"="INPUT"."CONTACTIDNAME","TARGET"."SN_PREVIOUSSALESSTAGE"="INPUT"."SN_PREVIOUSSALESSTAGE","TARGET"."SN_REVIEWPARTNERSTRATEGY"="INPUT"."SN_REVIEWPARTNERSTRATEGY","TARGET"."PARTICIPATESINWORKFLOW"="INPUT"."PARTICIPATESINWORKFLOW","TARGET"."SN_CUSTOMERCONTACTYOMINAME"="INPUT"."SN_CUSTOMERCONTACTYOMINAME","TARGET"."PRICELEVELIDNAME"="INPUT"."PRICELEVELIDNAME","TARGET"."PARTICIPATESINWORKFLOWNAME"="INPUT"."PARTICIPATESINWORKFLOWNAME","TARGET"."SN_OPPORTUNITY"="INPUT"."SN_OPPORTUNITY","TARGET"."SN_PARTNEREDNAME"="INPUT"."SN_PARTNEREDNAME","TARGET"."SN_DOYOUWANTTOASSOCIATEALEADMEETINGNAME"="INPUT"."SN_DOYOUWANTTOASSOCIATEALEADMEETINGNAME","TARGET"."TOTALAMOUNT_BASE"="INPUT"."TOTALAMOUNT_BASE","TARGET"."CURRENTSITUATION"="INPUT"."CURRENTSITUATION","TARGET"."SN_POWERSPONSORSHIPSTAGECOMPLETE"="INPUT"."SN_POWERSPONSORSHIPSTAGECOMPLETE","TARGET"."CUSTOMERIDTYPE"="INPUT"."CUSTOMERIDTYPE","TARGET"."CUSTOMERID"="INPUT"."CUSTOMERID","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_SWOTANALYSISCREATED"="INPUT"."SN_SWOTANALYSISCREATED","TARGET"."SN_APPROVEDDOCUMENTSSENTTOCHAMPIONNAME"="INPUT"."SN_APPROVEDDOCUMENTSSENTTOCHAMPIONNAME","TARGET"."NEEDNAME"="INPUT"."NEEDNAME","TARGET"."SN_EXCHANGERATEOVERRIDE"="INPUT"."SN_EXCHANGERATEOVERRIDE","TARGET"."SN_OPPORTUNITYFLAVOR"="INPUT"."SN_OPPORTUNITYFLAVOR","TARGET"."SN_PROPOSALSUPPORTSBVAREALIZATIONNAME"="INPUT"."SN_PROPOSALSUPPORTSBVAREALIZATIONNAME","TARGET"."SN_COMPLETESTAGE0"="INPUT"."SN_COMPLETESTAGE0","TARGET"."ISPRIVATENAME"="INPUT"."ISPRIVATENAME","TARGET"."SN_ENGAGEMENTMODELDEFINEDNAME"="INPUT"."SN_ENGAGEMENTMODELDEFINEDNAME","TARGET"."SN_SURFMASTERSLINESNAME"="INPUT"."SN_SURFMASTERSLINESNAME","TARGET"."COMPLETEFINALPROPOSALNAME"="INPUT"."COMPLETEFINALPROPOSALNAME","TARGET"."SENDTHANKYOUNOTE"="INPUT"."SENDTHANKYOUNOTE","TARGET"."STEPID"="INPUT"."STEPID","TARGET"."TIMELINENAME"="INPUT"."TIMELINENAME","TARGET"."SN_CPQMASTERLINESNAME"="INPUT"."SN_CPQMASTERLINESNAME","TARGET"."PRICINGERRORCODENAME"="INPUT"."PRICINGERRORCODENAME","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."SN_DIFFERENTIATEDVALUEIDENTIFIED"="INPUT"."SN_DIFFERENTIATEDVALUEIDENTIFIED","TARGET"."SN_EXECUTIVESPONSORNAME"="INPUT"."SN_EXECUTIVESPONSORNAME","TARGET"."SN_REVIEWPARTNERSTRATEGYNAME"="INPUT"."SN_REVIEWPARTNERSTRATEGYNAME","TARGET"."SN_RISKMGMTREVIEW"="INPUT"."SN_RISKMGMTREVIEW","TARGET"."SN_REQUESTDEALSCOPINGSUPPORT"="INPUT"."SN_REQUESTDEALSCOPINGSUPPORT","TARGET"."SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORMNAME"="INPUT"."SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORMNAME","TARGET"."SN_SUBMITBOOKING"="INPUT"."SN_SUBMITBOOKING","TARGET"."CAMPAIGNIDNAME"="INPUT"."CAMPAIGNIDNAME","TARGET"."SN_OFREQUESTEDNAME"="INPUT"."SN_OFREQUESTEDNAME","TARGET"."SLAINVOKEDIDNAME"="INPUT"."SLAINVOKEDIDNAME","TARGET"."SN_CREATEMUTUALCLOSEPLAN"="INPUT"."SN_CREATEMUTUALCLOSEPLAN","TARGET"."SN_ESTIMATESVALIDATED"="INPUT"."SN_ESTIMATESVALIDATED","TARGET"."SN_SCOPEDEVELOPMENTCREATEPROPOSAL"="INPUT"."SN_SCOPEDEVELOPMENTCREATEPROPOSAL","TARGET"."SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINEDNAME"="INPUT"."SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINEDNAME","TARGET"."SN_P4MEMBERS"="INPUT"."SN_P4MEMBERS","TARGET"."SN_STAKEHOLDERIDDNAME"="INPUT"."SN_STAKEHOLDERIDDNAME","TARGET"."MSDYN_FORECASTCATEGORY"="INPUT"."MSDYN_FORECASTCATEGORY","TARGET"."MSDYN_OPPORTUNITYSCORETREND"="INPUT"."MSDYN_OPPORTUNITYSCORETREND","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."SN_CUSTOMERLEGALANDPROCUREMENTENGAGEDNAME"="INPUT"."SN_CUSTOMERLEGALANDPROCUREMENTENGAGEDNAME","TARGET"."TOTALLINEITEMDISCOUNTAMOUNT_BASE"="INPUT"."TOTALLINEITEMDISCOUNTAMOUNT_BASE","TARGET"."EVALUATEFITNAME"="INPUT"."EVALUATEFITNAME","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_REVIEWPARTNERSPROPOSAL"="INPUT"."SN_REVIEWPARTNERSPROPOSAL","TARGET"."PARENTCONTACTID"="INPUT"."PARENTCONTACTID","TARGET"."SN_RENEWALTIMINGCODESNAME"="INPUT"."SN_RENEWALTIMINGCODESNAME","TARGET"."SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPENAME"="INPUT"."SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPENAME","TARGET"."SN_NETNEWACVFUTURE_BASE"="INPUT"."SN_NETNEWACVFUTURE_BASE","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENT"="INPUT"."SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENT","TARGET"."SN_TCSPRESENTEDNAME"="INPUT"."SN_TCSPRESENTEDNAME","TARGET"."SN_VALUEPROMPTERSCREATED_STATE_DEPRECATED"="INPUT"."SN_VALUEPROMPTERSCREATED_STATE_DEPRECATED","TARGET"."SN_POWERSPONSORSHIPSTAGECOMPLETENAME"="INPUT"."SN_POWERSPONSORSHIPSTAGECOMPLETENAME","TARGET"."SN_DOUBLECOMPELIGIBLE"="INPUT"."SN_DOUBLECOMPELIGIBLE","TARGET"."SN_RENEWALCATEGORYCODE"="INPUT"."SN_RENEWALCATEGORYCODE","TARGET"."SN_RENEWALACVNETFINANCIALS"="INPUT"."SN_RENEWALACVNETFINANCIALS","TARGET"."SN_ORDERFROMSUBMITTEDAPPROVEDNAME"="INPUT"."SN_ORDERFROMSUBMITTEDAPPROVEDNAME","TARGET"."NAME"="INPUT"."NAME","TARGET"."SN_VALUEPERSPECTIVE"="INPUT"."SN_VALUEPERSPECTIVE","TARGET"."SN_POWITHPROCUREMENT"="INPUT"."SN_POWITHPROCUREMENT","TARGET"."RESOLVEFEEDBACKNAME"="INPUT"."RESOLVEFEEDBACKNAME","TARGET"."SN_FIELDSALESREPYOMINAME"="INPUT"."SN_FIELDSALESREPYOMINAME","TARGET"."SN_OPPORTUNITYSTAGECOMPLETE"="INPUT"."SN_OPPORTUNITYSTAGECOMPLETE","TARGET"."SN_OPPTYRECORDID"="INPUT"."SN_OPPTYRECORDID","TARGET"."SN_NETNEWACVFUTURE"="INPUT"."SN_NETNEWACVFUTURE","TARGET"."SN_SURFCTTPRECEDENCE"="INPUT"."SN_SURFCTTPRECEDENCE","TARGET"."EMAILADDRESS"="INPUT"."EMAILADDRESS","TARGET"."TOTALLINEITEMDISCOUNTAMOUNT"="INPUT"."TOTALLINEITEMDISCOUNTAMOUNT","TARGET"."PRESENTPROPOSALNAME"="INPUT"."PRESENTPROPOSALNAME","TARGET"."SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENTNAME"="INPUT"."SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENTNAME","TARGET"."SN_OTHERREVENUE"="INPUT"."SN_OTHERREVENUE","TARGET"."SN_TRAININGREVENUE"="INPUT"."SN_TRAININGREVENUE","TARGET"."SN_OFSENTTOCUSTOMERNAME"="INPUT"."SN_OFSENTTOCUSTOMERNAME","TARGET"."NEW_DOCUMENTTYPE"="INPUT"."NEW_DOCUMENTTYPE","TARGET"."SN_IMPLEMENTATIONSUCCESSSCORECARDNAME"="INPUT"."SN_IMPLEMENTATIONSUCCESSSCORECARDNAME","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."TOTALLINEITEMAMOUNT"="INPUT"."TOTALLINEITEMAMOUNT","TARGET"."SN_WINLOSSNODECISIONREASONNAME"="INPUT"."SN_WINLOSSNODECISIONREASONNAME","TARGET"."DISCOUNTAMOUNT"="INPUT"."DISCOUNTAMOUNT","TARGET"."SN_ENGAGEMENTMODELDEFINED"="INPUT"."SN_ENGAGEMENTMODELDEFINED","TARGET"."SN_SWOTANALYSISCREATEDNAME"="INPUT"."SN_SWOTANALYSISCREATEDNAME","TARGET"."SN_CUSTOMERVALUEDEFINEDNAME"="INPUT"."SN_CUSTOMERVALUEDEFINEDNAME","TARGET"."SN_CHANNELTRANSACTIONTYPE"="INPUT"."SN_CHANNELTRANSACTIONTYPE","TARGET"."SN_POWERBUYERCOMMITMENT"="INPUT"."SN_POWERBUYERCOMMITMENT","TARGET"."SN_COMPLETESTAGE0NAME"="INPUT"."SN_COMPLETESTAGE0NAME","TARGET"."SN_SERVICEPROVIDERUSAGETYPE"="INPUT"."SN_SERVICEPROVIDERUSAGETYPE","TARGET"."SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDER"="INPUT"."SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDER","TARGET"."CUSTOMERPAINPOINTS"="INPUT"."CUSTOMERPAINPOINTS","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."SN_VALUEPROMPTERCREATED_DEPRECATED"="INPUT"."SN_VALUEPROMPTERCREATED_DEPRECATED","TARGET"."SN_IMPLEMENTATIONSUCCESSSCORECARD"="INPUT"."SN_IMPLEMENTATIONSUCCESSSCORECARD","TARGET"."SN_SECURITYSTAKEHOLDERSIGNEDOFFNAME"="INPUT"."SN_SECURITYSTAKEHOLDERSIGNEDOFFNAME","TARGET"."SN_CLOSEPLANAGREEDNAME"="INPUT"."SN_CLOSEPLANAGREEDNAME","TARGET"."SN_RENEWALACV"="INPUT"."SN_RENEWALACV","TARGET"."SN_DEFAULTMETRICOPPORTUNITYNAME"="INPUT"."SN_DEFAULTMETRICOPPORTUNITYNAME","TARGET"."SN_WINLOSSNODECISIONNOTES"="INPUT"."SN_WINLOSSNODECISIONNOTES","TARGET"."SN_SALESSTAGENAME"="INPUT"."SN_SALESSTAGENAME","TARGET"."SN_MEETINGNUMBER"="INPUT"."SN_MEETINGNUMBER","TARGET"."SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPIONNAME"="INPUT"."SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPIONNAME","TARGET"."CONTACTIDYOMINAME"="INPUT"."CONTACTIDYOMINAME","TARGET"."SN_LEAD_NUMBER"="INPUT"."SN_LEAD_NUMBER","TARGET"."SN_EXECUTIVESPONSOR"="INPUT"."SN_EXECUTIVESPONSOR","TARGET"."MSDYN_OPPORTUNITYGRADENAME"="INPUT"."MSDYN_OPPORTUNITYGRADENAME","TARGET"."SN_POWERBUYERSENGAGEDNAME"="INPUT"."SN_POWERBUYERSENGAGEDNAME","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_MOACOMPLETEDNAME"="INPUT"."SN_MOACOMPLETEDNAME","TARGET"."SN_RENEWALRISK"="INPUT"."SN_RENEWALRISK","TARGET"."SN_PARTNERED"="INPUT"."SN_PARTNERED","TARGET"."SN_BUDGETCOMMITMENT"="INPUT"."SN_BUDGETCOMMITMENT","TARGET"."SN_PSREVENUE_BASE"="INPUT"."SN_PSREVENUE_BASE","TARGET"."SN_CREATEMUTUALCLOSEPLANNAME"="INPUT"."SN_CREATEMUTUALCLOSEPLANNAME","TARGET"."SN_PREVIOUSFORECASTCATEGORYVALUE"="INPUT"."SN_PREVIOUSFORECASTCATEGORYVALUE","TARGET"."SN_SUBSCRIPTIONGUIDE"="INPUT"."SN_SUBSCRIPTIONGUIDE","TARGET"."IDENTIFYCOMPETITORSNAME"="INPUT"."IDENTIFYCOMPETITORSNAME","TARGET"."DECISIONMAKERNAME"="INPUT"."DECISIONMAKERNAME","TARGET"."BUDGETAMOUNT_BASE"="INPUT"."BUDGETAMOUNT_BASE","TARGET"."SN_SALESSTAGE"="INPUT"."SN_SALESSTAGE","TARGET"."SN_OFSENTTOCUSTOMER"="INPUT"."SN_OFSENTTOCUSTOMER","TARGET"."SN_INFLUENCEDETAILSLABEL"="INPUT"."SN_INFLUENCEDETAILSLABEL","TARGET"."ESTIMATEDVALUE"="INPUT"."ESTIMATEDVALUE","TARGET"."SN_IMPLEMENTATIONMODECODE"="INPUT"."SN_IMPLEMENTATIONMODECODE","TARGET"."SLANAME"="INPUT"."SLANAME","TARGET"."MSDYN_OPPORTUNITYSCORE"="INPUT"."MSDYN_OPPORTUNITYSCORE","TARGET"."SN_CLOSEPLANAGREEDNOMOA"="INPUT"."SN_CLOSEPLANAGREEDNOMOA","TARGET"."SCHEDULEFOLLOWUP_PROSPECT"="INPUT"."SCHEDULEFOLLOWUP_PROSPECT","TARGET"."SN_VALUEMGMTENGAGED"="INPUT"."SN_VALUEMGMTENGAGED","TARGET"."LASTONHOLDTIME"="INPUT"."LASTONHOLDTIME","TARGET"."PRICELEVELID"="INPUT"."PRICELEVELID","TARGET"."SN_LEGALCHECKNAME"="INPUT"."SN_LEGALCHECKNAME","TARGET"."SN_LEGALCHECK"="INPUT"."SN_LEGALCHECK","TARGET"."INITIALCOMMUNICATION"="INPUT"."INITIALCOMMUNICATION","TARGET"."BUDGETSTATUS"="INPUT"."BUDGETSTATUS","TARGET"."COMPLETEINTERNALREVIEW"="INPUT"."COMPLETEINTERNALREVIEW","TARGET"."SN_SPLITOPPTYNAME"="INPUT"."SN_SPLITOPPTYNAME","TARGET"."SN_RECEIVEDPO"="INPUT"."SN_RECEIVEDPO","TARGET"."SN_RENEWALCATEGORYCODENAME"="INPUT"."SN_RENEWALCATEGORYCODENAME","TARGET"."SN_OFROUTINGFORAPPROVALSNAME"="INPUT"."SN_OFROUTINGFORAPPROVALSNAME","TARGET"."CUSTOMERNEED"="INPUT"."CUSTOMERNEED","TARGET"."SN_POWITHPROCUREMENTNAME"="INPUT"."SN_POWITHPROCUREMENTNAME","TARGET"."SN_ENGAGECUSTOMEROUTCOMES"="INPUT"."SN_ENGAGECUSTOMEROUTCOMES","TARGET"."SN_ACTIVESTRATEGICNAME"="INPUT"."SN_ACTIVESTRATEGICNAME","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."SN_PIPELINESOURCECODENAME"="INPUT"."SN_PIPELINESOURCECODENAME","TARGET"."SN_FIELDTERRITORYNAME"="INPUT"."SN_FIELDTERRITORYNAME","TARGET"."SN_NETNEWACV_BASE"="INPUT"."SN_NETNEWACV_BASE","TARGET"."SN_DOUBLECOMPELIGIBLENAME"="INPUT"."SN_DOUBLECOMPELIGIBLENAME","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP,"TARGET"."SN_SCDEMONAME"="INPUT"."SN_SCDEMONAME","TARGET"."SN_SCWORKSHOPSNAME"="INPUT"."SN_SCWORKSHOPSNAME","TARGET"."SN_SCPOVNAME"="INPUT"."SN_SCPOVNAME","TARGET"."SN_SCTECHNICALWINNAME"="INPUT"."SN_SCTECHNICALWINNAME","TARGET"."SN_OPPORTUNITYSUMMARIESCREATED_STATE"="INPUT"."SN_OPPORTUNITYSUMMARIESCREATED_STATE","TARGET"."SN_JOINTACTIONPLANAGREEDNAME"="INPUT"."SN_JOINTACTIONPLANAGREEDNAME","TARGET"."SN_OPPORTUNITYSUMMARYCREATEDNAME"="INPUT"."SN_OPPORTUNITYSUMMARYCREATEDNAME","TARGET"."SN_OPPORTUNITYSUMMARIESCREATED_DATE"="INPUT"."SN_OPPORTUNITYSUMMARIESCREATED_DATE","TARGET"."SN_OPPORTUNITYSUMMARIESCREATED"="INPUT"."SN_OPPORTUNITYSUMMARIESCREATED","TARGET"."SN_OPPORTUNITYSUMMARYCREATED"="INPUT"."SN_OPPORTUNITYSUMMARYCREATED","TARGET"."SN_JOINTACTIONPLANAGREED"="INPUT"."SN_JOINTACTIONPLANAGREED","TARGET"."SN_SOURCED_DEPRECATED"="INPUT"."SN_SOURCED_DEPRECATED","TARGET"."SN_SOURCEDNAME_DEPRECATED"="INPUT"."SN_SOURCEDNAME_DEPRECATED","TARGET"."SN_RISKMITIGATIONSTEPSNAME_DEPRECATED"="INPUT"."SN_RISKMITIGATIONSTEPSNAME_DEPRECATED","TARGET"."SN_MULTIPERIOD"="INPUT"."SN_MULTIPERIOD","TARGET"."SN_OPTIONPERIOD"="INPUT"."SN_OPTIONPERIOD","TARGET"."SN_OMREVIEWSTATUS"="INPUT"."SN_OMREVIEWSTATUS","TARGET"."SN_TERMINATIONTYPE"="INPUT"."SN_TERMINATIONTYPE","TARGET"."SN_TERMINATIONTYPENAME"="INPUT"."SN_TERMINATIONTYPENAME","TARGET"."SN_ORIGINALSALESPARTNER"="INPUT"."SN_ORIGINALSALESPARTNER","TARGET"."SN_ORIGINALSALESTYPE"="INPUT"."SN_ORIGINALSALESTYPE","TARGET"."SN_GOLIVEDATE"="INPUT"."SN_GOLIVEDATE","TARGET"."SN_COMPETITORLOSTAGAINSTNAME"="INPUT"."SN_COMPETITORLOSTAGAINSTNAME","TARGET"."SN_COMPETITORLOSTAGAINST"="INPUT"."SN_COMPETITORLOSTAGAINST","TARGET"."SN_NONCOMPETITIVENAME"="INPUT"."SN_NONCOMPETITIVENAME","TARGET"."SN_NONCOMPETITIVE"="INPUT"."SN_NONCOMPETITIVE","TARGET"."SN_NONCOMPETITIVEUPDATEDBY"="INPUT"."SN_NONCOMPETITIVEUPDATEDBY","TARGET"."SN_NONCOMPETITIVEUPDATEDBYNAME"="INPUT"."SN_NONCOMPETITIVEUPDATEDBYNAME","TARGET"."SN_INCUMBENTVENDOR"="INPUT"."SN_INCUMBENTVENDOR","TARGET"."SN_INCUMBENTVENDORNAME"="INPUT"."SN_INCUMBENTVENDORNAME" WHEN NOT MATCHED THEN INSERT ("SALESSTAGECODENAME","SN_PURCHASEHISTORYREVIEW","CUSTOMERIDYOMINAME","SN_COMPLIANCECHECKNAME","PARENTACCOUNTID","SN_SURFCTTPRECEDENCENAME","SN_CPQMASTERLINES","SN_NUMBER","STAGEID","SN_RECORDURL","SN_BUSINESSOUTCOMESEXPLORATION","SN_DIDMARKETINGHELP","SN_TRAININGPLANAGREEDNAME","CAPTUREPROPOSALFEEDBACK","EVALUATEFIT","SN_OPPORTUNITYSOURCENAME","PRESENTFINALPROPOSALNAME","SN_BUSINESSISSUESTAGECOMPLETE","SN_SALESALLOCATIONPERCENTAGE","OWNINGBUSINESSUNITNAME","SN_WINLOSSNODECISIONREASON","SN_SPLITTHISOPPORTUNITYNAME","SN_SOLUTIONCONSULTANTNAME","TOTALDISCOUNTAMOUNT_BASE","PRESENTPROPOSAL","MODIFIEDBYYOMINAME","CAMPAIGNID","SN_FIELDTERRITORY","TRANSACTIONCURRENCYIDNAME","SN_BUSINESSVALUEASSESSMENT","SN_RENEWALRISKCODESNAME","RESOLVEFEEDBACK","SN_ACTIVATESEQUENCESNAME","SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENTNAME","SN_SOLUTIONDIFFERENTIATEDNAME","SN_SERVICENOWCONTACT","SN_ENGAGECUSTOMEROUTCOMESNAME","SN_POWERVALIDATIONSTAGECOMPLETE","SN_POWERVALIDATIONSTAGECOMPLETENAME","STEPNAME","SN_RISKTYPE","MODIFIEDONBEHALFBYYOMINAME","SN_TRAININGREVENUE_BASE","DISCOUNTAMOUNT_BASE","MSDYN_GDPROPTOUTNAME","SN_HASBUSINESSCASENAME","OPPORTUNITYID","TOTALAMOUNTLESSFREIGHT","PURCHASETIMEFRAMENAME","SN_SOLUTIONPRESENTEDTOCUSTOMER","SN_CURRENTCONTRACTENDDATE","CREATEDBYNAME","OVERRIDDENCREATEDON","NEW_DATELASTUPDATED","SN_VALUEMGMTENGAGEDNAME","SN_NNACVNETFINANCIALS","SN_BUSINESSISSUESTAGECOMPLETENAME","SN_DEALVALIDATION","SN_ENDCUSTOMERIDNAME","SN_TOTALNNACV","SN_NNACVFUTURENETFINANCIALS","SN_PSREVENUE","SN_CONTRACTSNAME","SN_SPLITOPPTYEVERYONE","ORIGINATINGLEADID","SN_TAEENGAGEDTRAINING","SN_ACTIVESTRATEGIC","QUALIFICATIONCOMMENTS","FREIGHTAMOUNT","OWNINGUSER","SN_OTHERREVENUE_BASE","SN_CHAMPIONFUNDINGIDENTIFIEDNAME","SN_TRANSACTINGPARTNERIDNAME","SN_RECONFIRMCLOSEPLANNAME","ACCOUNTIDYOMINAME","SN_TAEENGAGEDTRAININGNAME","TOTALAMOUNT","MSDYN_OPPORTUNITYGRADE","SN_DISCOVERYSTAGECOMPLETENAME","SN_SURF_SYSID","SN_RISKMITIGATIONSTEPS","SN_RECEIVEDOFNAME","SN_DOUBLECOMPTERRITORYNAME","SN_REQUESTSUBSCRIPTIONREMINDERSNAME","SN_FXRATE","SN_TCSPRESENTED","SN_RENEWALENGAGEMENTNAME","SN_REVIEWPARTNERSPROPOSALNAME","BUDGETTYPENAME","SN_POWERBUYERSINQUIRYNAME","MSDYN_SCOREREASONS","SN_CONTRACTREVIEWNAME","SN_TRANSACTINGPARTNERID","SN_SUBSCRIPTIONGUIDENAME","IDENTIFYCOMPETITORS","SN_RECEIVEDOF","STATUSCODE","DECISIONMAKER","SN_PIPELINESOURCECODE","MSDYN_FORECASTCATEGORYNAME","SN_OVERVIEWPRESENTEDNAME","SN_LEAD_NUMBERNAME","ACTUALVALUE_BASE","SN_NNACVFUTURENETFINANCIALS_BASE","SN_DIFFERENTIATEDVALUEIDENTIFIEDNAME","CREATEDONBEHALFBY","SN_TOTALNNACV_BASE","SN_MOACOMPLETED","FILEDEBRIEF","SN_SOURCESYSTEMNAME","SN_OPPORTUNITYTYPENAME","SN_POWERBUYERSENGAGED","ACTUALVALUE","SN_SOURCE_MEETINGNAME","ONHOLDTIME","CUSTOMERIDNAME","SN_FXRATEUSD","PRIORITYCODE","SN_ENDCUSTOMERID","SN_OPPORTUNITYSOURCE","ISPRIVATE","SN_FORECASTCATEGORY","SN_RENEWALENGAGEMENT","SN_CUSTOMERCONTACT","SN_SC_WORKSHOPS","SN_PARTNERECOSYSTEMUNDERSTOODNAME","STATUSCODENAME","SN_SUBMITSIGNEDDOCUMENTSFORCLOSURENAME","SN_PREVIOUSFORECASTCATEGORYVALUENAME","SN_ACEALLOCATIONPERCENTAGE","SN_PURCHASEHISTORYREVIEWNAME","SN_NNACVNETFINANCIALS_BASE","SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPION","SN_SERVICENOWCONTACTNAME","PURSUITDECISION","PRIORITYCODENAME","SN_SCOPEDEVELOPMENTCREATEPROPOSALNAME","ORIGINATINGLEADIDNAME","SN_ENDCUSTOMERIDYOMINAME","SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINED","COMPLETEFINALPROPOSAL","TOTALAMOUNTLESSFREIGHT_BASE","SN_PRESENTSOLUTIONSTAGECOMPLETENAME","PARENTACCOUNTIDYOMINAME","ESTIMATEDCLOSEDATE","SN_SERVICESSALESAPPROVALSNAME","SN_ENVIRONMENTTYPE","SLAID","SN_ALIGNMENTWITHINSPIREBVA","SN_CUSTOMERCONTACTNAME","SN_ALIGNMENTWITHINSPIREBVANAME","OPPORTUNITYRATINGCODE","TOTALDISCOUNTAMOUNT","SN_POWERBUYERCOMMITMENTNAME","CREATEDONBEHALFBYYOMINAME","IDENTIFYCUSTOMERCONTACTS","SN_ORDERFORMCONTRACTREVIEWCOMPLETED","CAPTUREPROPOSALFEEDBACKNAME","INITIALCOMMUNICATIONNAME","SN_CONTRACTREVIEW","SN_VALIDATESKUSFORRENEWALNAME","SN_SUBMITSIGNEDDOCUMENTSFORCLOSURE","SN_OPPORTUNITYBULIST","SN_PARTNERACCOUNTFORIMPLEMENTATIONMODE","SN_NETNEWACV","SN_DIDMARKETINGHELPNAME","CONFIRMINTEREST","SN_WHICHMARKETINGPROGRAMEVENT","SN_ORDERFROMSUBMITTEDAPPROVED","SN_SCHEDULEIPKTCUSTOMERHANDOFFNAME","SN_CUSTOMERLEGALANDPROCUREMENTENGAGED","SN_FIELDSALESREPNAME","SN_SPLITTHISOPPORTUNITY","PRESENTFINALPROPOSAL","PROCESSID","SN_SOURCE_MEETING","MSDYN_SCOREHISTORY","SN_SCHEDULEIPKTCUSTOMERHANDOFF","MODIFIEDON","MSDYN_PREDICTIVESCOREID","SN_OPPORTUNITYQUALIFIEDNAME","NEW_CREATEDBY","SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORM","SN_OPPORTUNITYBULISTNAME","CREATEDONBEHALFBYNAME","MSDYN_PREDICTIVESCOREIDNAME","SN_SC_POV","PROPOSEDSOLUTION","PARENTCONTACTIDNAME","IDENTIFYPURSUITTEAM","SN_PREVIOUSSALESSTAGENAME","SN_BVANAME","SN_FLAGFORCREATETASKMEMBERS","MODIFIEDONBEHALFBY","SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMERNAME","SN_REQUESTSUBSCRIPTIONREMINDERS","SN_RENEWALRISKCODES","SN_RENEWALACV_BASE","BUDGETAMOUNT","SN_SC_DEMO","SN_CLOSEPLANDEFINEDANDMUTUALLYAGREED","SN_VALIDATIONSTAGECOMPLETENAME","SN_CUSTOMERDASHBOARDREVIEW","STATECODE","SN_FLAGFORCREATETASKMEMBERSNAME","SN_SURFMASTERSLINES","SN_OVERVIEWPRESENTED","SKIPPRICECALCULATION","TOTALLINEITEMAMOUNT_BASE","ORIGINATINGLEADIDYOMINAME","SN_ROUTETOMARKETLABEL","COMPLETEINTERNALREVIEWNAME","MSDYN_SEGMENTIDNAME","SN_TRAININGCHAMPIONFUNDINGIDENTIFIEDNAME","SN_ESTIMATESVALIDATEDNAME","SN_PARTNERHASASIGNEDCONTRACTCHANGEORDERNAME","ACTUALCLOSEDATE","SN_RENEWALTIMING","SN_RENEWALRISKREASONCODESNAME","CONTACTID","SN_BUSINESSOUTCOMESIDENTIFIED","SN_OPPORTUNITYSTAGECOMPLETENAME","SN_BUSINESSOUTCOMESIDENTIFIEDNAME","SN_DOUBLECOMPTERRITORY","SN_OPPORTUNITYTYPE","SN_PROBABILITY","CONFIRMINTERESTNAME","SN_TRAININGCHAMPIONFUNDINGIDENTIFIED","MSDYN_SEGMENTID","SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENT","SN_CLOSEPLANAGREEDNOMOANAME","SN_CLOSEPLANDEFINEDANDMUTUALLYAGREEDNAME","MSDYN_OPPORTUNITYKPIID","SN_SNAPPRESENTEDTOCUSTOMER","SN_TRAININGPLANAGREED","SN_VALIDATIONSTAGECOMPLETE","SN_EXECUTIVESPONSORYOMINAME","SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMER","SN_SPLITOPPTYEVERYONENAME","SN_CHANNELTRANSACTIONTYPENAME","SN_SC_DEMONAME","SN_CURRENCYCODE","TIMESPENTBYMEONEMAILANDMEETINGS","SN_RENEWALTIMINGCODES","SN_SOLUTIONCONSULTANT","SN_DEALVALIDATIONNAME","SN_SERVICESSALESAPPROVALS","DESCRIPTION","SN_SUBMITTEDFORBOOKINGNAME","SN_VALIDATESKUSFORRENEWAL","SN_CLOSEPLANAGREED","SENDTHANKYOUNOTENAME","SN_APPROVEDDOCUMENTSSENTTOCHAMPION","SN_SC_POVNAME","SN_SOURCESYSTEM","SN_STAKEHOLDERIDD","SN_SUBMITTEDFORBOOKING","DISCOUNTPERCENTAGE","PURSUITDECISIONNAME","SN_SERVICENOWCONTACTYOMINAME","SN_DEFAULTMETRICOPPORTUNITY","SN_SPLITOPPTY","OWNERIDYOMINAME","SN_OPPORTUNITYFLAVORNAME","SN_DISCOVERYSTAGECOMPLETE","SN_DETERMINECODELIVERYMODELNAME","SN_CHAMPIONFUNDINGIDENTIFIED","SN_OPPORTUNITYBUSINESSUNITLIST","DEVELOPPROPOSAL","TRANSACTIONCURRENCYID","SN_COMANAGEDWITHD365","PARENTACCOUNTIDNAME","ISREVENUESYSTEMCALCULATED","SN_CUSTOMERVALUEDEFINED","SN_STRATEGIC","SN_CLOSEQUARTER","VERSIONNUMBER","OWNERID","SN_IMPLEMENTATIONMODECODENAME","FILEDEBRIEFNAME","CLOSEPROBABILITY","SN_SC_TECHNICALWIN","SN_SOLUTIONPRESENTEDTOCUSTOMERNAME","SN_ACTIVATESEQUENCES","IDENTIFYPURSUITTEAMNAME","SN_STRATEGICNAME","SN_FIELDSALESREP","SN_SOLUTIONDIFFERENTIATED","SN_SECURITYSTAKEHOLDERSIGNEDOFF","FREIGHTAMOUNT_BASE","SCHEDULEFOLLOWUP_QUALIFY","SN_DEALIMMINENTSTAGECOMPLETENAME","PURCHASEPROCESS","SKIPPRICECALCULATIONNAME","SN_BUSINESSOUTCOMESEXPLORATIONNAME","ACCOUNTID","EXCHANGERATE","SN_ALERTJSON","SN_DOYOUWANTTOASSOCIATEALEADMEETING","SN_BVA","SN_SC_TECHNICALWINNAME","SN_CONTRACTS","SALESSTAGE","SN_PARTNERHASASIGNEDCONTRACTCHANGEORDER","TOTALTAX","SN_PROBABILITYTOCLOSEINQUARTER","SN_RISKMGMTREVIEWNAME","SALESSTAGECODE","SN_RENEWALRISKREASON","IMPORTSEQUENCENUMBER","ISREVENUESYSTEMCALCULATEDNAME","SALESSTAGENAME","SN_OFREQUESTED","TOTALTAX_BASE","SN_POWERBUYERSINQUIRY","SN_PROPOSALSUPPORTSBVAREALIZATION","TIMELINE","PRICINGERRORCODE","SN_VALUEPROMPTERCREATEDNAME_DEPRECATED","SN_PRICINGAGREED","SN_REQUESTDEALSCOPINGSUPPORTNAME","SN_FORECASTCATEGORYNAME","SN_P4MEMBERSYOMINAME","SN_RENEWALACVNETFINANCIALS_BASE","NEW_DOCUMENTNAME","FINALDECISIONDATE","SN_SERVICEPROVIDERUSAGETYPENAME","TEAMSFOLLOWED","SN_VALUEPROMPTERSCREATED_DEPRECATED","SN_SNAPPRESENTEDTOCUSTOMERNAME","SN_OFROUTINGFORAPPROVALS","SN_PREVIOUSPCLVALUE","SN_OPPORTUNITYQUALIFIED","QUOTECOMMENTS","DEVELOPPROPOSALNAME","SN_DEALIMMINENTSTAGECOMPLETE","SN_CPQMASTERQUOTENAME","SN_RECEIVEDPONAME","SN_MUTUALSUCCESSPLANAGREED_DEPRECATED","SN_ORDERFORMCONTRACTREVIEWCOMPLETEDNAME","SN_VALUEPERSPECTIVENAME","MODIFIEDBY","SN_RISKTYPENAME","SN_COMANAGEDWITHD365NAME","SN_BUDGETCOMMITMENTNAME","NEED","SN_HASBUSINESSCASE","OWNERIDNAME","SN_COMPLIANCECHECK","SN_SC_WORKSHOPSNAME","OPPORTUNITYRATINGCODENAME","SN_RECONFIRMCLOSEPLAN","SN_BUSINESSVALUEASSESSMENTNAME","PARENTCONTACTIDYOMINAME","SN_P4MEMBERSNAME","SN_PRICINGAGREEDNAME","MSDYN_OPPORTUNITYSCORETRENDNAME","ACCOUNTIDNAME","SN_DETERMINECODELIVERYMODEL","SLAINVOKEDID","SN_CPQMASTERQUOTE","SN_MUTUALSUCCESSPLANAGREEDNAME_DEPRECATED","OWNERIDTYPE","SN_MARKETINGALLOCATIONPERCENTAGE","PURCHASEPROCESSNAME","TRAVERSEDPATH","IDENTIFYCUSTOMERCONTACTSNAME","SN_LEAD_NUMBERYOMINAME","SN_CURRENTPCLVALUE","SN_ENVIRONMENTTYPENAME","SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDERNAME","SCHEDULEPROPOSALMEETING","SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPE","SN_PRODUCTCATEGORYLIST","SN_PRESENTSOLUTIONSTAGECOMPLETE","SN_CUSTOMERDASHBOARDREVIEWNAME","STATECODENAME","MSDYN_OPPORTUNITYKPIIDNAME","PURCHASETIMEFRAME","ESTIMATEDVALUE_BASE","SN_RENEWALRISKREASONCODES","MSDYN_GDPROPTOUT","SN_PARTNERACCOUNTFORIMPLEMENTATIONMODENAME","SN_PARTNERECOSYSTEMUNDERSTOOD","SN_VALUEPROMPTERSCREATED_DATE_DEPRECATED","MSDYN_SIMILAROPPORTUNITIES","SN_SOLUTIONCONSULTANTYOMINAME","CONTACTIDNAME","SN_PREVIOUSSALESSTAGE","SN_REVIEWPARTNERSTRATEGY","PARTICIPATESINWORKFLOW","SN_CUSTOMERCONTACTYOMINAME","PRICELEVELIDNAME","PARTICIPATESINWORKFLOWNAME","SN_OPPORTUNITY","SN_PARTNEREDNAME","SN_DOYOUWANTTOASSOCIATEALEADMEETINGNAME","TOTALAMOUNT_BASE","CURRENTSITUATION","SN_POWERSPONSORSHIPSTAGECOMPLETE","CUSTOMERIDTYPE","CUSTOMERID","UTCCONVERSIONTIMEZONECODE","SN_SWOTANALYSISCREATED","SN_APPROVEDDOCUMENTSSENTTOCHAMPIONNAME","NEEDNAME","SN_EXCHANGERATEOVERRIDE","SN_OPPORTUNITYFLAVOR","SN_PROPOSALSUPPORTSBVAREALIZATIONNAME","SN_COMPLETESTAGE0","ISPRIVATENAME","SN_ENGAGEMENTMODELDEFINEDNAME","SN_SURFMASTERSLINESNAME","COMPLETEFINALPROPOSALNAME","SENDTHANKYOUNOTE","STEPID","TIMELINENAME","SN_CPQMASTERLINESNAME","PRICINGERRORCODENAME","CREATEDON","SN_DIFFERENTIATEDVALUEIDENTIFIED","SN_EXECUTIVESPONSORNAME","SN_REVIEWPARTNERSTRATEGYNAME","SN_RISKMGMTREVIEW","SN_REQUESTDEALSCOPINGSUPPORT","SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORMNAME","SN_SUBMITBOOKING","CAMPAIGNIDNAME","SN_OFREQUESTEDNAME","SLAINVOKEDIDNAME","SN_CREATEMUTUALCLOSEPLAN","SN_ESTIMATESVALIDATED","SN_SCOPEDEVELOPMENTCREATEPROPOSAL","SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINEDNAME","SN_P4MEMBERS","SN_STAKEHOLDERIDDNAME","MSDYN_FORECASTCATEGORY","MSDYN_OPPORTUNITYSCORETREND","MODIFIEDBYNAME","SN_CUSTOMERLEGALANDPROCUREMENTENGAGEDNAME","TOTALLINEITEMDISCOUNTAMOUNT_BASE","EVALUATEFITNAME","MODIFIEDONBEHALFBYNAME","SN_REVIEWPARTNERSPROPOSAL","PARENTCONTACTID","SN_RENEWALTIMINGCODESNAME","SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPENAME","SN_NETNEWACVFUTURE_BASE","OWNINGTEAM","SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENT","SN_TCSPRESENTEDNAME","SN_VALUEPROMPTERSCREATED_STATE_DEPRECATED","SN_POWERSPONSORSHIPSTAGECOMPLETENAME","SN_DOUBLECOMPELIGIBLE","SN_RENEWALCATEGORYCODE","SN_RENEWALACVNETFINANCIALS","SN_ORDERFROMSUBMITTEDAPPROVEDNAME","NAME","SN_VALUEPERSPECTIVE","SN_POWITHPROCUREMENT","RESOLVEFEEDBACKNAME","SN_FIELDSALESREPYOMINAME","SN_OPPORTUNITYSTAGECOMPLETE","SN_OPPTYRECORDID","SN_NETNEWACVFUTURE","SN_SURFCTTPRECEDENCE","EMAILADDRESS","TOTALLINEITEMDISCOUNTAMOUNT","PRESENTPROPOSALNAME","SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENTNAME","SN_OTHERREVENUE","SN_TRAININGREVENUE","SN_OFSENTTOCUSTOMERNAME","NEW_DOCUMENTTYPE","SN_IMPLEMENTATIONSUCCESSSCORECARDNAME","CREATEDBYYOMINAME","TOTALLINEITEMAMOUNT","SN_WINLOSSNODECISIONREASONNAME","DISCOUNTAMOUNT","SN_ENGAGEMENTMODELDEFINED","SN_SWOTANALYSISCREATEDNAME","SN_CUSTOMERVALUEDEFINEDNAME","SN_CHANNELTRANSACTIONTYPE","SN_POWERBUYERCOMMITMENT","SN_COMPLETESTAGE0NAME","SN_SERVICEPROVIDERUSAGETYPE","SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDER","CUSTOMERPAINPOINTS","OWNINGBUSINESSUNIT","SN_VALUEPROMPTERCREATED_DEPRECATED","SN_IMPLEMENTATIONSUCCESSSCORECARD","SN_SECURITYSTAKEHOLDERSIGNEDOFFNAME","SN_CLOSEPLANAGREEDNAME","SN_RENEWALACV","SN_DEFAULTMETRICOPPORTUNITYNAME","SN_WINLOSSNODECISIONNOTES","SN_SALESSTAGENAME","SN_MEETINGNUMBER","SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPIONNAME","CONTACTIDYOMINAME","SN_LEAD_NUMBER","SN_EXECUTIVESPONSOR","MSDYN_OPPORTUNITYGRADENAME","SN_POWERBUYERSENGAGEDNAME","TIMEZONERULEVERSIONNUMBER","SN_MOACOMPLETEDNAME","SN_RENEWALRISK","SN_PARTNERED","SN_BUDGETCOMMITMENT","SN_PSREVENUE_BASE","SN_CREATEMUTUALCLOSEPLANNAME","SN_PREVIOUSFORECASTCATEGORYVALUE","SN_SUBSCRIPTIONGUIDE","IDENTIFYCOMPETITORSNAME","DECISIONMAKERNAME","BUDGETAMOUNT_BASE","SN_SALESSTAGE","SN_OFSENTTOCUSTOMER","SN_INFLUENCEDETAILSLABEL","ESTIMATEDVALUE","SN_IMPLEMENTATIONMODECODE","SLANAME","MSDYN_OPPORTUNITYSCORE","SN_CLOSEPLANAGREEDNOMOA","SCHEDULEFOLLOWUP_PROSPECT","SN_VALUEMGMTENGAGED","LASTONHOLDTIME","PRICELEVELID","SN_LEGALCHECKNAME","SN_LEGALCHECK","INITIALCOMMUNICATION","BUDGETSTATUS","COMPLETEINTERNALREVIEW","SN_SPLITOPPTYNAME","SN_RECEIVEDPO","SN_RENEWALCATEGORYCODENAME","SN_OFROUTINGFORAPPROVALSNAME","CUSTOMERNEED","SN_POWITHPROCUREMENTNAME","SN_ENGAGECUSTOMEROUTCOMES","SN_ACTIVESTRATEGICNAME","CREATEDBY","SN_PIPELINESOURCECODENAME","SN_FIELDTERRITORYNAME","SN_NETNEWACV_BASE","SN_DOUBLECOMPELIGIBLENAME","ETL_UPDATE_DATE","SN_SCDEMONAME","SN_SCWORKSHOPSNAME","SN_SCPOVNAME","SN_SCTECHNICALWINNAME","SN_OPPORTUNITYSUMMARIESCREATED_STATE","SN_JOINTACTIONPLANAGREEDNAME","SN_OPPORTUNITYSUMMARYCREATEDNAME","SN_OPPORTUNITYSUMMARIESCREATED_DATE","SN_OPPORTUNITYSUMMARIESCREATED","SN_OPPORTUNITYSUMMARYCREATED","SN_JOINTACTIONPLANAGREED","SN_SOURCED_DEPRECATED","SN_SOURCEDNAME_DEPRECATED","SN_RISKMITIGATIONSTEPSNAME_DEPRECATED","SN_MULTIPERIOD","SN_OPTIONPERIOD","SN_OMREVIEWSTATUS","SN_TERMINATIONTYPE","SN_TERMINATIONTYPENAME","SN_ORIGINALSALESPARTNER","SN_ORIGINALSALESTYPE","SN_GOLIVEDATE","SN_COMPETITORLOSTAGAINSTNAME","SN_COMPETITORLOSTAGAINST","SN_NONCOMPETITIVENAME","SN_NONCOMPETITIVE","SN_NONCOMPETITIVEUPDATEDBY","SN_NONCOMPETITIVEUPDATEDBYNAME","SN_INCUMBENTVENDOR","SN_INCUMBENTVENDORNAME") VALUES ("INPUT"."SALESSTAGECODENAME","INPUT"."SN_PURCHASEHISTORYREVIEW","INPUT"."CUSTOMERIDYOMINAME","INPUT"."SN_COMPLIANCECHECKNAME","INPUT"."PARENTACCOUNTID","INPUT"."SN_SURFCTTPRECEDENCENAME","INPUT"."SN_CPQMASTERLINES","INPUT"."SN_NUMBER","INPUT"."STAGEID","INPUT"."SN_RECORDURL","INPUT"."SN_BUSINESSOUTCOMESEXPLORATION","INPUT"."SN_DIDMARKETINGHELP","INPUT"."SN_TRAININGPLANAGREEDNAME","INPUT"."CAPTUREPROPOSALFEEDBACK","INPUT"."EVALUATEFIT","INPUT"."SN_OPPORTUNITYSOURCENAME","INPUT"."PRESENTFINALPROPOSALNAME","INPUT"."SN_BUSINESSISSUESTAGECOMPLETE","INPUT"."SN_SALESALLOCATIONPERCENTAGE","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."SN_WINLOSSNODECISIONREASON","INPUT"."SN_SPLITTHISOPPORTUNITYNAME","INPUT"."SN_SOLUTIONCONSULTANTNAME","INPUT"."TOTALDISCOUNTAMOUNT_BASE","INPUT"."PRESENTPROPOSAL","INPUT"."MODIFIEDBYYOMINAME","INPUT"."CAMPAIGNID","INPUT"."SN_FIELDTERRITORY","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."SN_BUSINESSVALUEASSESSMENT","INPUT"."SN_RENEWALRISKCODESNAME","INPUT"."RESOLVEFEEDBACK","INPUT"."SN_ACTIVATESEQUENCESNAME","INPUT"."SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENTNAME","INPUT"."SN_SOLUTIONDIFFERENTIATEDNAME","INPUT"."SN_SERVICENOWCONTACT","INPUT"."SN_ENGAGECUSTOMEROUTCOMESNAME","INPUT"."SN_POWERVALIDATIONSTAGECOMPLETE","INPUT"."SN_POWERVALIDATIONSTAGECOMPLETENAME","INPUT"."STEPNAME","INPUT"."SN_RISKTYPE","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_TRAININGREVENUE_BASE","INPUT"."DISCOUNTAMOUNT_BASE","INPUT"."MSDYN_GDPROPTOUTNAME","INPUT"."SN_HASBUSINESSCASENAME","INPUT"."OPPORTUNITYID","INPUT"."TOTALAMOUNTLESSFREIGHT","INPUT"."PURCHASETIMEFRAMENAME","INPUT"."SN_SOLUTIONPRESENTEDTOCUSTOMER","INPUT"."SN_CURRENTCONTRACTENDDATE","INPUT"."CREATEDBYNAME","INPUT"."OVERRIDDENCREATEDON","INPUT"."NEW_DATELASTUPDATED","INPUT"."SN_VALUEMGMTENGAGEDNAME","INPUT"."SN_NNACVNETFINANCIALS","INPUT"."SN_BUSINESSISSUESTAGECOMPLETENAME","INPUT"."SN_DEALVALIDATION","INPUT"."SN_ENDCUSTOMERIDNAME","INPUT"."SN_TOTALNNACV","INPUT"."SN_NNACVFUTURENETFINANCIALS","INPUT"."SN_PSREVENUE","INPUT"."SN_CONTRACTSNAME","INPUT"."SN_SPLITOPPTYEVERYONE","INPUT"."ORIGINATINGLEADID","INPUT"."SN_TAEENGAGEDTRAINING","INPUT"."SN_ACTIVESTRATEGIC","INPUT"."QUALIFICATIONCOMMENTS","INPUT"."FREIGHTAMOUNT","INPUT"."OWNINGUSER","INPUT"."SN_OTHERREVENUE_BASE","INPUT"."SN_CHAMPIONFUNDINGIDENTIFIEDNAME","INPUT"."SN_TRANSACTINGPARTNERIDNAME","INPUT"."SN_RECONFIRMCLOSEPLANNAME","INPUT"."ACCOUNTIDYOMINAME","INPUT"."SN_TAEENGAGEDTRAININGNAME","INPUT"."TOTALAMOUNT","INPUT"."MSDYN_OPPORTUNITYGRADE","INPUT"."SN_DISCOVERYSTAGECOMPLETENAME","INPUT"."SN_SURF_SYSID","INPUT"."SN_RISKMITIGATIONSTEPS","INPUT"."SN_RECEIVEDOFNAME","INPUT"."SN_DOUBLECOMPTERRITORYNAME","INPUT"."SN_REQUESTSUBSCRIPTIONREMINDERSNAME","INPUT"."SN_FXRATE","INPUT"."SN_TCSPRESENTED","INPUT"."SN_RENEWALENGAGEMENTNAME","INPUT"."SN_REVIEWPARTNERSPROPOSALNAME","INPUT"."BUDGETTYPENAME","INPUT"."SN_POWERBUYERSINQUIRYNAME","INPUT"."MSDYN_SCOREREASONS","INPUT"."SN_CONTRACTREVIEWNAME","INPUT"."SN_TRANSACTINGPARTNERID","INPUT"."SN_SUBSCRIPTIONGUIDENAME","INPUT"."IDENTIFYCOMPETITORS","INPUT"."SN_RECEIVEDOF","INPUT"."STATUSCODE","INPUT"."DECISIONMAKER","INPUT"."SN_PIPELINESOURCECODE","INPUT"."MSDYN_FORECASTCATEGORYNAME","INPUT"."SN_OVERVIEWPRESENTEDNAME","INPUT"."SN_LEAD_NUMBERNAME","INPUT"."ACTUALVALUE_BASE","INPUT"."SN_NNACVFUTURENETFINANCIALS_BASE","INPUT"."SN_DIFFERENTIATEDVALUEIDENTIFIEDNAME","INPUT"."CREATEDONBEHALFBY","INPUT"."SN_TOTALNNACV_BASE","INPUT"."SN_MOACOMPLETED","INPUT"."FILEDEBRIEF","INPUT"."SN_SOURCESYSTEMNAME","INPUT"."SN_OPPORTUNITYTYPENAME","INPUT"."SN_POWERBUYERSENGAGED","INPUT"."ACTUALVALUE","INPUT"."SN_SOURCE_MEETINGNAME","INPUT"."ONHOLDTIME","INPUT"."CUSTOMERIDNAME","INPUT"."SN_FXRATEUSD","INPUT"."PRIORITYCODE","INPUT"."SN_ENDCUSTOMERID","INPUT"."SN_OPPORTUNITYSOURCE","INPUT"."ISPRIVATE","INPUT"."SN_FORECASTCATEGORY","INPUT"."SN_RENEWALENGAGEMENT","INPUT"."SN_CUSTOMERCONTACT","INPUT"."SN_SC_WORKSHOPS","INPUT"."SN_PARTNERECOSYSTEMUNDERSTOODNAME","INPUT"."STATUSCODENAME","INPUT"."SN_SUBMITSIGNEDDOCUMENTSFORCLOSURENAME","INPUT"."SN_PREVIOUSFORECASTCATEGORYVALUENAME","INPUT"."SN_ACEALLOCATIONPERCENTAGE","INPUT"."SN_PURCHASEHISTORYREVIEWNAME","INPUT"."SN_NNACVNETFINANCIALS_BASE","INPUT"."SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPION","INPUT"."SN_SERVICENOWCONTACTNAME","INPUT"."PURSUITDECISION","INPUT"."PRIORITYCODENAME","INPUT"."SN_SCOPEDEVELOPMENTCREATEPROPOSALNAME","INPUT"."ORIGINATINGLEADIDNAME","INPUT"."SN_ENDCUSTOMERIDYOMINAME","INPUT"."SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINED","INPUT"."COMPLETEFINALPROPOSAL","INPUT"."TOTALAMOUNTLESSFREIGHT_BASE","INPUT"."SN_PRESENTSOLUTIONSTAGECOMPLETENAME","INPUT"."PARENTACCOUNTIDYOMINAME","INPUT"."ESTIMATEDCLOSEDATE","INPUT"."SN_SERVICESSALESAPPROVALSNAME","INPUT"."SN_ENVIRONMENTTYPE","INPUT"."SLAID","INPUT"."SN_ALIGNMENTWITHINSPIREBVA","INPUT"."SN_CUSTOMERCONTACTNAME","INPUT"."SN_ALIGNMENTWITHINSPIREBVANAME","INPUT"."OPPORTUNITYRATINGCODE","INPUT"."TOTALDISCOUNTAMOUNT","INPUT"."SN_POWERBUYERCOMMITMENTNAME","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."IDENTIFYCUSTOMERCONTACTS","INPUT"."SN_ORDERFORMCONTRACTREVIEWCOMPLETED","INPUT"."CAPTUREPROPOSALFEEDBACKNAME","INPUT"."INITIALCOMMUNICATIONNAME","INPUT"."SN_CONTRACTREVIEW","INPUT"."SN_VALIDATESKUSFORRENEWALNAME","INPUT"."SN_SUBMITSIGNEDDOCUMENTSFORCLOSURE","INPUT"."SN_OPPORTUNITYBULIST","INPUT"."SN_PARTNERACCOUNTFORIMPLEMENTATIONMODE","INPUT"."SN_NETNEWACV","INPUT"."SN_DIDMARKETINGHELPNAME","INPUT"."CONFIRMINTEREST","INPUT"."SN_WHICHMARKETINGPROGRAMEVENT","INPUT"."SN_ORDERFROMSUBMITTEDAPPROVED","INPUT"."SN_SCHEDULEIPKTCUSTOMERHANDOFFNAME","INPUT"."SN_CUSTOMERLEGALANDPROCUREMENTENGAGED","INPUT"."SN_FIELDSALESREPNAME","INPUT"."SN_SPLITTHISOPPORTUNITY","INPUT"."PRESENTFINALPROPOSAL","INPUT"."PROCESSID","INPUT"."SN_SOURCE_MEETING","INPUT"."MSDYN_SCOREHISTORY","INPUT"."SN_SCHEDULEIPKTCUSTOMERHANDOFF","INPUT"."MODIFIEDON","INPUT"."MSDYN_PREDICTIVESCOREID","INPUT"."SN_OPPORTUNITYQUALIFIEDNAME","INPUT"."NEW_CREATEDBY","INPUT"."SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORM","INPUT"."SN_OPPORTUNITYBULISTNAME","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MSDYN_PREDICTIVESCOREIDNAME","INPUT"."SN_SC_POV","INPUT"."PROPOSEDSOLUTION","INPUT"."PARENTCONTACTIDNAME","INPUT"."IDENTIFYPURSUITTEAM","INPUT"."SN_PREVIOUSSALESSTAGENAME","INPUT"."SN_BVANAME","INPUT"."SN_FLAGFORCREATETASKMEMBERS","INPUT"."MODIFIEDONBEHALFBY","INPUT"."SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMERNAME","INPUT"."SN_REQUESTSUBSCRIPTIONREMINDERS","INPUT"."SN_RENEWALRISKCODES","INPUT"."SN_RENEWALACV_BASE","INPUT"."BUDGETAMOUNT","INPUT"."SN_SC_DEMO","INPUT"."SN_CLOSEPLANDEFINEDANDMUTUALLYAGREED","INPUT"."SN_VALIDATIONSTAGECOMPLETENAME","INPUT"."SN_CUSTOMERDASHBOARDREVIEW","INPUT"."STATECODE","INPUT"."SN_FLAGFORCREATETASKMEMBERSNAME","INPUT"."SN_SURFMASTERSLINES","INPUT"."SN_OVERVIEWPRESENTED","INPUT"."SKIPPRICECALCULATION","INPUT"."TOTALLINEITEMAMOUNT_BASE","INPUT"."ORIGINATINGLEADIDYOMINAME","INPUT"."SN_ROUTETOMARKETLABEL","INPUT"."COMPLETEINTERNALREVIEWNAME","INPUT"."MSDYN_SEGMENTIDNAME","INPUT"."SN_TRAININGCHAMPIONFUNDINGIDENTIFIEDNAME","INPUT"."SN_ESTIMATESVALIDATEDNAME","INPUT"."SN_PARTNERHASASIGNEDCONTRACTCHANGEORDERNAME","INPUT"."ACTUALCLOSEDATE","INPUT"."SN_RENEWALTIMING","INPUT"."SN_RENEWALRISKREASONCODESNAME","INPUT"."CONTACTID","INPUT"."SN_BUSINESSOUTCOMESIDENTIFIED","INPUT"."SN_OPPORTUNITYSTAGECOMPLETENAME","INPUT"."SN_BUSINESSOUTCOMESIDENTIFIEDNAME","INPUT"."SN_DOUBLECOMPTERRITORY","INPUT"."SN_OPPORTUNITYTYPE","INPUT"."SN_PROBABILITY","INPUT"."CONFIRMINTERESTNAME","INPUT"."SN_TRAININGCHAMPIONFUNDINGIDENTIFIED","INPUT"."MSDYN_SEGMENTID","INPUT"."SN_STAFFINGDEMANDSWITHRESOURCEMANAGEMENT","INPUT"."SN_CLOSEPLANAGREEDNOMOANAME","INPUT"."SN_CLOSEPLANDEFINEDANDMUTUALLYAGREEDNAME","INPUT"."MSDYN_OPPORTUNITYKPIID","INPUT"."SN_SNAPPRESENTEDTOCUSTOMER","INPUT"."SN_TRAININGPLANAGREED","INPUT"."SN_VALIDATIONSTAGECOMPLETE","INPUT"."SN_EXECUTIVESPONSORYOMINAME","INPUT"."SN_SENDCOUNTERSIGNEDDOCUMENTSTOCUSTOMER","INPUT"."SN_SPLITOPPTYEVERYONENAME","INPUT"."SN_CHANNELTRANSACTIONTYPENAME","INPUT"."SN_SC_DEMONAME","INPUT"."SN_CURRENCYCODE","INPUT"."TIMESPENTBYMEONEMAILANDMEETINGS","INPUT"."SN_RENEWALTIMINGCODES","INPUT"."SN_SOLUTIONCONSULTANT","INPUT"."SN_DEALVALIDATIONNAME","INPUT"."SN_SERVICESSALESAPPROVALS","INPUT"."DESCRIPTION","INPUT"."SN_SUBMITTEDFORBOOKINGNAME","INPUT"."SN_VALIDATESKUSFORRENEWAL","INPUT"."SN_CLOSEPLANAGREED","INPUT"."SENDTHANKYOUNOTENAME","INPUT"."SN_APPROVEDDOCUMENTSSENTTOCHAMPION","INPUT"."SN_SC_POVNAME","INPUT"."SN_SOURCESYSTEM","INPUT"."SN_STAKEHOLDERIDD","INPUT"."SN_SUBMITTEDFORBOOKING","INPUT"."DISCOUNTPERCENTAGE","INPUT"."PURSUITDECISIONNAME","INPUT"."SN_SERVICENOWCONTACTYOMINAME","INPUT"."SN_DEFAULTMETRICOPPORTUNITY","INPUT"."SN_SPLITOPPTY","INPUT"."OWNERIDYOMINAME","INPUT"."SN_OPPORTUNITYFLAVORNAME","INPUT"."SN_DISCOVERYSTAGECOMPLETE","INPUT"."SN_DETERMINECODELIVERYMODELNAME","INPUT"."SN_CHAMPIONFUNDINGIDENTIFIED","INPUT"."SN_OPPORTUNITYBUSINESSUNITLIST","INPUT"."DEVELOPPROPOSAL","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_COMANAGEDWITHD365","INPUT"."PARENTACCOUNTIDNAME","INPUT"."ISREVENUESYSTEMCALCULATED","INPUT"."SN_CUSTOMERVALUEDEFINED","INPUT"."SN_STRATEGIC","INPUT"."SN_CLOSEQUARTER","INPUT"."VERSIONNUMBER","INPUT"."OWNERID","INPUT"."SN_IMPLEMENTATIONMODECODENAME","INPUT"."FILEDEBRIEFNAME","INPUT"."CLOSEPROBABILITY","INPUT"."SN_SC_TECHNICALWIN","INPUT"."SN_SOLUTIONPRESENTEDTOCUSTOMERNAME","INPUT"."SN_ACTIVATESEQUENCES","INPUT"."IDENTIFYPURSUITTEAMNAME","INPUT"."SN_STRATEGICNAME","INPUT"."SN_FIELDSALESREP","INPUT"."SN_SOLUTIONDIFFERENTIATED","INPUT"."SN_SECURITYSTAKEHOLDERSIGNEDOFF","INPUT"."FREIGHTAMOUNT_BASE","INPUT"."SCHEDULEFOLLOWUP_QUALIFY","INPUT"."SN_DEALIMMINENTSTAGECOMPLETENAME","INPUT"."PURCHASEPROCESS","INPUT"."SKIPPRICECALCULATIONNAME","INPUT"."SN_BUSINESSOUTCOMESEXPLORATIONNAME","INPUT"."ACCOUNTID","INPUT"."EXCHANGERATE","INPUT"."SN_ALERTJSON","INPUT"."SN_DOYOUWANTTOASSOCIATEALEADMEETING","INPUT"."SN_BVA","INPUT"."SN_SC_TECHNICALWINNAME","INPUT"."SN_CONTRACTS","INPUT"."SALESSTAGE","INPUT"."SN_PARTNERHASASIGNEDCONTRACTCHANGEORDER","INPUT"."TOTALTAX","INPUT"."SN_PROBABILITYTOCLOSEINQUARTER","INPUT"."SN_RISKMGMTREVIEWNAME","INPUT"."SALESSTAGECODE","INPUT"."SN_RENEWALRISKREASON","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."ISREVENUESYSTEMCALCULATEDNAME","INPUT"."SALESSTAGENAME","INPUT"."SN_OFREQUESTED","INPUT"."TOTALTAX_BASE","INPUT"."SN_POWERBUYERSINQUIRY","INPUT"."SN_PROPOSALSUPPORTSBVAREALIZATION","INPUT"."TIMELINE","INPUT"."PRICINGERRORCODE","INPUT"."SN_VALUEPROMPTERCREATEDNAME_DEPRECATED","INPUT"."SN_PRICINGAGREED","INPUT"."SN_REQUESTDEALSCOPINGSUPPORTNAME","INPUT"."SN_FORECASTCATEGORYNAME","INPUT"."SN_P4MEMBERSYOMINAME","INPUT"."SN_RENEWALACVNETFINANCIALS_BASE","INPUT"."NEW_DOCUMENTNAME","INPUT"."FINALDECISIONDATE","INPUT"."SN_SERVICEPROVIDERUSAGETYPENAME","INPUT"."TEAMSFOLLOWED","INPUT"."SN_VALUEPROMPTERSCREATED_DEPRECATED","INPUT"."SN_SNAPPRESENTEDTOCUSTOMERNAME","INPUT"."SN_OFROUTINGFORAPPROVALS","INPUT"."SN_PREVIOUSPCLVALUE","INPUT"."SN_OPPORTUNITYQUALIFIED","INPUT"."QUOTECOMMENTS","INPUT"."DEVELOPPROPOSALNAME","INPUT"."SN_DEALIMMINENTSTAGECOMPLETE","INPUT"."SN_CPQMASTERQUOTENAME","INPUT"."SN_RECEIVEDPONAME","INPUT"."SN_MUTUALSUCCESSPLANAGREED_DEPRECATED","INPUT"."SN_ORDERFORMCONTRACTREVIEWCOMPLETEDNAME","INPUT"."SN_VALUEPERSPECTIVENAME","INPUT"."MODIFIEDBY","INPUT"."SN_RISKTYPENAME","INPUT"."SN_COMANAGEDWITHD365NAME","INPUT"."SN_BUDGETCOMMITMENTNAME","INPUT"."NEED","INPUT"."SN_HASBUSINESSCASE","INPUT"."OWNERIDNAME","INPUT"."SN_COMPLIANCECHECK","INPUT"."SN_SC_WORKSHOPSNAME","INPUT"."OPPORTUNITYRATINGCODENAME","INPUT"."SN_RECONFIRMCLOSEPLAN","INPUT"."SN_BUSINESSVALUEASSESSMENTNAME","INPUT"."PARENTCONTACTIDYOMINAME","INPUT"."SN_P4MEMBERSNAME","INPUT"."SN_PRICINGAGREEDNAME","INPUT"."MSDYN_OPPORTUNITYSCORETRENDNAME","INPUT"."ACCOUNTIDNAME","INPUT"."SN_DETERMINECODELIVERYMODEL","INPUT"."SLAINVOKEDID","INPUT"."SN_CPQMASTERQUOTE","INPUT"."SN_MUTUALSUCCESSPLANAGREEDNAME_DEPRECATED","INPUT"."OWNERIDTYPE","INPUT"."SN_MARKETINGALLOCATIONPERCENTAGE","INPUT"."PURCHASEPROCESSNAME","INPUT"."TRAVERSEDPATH","INPUT"."IDENTIFYCUSTOMERCONTACTSNAME","INPUT"."SN_LEAD_NUMBERYOMINAME","INPUT"."SN_CURRENTPCLVALUE","INPUT"."SN_ENVIRONMENTTYPENAME","INPUT"."SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDERNAME","INPUT"."SCHEDULEPROPOSALMEETING","INPUT"."SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPE","INPUT"."SN_PRODUCTCATEGORYLIST","INPUT"."SN_PRESENTSOLUTIONSTAGECOMPLETE","INPUT"."SN_CUSTOMERDASHBOARDREVIEWNAME","INPUT"."STATECODENAME","INPUT"."MSDYN_OPPORTUNITYKPIIDNAME","INPUT"."PURCHASETIMEFRAME","INPUT"."ESTIMATEDVALUE_BASE","INPUT"."SN_RENEWALRISKREASONCODES","INPUT"."MSDYN_GDPROPTOUT","INPUT"."SN_PARTNERACCOUNTFORIMPLEMENTATIONMODENAME","INPUT"."SN_PARTNERECOSYSTEMUNDERSTOOD","INPUT"."SN_VALUEPROMPTERSCREATED_DATE_DEPRECATED","INPUT"."MSDYN_SIMILAROPPORTUNITIES","INPUT"."SN_SOLUTIONCONSULTANTYOMINAME","INPUT"."CONTACTIDNAME","INPUT"."SN_PREVIOUSSALESSTAGE","INPUT"."SN_REVIEWPARTNERSTRATEGY","INPUT"."PARTICIPATESINWORKFLOW","INPUT"."SN_CUSTOMERCONTACTYOMINAME","INPUT"."PRICELEVELIDNAME","INPUT"."PARTICIPATESINWORKFLOWNAME","INPUT"."SN_OPPORTUNITY","INPUT"."SN_PARTNEREDNAME","INPUT"."SN_DOYOUWANTTOASSOCIATEALEADMEETINGNAME","INPUT"."TOTALAMOUNT_BASE","INPUT"."CURRENTSITUATION","INPUT"."SN_POWERSPONSORSHIPSTAGECOMPLETE","INPUT"."CUSTOMERIDTYPE","INPUT"."CUSTOMERID","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_SWOTANALYSISCREATED","INPUT"."SN_APPROVEDDOCUMENTSSENTTOCHAMPIONNAME","INPUT"."NEEDNAME","INPUT"."SN_EXCHANGERATEOVERRIDE","INPUT"."SN_OPPORTUNITYFLAVOR","INPUT"."SN_PROPOSALSUPPORTSBVAREALIZATIONNAME","INPUT"."SN_COMPLETESTAGE0","INPUT"."ISPRIVATENAME","INPUT"."SN_ENGAGEMENTMODELDEFINEDNAME","INPUT"."SN_SURFMASTERSLINESNAME","INPUT"."COMPLETEFINALPROPOSALNAME","INPUT"."SENDTHANKYOUNOTE","INPUT"."STEPID","INPUT"."TIMELINENAME","INPUT"."SN_CPQMASTERLINESNAME","INPUT"."PRICINGERRORCODENAME","INPUT"."CREATEDON","INPUT"."SN_DIFFERENTIATEDVALUEIDENTIFIED","INPUT"."SN_EXECUTIVESPONSORNAME","INPUT"."SN_REVIEWPARTNERSTRATEGYNAME","INPUT"."SN_RISKMGMTREVIEW","INPUT"."SN_REQUESTDEALSCOPINGSUPPORT","INPUT"."SN_CUSTOMERREVIEWINGNEGOTIATINGORDERFORMNAME","INPUT"."SN_SUBMITBOOKING","INPUT"."CAMPAIGNIDNAME","INPUT"."SN_OFREQUESTEDNAME","INPUT"."SLAINVOKEDIDNAME","INPUT"."SN_CREATEMUTUALCLOSEPLAN","INPUT"."SN_ESTIMATESVALIDATED","INPUT"."SN_SCOPEDEVELOPMENTCREATEPROPOSAL","INPUT"."SN_CUSTOMEROUTCOMESSALESSTRATEGYDEFINEDNAME","INPUT"."SN_P4MEMBERS","INPUT"."SN_STAKEHOLDERIDDNAME","INPUT"."MSDYN_FORECASTCATEGORY","INPUT"."MSDYN_OPPORTUNITYSCORETREND","INPUT"."MODIFIEDBYNAME","INPUT"."SN_CUSTOMERLEGALANDPROCUREMENTENGAGEDNAME","INPUT"."TOTALLINEITEMDISCOUNTAMOUNT_BASE","INPUT"."EVALUATEFITNAME","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_REVIEWPARTNERSPROPOSAL","INPUT"."PARENTCONTACTID","INPUT"."SN_RENEWALTIMINGCODESNAME","INPUT"."SN_CUSTOMERALIGNEDONENGAGEMENTMODELANDSCOPENAME","INPUT"."SN_NETNEWACVFUTURE_BASE","INPUT"."OWNINGTEAM","INPUT"."SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENT","INPUT"."SN_TCSPRESENTEDNAME","INPUT"."SN_VALUEPROMPTERSCREATED_STATE_DEPRECATED","INPUT"."SN_POWERSPONSORSHIPSTAGECOMPLETENAME","INPUT"."SN_DOUBLECOMPELIGIBLE","INPUT"."SN_RENEWALCATEGORYCODE","INPUT"."SN_RENEWALACVNETFINANCIALS","INPUT"."SN_ORDERFROMSUBMITTEDAPPROVEDNAME","INPUT"."NAME","INPUT"."SN_VALUEPERSPECTIVE","INPUT"."SN_POWITHPROCUREMENT","INPUT"."RESOLVEFEEDBACKNAME","INPUT"."SN_FIELDSALESREPYOMINAME","INPUT"."SN_OPPORTUNITYSTAGECOMPLETE","INPUT"."SN_OPPTYRECORDID","INPUT"."SN_NETNEWACVFUTURE","INPUT"."SN_SURFCTTPRECEDENCE","INPUT"."EMAILADDRESS","INPUT"."TOTALLINEITEMDISCOUNTAMOUNT","INPUT"."PRESENTPROPOSALNAME","INPUT"."SN_STAFFINGAWARENESSWITHRESOURCEMANAGEMENTNAME","INPUT"."SN_OTHERREVENUE","INPUT"."SN_TRAININGREVENUE","INPUT"."SN_OFSENTTOCUSTOMERNAME","INPUT"."NEW_DOCUMENTTYPE","INPUT"."SN_IMPLEMENTATIONSUCCESSSCORECARDNAME","INPUT"."CREATEDBYYOMINAME","INPUT"."TOTALLINEITEMAMOUNT","INPUT"."SN_WINLOSSNODECISIONREASONNAME","INPUT"."DISCOUNTAMOUNT","INPUT"."SN_ENGAGEMENTMODELDEFINED","INPUT"."SN_SWOTANALYSISCREATEDNAME","INPUT"."SN_CUSTOMERVALUEDEFINEDNAME","INPUT"."SN_CHANNELTRANSACTIONTYPE","INPUT"."SN_POWERBUYERCOMMITMENT","INPUT"."SN_COMPLETESTAGE0NAME","INPUT"."SN_SERVICEPROVIDERUSAGETYPE","INPUT"."SN_SNAPSUBMITTEDTOSECURITYSTAKEHOLDER","INPUT"."CUSTOMERPAINPOINTS","INPUT"."OWNINGBUSINESSUNIT","INPUT"."SN_VALUEPROMPTERCREATED_DEPRECATED","INPUT"."SN_IMPLEMENTATIONSUCCESSSCORECARD","INPUT"."SN_SECURITYSTAKEHOLDERSIGNEDOFFNAME","INPUT"."SN_CLOSEPLANAGREEDNAME","INPUT"."SN_RENEWALACV","INPUT"."SN_DEFAULTMETRICOPPORTUNITYNAME","INPUT"."SN_WINLOSSNODECISIONNOTES","INPUT"."SN_SALESSTAGENAME","INPUT"."SN_MEETINGNUMBER","INPUT"."SN_ORDERDOCUMENTSCOMPLETEDANDSENTTOCHAMPIONNAME","INPUT"."CONTACTIDYOMINAME","INPUT"."SN_LEAD_NUMBER","INPUT"."SN_EXECUTIVESPONSOR","INPUT"."MSDYN_OPPORTUNITYGRADENAME","INPUT"."SN_POWERBUYERSENGAGEDNAME","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_MOACOMPLETEDNAME","INPUT"."SN_RENEWALRISK","INPUT"."SN_PARTNERED","INPUT"."SN_BUDGETCOMMITMENT","INPUT"."SN_PSREVENUE_BASE","INPUT"."SN_CREATEMUTUALCLOSEPLANNAME","INPUT"."SN_PREVIOUSFORECASTCATEGORYVALUE","INPUT"."SN_SUBSCRIPTIONGUIDE","INPUT"."IDENTIFYCOMPETITORSNAME","INPUT"."DECISIONMAKERNAME","INPUT"."BUDGETAMOUNT_BASE","INPUT"."SN_SALESSTAGE","INPUT"."SN_OFSENTTOCUSTOMER","INPUT"."SN_INFLUENCEDETAILSLABEL","INPUT"."ESTIMATEDVALUE","INPUT"."SN_IMPLEMENTATIONMODECODE","INPUT"."SLANAME","INPUT"."MSDYN_OPPORTUNITYSCORE","INPUT"."SN_CLOSEPLANAGREEDNOMOA","INPUT"."SCHEDULEFOLLOWUP_PROSPECT","INPUT"."SN_VALUEMGMTENGAGED","INPUT"."LASTONHOLDTIME","INPUT"."PRICELEVELID","INPUT"."SN_LEGALCHECKNAME","INPUT"."SN_LEGALCHECK","INPUT"."INITIALCOMMUNICATION","INPUT"."BUDGETSTATUS","INPUT"."COMPLETEINTERNALREVIEW","INPUT"."SN_SPLITOPPTYNAME","INPUT"."SN_RECEIVEDPO","INPUT"."SN_RENEWALCATEGORYCODENAME","INPUT"."SN_OFROUTINGFORAPPROVALSNAME","INPUT"."CUSTOMERNEED","INPUT"."SN_POWITHPROCUREMENTNAME","INPUT"."SN_ENGAGECUSTOMEROUTCOMES","INPUT"."SN_ACTIVESTRATEGICNAME","INPUT"."CREATEDBY","INPUT"."SN_PIPELINESOURCECODENAME","INPUT"."SN_FIELDTERRITORYNAME","INPUT"."SN_NETNEWACV_BASE","INPUT"."SN_DOUBLECOMPELIGIBLENAME",CURRENT_TIMESTAMP,"INPUT"."SN_SCDEMONAME","INPUT"."SN_SCWORKSHOPSNAME","INPUT"."SN_SCPOVNAME","INPUT"."SN_SCTECHNICALWINNAME","INPUT"."SN_OPPORTUNITYSUMMARIESCREATED_STATE","INPUT"."SN_JOINTACTIONPLANAGREEDNAME","INPUT"."SN_OPPORTUNITYSUMMARYCREATEDNAME","INPUT"."SN_OPPORTUNITYSUMMARIESCREATED_DATE","INPUT"."SN_OPPORTUNITYSUMMARIESCREATED","INPUT"."SN_OPPORTUNITYSUMMARYCREATED","INPUT"."SN_JOINTACTIONPLANAGREED","INPUT"."SN_SOURCED_DEPRECATED","INPUT"."SN_SOURCEDNAME_DEPRECATED","INPUT"."SN_RISKMITIGATIONSTEPSNAME_DEPRECATED","INPUT"."SN_MULTIPERIOD","INPUT"."SN_OPTIONPERIOD","INPUT"."SN_OMREVIEWSTATUS","INPUT"."SN_TERMINATIONTYPE","INPUT"."SN_TERMINATIONTYPENAME","INPUT"."SN_ORIGINALSALESPARTNER","INPUT"."SN_ORIGINALSALESTYPE","INPUT"."SN_GOLIVEDATE","INPUT"."SN_COMPETITORLOSTAGAINSTNAME","INPUT"."SN_COMPETITORLOSTAGAINST","INPUT"."SN_NONCOMPETITIVENAME","INPUT"."SN_NONCOMPETITIVE","INPUT"."SN_NONCOMPETITIVEUPDATEDBY","INPUT"."SN_NONCOMPETITIVEUPDATEDBYNAME","INPUT"."SN_INCUMBENTVENDOR","INPUT"."SN_INCUMBENTVENDORNAME")
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_opportunities"},
        {"dynamics365.opportunities"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_subproducts_v2():
    """
    ServiceNow Query ID 1369 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitysubproductses TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitysubproductses WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID" WHEN MATCHED THEN UPDATE SET "TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_AUTOCREATED"="INPUT"."SN_AUTOCREATED","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_PERCENTAGE"="INPUT"."SN_PERCENTAGE","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPPORTUNITYPRODUCT"="INPUT"."SN_OPPORTUNITYPRODUCT","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_ANNUALRATEAMOUNT_BASE"="INPUT"."SN_ANNUALRATEAMOUNT_BASE","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_AMOUNT"="INPUT"."SN_AMOUNT","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_OPPORTUNITYPRODUCTNAME"="INPUT"."SN_OPPORTUNITYPRODUCTNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."SN_AMOUNT_BASE"="INPUT"."SN_AMOUNT_BASE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_ANNUALEXCHANGERATE"="INPUT"."SN_ANNUALEXCHANGERATE","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."SN_ANNUALRATEAMOUNT"="INPUT"."SN_ANNUALRATEAMOUNT","TARGET"."SN_AUTOCREATEDNAME"="INPUT"."SN_AUTOCREATEDNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_CUSTOMEXCHANGERATE"="INPUT"."SN_CUSTOMEXCHANGERATE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CREATEDONBEHALFBY","OWNINGTEAM","TRANSACTIONCURRENCYIDNAME","STATUSCODE","IMPORTSEQUENCENUMBER","OWNINGBUSINESSUNITNAME","VERSIONNUMBER","SN_OPPORTUNITYSUBPRODUCTSID","MODIFIEDONBEHALFBY","CREATEDBYYOMINAME","OWNINGBUSINESSUNIT","STATUSCODENAME","SN_NAME","STATECODE","SN_AUTOCREATED","OWNERIDYOMINAME","SN_PERCENTAGE","OWNERID","CREATEDBY","MODIFIEDONBEHALFBYYOMINAME","SN_SUBPRODUCTNAME","SN_OPPORTUNITYPRODUCT","UTCCONVERSIONTIMEZONECODE","SN_ANNUALRATEAMOUNT_BASE","CREATEDONBEHALFBYYOMINAME","SN_AMOUNT","CREATEDONBEHALFBYNAME","MODIFIEDON","STATECODENAME","MODIFIEDBYYOMINAME","MODIFIEDBY","SN_OPPORTUNITYPRODUCTNAME","CREATEDBYNAME","OWNERIDNAME","OWNINGUSER","MODIFIEDONBEHALFBYNAME","SN_CURRENCYCODE","SN_AMOUNT_BASE","EXCHANGERATE","SN_SUBPRODUCT","MODIFIEDBYNAME","OWNERIDTYPE","CREATEDON","TIMEZONERULEVERSIONNUMBER","SN_ANNUALEXCHANGERATE","OVERRIDDENCREATEDON","SN_ANNUALRATEAMOUNT","SN_AUTOCREATEDNAME","TRANSACTIONCURRENCYID","SN_CUSTOMEXCHANGERATE","ETL_UPDATE_DATE") VALUES ("INPUT"."CREATEDONBEHALFBY","INPUT"."OWNINGTEAM","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."STATUSCODE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","INPUT"."MODIFIEDONBEHALFBY","INPUT"."CREATEDBYYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."STATUSCODENAME","INPUT"."SN_NAME","INPUT"."STATECODE","INPUT"."SN_AUTOCREATED","INPUT"."OWNERIDYOMINAME","INPUT"."SN_PERCENTAGE","INPUT"."OWNERID","INPUT"."CREATEDBY","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPPORTUNITYPRODUCT","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_ANNUALRATEAMOUNT_BASE","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_AMOUNT","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MODIFIEDON","INPUT"."STATECODENAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."MODIFIEDBY","INPUT"."SN_OPPORTUNITYPRODUCTNAME","INPUT"."CREATEDBYNAME","INPUT"."OWNERIDNAME","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_CURRENCYCODE","INPUT"."SN_AMOUNT_BASE","INPUT"."EXCHANGERATE","INPUT"."SN_SUBPRODUCT","INPUT"."MODIFIEDBYNAME","INPUT"."OWNERIDTYPE","INPUT"."CREATEDON","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_ANNUALEXCHANGERATE","INPUT"."OVERRIDDENCREATEDON","INPUT"."SN_ANNUALRATEAMOUNT","INPUT"."SN_AUTOCREATEDNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_CUSTOMEXCHANGERATE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitysubproductses"},
        {"dynamics365.sn_opportunitysubproductses"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_subproducts_v3():
    """
    ServiceNow Query ID 1604 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitysubproductses TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitysubproductses WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID" WHEN MATCHED THEN UPDATE SET "TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_AUTOCREATED"="INPUT"."SN_AUTOCREATED","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_PERCENTAGE"="INPUT"."SN_PERCENTAGE","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPPORTUNITYPRODUCT"="INPUT"."SN_OPPORTUNITYPRODUCT","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_ANNUALRATEAMOUNT_BASE"="INPUT"."SN_ANNUALRATEAMOUNT_BASE","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_AMOUNT"="INPUT"."SN_AMOUNT","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_OPPORTUNITYPRODUCTNAME"="INPUT"."SN_OPPORTUNITYPRODUCTNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."SN_AMOUNT_BASE"="INPUT"."SN_AMOUNT_BASE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_ANNUALEXCHANGERATE"="INPUT"."SN_ANNUALEXCHANGERATE","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."SN_ANNUALRATEAMOUNT"="INPUT"."SN_ANNUALRATEAMOUNT","TARGET"."SN_AUTOCREATEDNAME"="INPUT"."SN_AUTOCREATEDNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_CUSTOMEXCHANGERATE"="INPUT"."SN_CUSTOMEXCHANGERATE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CREATEDONBEHALFBY","OWNINGTEAM","TRANSACTIONCURRENCYIDNAME","STATUSCODE","IMPORTSEQUENCENUMBER","OWNINGBUSINESSUNITNAME","VERSIONNUMBER","SN_OPPORTUNITYSUBPRODUCTSID","MODIFIEDONBEHALFBY","CREATEDBYYOMINAME","OWNINGBUSINESSUNIT","STATUSCODENAME","SN_NAME","STATECODE","SN_AUTOCREATED","OWNERIDYOMINAME","SN_PERCENTAGE","OWNERID","CREATEDBY","MODIFIEDONBEHALFBYYOMINAME","SN_SUBPRODUCTNAME","SN_OPPORTUNITYPRODUCT","UTCCONVERSIONTIMEZONECODE","SN_ANNUALRATEAMOUNT_BASE","CREATEDONBEHALFBYYOMINAME","SN_AMOUNT","CREATEDONBEHALFBYNAME","MODIFIEDON","STATECODENAME","MODIFIEDBYYOMINAME","MODIFIEDBY","SN_OPPORTUNITYPRODUCTNAME","CREATEDBYNAME","OWNERIDNAME","OWNINGUSER","MODIFIEDONBEHALFBYNAME","SN_CURRENCYCODE","SN_AMOUNT_BASE","EXCHANGERATE","SN_SUBPRODUCT","MODIFIEDBYNAME","OWNERIDTYPE","CREATEDON","TIMEZONERULEVERSIONNUMBER","SN_ANNUALEXCHANGERATE","OVERRIDDENCREATEDON","SN_ANNUALRATEAMOUNT","SN_AUTOCREATEDNAME","TRANSACTIONCURRENCYID","SN_CUSTOMEXCHANGERATE","ETL_UPDATE_DATE") VALUES ("INPUT"."CREATEDONBEHALFBY","INPUT"."OWNINGTEAM","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."STATUSCODE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","INPUT"."MODIFIEDONBEHALFBY","INPUT"."CREATEDBYYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."STATUSCODENAME","INPUT"."SN_NAME","INPUT"."STATECODE","INPUT"."SN_AUTOCREATED","INPUT"."OWNERIDYOMINAME","INPUT"."SN_PERCENTAGE","INPUT"."OWNERID","INPUT"."CREATEDBY","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPPORTUNITYPRODUCT","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_ANNUALRATEAMOUNT_BASE","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_AMOUNT","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MODIFIEDON","INPUT"."STATECODENAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."MODIFIEDBY","INPUT"."SN_OPPORTUNITYPRODUCTNAME","INPUT"."CREATEDBYNAME","INPUT"."OWNERIDNAME","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_CURRENCYCODE","INPUT"."SN_AMOUNT_BASE","INPUT"."EXCHANGERATE","INPUT"."SN_SUBPRODUCT","INPUT"."MODIFIEDBYNAME","INPUT"."OWNERIDTYPE","INPUT"."CREATEDON","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_ANNUALEXCHANGERATE","INPUT"."OVERRIDDENCREATEDON","INPUT"."SN_ANNUALRATEAMOUNT","INPUT"."SN_AUTOCREATEDNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_CUSTOMEXCHANGERATE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitysubproductses"},
        {"dynamics365.sn_opportunitysubproductses"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_subproducts_v4():
    """
    ServiceNow Query ID 1936 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitysubproductses TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitysubproductses WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID" WHEN MATCHED THEN UPDATE SET "TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_AUTOCREATED"="INPUT"."SN_AUTOCREATED","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_PERCENTAGE"="INPUT"."SN_PERCENTAGE","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPPORTUNITYPRODUCT"="INPUT"."SN_OPPORTUNITYPRODUCT","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_ANNUALRATEAMOUNT_BASE"="INPUT"."SN_ANNUALRATEAMOUNT_BASE","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_AMOUNT"="INPUT"."SN_AMOUNT","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_OPPORTUNITYPRODUCTNAME"="INPUT"."SN_OPPORTUNITYPRODUCTNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."SN_AMOUNT_BASE"="INPUT"."SN_AMOUNT_BASE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_ANNUALEXCHANGERATE"="INPUT"."SN_ANNUALEXCHANGERATE","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."SN_ANNUALRATEAMOUNT"="INPUT"."SN_ANNUALRATEAMOUNT","TARGET"."SN_AUTOCREATEDNAME"="INPUT"."SN_AUTOCREATEDNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_CUSTOMEXCHANGERATE"="INPUT"."SN_CUSTOMEXCHANGERATE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CREATEDONBEHALFBY","OWNINGTEAM","TRANSACTIONCURRENCYIDNAME","STATUSCODE","IMPORTSEQUENCENUMBER","OWNINGBUSINESSUNITNAME","VERSIONNUMBER","SN_OPPORTUNITYSUBPRODUCTSID","MODIFIEDONBEHALFBY","CREATEDBYYOMINAME","OWNINGBUSINESSUNIT","STATUSCODENAME","SN_NAME","STATECODE","SN_AUTOCREATED","OWNERIDYOMINAME","SN_PERCENTAGE","OWNERID","CREATEDBY","MODIFIEDONBEHALFBYYOMINAME","SN_SUBPRODUCTNAME","SN_OPPORTUNITYPRODUCT","UTCCONVERSIONTIMEZONECODE","SN_ANNUALRATEAMOUNT_BASE","CREATEDONBEHALFBYYOMINAME","SN_AMOUNT","CREATEDONBEHALFBYNAME","MODIFIEDON","STATECODENAME","MODIFIEDBYYOMINAME","MODIFIEDBY","SN_OPPORTUNITYPRODUCTNAME","CREATEDBYNAME","OWNERIDNAME","OWNINGUSER","MODIFIEDONBEHALFBYNAME","SN_CURRENCYCODE","SN_AMOUNT_BASE","EXCHANGERATE","SN_SUBPRODUCT","MODIFIEDBYNAME","OWNERIDTYPE","CREATEDON","TIMEZONERULEVERSIONNUMBER","SN_ANNUALEXCHANGERATE","OVERRIDDENCREATEDON","SN_ANNUALRATEAMOUNT","SN_AUTOCREATEDNAME","TRANSACTIONCURRENCYID","SN_CUSTOMEXCHANGERATE","ETL_UPDATE_DATE") VALUES ("INPUT"."CREATEDONBEHALFBY","INPUT"."OWNINGTEAM","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."STATUSCODE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","INPUT"."MODIFIEDONBEHALFBY","INPUT"."CREATEDBYYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."STATUSCODENAME","INPUT"."SN_NAME","INPUT"."STATECODE","INPUT"."SN_AUTOCREATED","INPUT"."OWNERIDYOMINAME","INPUT"."SN_PERCENTAGE","INPUT"."OWNERID","INPUT"."CREATEDBY","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPPORTUNITYPRODUCT","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_ANNUALRATEAMOUNT_BASE","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_AMOUNT","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MODIFIEDON","INPUT"."STATECODENAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."MODIFIEDBY","INPUT"."SN_OPPORTUNITYPRODUCTNAME","INPUT"."CREATEDBYNAME","INPUT"."OWNERIDNAME","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_CURRENCYCODE","INPUT"."SN_AMOUNT_BASE","INPUT"."EXCHANGERATE","INPUT"."SN_SUBPRODUCT","INPUT"."MODIFIEDBYNAME","INPUT"."OWNERIDTYPE","INPUT"."CREATEDON","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_ANNUALEXCHANGERATE","INPUT"."OVERRIDDENCREATEDON","INPUT"."SN_ANNUALRATEAMOUNT","INPUT"."SN_AUTOCREATEDNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_CUSTOMEXCHANGERATE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitysubproductses"},
        {"dynamics365.sn_opportunitysubproductses"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_domain_table():
    """
    ServiceNow Query ID 1949 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
Merge into domain using domain_6235225 on domain."SYS_ID" = domain_6235225."SYS_ID"  when matched then update set  domain."PSP_PER_UPDATE_DT" =  '2025-01-01 00:00:00', domain."SYS_DOMAIN_CODE" =  domain_6235225."SYS_DOMAIN_CODE", domain."SYS_TAGS" =  domain_6235225."SYS_TAGS", domain."SYS_DOMAIN_PATH" =  domain_6235225."SYS_DOMAIN_PATH", domain."DV_TYPE" =  domain_6235225."DV_TYPE", domain."DESCRIPTION" =  domain_6235225."DESCRIPTION", domain."SYS_ID" =  domain_6235225."SYS_ID", domain."DV_SYS_DOMAIN" =  domain_6235225."DV_SYS_DOMAIN", domain."NAME" =  domain_6235225."NAME", domain."SYS_DOMAIN" =  domain_6235225."SYS_DOMAIN", domain."PSP_PER_INSERT_DT" =  domain."PSP_PER_INSERT_DT", domain."SYS_CREATED_BY" =  domain_6235225."SYS_CREATED_BY", domain."PRIMARY" =  domain_6235225."PRIMARY", domain."SYS_UPDATED_ON" =  domain_6235225."SYS_UPDATED_ON", domain."DV_PARENT" =  domain_6235225."DV_PARENT", domain."SYS_MOD_COUNT" =  domain_6235225."SYS_MOD_COUNT", domain."ACTIVE" =  domain_6235225."ACTIVE", domain."TYPE" =  domain_6235225."TYPE", domain."PSP_PER_DELETE_DT" =  domain_6235225."PSP_PER_DELETE_DT", domain."SYS_UPDATED_BY" =  domain_6235225."SYS_UPDATED_BY", domain."PARENT" =  domain_6235225."PARENT", domain."SYS_CREATED_ON" =  domain_6235225."SYS_CREATED_ON", domain."DEFAULT" =  domain_6235225."DEFAULT" when not matched then insert ( domain."PSP_PER_UPDATE_DT", domain."SYS_DOMAIN_CODE", domain."SYS_TAGS", domain."SYS_DOMAIN_PATH", domain."DV_TYPE", domain."DESCRIPTION", domain."SYS_ID", domain."DV_SYS_DOMAIN", domain."NAME", domain."SYS_DOMAIN", domain."PSP_PER_INSERT_DT", domain."SYS_CREATED_BY", domain."PRIMARY", domain."SYS_UPDATED_ON", domain."DV_PARENT", domain."SYS_MOD_COUNT", domain."ACTIVE", domain."TYPE", domain."PSP_PER_DELETE_DT", domain."SYS_UPDATED_BY", domain."PARENT", domain."SYS_CREATED_ON", domain."DEFAULT") values ( 'placeholder_2', domain_6235225."SYS_DOMAIN_CODE", domain_6235225."SYS_TAGS", domain_6235225."SYS_DOMAIN_PATH", domain_6235225."DV_TYPE", domain_6235225."DESCRIPTION", domain_6235225."SYS_ID", domain_6235225."DV_SYS_DOMAIN", domain_6235225."NAME", domain_6235225."SYS_DOMAIN", 'placeholder_3', domain_6235225."SYS_CREATED_BY", domain_6235225."PRIMARY", domain_6235225."SYS_UPDATED_ON", domain_6235225."DV_PARENT", domain_6235225."SYS_MOD_COUNT", domain_6235225."ACTIVE", domain_6235225."TYPE", domain_6235225."PSP_PER_DELETE_DT", domain_6235225."SYS_UPDATED_BY", domain_6235225."PARENT", domain_6235225."SYS_CREATED_ON", domain_6235225."DEFAULT")
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"<default>.domain_6235225"},
        {"<default>.domain"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_subproducts_v5():
    """
    ServiceNow Query ID 2285 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_opportunitysubproductses TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_opportunitysubproductses WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID" WHEN MATCHED THEN UPDATE SET "TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_OPPORTUNITYSUBPRODUCTSID"="INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."SN_AUTOCREATED"="INPUT"."SN_AUTOCREATED","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_PERCENTAGE"="INPUT"."SN_PERCENTAGE","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPPORTUNITYPRODUCT"="INPUT"."SN_OPPORTUNITYPRODUCT","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_ANNUALRATEAMOUNT_BASE"="INPUT"."SN_ANNUALRATEAMOUNT_BASE","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_AMOUNT"="INPUT"."SN_AMOUNT","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_OPPORTUNITYPRODUCTNAME"="INPUT"."SN_OPPORTUNITYPRODUCTNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."SN_AMOUNT_BASE"="INPUT"."SN_AMOUNT_BASE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_ANNUALEXCHANGERATE"="INPUT"."SN_ANNUALEXCHANGERATE","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."SN_ANNUALRATEAMOUNT"="INPUT"."SN_ANNUALRATEAMOUNT","TARGET"."SN_AUTOCREATEDNAME"="INPUT"."SN_AUTOCREATEDNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_CUSTOMEXCHANGERATE"="INPUT"."SN_CUSTOMEXCHANGERATE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("CREATEDONBEHALFBY","OWNINGTEAM","TRANSACTIONCURRENCYIDNAME","STATUSCODE","IMPORTSEQUENCENUMBER","OWNINGBUSINESSUNITNAME","VERSIONNUMBER","SN_OPPORTUNITYSUBPRODUCTSID","MODIFIEDONBEHALFBY","CREATEDBYYOMINAME","OWNINGBUSINESSUNIT","STATUSCODENAME","SN_NAME","STATECODE","SN_AUTOCREATED","OWNERIDYOMINAME","SN_PERCENTAGE","OWNERID","CREATEDBY","MODIFIEDONBEHALFBYYOMINAME","SN_SUBPRODUCTNAME","SN_OPPORTUNITYPRODUCT","UTCCONVERSIONTIMEZONECODE","SN_ANNUALRATEAMOUNT_BASE","CREATEDONBEHALFBYYOMINAME","SN_AMOUNT","CREATEDONBEHALFBYNAME","MODIFIEDON","STATECODENAME","MODIFIEDBYYOMINAME","MODIFIEDBY","SN_OPPORTUNITYPRODUCTNAME","CREATEDBYNAME","OWNERIDNAME","OWNINGUSER","MODIFIEDONBEHALFBYNAME","SN_CURRENCYCODE","SN_AMOUNT_BASE","EXCHANGERATE","SN_SUBPRODUCT","MODIFIEDBYNAME","OWNERIDTYPE","CREATEDON","TIMEZONERULEVERSIONNUMBER","SN_ANNUALEXCHANGERATE","OVERRIDDENCREATEDON","SN_ANNUALRATEAMOUNT","SN_AUTOCREATEDNAME","TRANSACTIONCURRENCYID","SN_CUSTOMEXCHANGERATE","ETL_UPDATE_DATE") VALUES ("INPUT"."CREATEDONBEHALFBY","INPUT"."OWNINGTEAM","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."STATUSCODE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_OPPORTUNITYSUBPRODUCTSID","INPUT"."MODIFIEDONBEHALFBY","INPUT"."CREATEDBYYOMINAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."STATUSCODENAME","INPUT"."SN_NAME","INPUT"."STATECODE","INPUT"."SN_AUTOCREATED","INPUT"."OWNERIDYOMINAME","INPUT"."SN_PERCENTAGE","INPUT"."OWNERID","INPUT"."CREATEDBY","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPPORTUNITYPRODUCT","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_ANNUALRATEAMOUNT_BASE","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_AMOUNT","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."MODIFIEDON","INPUT"."STATECODENAME","INPUT"."MODIFIEDBYYOMINAME","INPUT"."MODIFIEDBY","INPUT"."SN_OPPORTUNITYPRODUCTNAME","INPUT"."CREATEDBYNAME","INPUT"."OWNERIDNAME","INPUT"."OWNINGUSER","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."SN_CURRENCYCODE","INPUT"."SN_AMOUNT_BASE","INPUT"."EXCHANGERATE","INPUT"."SN_SUBPRODUCT","INPUT"."MODIFIEDBYNAME","INPUT"."OWNERIDTYPE","INPUT"."CREATEDON","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_ANNUALEXCHANGERATE","INPUT"."OVERRIDDENCREATEDON","INPUT"."SN_ANNUALRATEAMOUNT","INPUT"."SN_AUTOCREATEDNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_CUSTOMEXCHANGERATE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_opportunitysubproductses"},
        {"dynamics365.sn_opportunitysubproductses"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_sales_credits():
    """
    ServiceNow Query ID 3212 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_salescredits TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_salescredits WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."SN_SALESCREDITID"="INPUT"."SN_SALESCREDITID" WHEN MATCHED THEN UPDATE SET "TARGET"."SN_SOURCED"="INPUT"."SN_SOURCED","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."SN_BUSINESSUNIT"="INPUT"."SN_BUSINESSUNIT","TARGET"."SN_AMOUNTUSD"="INPUT"."SN_AMOUNTUSD","TARGET"."SN_TERRITORYID"="INPUT"."SN_TERRITORYID","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."SN_SALESCREDITTYPENAME"="INPUT"."SN_SALESCREDITTYPENAME","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."SN_CREDITEDMEMBERYOMINAME"="INPUT"."SN_CREDITEDMEMBERYOMINAME","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."SN_SOURCE"="INPUT"."SN_SOURCE","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_CREDITEDMEMBER"="INPUT"."SN_CREDITEDMEMBER","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_SOURCENAME"="INPUT"."SN_SOURCENAME","TARGET"."SN_SOURCEDNAME"="INPUT"."SN_SOURCEDNAME","TARGET"."SN_TERRITORYIDNAME"="INPUT"."SN_TERRITORYIDNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."SN_PERCENTAGEALLOCATION"="INPUT"."SN_PERCENTAGEALLOCATION","TARGET"."SN_PRLNUMBER"="INPUT"."SN_PRLNUMBER","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."SN_NNACVCREDIT"="INPUT"."SN_NNACVCREDIT","TARGET"."SN_OPPORTUNITYSPLITNAME"="INPUT"."SN_OPPORTUNITYSPLITNAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."SN_OPPORTUNITYSPLIT"="INPUT"."SN_OPPORTUNITYSPLIT","TARGET"."SN_STARTDATE"="INPUT"."SN_STARTDATE","TARGET"."SN_AMOUNTUSD_BASE"="INPUT"."SN_AMOUNTUSD_BASE","TARGET"."SN_LINEBOOKDATE"="INPUT"."SN_LINEBOOKDATE","TARGET"."SN_OPPORTUNITY"="INPUT"."SN_OPPORTUNITY","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."SN_BUSINESSUNITNAME"="INPUT"."SN_BUSINESSUNITNAME","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."SN_SALESCREDITTYPE"="INPUT"."SN_SALESCREDITTYPE","TARGET"."SN_CREDITEDMEMBERNAME"="INPUT"."SN_CREDITEDMEMBERNAME","TARGET"."SN_PARTNERED"="INPUT"."SN_PARTNERED","TARGET"."SN_CREDITEDORGANIZATIONNAME"="INPUT"."SN_CREDITEDORGANIZATIONNAME","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."SN_PARTNEREDNAME"="INPUT"."SN_PARTNEREDNAME","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."SN_NNACVCREDIT_BASE"="INPUT"."SN_NNACVCREDIT_BASE","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."SN_FORECASTCATEGORYNAME"="INPUT"."SN_FORECASTCATEGORYNAME","TARGET"."SN_FORECASTCATEGORY"="INPUT"."SN_FORECASTCATEGORY","TARGET"."SN_SALESCREDITID"="INPUT"."SN_SALESCREDITID","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."SN_OPPORTUNITYNAME"="INPUT"."SN_OPPORTUNITYNAME","TARGET"."SN_CREDITEDORGANIZATION"="INPUT"."SN_CREDITEDORGANIZATION","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("SN_SOURCED","TIMEZONERULEVERSIONNUMBER","SN_BUSINESSUNIT","SN_AMOUNTUSD","SN_TERRITORYID","OWNINGTEAM","SN_SALESCREDITTYPENAME","CREATEDON","SN_CREDITEDMEMBERYOMINAME","SN_NAME","OWNINGUSER","SN_SOURCE","UTCCONVERSIONTIMEZONECODE","SN_CREDITEDMEMBER","MODIFIEDONBEHALFBYYOMINAME","SN_SOURCENAME","SN_SOURCEDNAME","SN_TERRITORYIDNAME","STATUSCODE","CREATEDBYYOMINAME","SN_PERCENTAGEALLOCATION","SN_PRLNUMBER","MODIFIEDONBEHALFBY","MODIFIEDBYYOMINAME","OWNERIDYOMINAME","OWNERID","STATUSCODENAME","VERSIONNUMBER","CREATEDBY","OVERRIDDENCREATEDON","MODIFIEDBYNAME","EXCHANGERATE","IMPORTSEQUENCENUMBER","OWNERIDNAME","SN_NNACVCREDIT","SN_OPPORTUNITYSPLITNAME","OWNERIDTYPE","SN_OPPORTUNITYSPLIT","SN_STARTDATE","SN_AMOUNTUSD_BASE","SN_LINEBOOKDATE","SN_OPPORTUNITY","MODIFIEDON","CREATEDONBEHALFBY","SN_BUSINESSUNITNAME","TRANSACTIONCURRENCYID","CREATEDBYNAME","STATECODE","MODIFIEDONBEHALFBYNAME","CREATEDONBEHALFBYNAME","SN_SALESCREDITTYPE","SN_CREDITEDMEMBERNAME","SN_PARTNERED","SN_CREDITEDORGANIZATIONNAME","MODIFIEDBY","SN_PARTNEREDNAME","TRANSACTIONCURRENCYIDNAME","SN_NNACVCREDIT_BASE","OWNINGBUSINESSUNIT","SN_FORECASTCATEGORYNAME","SN_FORECASTCATEGORY","SN_SALESCREDITID","CREATEDONBEHALFBYYOMINAME","SN_OPPORTUNITYNAME","SN_CREDITEDORGANIZATION","STATECODENAME","ETL_UPDATE_DATE") VALUES ("INPUT"."SN_SOURCED","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."SN_BUSINESSUNIT","INPUT"."SN_AMOUNTUSD","INPUT"."SN_TERRITORYID","INPUT"."OWNINGTEAM","INPUT"."SN_SALESCREDITTYPENAME","INPUT"."CREATEDON","INPUT"."SN_CREDITEDMEMBERYOMINAME","INPUT"."SN_NAME","INPUT"."OWNINGUSER","INPUT"."SN_SOURCE","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_CREDITEDMEMBER","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_SOURCENAME","INPUT"."SN_SOURCEDNAME","INPUT"."SN_TERRITORYIDNAME","INPUT"."STATUSCODE","INPUT"."CREATEDBYYOMINAME","INPUT"."SN_PERCENTAGEALLOCATION","INPUT"."SN_PRLNUMBER","INPUT"."MODIFIEDONBEHALFBY","INPUT"."MODIFIEDBYYOMINAME","INPUT"."OWNERIDYOMINAME","INPUT"."OWNERID","INPUT"."STATUSCODENAME","INPUT"."VERSIONNUMBER","INPUT"."CREATEDBY","INPUT"."OVERRIDDENCREATEDON","INPUT"."MODIFIEDBYNAME","INPUT"."EXCHANGERATE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNERIDNAME","INPUT"."SN_NNACVCREDIT","INPUT"."SN_OPPORTUNITYSPLITNAME","INPUT"."OWNERIDTYPE","INPUT"."SN_OPPORTUNITYSPLIT","INPUT"."SN_STARTDATE","INPUT"."SN_AMOUNTUSD_BASE","INPUT"."SN_LINEBOOKDATE","INPUT"."SN_OPPORTUNITY","INPUT"."MODIFIEDON","INPUT"."CREATEDONBEHALFBY","INPUT"."SN_BUSINESSUNITNAME","INPUT"."TRANSACTIONCURRENCYID","INPUT"."CREATEDBYNAME","INPUT"."STATECODE","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."SN_SALESCREDITTYPE","INPUT"."SN_CREDITEDMEMBERNAME","INPUT"."SN_PARTNERED","INPUT"."SN_CREDITEDORGANIZATIONNAME","INPUT"."MODIFIEDBY","INPUT"."SN_PARTNEREDNAME","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."SN_NNACVCREDIT_BASE","INPUT"."OWNINGBUSINESSUNIT","INPUT"."SN_FORECASTCATEGORYNAME","INPUT"."SN_FORECASTCATEGORY","INPUT"."SN_SALESCREDITID","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."SN_OPPORTUNITYNAME","INPUT"."SN_CREDITEDORGANIZATION","INPUT"."STATECODENAME",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_salescredits"},
        {"dynamics365.sn_salescredits"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_opportunity_products():
    """
    ServiceNow Query ID 3557 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.opportunityproducts TARGET USING ( SELECT * FROM DYNAMICS365.stg_opportunityproducts WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON "TARGET"."OPPORTUNITYPRODUCTID"="INPUT"."OPPORTUNITYPRODUCTID" WHEN MATCHED THEN UPDATE SET "TARGET"."SN_VALUEAMOUNT_BASE"="INPUT"."SN_VALUEAMOUNT_BASE","TARGET"."PROPERTYCONFIGURATIONSTATUS"="INPUT"."PROPERTYCONFIGURATIONSTATUS","TARGET"."PRODUCTID"="INPUT"."PRODUCTID","TARGET"."PRICINGERRORCODE"="INPUT"."PRICINGERRORCODE","TARGET"."SN_NETNEWANNUALCONTRACTVALUE_BASE"="INPUT"."SN_NETNEWANNUALCONTRACTVALUE_BASE","TARGET"."ENTITYIMAGEID"="INPUT"."ENTITYIMAGEID","TARGET"."BASEAMOUNT_BASE"="INPUT"."BASEAMOUNT_BASE","TARGET"."MANUALDISCOUNTAMOUNT"="INPUT"."MANUALDISCOUNTAMOUNT","TARGET"."SN_STARTDATEOPPORTUNITYPRODUCT"="INPUT"."SN_STARTDATEOPPORTUNITYPRODUCT","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."OPPORTUNITYSTATECODENAME"="INPUT"."OPPORTUNITYSTATECODENAME","TARGET"."ISPRODUCTOVERRIDDEN"="INPUT"."ISPRODUCTOVERRIDDEN","TARGET"."PRODUCTDESCRIPTION"="INPUT"."PRODUCTDESCRIPTION","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."ENTITYIMAGE_TIMESTAMP"="INPUT"."ENTITYIMAGE_TIMESTAMP","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."VOLUMEDISCOUNTAMOUNT_BASE"="INPUT"."VOLUMEDISCOUNTAMOUNT_BASE","TARGET"."PRODUCTNAME"="INPUT"."PRODUCTNAME","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."PRICEPERUNIT"="INPUT"."PRICEPERUNIT","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."SN_OPPORTUNITYLINEDEFAULTMETRICNAME"="INPUT"."SN_OPPORTUNITYLINEDEFAULTMETRICNAME","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."PARENTBUNDLEIDREF"="INPUT"."PARENTBUNDLEIDREF","TARGET"."SN_VALUEAMOUNT"="INPUT"."SN_VALUEAMOUNT","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."PARENTBUNDLEID"="INPUT"."PARENTBUNDLEID","TARGET"."PRICINGERRORCODENAME"="INPUT"."PRICINGERRORCODENAME","TARGET"."SEQUENCENUMBER"="INPUT"."SEQUENCENUMBER","TARGET"."DESCRIPTION"="INPUT"."DESCRIPTION","TARGET"."SKIPPRICECALCULATIONNAME"="INPUT"."SKIPPRICECALCULATIONNAME","TARGET"."OPPORTUNITYID"="INPUT"."OPPORTUNITYID","TARGET"."ENTITYIMAGE"="INPUT"."ENTITYIMAGE","TARGET"."UOMIDNAME"="INPUT"."UOMIDNAME","TARGET"."SN_DEFAULTMETRICOPPORTUNITYLINE"="INPUT"."SN_DEFAULTMETRICOPPORTUNITYLINE","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."PRICEPERUNIT_BASE"="INPUT"."PRICEPERUNIT_BASE","TARGET"."PRODUCTTYPECODE"="INPUT"."PRODUCTTYPECODE","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."UOMID"="INPUT"."UOMID","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."OPPORTUNITYIDNAME"="INPUT"."OPPORTUNITYIDNAME","TARGET"."QUANTITY"="INPUT"."QUANTITY","TARGET"."SN_DEFAULTMETRICOPPORTUNITYLINENAME"="INPUT"."SN_DEFAULTMETRICOPPORTUNITYLINENAME","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_RENEWALACV_BASE"="INPUT"."SN_RENEWALACV_BASE","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQUENCENUMBER","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."SKIPPRICECALCULATION"="INPUT"."SKIPPRICECALCULATION","TARGET"."MANUALDISCOUNTAMOUNT_BASE"="INPUT"."MANUALDISCOUNTAMOUNT_BASE","TARGET"."PRODUCTTYPECODENAME"="INPUT"."PRODUCTTYPECODENAME","TARGET"."ISPRODUCTOVERRIDDENNAME"="INPUT"."ISPRODUCTOVERRIDDENNAME","TARGET"."ISPRICEOVERRIDDEN"="INPUT"."ISPRICEOVERRIDDEN","TARGET"."PRODUCTIDNAME"="INPUT"."PRODUCTIDNAME","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."TAX_BASE"="INPUT"."TAX_BASE","TARGET"."OPPORTUNITYPRODUCTNAME"="INPUT"."OPPORTUNITYPRODUCTNAME","TARGET"."SN_NETNEWANNUALCONTRACTVALUE"="INPUT"."SN_NETNEWANNUALCONTRACTVALUE","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."OPPORTUNITYPRODUCTID"="INPUT"."OPPORTUNITYPRODUCTID","TARGET"."ENTITYIMAGE_URL"="INPUT"."ENTITYIMAGE_URL","TARGET"."SN_CURRENCYCODE"="INPUT"."SN_CURRENCYCODE","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."SN_SURF_SYSID"="INPUT"."SN_SURF_SYSID","TARGET"."VOLUMEDISCOUNTAMOUNT"="INPUT"."VOLUMEDISCOUNTAMOUNT","TARGET"."SN_RENEWALACV"="INPUT"."SN_RENEWALACV","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."ISPRICEOVERRIDDENNAME"="INPUT"."ISPRICEOVERRIDDENNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."LINEITEMNUMBER"="INPUT"."LINEITEMNUMBER","TARGET"."EXTENDEDAMOUNT_BASE"="INPUT"."EXTENDEDAMOUNT_BASE","TARGET"."SN_OPPORTUNITYLINEDEFAULTMETRIC"="INPUT"."SN_OPPORTUNITYLINEDEFAULTMETRIC","TARGET"."OPPORTUNITYSTATECODE"="INPUT"."OPPORTUNITYSTATECODE","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."EXTENDEDAMOUNT"="INPUT"."EXTENDEDAMOUNT","TARGET"."TAX"="INPUT"."TAX","TARGET"."BASEAMOUNT"="INPUT"."BASEAMOUNT","TARGET"."PROPERTYCONFIGURATIONSTATUSNAME"="INPUT"."PROPERTYCONFIGURATIONSTATUSNAME","TARGET"."PRODUCTASSOCIATIONID"="INPUT"."PRODUCTASSOCIATIONID","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP,"TARGET"."SN_SUBPRODUCT"="INPUT"."SN_SUBPRODUCT","TARGET"."SN_SUBPRODUCTNAME"="INPUT"."SN_SUBPRODUCTNAME","TARGET"."SN_OPTIONPERIOD"="INPUT"."SN_OPTIONPERIOD" WHEN NOT MATCHED THEN INSERT ("SN_VALUEAMOUNT_BASE","PROPERTYCONFIGURATIONSTATUS","PRODUCTID","PRICINGERRORCODE","SN_NETNEWANNUALCONTRACTVALUE_BASE","ENTITYIMAGEID","BASEAMOUNT_BASE","MANUALDISCOUNTAMOUNT","SN_STARTDATEOPPORTUNITYPRODUCT","OWNERIDTYPE","OPPORTUNITYSTATECODENAME","ISPRODUCTOVERRIDDEN","PRODUCTDESCRIPTION","OWNERIDYOMINAME","ENTITYIMAGE_TIMESTAMP","OVERRIDDENCREATEDON","MODIFIEDBYNAME","OWNINGBUSINESSUNIT","MODIFIEDBYYOMINAME","VOLUMEDISCOUNTAMOUNT_BASE","PRODUCTNAME","CREATEDONBEHALFBY","PRICEPERUNIT","CREATEDON","SN_OPPORTUNITYLINEDEFAULTMETRICNAME","MODIFIEDONBEHALFBY","PARENTBUNDLEIDREF","SN_VALUEAMOUNT","OWNINGTEAM","PARENTBUNDLEID","PRICINGERRORCODENAME","SEQUENCENUMBER","DESCRIPTION","SKIPPRICECALCULATIONNAME","OPPORTUNITYID","ENTITYIMAGE","UOMIDNAME","SN_DEFAULTMETRICOPPORTUNITYLINE","TRANSACTIONCURRENCYID","MODIFIEDBY","PRICEPERUNIT_BASE","PRODUCTTYPECODE","TIMEZONERULEVERSIONNUMBER","CREATEDONBEHALFBYNAME","OWNINGUSER","UOMID","CREATEDBYYOMINAME","OPPORTUNITYIDNAME","QUANTITY","SN_DEFAULTMETRICOPPORTUNITYLINENAME","UTCCONVERSIONTIMEZONECODE","SN_RENEWALACV_BASE","IMPORTSEQUENCENUMBER","OWNERIDNAME","MODIFIEDON","SKIPPRICECALCULATION","MANUALDISCOUNTAMOUNT_BASE","PRODUCTTYPECODENAME","ISPRODUCTOVERRIDDENNAME","ISPRICEOVERRIDDEN","PRODUCTIDNAME","MODIFIEDONBEHALFBYNAME","TAX_BASE","OPPORTUNITYPRODUCTNAME","SN_NETNEWANNUALCONTRACTVALUE","VERSIONNUMBER","OPPORTUNITYPRODUCTID","ENTITYIMAGE_URL","SN_CURRENCYCODE","CREATEDBY","OWNERID","SN_SURF_SYSID","VOLUMEDISCOUNTAMOUNT","SN_RENEWALACV","TRANSACTIONCURRENCYIDNAME","ISPRICEOVERRIDDENNAME","CREATEDBYNAME","CREATEDONBEHALFBYYOMINAME","LINEITEMNUMBER","EXTENDEDAMOUNT_BASE","SN_OPPORTUNITYLINEDEFAULTMETRIC","OPPORTUNITYSTATECODE","EXCHANGERATE","MODIFIEDONBEHALFBYYOMINAME","EXTENDEDAMOUNT","TAX","BASEAMOUNT","PROPERTYCONFIGURATIONSTATUSNAME","PRODUCTASSOCIATIONID","ETL_UPDATE_DATE","SN_SUBPRODUCT","SN_SUBPRODUCTNAME","SN_OPTIONPERIOD") VALUES ("INPUT"."SN_VALUEAMOUNT_BASE","INPUT"."PROPERTYCONFIGURATIONSTATUS","INPUT"."PRODUCTID","INPUT"."PRICINGERRORCODE","INPUT"."SN_NETNEWANNUALCONTRACTVALUE_BASE","INPUT"."ENTITYIMAGEID","INPUT"."BASEAMOUNT_BASE","INPUT"."MANUALDISCOUNTAMOUNT","INPUT"."SN_STARTDATEOPPORTUNITYPRODUCT","INPUT"."OWNERIDTYPE","INPUT"."OPPORTUNITYSTATECODENAME","INPUT"."ISPRODUCTOVERRIDDEN","INPUT"."PRODUCTDESCRIPTION","INPUT"."OWNERIDYOMINAME","INPUT"."ENTITYIMAGE_TIMESTAMP","INPUT"."OVERRIDDENCREATEDON","INPUT"."MODIFIEDBYNAME","INPUT"."OWNINGBUSINESSUNIT","INPUT"."MODIFIEDBYYOMINAME","INPUT"."VOLUMEDISCOUNTAMOUNT_BASE","INPUT"."PRODUCTNAME","INPUT"."CREATEDONBEHALFBY","INPUT"."PRICEPERUNIT","INPUT"."CREATEDON","INPUT"."SN_OPPORTUNITYLINEDEFAULTMETRICNAME","INPUT"."MODIFIEDONBEHALFBY","INPUT"."PARENTBUNDLEIDREF","INPUT"."SN_VALUEAMOUNT","INPUT"."OWNINGTEAM","INPUT"."PARENTBUNDLEID","INPUT"."PRICINGERRORCODENAME","INPUT"."SEQUENCENUMBER","INPUT"."DESCRIPTION","INPUT"."SKIPPRICECALCULATIONNAME","INPUT"."OPPORTUNITYID","INPUT"."ENTITYIMAGE","INPUT"."UOMIDNAME","INPUT"."SN_DEFAULTMETRICOPPORTUNITYLINE","INPUT"."TRANSACTIONCURRENCYID","INPUT"."MODIFIEDBY","INPUT"."PRICEPERUNIT_BASE","INPUT"."PRODUCTTYPECODE","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."OWNINGUSER","INPUT"."UOMID","INPUT"."CREATEDBYYOMINAME","INPUT"."OPPORTUNITYIDNAME","INPUT"."QUANTITY","INPUT"."SN_DEFAULTMETRICOPPORTUNITYLINENAME","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_RENEWALACV_BASE","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."OWNERIDNAME","INPUT"."MODIFIEDON","INPUT"."SKIPPRICECALCULATION","INPUT"."MANUALDISCOUNTAMOUNT_BASE","INPUT"."PRODUCTTYPECODENAME","INPUT"."ISPRODUCTOVERRIDDENNAME","INPUT"."ISPRICEOVERRIDDEN","INPUT"."PRODUCTIDNAME","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."TAX_BASE","INPUT"."OPPORTUNITYPRODUCTNAME","INPUT"."SN_NETNEWANNUALCONTRACTVALUE","INPUT"."VERSIONNUMBER","INPUT"."OPPORTUNITYPRODUCTID","INPUT"."ENTITYIMAGE_URL","INPUT"."SN_CURRENCYCODE","INPUT"."CREATEDBY","INPUT"."OWNERID","INPUT"."SN_SURF_SYSID","INPUT"."VOLUMEDISCOUNTAMOUNT","INPUT"."SN_RENEWALACV","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."ISPRICEOVERRIDDENNAME","INPUT"."CREATEDBYNAME","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."LINEITEMNUMBER","INPUT"."EXTENDEDAMOUNT_BASE","INPUT"."SN_OPPORTUNITYLINEDEFAULTMETRIC","INPUT"."OPPORTUNITYSTATECODE","INPUT"."EXCHANGERATE","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."EXTENDEDAMOUNT","INPUT"."TAX","INPUT"."BASEAMOUNT","INPUT"."PROPERTYCONFIGURATIONSTATUSNAME","INPUT"."PRODUCTASSOCIATIONID",CURRENT_TIMESTAMP,"INPUT"."SN_SUBPRODUCT","INPUT"."SN_SUBPRODUCTNAME","INPUT"."SN_OPTIONPERIOD")
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_opportunityproducts"},
        {"dynamics365.opportunityproducts"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )


def test_merge_dynamics365_deal_registrations():
    """
    ServiceNow Query ID 3708 - Complex Merge

    Reference parser: sqlglot
    Suspected incorrect: sqlparse
    """
    sql = """\
MERGE INTO DYNAMICS365.sn_dealregistrations TARGET USING ( SELECT * FROM DYNAMICS365.stg_sn_dealregistrations WHERE ETL_REFRESH_SCHEDULE = 'placeholder_1') INPUT ON TARGET.SN_DEALREGISTRATIONID=INPUT.SN_DEALREGISTRATIONID WHEN MATCHED THEN UPDATE SET "TARGET"."OWNINGBUSINESSUNIT"="INPUT"."OWNINGBUSINESSUNIT","TARGET"."OWNINGBUSINESSUNITNAME"="INPUT"."OWNINGBUSINESSUNITNAME","TARGET"."CREATEDBYNAME"="INPUT"."CREATEDBYNAME","TARGET"."CREATEDBYYOMINAME"="INPUT"."CREATEDBYYOMINAME","TARGET"."CREATEDON"="INPUT"."CREATEDON","TARGET"."CREATEDONBEHALFBY"="INPUT"."CREATEDONBEHALFBY","TARGET"."CREATEDONBEHALFBYNAME"="INPUT"."CREATEDONBEHALFBYNAME","TARGET"."CREATEDONBEHALFBYYOMINAME"="INPUT"."CREATEDONBEHALFBYYOMINAME","TARGET"."EXCHANGERATE"="INPUT"."EXCHANGERATE","TARGET"."MODIFIEDBY"="INPUT"."MODIFIEDBY","TARGET"."MODIFIEDBYNAME"="INPUT"."MODIFIEDBYNAME","TARGET"."MODIFIEDON"="INPUT"."MODIFIEDON","TARGET"."MODIFIEDONBEHALFBY"="INPUT"."MODIFIEDONBEHALFBY","TARGET"."OVERRIDDENCREATEDON"="INPUT"."OVERRIDDENCREATEDON","TARGET"."OWNERIDNAME"="INPUT"."OWNERIDNAME","TARGET"."OWNERIDYOMINAME"="INPUT"."OWNERIDYOMINAME","TARGET"."SN_SUBSTATUSNAME"="INPUT"."SN_SUBSTATUSNAME","TARGET"."MODIFIEDONBEHALFBYNAME"="INPUT"."MODIFIEDONBEHALFBYNAME","TARGET"."OWNINGUSER"="INPUT"."OWNINGUSER","TARGET"."SN_ACTIVEWORKFLOW"="INPUT"."SN_ACTIVEWORKFLOW","TARGET"."SN_ADDRESS1"="INPUT"."SN_ADDRESS1","TARGET"."SN_AEAUTOAPPROVED"="INPUT"."SN_AEAUTOAPPROVED","TARGET"."SN_AEAUTOAPPROVEDNAME"="INPUT"."SN_AEAUTOAPPROVEDNAME","TARGET"."SN_ANTICIPATEDTIMETOCLOSE"="INPUT"."SN_ANTICIPATEDTIMETOCLOSE","TARGET"."SN_ANTICIPATEDTIMETOCLOSENAME"="INPUT"."SN_ANTICIPATEDTIMETOCLOSENAME","TARGET"."SN_APPROVALSTATUS"="INPUT"."SN_APPROVALSTATUS","TARGET"."SN_AUTHORITY"="INPUT"."SN_AUTHORITY","TARGET"."SN_AUTHORITYNAME"="INPUT"."SN_AUTHORITYNAME","TARGET"."SN_AUTHORIZEDTOSELLNAME"="INPUT"."SN_AUTHORIZEDTOSELLNAME","TARGET"."SN_CAMPAIGNTYPENAME"="INPUT"."SN_CAMPAIGNTYPENAME","TARGET"."SN_CONTACTIDYOMINAME"="INPUT"."SN_CONTACTIDYOMINAME","TARGET"."SN_CONVERTTOINFLUENCEREQUESTEDBYYOMINAME"="INPUT"."SN_CONVERTTOINFLUENCEREQUESTEDBYYOMINAME","TARGET"."OWNERIDTYPE"="INPUT"."OWNERIDTYPE","TARGET"."SN_AEMGRAUTOAPPROVEDNAME"="INPUT"."SN_AEMGRAUTOAPPROVEDNAME","TARGET"."SN_ENGAGEDWITHSERVICENOWNAME"="INPUT"."SN_ENGAGEDWITHSERVICENOWNAME","TARGET"."SN_EXTENSIONREQUESTEDNAME"="INPUT"."SN_EXTENSIONREQUESTEDNAME","TARGET"."SN_FEDERALNAME"="INPUT"."SN_FEDERALNAME","TARGET"."SN_JOINTPLANNINGEFFORT"="INPUT"."SN_JOINTPLANNINGEFFORT","TARGET"."SN_LOCALCURRENCY"="INPUT"."SN_LOCALCURRENCY","TARGET"."SN_NUMBEROFSEATS"="INPUT"."SN_NUMBEROFSEATS","TARGET"."SN_REJECTIONCODENAME"="INPUT"."SN_REJECTIONCODENAME","TARGET"."MODIFIEDONBEHALFBYYOMINAME"="INPUT"."MODIFIEDONBEHALFBYYOMINAME","TARGET"."SN_ANNUALREVENUE"="INPUT"."SN_ANNUALREVENUE","TARGET"."SN_ANTICIPATEDTIMETOCLOSEDATE"="INPUT"."SN_ANTICIPATEDTIMETOCLOSEDATE","TARGET"."SN_BUDGETNAME"="INPUT"."SN_BUDGETNAME","TARGET"."SN_CITY"="INPUT"."SN_CITY","TARGET"."IMPORTSEQUENCENUMBER"="INPUT"."IMPORTSEQU
ENCENUMBER","TARGET"."MODIFIEDBYYOMINAME"="INPUT"."MODIFIEDBYYOMINAME","TARGET"."SN_OPPORTUNITYID"="INPUT"."SN_OPPORTUNITYID","TARGET"."SN_DEALTAGS"="INPUT"."SN_DEALTAGS","TARGET"."SN_ANNUALREVENUE_BASE"="INPUT"."SN_ANNUALREVENUE_BASE","TARGET"."SN_BUDGET"="INPUT"."SN_BUDGET","TARGET"."SN_CAMPAIGNTYPE"="INPUT"."SN_CAMPAIGNTYPE","TARGET"."SN_CONTACTIDNAME"="INPUT"."SN_CONTACTIDNAME","TARGET"."SN_CONTACTJOBTITLE"="INPUT"."SN_CONTACTJOBTITLE","TARGET"."SN_CONTACTNAME"="INPUT"."SN_CONTACTNAME","TARGET"."SN_CUSTOMERACCOUNTNAMEFROMPORTAL"="INPUT"."SN_CUSTOMERACCOUNTNAMEFROMPORTAL","TARGET"."SN_CUSTOMERACCOUNTYOMINAME"="INPUT"."SN_CUSTOMERACCOUNTYOMINAME","TARGET"."SN_ENGAGEDWITHSERVICENOW"="INPUT"."SN_ENGAGEDWITHSERVICENOW","TARGET"."SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNONAME"="INPUT"."SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNONAME","TARGET"."SN_RDTAPPROVEDNAME"="INPUT"."SN_RDTAPPROVEDNAME","TARGET"."SN_REGISTRATIONSUBMITTER"="INPUT"."SN_REGISTRATIONSUBMITTER","TARGET"."SN_SECONDARYDEMANDACCELERATOR"="INPUT"."SN_SECONDARYDEMANDACCELERATOR","TARGET"."CREATEDBY"="INPUT"."CREATEDBY","TARGET"."OWNERID"="INPUT"."OWNERID","TARGET"."SN_ADDRESS2"="INPUT"."SN_ADDRESS2","TARGET"."SN_APPROVALDATE"="INPUT"."SN_APPROVALDATE","TARGET"."SN_CHANNELEVENTCAMPAIGN"="INPUT"."SN_CHANNELEVENTCAMPAIGN","TARGET"."SN_CHANNELEVENTCAMPAIGNNAME"="INPUT"."SN_CHANNELEVENTCAMPAIGNNAME","TARGET"."SN_CONTACTFIRSTNAME"="INPUT"."SN_CONTACTFIRSTNAME","TARGET"."SN_CONTACTLASTNAME"="INPUT"."SN_CONTACTLASTNAME","TARGET"."SN_CONTACTPARTNERCHECKNAME"="INPUT"."SN_CONTACTPARTNERCHECKNAME","TARGET"."SN_CONTACTPHONE"="INPUT"."SN_CONTACTPHONE","TARGET"."SN_CONVERTTOINFLUENCENAME"="INPUT"."SN_CONVERTTOINFLUENCENAME","TARGET"."SN_COSELLING"="INPUT"."SN_COSELLING","TARGET"."OWNINGTEAM"="INPUT"."OWNINGTEAM","TARGET"."SN_CONTACTPARTNERCHECK"="INPUT"."SN_CONTACTPARTNERCHECK","TARGET"."SN_CONVERTTOINFLUENCE"="INPUT"."SN_CONVERTTOINFLUENCE","TARGET"."SN_INVOICESANDPAYMENTSDUE"="INPUT"."SN_INVOICESANDPAYMENTSDUE","TARGET"."SN_PARTNERACCOUNTNUMBER"="INPUT"."SN_PARTNERACCOUNTNUMBER","TARGET"."SN_ACTIVEWORKFLOWNAME"="INPUT"."SN_ACTIVEWORKFLOWNAME","TARGET"."SN_AEMGRAUTOAPPROVED"="INPUT"."SN_AEMGRAUTOAPPROVED","TARGET"."SN_COSELLINGNAME"="INPUT"."SN_COSELLINGNAME","TARGET"."SN_COUNTRY"="INPUT"."SN_COUNTRY","TARGET"."SN_CURRENTAPPROVER"="INPUT"."SN_CURRENTAPPROVER","TARGET"."SN_CURRENTAPPROVERNAME"="INPUT"."SN_CURRENTAPPROVERNAME","TARGET"."SN_CURRENTAPPROVERYOMINAME"="INPUT"."SN_CURRENTAPPROVERYOMINAME","TARGET"."SN_CUSTOMERACCOUNT"="INPUT"."SN_CUSTOMERACCOUNT","TARGET"."SN_CUSTOMERACCOUNTNAME"="INPUT"."SN_CUSTOMERACCOUNTNAME","TARGET"."SN_CUSTOMERCOMPLAINTS"="INPUT"."SN_CUSTOMERCOMPLAINTS","TARGET"."SN_CUSTOMEREMPLOYEESIZE"="INPUT"."SN_CUSTOMEREMPLOYEESIZE","TARGET"."SN_CUSTOMEREMPLOYEESIZENAME"="INPUT"."SN_CUSTOMEREMPLOYEESIZENAME","TARGET"."SN_DEALREGISTRATIONID"="INPUT"."SN_DEALREGISTRATIONID","TARGET"."SN_DEALTYPE"="INPUT"."SN_DEALTYPE","TARGET"."SN_DEALTYPENAME"="INPUT"."SN_DEALTYPENAME","TARGET"."SN_DEMANDACCELERATORCHECK"="INPUT"."SN_DEMANDACCELERATORCHECK","TARGET"."SN_DENIEDDATE"="INPUT"."SN_DENIEDDATE","TARGET"."SN_DUPLICATEREASON"="INPUT"."SN_DUPLICATEREASON","TARGET"."SN_EXCEPTIONREQUESTERYOMINAME"="INPUT"."SN_EXCEPTIONREQUESTERYOMINAME","TARGET"."SN_FEDERAL"="INPUT"."SN_FEDERAL","TARGET"."SN_FORMCOMPLETED"="INPUT"."SN_FORMCOMPLETED","TARGET"."SN_FORMCOMPLETEDNAME"="INPUT"."SN_FORMCOMPLETEDNAME","TARGET"."SN_GEO"="INPUT"."SN_GEO","TARGET"."SN_INCUMBENTNAME"="INPUT"."SN_INCUMBENTNAME","TARGET"."SN_INVOICESANDPAYMENTSDUENAME"="INPUT"."SN_INVOICESANDPAYMENTSDUENAME","TARGET"."SN_ISKNOWNRFP"="INPUT"."SN_ISKNOWNRFP","TARGET"."SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNO"="INPUT"."SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNO","TARGET"."SN_JOINTPLANNINGEFFORTNAME"="INPUT"."SN_JOINTPLANNINGEFFORTNAME","TARGET"."SN_MDMXREFID"="INPUT"."SN_MDMXREFID","TARGET"."SN_NUMOFEMPLOYEES"="INPUT"."SN_NUMOFEMPLOYEES","TARGET"."UTCCONVERSIONTIMEZONECODE"="INPUT"."UTCCONVERSIONTIMEZONECODE","TARGET"."SN_PARCLASSIFICATION"="INPUT"."SN_PARCLASSIFICATION","TARGET"."SN_PARTNERACCOUNT"="INPUT"."SN_PARTNERACCOUNT","TARGET"."SN_PARTNERACTIVITY"="INPUT"."SN_PARTNERACTIVITY","TARGET"."SN_PARTNERPRIMARYSALESREP"="INPUT"."SN_PARTNERPRIMARYSALESREP","TARGET"."SN_PARTNERSALESCONTACT"="INPUT"."SN_PARTNERSALESCONTACT","TARGET"."SN_PLANTOBID"="INPUT"."SN_PLANTOBID","TARGET"."SN_PLEASEDESCRIBEOPPORTUNITY"="INPUT"."SN_PLEASEDESCRIBEOPPORTUNITY","TARGET"."SN_POTENTIALACVUSD"="INPUT"."SN_POTENTIALACVUSD","TARGET"."SN_PP_SYSID"="INPUT"."SN_PP_SYSID","TARGET"."SN_PRIMARYCAMPAIGN"="INPUT"."SN_PRIMARYCAMPAIGN","TARGET"."SN_PRIMARYDEMANDACCELERATORNAME"="INPUT"."SN_PRIMARYDEMANDACCELERATORNAME","TARGET"."SN_PRIMARYSALESREP"="INPUT"."SN_PRIMARYSALESREP","TARGET"."SN_PRIMARYSALESREPYOMINAME"="INPUT"."SN_PRIMARYSALESREPYOMINAME","TARGET"."SN_PRODUCTS"="INPUT"."SN_PRODUCTS","TARGET"."SN_WORKFLOWVERSION"="INPUT"."SN_WORKFLOWVERSION","TARGET"."SN_ZIPPOSTALCODE"="INPUT"."SN_ZIPPOSTALCODE","TARGET"."SN_RDTREJECTED"="INPUT"."SN_RDTREJECTED","TARGET"."SN_RDTRRAPPROVED"="INPUT"."SN_RDTRRAPPROVED","TARGET"."SN_REGIONALALLIANCEMANAGERNAME"="INPUT"."SN_REGIONALALLIANCEMANAGERNAME","TARGET"."SN_REGISTRATIONASSOCIATION"="INPUT"."SN_REGISTRATIONASSOCIATION","TARGET"."SN_REGISTRATIONNAME"="INPUT"."SN_REGISTRATIONNAME","TARGET"."SN_REGISTRATIONSTATUSNAME"="INPUT"."SN_REGISTRATIONSTATUSNAME","TARGET"."SN_REGISTRATIONSUBMITTERNAME"="INPUT"."SN_REGISTRATIONSUBMITTERNAME","TARGET"."SN_REGISTRATIONSUBMITTERYOMINAME"="INPUT"."SN_REGISTRATIONSUBMITTERYOMINAME","TARGET"."SN_STATEPROVINCE"="INPUT"."SN_STATEPROVINCE","TARGET"."SN_SUBMARKETINGACTIVITYNUMBER"="INPUT"."SN_SUBMARKETINGACTIVITYNUMBER","TARGET"."SN_TERRITORYTIER"="INPUT"."SN_TERRITORYTIER","TARGET"."SN_TERRITORYTIERNAME"="INPUT"."SN_TERRITORYTIERNAME","TARGET"."SN_WANTTOBEENGAGEDWITHSERVICENOW"="INPUT"."SN_WANTTOBEENGAGEDWITHSERVICENOW","TARGET"."SN_WHATISCUSTOMERINTERESTEDIN"="INPUT"."SN_WHATISCUSTOMERINTERESTEDIN","TARGET"."SN_QUALIFIEDDATE"="INPUT"."SN_QUALIFIEDDATE","TARGET"."SN_QUANTITY"="INPUT"."SN_QUANTITY","TARGET"."STATECODENAME"="INPUT"."STATECODENAME","TARGET"."SN_AUTHORIZEDTOSELL"="INPUT"."SN_AUTHORIZEDTOSELL","TARGET"."SN_CONTACTID"="INPUT"."SN_CONTACTID","TARGET"."SN_CONVERTTOINFLUENCEREQUESTEDBY"="INPUT"."SN_CONVERTTOINFLUENCEREQUESTEDBY","TARGET"."SN_CONVERTTOINFLUENCEREQUESTEDBYNAME"="INPUT"."SN_CONVERTTOINFLUENCEREQUESTEDBYNAME","TARGET"."SN_CUSTOMERCOMPLAINTSNAME"="INPUT"."SN_CUSTOMERCOMPLAINTSNAME","TARGET"."SN_DEMANDACCELERATORCHECKNAME"="INPUT"."SN_DEMANDACCELERATORCHECKNAME","TARGET"."SN_DUPLICATECHECK"="INPUT"."SN_DUPLICATECHECK","TARGET"."SN_DUPLICATECHECKNAME"="INPUT"."SN_DUPLICATECHECKNAME","TARGET"."SN_EXCEPTIONREASON"="INPUT"."SN_EXCEPTIONREASON","TARGET"."SN_EXCEPTIONREQUESTERNAME"="INPUT"."SN_EXCEPTIONREQUESTERNAME","TARGET"."SN_EXTENSIONREQUESTED"="INPUT"."SN_EXTENSIONREQUESTED","TARGET"."SN_NAME"="INPUT"."SN_NAME","TARGET"."SN_POTENTIALANNUALCONTRACTVALUE"="INPUT"."SN_POTENTIALANNUALCONTRACTVALUE","TARGET"."SN_REGIONALALLIANCEMANAGERYOMINAME"="INPUT"."SN_REGIONALALLIANCEMANAGERYOMINAME","TARGET"."SN_STRATEGICRAMNAME"="INPUT"."SN_STRATEGICRAMNAME","TARGET"."SN_SUBMITTEDBY"="INPUT"."SN_SUBMITTEDBY","TARGET"."SN_SUBSTATUS"="INPUT"."SN_SUBSTATUS","TARGET"."SN_DUPLICATEREASONNAME"="INPUT"."SN_DUPLICATEREASONNAME","TARGET"."SN_EXPIRATIONDATE"="INPUT"."SN_EXPIRATIONDATE","TARGET"."SN_EXTENSIONAPPROVALDATE"="INPUT"."SN_EXTENSIONAPPROVALDATE","TARGET"."SN_EXTENSIONCOUNT"="INPUT"."SN_EXTENSIONCOUNT","TARGET"."SN_GEONAME"="INPUT"."SN_GEONAME","TARGET"."SN_INCUMBENT"="INPUT"."SN_INCUMBENT","TARGET"."SN_ISKNOWNRFPNAME"="INPUT"."SN_ISKNOWNRFPNAME","TARGET"."SN_ISTHISARESULTOFDEMANDACCELERATOR"="INPUT"."SN_ISTHISARESULTOFDEMANDACCELERATOR","TARGET"."SN_ISTHISARESULTOFDEMANDACCELERATORNAME"="INPUT"."SN_ISTHISARESULTOFDEMANDACCELERATORNAME","TARGET"."SN_LOCALCURRENCYNAME"="INPUT"."SN_LOCALCURRENCYNAME","TARGET"."SN_MDMID"="INPUT"."SN_MDMID","TARGET"."SN_PARTNERACCOUNTNAME"="INPUT"."SN_PARTNERACCOUNTNAME","TARGET"."SN_OPPORTUNITYTYPE"="INPUT"."SN_OPPORTUNITYTYPE","TARGET"."SN_OPPORTUNITYTYPENAME"="INPUT"."SN_OPPORTUNITYTYPENAME","TARGET"."SN_ORIGINALOPPORTUNITY"="INPUT"."SN_ORIGINALOPPORTUNITY","TARGET"."SN_ORIGINALOPPORTUNITYNAME"="INPUT"."SN_ORIGINALOPPORTUNITYNAME","TARGET"."SN_OTHERPRODUCT"="INPUT"."SN_OTHERPRODUCT","TARGET"."SN_PARTNERCONTACTNAME"="INPUT"."SN_PARTNERCONTACTNAME","TARGET"."SN_PARTNERPRIMARYSALESREPYOMINAME"="INPUT"."SN_PARTNERPRIMARYSALESREPYOMINAME","TARGET"."SN_PARTNERPROVIDEDSNOPPORTUNITYID"="INPUT"."SN_PARTNERPROVIDEDSNOPPORTUNITYID","TARGET"."SN_PARTNERSALESCONTACTNAME"="INPUT"."SN_PARTNERSALESCONTACTNAME","TARGET"."SN_PLANTOBIDNAME"="INPUT"."SN_PLANTOBIDNAME","TARGET"."SN_PREAPPROVEDOPPORTUNITYFORECAST_STAGE"="INPUT"."SN_PREAPPROVEDOPPORTUNITYFORECAST_STAGE","TARGET"."SN_PRIMARYBU"="INPUT"."SN_PRIMARYBU","TARGET"."SN_PRIMARYDEMANDACCELERATOR"="INPUT"."SN_PRIMARYDEMANDACCELERATOR","TARGET"."SN_PRLNUMBERIDNAME"="INPUT"."SN_PRLNUMBERIDNAME","TARGET"."SN_SELECTEDPROSPECTACCOUNTISNAME"="INPUT"."SN_SELECTEDPROSPECTACCOUNTISNAME","TARGET"."SN_SELECTPUBLICSECTORTYPE"="INPUT"."SN_SELECTPUBLICSECTORTYPE","TARGET"."SN_RAMAUTOAPPROVED"="INPUT"."SN_RAMAUTOAPPROVED","TARGET"."SN_RDTAERAMVERIFICATION"="INPUT"."SN_RDTAERAMVERIFICATION","TARGET"."SN_RDTAERAMVERIFICATIONNAME"="INPUT"."SN_RDTAERAMVERIFICATIONNAME","TARGET"."SN_RDTAPPROVED"="INPUT"."SN_RDTAPPROVED","TARGET"."SN_RDTCHECKLISTDATE"="INPUT"."SN_RDTCHECKLISTDATE","TARGET"."SN_RDTOWNERYOMINAME"="INPUT"."SN_RDTOWNERYOMINAME","TARGET"."SN_RDTRRAPPROVEDNAME"="INPUT"."SN_RDTRRAPPROVEDNAME","TARGET"."SN_REGION"="INPUT"."SN_REGION","TARGET"."SN_REGISTRATIONASSOCIATIONNAME"="INPUT"."SN_REGISTRATIONASSOCIATIONNAME","TARGET"."SN_REGISTRATIONCLOSEDDATE"="INPUT"."SN_REGISTRATIONCLOSEDDATE","TARGET"."SN_REGISTRATIONSTATUS"="INPUT"."SN_REGISTRATIONSTATUS","TARGET"."SN_REGISTRATIONTYPENAME"="INPUT"."SN_REGISTRATIONTYPENAME","TARGET"."SN_REJECTIONCOMMENTS"="INPUT"."SN_REJECTIONCOMMENTS","TARGET"."SN_REQUESTINFOCOUNTER"="INPUT"."SN_REQUESTINFOCOUNTER","TARGET"."SN_WHATISCUSTOMERINTERESTEDINNAME"="INPUT"."SN_WHATISCUSTOMERINTERESTEDINNAME","TARGET"."SN_RAMAUTOAPPROVEDNAME"="INPUT"."SN_RAMAUTOAPPROVEDNAME","TARGET"."SN_SELECTPUBLICSECTORTYPENAME"="INPUT"."SN_SELECTPUBLICSECTORTYPENAME","TARGET"."SN_SERVICENOWCONTACTNAME"="INPUT"."SN_SERVICENOWCONTACTNAME","TARGET"."SN_SOURCED"="INPUT"."SN_SOURCED","TARGET"."SN_STRATEGICRAM"="INPUT"."SN_STRATEGICRAM","TARGET"."SN_STRATEGICRAMYOMINAME"="INPUT"."SN_STRATEGICRAMYOMINAME","TARGET"."SN_SURF_SYSID"="INPUT"."SN_SURF_SYSID","TARGET"."SN_SURFCONTACTNUMBER"="INPUT"."SN_SURFCONTACTNUMBER","TARGET"."SN_VLELEACCOUNT"="INPUT"."SN_VLELEACCOUNT","TARGET"."SN_VLELEACCOUNTNAME"="INPUT"."SN_VLELEACCOUNTNAME","TARGET"."STATUSCODE"="INPUT"."STATUSCODE","TARGET"."STATUSCODENAME"="INPUT"."STATUSCODENAME","TARGET"."TIMEZONERULEVERSIONNUMBER"="INPUT"."TIMEZONERULEVERSIONNUMBER","TARGET"."TRANSACTIONCURRENCYID"="INPUT"."TRANSACTIONCURRENCYID","TARGET"."SN_SELECTEDPROSPECTACCOUNTIS"="INPUT"."SN_SELECTEDPROSPECTACCOUNTIS","TARGET"."SN_SUBMISSIONDATE"="INPUT"."SN_SUBMISSIONDATE","TARGET"."SN_EXCEPTIONREASONNAME"="INPUT"."SN_EXCEPTIONREASONNAME","TARGET"."SN_EXCEPTIONREQUESTER"="INPUT"."SN_EXCEPTIONREQUESTER","TARGET"."SN_PARTNERPRIMARYSALESREPNAME"="INPUT"."SN_PARTNERPRIMARYSALESREPNAME","TARGET"."SN_PARTNERSALESCONTACTYOMINAME"="INPUT"."SN_PARTNERSALESCONTACTYOMINAME","TARGET"."SN_PRIMARYCAMPAIGNNAME"="INPUT"."SN_PRIMARYCAMPAIGNNAME","TARGET"."SN_PRIMARYPHONENO"="INPUT"."SN_PRIMARYPHONENO","TARGET"."SN_PRIMARYSALESREPNAME"="INPUT"."SN_PRIMARYSALESREPNAME","TARGET"."SN_PRLNUMBERID"="INPUT"."SN_PRLNUMBERID","TARGET"."SN_RDTOWNER"="INPUT"."SN_RDTOWNER","TARGET"."SN_RDTOWNERNAME"="INPUT"."SN_RDTOWNERNAME","TARGET"."SN_RDTREJECTEDNAME"="INPUT"."SN_RDTREJECTEDNAME","TARGET"."SN_REGIONALALLIANCEMANAGER"="INPUT"."SN_REGIONALALLIANCEMANAGER","TARGET"."SN_REGISTRATIONTYPE"="INPUT"."SN_REGISTRATIONTYPE","TARGET"."SN_REJECTIONCODE"="INPUT"."SN_REJECTIONCODE","TARGET"."SN_OPPORTUNITYIDNAME"="INPUT"."SN_OPPORTUNITYIDNAME","TARGET"."SN_CONTACTEMAIL"="INPUT"."SN_CONTACTEMAIL","TARGET"."SN_VERIFIEDPARTNERWASCONTACTED"="INPUT"."SN_VERIFIEDPARTNERWASCONTACTED","TARGET"."SN_VERIFIEDPARTNERWASCONTACTEDNAME"="INPUT"."SN_VERIFIEDPARTNERWASCONTACTEDNAME","TARGET"."SN_WORKFLOWVERSIONNAME"="INPUT"."SN_WORKFLOWVERSIONNAME","TARGET"."SN_PARCLASSIFICATIONNAME"="INPUT"."SN_PARCLASSIFICATIONNAME","TARGET"."SN_PRIMARYBUNAME"="INPUT"."SN_PRIMARYBUNAME","TARGET"."SN_SOURCEDNAME"="INPUT"."SN_SOURCEDNAME","TARGET"."SN_WANTTOBEENGAGEDWITHSERVICENOWNAME"="INPUT"."SN_WANTTOBEENGAGEDWITHSERVICENOWNAME","TARGET"."STATECODE"="INPUT"."STATECODE","TARGET"."TRANSACTIONCURRENCYIDNAME"="INPUT"."TRANSACTIONCURRENCYIDNAME","TARGET"."VERSIONNUMBER"="INPUT"."VERSIONNUMBER","TARGET"."SN_SECONDARYCAMPAIGN"="INPUT"."SN_SECONDARYCAMPAIGN","TARGET"."SN_SECONDARYCAMPAIGNNAME"="INPUT"."SN_SECONDARYCAMPAIGNNAME","TARGET"."SN_WEBSITE"="INPUT"."SN_WEBSITE","TARGET"."ETL_UPDATE_DATE"=CURRENT_TIMESTAMP WHEN NOT MATCHED THEN INSERT ("OWNINGBUSINESSUNIT","OWNINGBUSINESSUNITNAME","CREATEDBYNAME","CREATEDBYYOMINAME","CREATEDON","CREATEDONBEHALFBY","CREATEDONBEHALFBYNAME","CREATEDONBEHALFBYYOMINAME","EXCHANGERATE","MODIFIEDBY","MODIFIEDBYNAME","MODIFIEDON","MODIFIEDONBEHALFBY","OVERRIDDENCREATEDON","OWNERIDNAME","OWNERIDYOMINAME","SN_SUBSTATUSNAME","MODIFIEDONBEHALFBYNAME","OWNINGUSER","SN_ACTIVEWORKFLOW","SN_ADDRESS1","SN_AEAUTOAPPROVED","SN_AEAUTOAPPROVEDNAME","SN_ANTICIPATEDTIMETOCLOSE","SN_ANTICIPATEDTIMETOCLOSENAME","SN_APPROVALSTATUS","SN_AUTHORITY","SN_AUTHORITYNAME","SN_AUTHORIZEDTOSELLNAME","SN_CAMPAIGNTYPENAME","SN_CONTACTIDYOMINAME","SN_CONVERTTOINFLUENCEREQUESTEDBYYOMINAME","OWNERIDTYPE","SN_AEMGRAUTOAPPROVEDNAME","SN_ENGAGEDWITHSERVICENOWNAME","SN_EXTENSIONREQUESTEDNAME","SN_FEDERALNAME","SN_JOINTPLANNINGEFFORT","SN_LOCALCURRENCY","SN_NUMBEROFSEATS","SN_REJECTIONCODENAME","MODIFIEDONBEHALFBYYOMINAME","SN_ANNUALREVENUE","SN_ANTICIPATEDTIMETOCLOSEDATE","SN_BUDGETNAME","SN_CITY","IMPORTSEQUENCENUMBER","MODIFIEDBYYOMINAME","SN_OPPORTUNITYID","SN_DEALTAGS","SN_ANNUALREVENUE_BASE","SN_BUDGET","SN_CAMPAIGNTYPE","SN_CONTACTIDNAME","SN_CONTACTJOBTITLE","SN_CONTACTNAME","SN_CUSTOMERACCOUNTNAMEFROMPORTAL","SN_CUSTOMERACCOUNTYOMINAME","SN_ENGAGEDWITHSERVICENOW","SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNONAME","SN_RDTAPPROVEDNAME","SN_REGISTRATIONSUBMITTER","SN_SECONDARYDEMANDACCELERATOR","CREATEDBY","OWNERID","SN_ADDRESS2","SN_APPROVALDATE","SN_CHANNELEVENTCAMPAIGN","SN_CHANNELEVENTCAMPAIGNNAME","SN_CONTACTFIRSTNAME","SN_CONTACTLASTNAME","SN_CONTACTPARTNERCHECKNAME","SN_CONTACTPHONE","SN_CONVERTTOINFLUENCENAME","SN_COSELLING","OWNINGTEAM","SN_CONTACTPARTNERCHECK","SN_CONVERTTOINFLUENCE","SN_INVOICESANDPAYMENTSDUE","SN_PARTNERACCOUNTNUMBER","SN_ACTIVEWORKFLOWNAME","SN_AEMGRAUTOAPPROVED","SN_COSELLINGNAME","SN_COUNTRY","SN_CURRENTAPPROVER","SN_CURRENTAPPROVERNAME","SN_CURRENTAPPROVERYOMINAME","SN_CUSTOMERACCOUNT","SN_CUSTOMERACCOUNTNAME","SN_CUSTOMERCOMPLAINTS","SN_CUSTOMEREMPLOYEESIZE","SN_CUSTOMEREMPLOYEESIZENAME","SN_DEALREGISTRATIONID","SN_DEALTYPE","SN_DEALTYPENAME","SN_DEMANDACCELERATORCHECK","SN_DENIEDDATE","SN_DUPLICATEREASON","SN_EXCEPTIONREQUESTERYOMINAME","SN_FEDERAL","SN_FORMCOMPLETED","SN_FORMCOMPLETEDNAME","SN_GEO","SN_INCUMBENTNAME","SN_INVOICESANDPAYMENTSDUENAME","SN_ISKNOWNRFP","SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNO","SN_JOINTPLANNINGEFFORTNAME","SN_MDMXREFID","SN_NUMOFEMPLOYEES","UTCCONVERSIONTIMEZONECODE","SN_PARCLASSIFICATION","SN_PARTNERACCOUNT","SN_PARTNERACTIVITY","SN_PARTNERPRIMARYSALESREP","SN_PARTNERSALESCONTACT","SN_PLANTOBID","SN_PLEASEDESCRIBEOPPORTUNITY","SN_POTENTIALACVUSD","SN_PP_SYSID","SN_PRIMARYCAMPAIGN","SN_PRIMARYDEMANDACCELERATORNAME","SN_PRIMARYSALESREP","SN_PRIMARYSALESREPYOMINAME","SN_PRODUCTS","SN_WORKFLOWVERSION","SN_ZIPPOSTALCODE","SN_RDTREJECTED","SN_RDTRRAPPROVED","SN_REGIONALALLIANCEMANAGERNAME","SN_REGISTRATIONASSOCIATION","SN_REGISTRATIONNAME","SN_REGISTRATIONSTATUSNAME","SN_REGISTRATIONSUBMITTERNAME","SN_REGISTRATIONSUBMITTERYOMINAME","SN_STATEPROVINCE","SN_SUBMARKETINGACTIVITYNUMBER","SN_TERRITORYTIER","SN_TERRITORYTIERNAME","SN_WANTTOBEENGAGEDWITHSERVICENOW","SN_WHATISCUSTOMERINTERESTEDIN","SN_QUALIFIEDDATE","SN_QUANTITY","STATECODENAME","SN_AUTHORIZEDTOSELL","SN_CONTACTID","SN_CONVERTTOINFLUENCEREQUESTEDBY","SN_CONVERTTOINFLUENCEREQUESTEDBYNAME","SN_CUSTOMERCOMPLAINTSNAME","SN_DEMANDACCELERATORCHECKNAME","SN_DUPLICATECHECK","SN_DUPLICATECHECKNAME","SN_EXCEPTIONREASON","SN_EXCEPTIONREQUESTERNAME","SN_EXTENSIONREQUESTED","SN_NAME","SN_POTENTIALANNUALCONTRACTVALUE","SN_REGIONALALLIANCEMANAGERYOMINAME","SN_STRATEGICRAMNAME","SN_SUBMITTEDBY","SN_SUBSTATUS","SN_DUPLICATEREASONNAME","SN_EXPIRATIONDATE","SN_EXTENSIONAPPROVALDATE","SN_EXTENSIONCOUNT","SN_GEONAME","SN_INCUMBENT","SN_ISKNOWNRFPNAME","SN_ISTHISARESULTOFDEMANDACCELERATOR","SN_ISTHISARESULTOFDEMANDACCELERATORNAME","SN_LOCALCURRENCYNAME","SN_MDMID","SN_PARTNERACCOUNTNAME","SN_OPPORTUNITYTYPE","SN_OPPORTUNITYTYPENAME","SN_ORIGINALOPPORTUNITY","SN_ORIGINALOPPORTUNITYNAME","SN_OTHERPRODUCT","SN_PARTNERCONTACTNAME","SN_PARTNERPRIMARYSALESREPYOMINAME","SN_PARTNERPROVIDEDSNOPPORTUNITYID","SN_PARTNERSALESCONTACTNAME","SN_PLANTOBIDNAME","SN_PREAPPROVEDOPPORTUNITYFORECAST_STAGE","SN_PRIMARYBU","SN_PRIMARYDEMANDACCELERATOR","SN_PRLNUMBERIDNAME","SN_SELECTEDPROSPECTACCOUNTISNAME","SN_SELECTPUBLICSECTORTYPE","SN_RAMAUTOAPPROVED","SN_RDTAERAMVERIFICATION","SN_RDTAERAMVERIFICATIONNAME","SN_RDTAPPROVED","SN_RDTCHECKLISTDATE","SN_RDTOWNERYOMINAME","SN_RDTRRAPPROVEDNAME","SN_REGION","SN_REGISTRATIONASSOCIATIONNAME","SN_REGISTRATIONCLOSEDDATE","SN_REGISTRATIONSTATUS","SN_REGISTRATIONTYPENAME","SN_REJECTIONCOMMENTS","SN_REQUESTINFOCOUNTER","SN_WHATISCUSTOMERINTERESTEDINNAME","SN_RAMAUTOAPPROVEDNAME","SN_SELECTPUBLICSECTORTYPENAME","SN_SERVICENOWCONTACTNAME","SN_SOURCED","SN_STRATEGICRAM","SN_STRATEGICRAMYOMINAME","SN_SURF_SYSID","SN_SURFCONTACTNUMBER","SN_VLELEACCOUNT","SN_VLELEACCOUNTNAME","STATUSCODE","STATUSCODENAME","TIMEZONERULEVERSIONNUMBER","TRANSACTIONCURRENCYID","SN_SELECTEDPROSPECTACCOUNTIS","SN_SUBMISSIONDATE","SN_EXCEPTIONREASONNAME","SN_EXCEPTIONREQUESTER","SN_PARTNERPRIMARYSALESREPNAME","SN_PARTNERSALESCONTACTYOMINAME","SN_PRIMARYCAMPAIGNNAME","SN_PRIMARYPHONENO","SN_PRIMARYSALESREPNAME","SN_PRLNUMBERID","SN_RDTOWNER","SN_RDTOWNERNAME","SN_RDTREJECTEDNAME","SN_REGIONALALLIANCEMANAGER","SN_REGISTRATIONTYPE","SN_REJECTIONCODE","SN_OPPORTUNITYIDNAME","SN_CONTACTEMAIL","SN_VERIFIEDPARTNERWASCONTACTED","SN_VERIFIEDPARTNERWASCONTACTEDNAME","SN_WORKFLOWVERSIONNAME","SN_PARCLASSIFICATIONNAME","SN_PRIMARYBUNAME","SN_SOURCEDNAME","SN_WANTTOBEENGAGEDWITHSERVICENOWNAME","STATECODE","TRANSACTIONCURRENCYIDNAME","VERSIONNUMBER","SN_SECONDARYCAMPAIGN","SN_SECONDARYCAMPAIGNNAME","SN_WEBSITE","ETL_UPDATE_DATE") VALUES ("INPUT"."OWNINGBUSINESSUNIT","INPUT"."OWNINGBUSINESSUNITNAME","INPUT"."CREATEDBYNAME","INPUT"."CREATEDBYYOMINAME","INPUT"."CREATEDON","INPUT"."CREATEDONBEHALFBY","INPUT"."CREATEDONBEHALFBYNAME","INPUT"."CREATEDONBEHALFBYYOMINAME","INPUT"."EXCHANGERATE","INPUT"."MODIFIEDBY","INPUT"."MODIFIEDBYNAME","INPUT"."MODIFIEDON","INPUT"."MODIFIEDONBEHALFBY","INPUT"."OVERRIDDENCREATEDON","INPUT"."OWNERIDNAME","INPUT"."OWNERIDYOMINAME","INPUT"."SN_SUBSTATUSNAME","INPUT"."MODIFIEDONBEHALFBYNAME","INPUT"."OWNINGUSER","INPUT"."SN_ACTIVEWORKFLOW","INPUT"."SN_ADDRESS1","INPUT"."SN_AEAUTOAPPROVED","INPUT"."SN_AEAUTOAPPROVEDNAME","INPUT"."SN_ANTICIPATEDTIMETOCLOSE","INPUT"."SN_ANTICIPATEDTIMETOCLOSENAME","INPUT"."SN_APPROVALSTATUS","INPUT"."SN_AUTHORITY","INPUT"."SN_AUTHORITYNAME","INPUT"."SN_AUTHORIZEDTOSELLNAME","INPUT"."SN_CAMPAIGNTYPENAME","INPUT"."SN_CONTACTIDYOMINAME","INPUT"."SN_CONVERTTOINFLUENCEREQUESTEDBYYOMINAME","INPUT"."OWNERIDTYPE","INPUT"."SN_AEMGRAUTOAPPROVEDNAME","INPUT"."SN_ENGAGEDWITHSERVICENOWNAME","INPUT"."SN_EXTENSIONREQUESTEDNAME","INPUT"."SN_FEDERALNAME","INPUT"."SN_JOINTPLANNINGEFFORT","INPUT"."SN_LOCALCURRENCY","INPUT"."SN_NUMBEROFSEATS","INPUT"."SN_REJECTIONCODENAME","INPUT"."MODIFIEDONBEHALFBYYOMINAME","INPUT"."SN_ANNUALREVENUE","INPUT"."SN_ANTICIPATEDTIMETOCLOSEDATE","INPUT"."SN_BUDGETNAME","INPUT"."SN_CITY","INPUT"."IMPORTSEQUENCENUMBER","INPUT"."MODIFIEDBYYOMINAME","INPUT"."SN_OPPORTUNITYID","INPUT"."SN_DEALTAGS","INPUT"."SN_ANNUALREVENUE_BASE","INPUT"."SN_BUDGET","INPUT"."SN_CAMPAIGNTYPE","INPUT"."SN_CONTACTIDNAME","INPUT"."SN_CONTACTJOBTITLE","INPUT"."SN_CONTACTNAME","INPUT"."SN_CUSTOMERACCOUNTNAMEFROMPORTAL","INPUT"."SN_CUSTOMERACCOUNTYOMINAME","INPUT"."SN_ENGAGEDWITHSERVICENOW","INPUT"."SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNONAME","INPUT"."SN_RDTAPPROVEDNAME","INPUT"."SN_REGISTRATIONSUBMITTER","INPUT"."SN_SECONDARYDEMANDACCELERATOR","INPUT"."CREATEDBY","INPUT"."OWNERID","INPUT"."SN_ADDRESS2","INPUT"."SN_APPROVALDATE","INPUT"."SN_CHANNELEVENTCAMPAIGN","INPUT"."SN_CHANNELEVENTCAMPAIGNNAME","INPUT"."SN_CONTACTFIRSTNAME","INPUT"."SN_CONTACTLASTNAME","INPUT"."SN_CONTACTPARTNERCHECKNAME","INPUT"."SN_CONTACTPHONE","INPUT"."SN_CONVERTTOINFLUENCENAME","INPUT"."SN_COSELLING","INPUT"."OWNINGTEAM","INPUT"."SN_CONTACTPARTNERCHECK","INPUT"."SN_CONVERTTOINFLUENCE","INPUT"."SN_INVOICESANDPAYMENTSDUE","INPUT"."SN_PARTNERACCOUNTNUMBER","INPUT"."SN_ACTIVEWORKFLOWNAME","INPUT"."SN_AEMGRAUTOAPPROVED","INPUT"."SN_COSELLINGNAME","INPUT"."SN_COUNTRY","INPUT"."SN_CURRENTAPPROVER","INPUT"."SN_CURRENTAPPROVERNAME","INPUT"."SN_CURRENTAPPROVERYOMINAME","INPUT"."SN_CUSTOMERACCOUNT","INPUT"."SN_CUSTOMERACCOUNTNAME","INPUT"."SN_CUSTOMERCOMPLAINTS","INPUT"."SN_CUSTOMEREMPLOYEESIZE","INPUT"."SN_CUSTOMEREMPLOYEESIZENAME","INPUT"."SN_DEALREGISTRATIONID","INPUT"."SN_DEALTYPE","INPUT"."SN_DEALTYPENAME","INPUT"."SN_DEMANDACCELERATORCHECK","INPUT"."SN_DENIEDDATE","INPUT"."SN_DUPLICATEREASON","INPUT"."SN_EXCEPTIONREQUESTERYOMINAME","INPUT"."SN_FEDERAL","INPUT"."SN_FORMCOMPLETED","INPUT"."SN_FORMCOMPLETEDNAME","INPUT"."SN_GEO","INPUT"."SN_INCUMBENTNAME","INPUT"."SN_INVOICESANDPAYMENTSDUENAME","INPUT"."SN_ISKNOWNRFP","INPUT"."SN_ISTHISREGISTRATIONRELATEDTOAPARTNERSNO","INPUT"."SN_JOINTPLANNINGEFFORTNAME","INPUT"."SN_MDMXREFID","INPUT"."SN_NUMOFEMPLOYEES","INPUT"."UTCCONVERSIONTIMEZONECODE","INPUT"."SN_PARCLASSIFICATION","INPUT"."SN_PARTNERACCOUNT","INPUT"."SN_PARTNERACTIVITY","INPUT"."SN_PARTNERPRIMARYSALESREP","INPUT"."SN_PARTNERSALESCONTACT","INPUT"."SN_PLANTOBID","INPUT"."SN_PLEASEDESCRIBEOPPORTUNITY","INPUT"."SN_POTENTIALACVUSD","INPUT"."SN_PP_SYSID","INPUT"."SN_PRIMARYCAMPAIGN","INPUT"."SN_PRIMARYDEMANDACCELERATORNAME","INPUT"."SN_PRIMARYSALESREP","INPUT"."SN_PRIMARYSALESREPYOMINAME","INPUT"."SN_PRODUCTS","INPUT"."SN_WORKFLOWVERSION","INPUT"."SN_ZIPPOSTALCODE","INPUT"."SN_RDTREJECTED","INPUT"."SN_RDTRRAPPROVED","INPUT"."SN_REGIONALALLIANCEMANAGERNAME","INPUT"."SN_REGISTRATIONASSOCIATION","INPUT"."SN_REGISTRATIONNAME","INPUT"."SN_REGISTRATIONSTATUSNAME","INPUT"."SN_REGISTRATIONSUBMITTERNAME","INPUT"."SN_REGISTRATIONSUBMITTERYOMINAME","INPUT"."SN_STATEPROVINCE","INPUT"."SN_SUBMARKETINGACTIVITYNUMBER","INPUT"."SN_TERRITORYTIER","INPUT"."SN_TERRITORYTIERNAME","INPUT"."SN_WANTTOBEENGAGEDWITHSERVICENOW","INPUT"."SN_WHATISCUSTOMERINTERESTEDIN","INPUT"."SN_QUALIFIEDDATE","INPUT"."SN_QUANTITY","INPUT"."STATECODENAME","INPUT"."SN_AUTHORIZEDTOSELL","INPUT"."SN_CONTACTID","INPUT"."SN_CONVERTTOINFLUENCEREQUESTEDBY","INPUT"."SN_CONVERTTOINFLUENCEREQUESTEDBYNAME","INPUT"."SN_CUSTOMERCOMPLAINTSNAME","INPUT"."SN_DEMANDACCELERATORCHECKNAME","INPUT"."SN_DUPLICATECHECK","INPUT"."SN_DUPLICATECHECKNAME","INPUT"."SN_EXCEPTIONREASON","INPUT"."SN_EXCEPTIONREQUESTERNAME","INPUT"."SN_EXTENSIONREQUESTED","INPUT"."SN_NAME","INPUT"."SN_POTENTIALANNUALCONTRACTVALUE","INPUT"."SN_REGIONALALLIANCEMANAGERYOMINAME","INPUT"."SN_STRATEGICRAMNAME","INPUT"."SN_SUBMITTEDBY","INPUT"."SN_SUBSTATUS","INPUT"."SN_DUPLICATEREASONNAME","INPUT"."SN_EXPIRATIONDATE","INPUT"."SN_EXTENSIONAPPROVALDATE","INPUT"."SN_EXTENSIONCOUNT","INPUT"."SN_GEONAME","INPUT"."SN_INCUMBENT","INPUT"."SN_ISKNOWNRFPNAME","INPUT"."SN_ISTHISARESULTOFDEMANDACCELERATOR","INPUT"."SN_ISTHISARESULTOFDEMANDACCELERATORNAME","INPUT"."SN_LOCALCURRENCYNAME","INPUT"."SN_MDMID","INPUT"."SN_PARTNERACCOUNTNAME","INPUT"."SN_OPPORTUNITYTYPE","INPUT"."SN_OPPORTUNITYTYPENAME","INPUT"."SN_ORIGINALOPPORTUNITY","INPUT"."SN_ORIGINALOPPORTUNITYNAME","INPUT"."SN_OTHERPRODUCT","INPUT"."SN_PARTNERCONTACTNAME","INPUT"."SN_PARTNERPRIMARYSALESREPYOMINAME","INPUT"."SN_PARTNERPROVIDEDSNOPPORTUNITYID","INPUT"."SN_PARTNERSALESCONTACTNAME","INPUT"."SN_PLANTOBIDNAME","INPUT"."SN_PREAPPROVEDOPPORTUNITYFORECAST_STAGE","INPUT"."SN_PRIMARYBU","INPUT"."SN_PRIMARYDEMANDACCELERATOR","INPUT"."SN_PRLNUMBERIDNAME","INPUT"."SN_SELECTEDPROSPECTACCOUNTISNAME","INPUT"."SN_SELECTPUBLICSECTORTYPE","INPUT"."SN_RAMAUTOAPPROVED","INPUT"."SN_RDTAERAMVERIFICATION","INPUT"."SN_RDTAERAMVERIFICATIONNAME","INPUT"."SN_RDTAPPROVED","INPUT"."SN_RDTCHECKLISTDATE","INPUT"."SN_RDTOWNERYOMINAME","INPUT"."SN_RDTRRAPPROVEDNAME","INPUT"."SN_REGION","INPUT"."SN_REGISTRATIONASSOCIATIONNAME","INPUT"."SN_REGISTRATIONCLOSEDDATE","INPUT"."SN_REGISTRATIONSTATUS","INPUT"."SN_REGISTRATIONTYPENAME","INPUT"."SN_REJECTIONCOMMENTS","INPUT"."SN_REQUESTINFOCOUNTER","INPUT"."SN_WHATISCUSTOMERINTERESTEDINNAME","INPUT"."SN_RAMAUTOAPPROVEDNAME","INPUT"."SN_SELECTPUBLICSECTORTYPENAME","INPUT"."SN_SERVICENOWCONTACTNAME","INPUT"."SN_SOURCED","INPUT"."SN_STRATEGICRAM","INPUT"."SN_STRATEGICRAMYOMINAME","INPUT"."SN_SURF_SYSID","INPUT"."SN_SURFCONTACTNUMBER","INPUT"."SN_VLELEACCOUNT","INPUT"."SN_VLELEACCOUNTNAME","INPUT"."STATUSCODE","INPUT"."STATUSCODENAME","INPUT"."TIMEZONERULEVERSIONNUMBER","INPUT"."TRANSACTIONCURRENCYID","INPUT"."SN_SELECTEDPROSPECTACCOUNTIS","INPUT"."SN_SUBMISSIONDATE","INPUT"."SN_EXCEPTIONREASONNAME","INPUT"."SN_EXCEPTIONREQUESTER","INPUT"."SN_PARTNERPRIMARYSALESREPNAME","INPUT"."SN_PARTNERSALESCONTACTYOMINAME","INPUT"."SN_PRIMARYCAMPAIGNNAME","INPUT"."SN_PRIMARYPHONENO","INPUT"."SN_PRIMARYSALESREPNAME","INPUT"."SN_PRLNUMBERID","INPUT"."SN_RDTOWNER","INPUT"."SN_RDTOWNERNAME","INPUT"."SN_RDTREJECTEDNAME","INPUT"."SN_REGIONALALLIANCEMANAGER","INPUT"."SN_REGISTRATIONTYPE","INPUT"."SN_REJECTIONCODE","INPUT"."SN_OPPORTUNITYIDNAME","INPUT"."SN_CONTACTEMAIL","INPUT"."SN_VERIFIEDPARTNERWASCONTACTED","INPUT"."SN_VERIFIEDPARTNERWASCONTACTEDNAME","INPUT"."SN_WORKFLOWVERSIONNAME","INPUT"."SN_PARCLASSIFICATIONNAME","INPUT"."SN_PRIMARYBUNAME","INPUT"."SN_SOURCEDNAME","INPUT"."SN_WANTTOBEENGAGEDWITHSERVICENOWNAME","INPUT"."STATECODE","INPUT"."TRANSACTIONCURRENCYIDNAME","INPUT"."VERSIONNUMBER","INPUT"."SN_SECONDARYCAMPAIGN","INPUT"."SN_SECONDARYCAMPAIGNNAME","INPUT"."SN_WEBSITE",CURRENT_TIMESTAMP)
"""

    # Table lineage
    # SqlParse: Cannot extract source tables from complex MERGE statements
    assert_table_lineage_equal(
        sql,
        {"dynamics365.stg_sn_dealregistrations"},
        {"dynamics365.sn_dealregistrations"},
        dialect="snowflake",
        test_sqlparse=False,  # SqlParse fails on this query
    )
