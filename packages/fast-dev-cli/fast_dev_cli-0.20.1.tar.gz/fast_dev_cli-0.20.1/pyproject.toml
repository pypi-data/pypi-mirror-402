[build-system]
requires = [
    "pdm-backend",
]
build-backend = "pdm.backend"

[project]
name = "fast-dev-cli"
dynamic = []
description = "Python project development tool."
authors = [
    { name = "Waket Zheng", email = "waketzheng@gmail.com>" },
]
readme = "README.md"
requires-python = ">=3.10"
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "Intended Audience :: System Administrators",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Topic :: Software Development :: Libraries",
    "Topic :: Software Development",
    "Typing :: Typed",
    "License :: OSI Approved :: MIT License",
]
dependencies = [
    "typer-slim >=0.12.3,<1",
    "tomli >=2.0.1,<3; python_version < '3.11'",
    "emoji >=2.12.1",
    "packaging >=20.5",
    "coverage >=7.5.1",
    "pytest >=8.2.0",
]
version = "0.20.1"

[project.urls]
Homepage = "https://github.com/waketzheng/fast-dev-cli"

[project.optional-dependencies]
include-optional-dependencies = [
    "all",
]

[project.scripts]
fast = "fast_dev_cli:cli.main"

[dependency-groups]
dev = [
    "twine>=6.1.0",
    "asynctor>=0.10.0",
]

[tool.pdm]
distribution = true

[tool.pdm.version]
source = "file"
path = "fast_dev_cli/__init__.py"

[tool.pdm.build]
source-includes = [
    "scripts/",
]

[tool.pdm.dev-dependencies]
dev = [
    "-e file:///${PROJECT_ROOT}/#egg=fast-dev-cli[all]",
]

[tool.pdm.scripts]
up = "pdm update -G :all"
tree = "pdm list --tree {args}"
deps = "pdm run python scripts/deps.py {args}"
prod = "pdm install --prod --frozen {args}"
test = "pdm run fast test {args}"
lint = "pdm run fast lint {args}"
check = "pdm run fast check {args}"
tag = "pdm run fast tag {args}"
bump = "pdm run fast bump patch --commit {args}"

[tool.pdm.scripts.fresh]
composite = [
    "up",
    "deps",
]

[tool.pdm.scripts.ci]
composite = [
    "deps",
    "check",
    "test",
]

[tool.pdm.scripts.start]
composite = [
    "pre-commit install",
    "deps",
]

[tool.pdm.scripts.style]
composite = [
    "ruff format",
    "ruff check --fix --unsafe-fixes {args}",
]

[tool.waketzheng._internal-slim-build.packages.fastdevcli-slim.project]
name = "fastdevcli-slim"

[tool.waketzheng._internal-slim-build.packages.fastdevcli-slim.project.scripts]
fast = "fast_dev_cli:cli.main"

[tool.waketzheng._internal-slim-build.packages.fast-dev-cli]
include-optional-dependencies = [
    "standard",
]

[tool.waketzheng._internal-slim-build.packages.fast-dev-cli.project.optional-dependencies]
include-optional-dependencies = [
    "all",
]

[tool.waketzheng._internal-slim-build.packages.fast-dev-cli.project.scripts]
fast = "fast_dev_cli:cli.main"

[tool.pytest.ini_options]
testpaths = [
    "tests",
]

[tool.coverage.run]
parallel = true
source = [
    "fast_dev_cli",
]
omit = [
    "__pypackages__/*",
    ".venv/*",
    "venv*.bak/*",
]
context = "${CONTEXT}"

[tool.coverage.report]
exclude_also = [
    "pragma: no cover",
    "@overload",
    "if __name__ == \"__main__\":",
    "if TYPE_CHECKING:",
]
omit = [
    "tests/*",
    "fast_dev_cli/__main__.py",
]

[tool.ty.src]
exclude = [
    "*.bak",
]

[tool.ty.rules]
unresolved-import = "ignore"
unused-ignore-comment = "ignore"

[tool.ty.environment]
python-version = "3.10"

[tool.mypy]
pretty = true
python_version = "3.10"
ignore_missing_imports = true
check_untyped_defs = true
warn_unused_ignores = true
exclude = [
    "^fabfile\\.py$",
    "two\\.pyi$",
    "^\\.venv",
    "\\.bak",
    "__pypackages__",
]

[tool.ruff.lint]
extend-select = [
    "E",
    "W",
    "F",
    "I",
    "B",
    "C4",
    "UP",
]

[tool.ruff.lint.per-file-ignores]
"test_*.py" = [
    "E501",
]
"scripts/*.py" = [
    "UP009",
    "UP032",
]
"fast_dev_cli/cli.py" = [
    "UP007",
    "UP045",
]

[tool.bandit]
exclude_dirs = [
    "tests",
    "scripts",
    "examples",
    ".venv",
]
