# Python Language Configuration for SEF Agents
# Used by debt_scanner, ai_pattern_detector, compliance tools

language: python
extensions: [".py", ".pyw", ".pyi"]
parser: ast

# Debt detection patterns
debt_patterns:
  todo_fixme:
    description: "TODO/FIXME comments indicate incomplete work"
    severity: medium
    pattern: "#\\s*(TODO|FIXME|XXX|HACK|BUG)[\\s:]+(.+)"
    suggestion: "Address the TODO or create a tracked issue"

  bare_except:
    description: "Bare except catches all exceptions including system exits"
    severity: critical
    ast_node: ExceptHandler
    condition: "node.type is None"
    suggestion: "Use specific exception types"

  broad_except:
    description: "except Exception is too broad"
    severity: high
    ast_node: ExceptHandler
    condition: "node.type.id == 'Exception'"
    suggestion: "Catch specific exceptions like ValueError, TypeError"

  missing_type_hints:
    description: "Type hints enable static analysis and catch bugs at dev time"
    severity: high
    ast_node: FunctionDef
    condition: "no return type or missing arg types"
    suggestion: "Add type hints: def func(arg: Type) -> ReturnType"

  missing_docstring:
    description: "Public APIs must be documented for maintainability"
    severity: medium
    ast_node: FunctionDef
    condition: "not private and no docstring"
    suggestion: "Add Google/Numpy style docstring with Args/Returns/Raises"

  high_complexity:
    description: "Function has too many branches"
    severity: high
    ast_node: FunctionDef
    condition: "complexity > threshold"
    suggestion: "Refactor into smaller functions"

  long_function:
    description: "Function exceeds line limit"
    severity: medium
    ast_node: FunctionDef
    condition: "lines > threshold"
    suggestion: "Break into smaller focused functions"

  deep_nesting:
    description: "Code is nested too deeply"
    severity: medium
    ast_node: FunctionDef
    condition: "nesting > threshold"
    suggestion: "Use early returns or extract methods"

# Deprecated imports
deprecated_imports:
  distutils: "Use setuptools or build instead"
  imp: "Use importlib instead"
  optparse: "Use argparse instead"
  formatter: "Removed in Python 3.10"
  parser: "Use ast instead"
  symbol: "Use ast instead"
  asynchat: "Use asyncio instead"
  asyncore: "Use asyncio instead"
  smtpd: "Use aiosmtpd instead"
  cgi: "Use modern web frameworks"
  cgitb: "Use proper error handling"

# Naming conventions
naming:
  generic_names:
    - data
    - result
    - temp
    - tmp
    - handler
    - manager
    - helper
    - utils
    - misc
    - stuff
    - thing
    - obj
    - val
    - var
    - foo
    - bar
    - baz
    - item
    - elem
    - info
    - x
    - y
    - z

  conventions:
    functions: snake_case
    classes: PascalCase
    constants: UPPER_SNAKE_CASE
    modules: snake_case
    variables: snake_case

# Quality thresholds (production-grade)
thresholds:
  complexity: 12          # Maintainable, testable code
  function_length: 50     # Single responsibility
  nesting_depth: 3        # Readable, avoid arrow anti-pattern
  file_length: 300        # Encourages module extraction
  comment_ratio: 0.4
  class_ratio: 0.5

# File exclusions
exclusions:
  # Skip entire analysis (autogenerated, vendor, coverage, hidden dirs, data files)
  skip_analysis:
    - "**/node_modules/**"
    - "**/.git/**"
    - "**/__pycache__/**"
    - "**/.venv/**"
    - "**/venv/**"
    - "**/dist/**"
    - "**/build/**"
    - "**/coverage/**"
    - "**/.*/**"  # Hidden directories
    - "**/*.json"  # JSON files excluded from complexity checks
    - "**/vendor/**"
    - "**/vendors/**"
    - "**/third-party/**"
    - "**/third_party/**"

# AI anti-patterns
anti_patterns:
  over_abstraction:
    description: "Too many classes relative to functions"
    threshold: 0.5

  copy_paste:
    description: "Duplicated code blocks"
    min_block_size: 5

  verbose_comments:
    description: "Excessive comments"
    max_ratio: 0.4
