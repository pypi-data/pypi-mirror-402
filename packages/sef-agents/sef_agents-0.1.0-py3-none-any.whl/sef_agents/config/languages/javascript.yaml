# JavaScript Language Configuration for SEF Agents

language: javascript
extensions: [".js", ".jsx", ".mjs", ".cjs"]
parser: regex

# Debt detection patterns
debt_patterns:
  todo_fixme:
    description: "TODO/FIXME comments indicate incomplete work"
    severity: medium
    pattern: "//\\s*(TODO|FIXME|XXX|HACK|BUG)[\\s:]+(.+)"
    suggestion: "Address the TODO or create a tracked issue"

  var_usage:
    description: "Using var instead of let/const"
    severity: medium
    pattern: "\\bvar\\s+\\w+"
    suggestion: "Use const for constants, let for variables"

  console_log:
    description: "console.log leaks to production, use structured logging"
    severity: high
    pattern: "console\\.(log|debug|info|warn|error)\\("
    suggestion: "Use structured logging library (e.g., pino, winston)"

  empty_catch:
    description: "Empty catch blocks swallow errors"
    severity: high
    pattern: "catch\\s*\\([^)]*\\)\\s*\\{\\s*\\}"
    suggestion: "Handle or log the error"

  eval_usage:
    description: "eval() is a security risk"
    severity: critical
    pattern: "\\beval\\s*\\("
    suggestion: "Use safer alternatives like JSON.parse"

  document_write:
    description: "document.write is deprecated"
    severity: high
    pattern: "document\\.write\\("
    suggestion: "Use DOM manipulation methods"

  innerhtml_assignment:
    description: "innerHTML can cause XSS vulnerabilities"
    severity: high
    pattern: "\\.innerHTML\\s*="
    suggestion: "Use textContent or sanitize input"

  sync_xhr:
    description: "Synchronous XHR blocks the main thread"
    severity: high
    pattern: "XMLHttpRequest.*false\\s*\\)"
    suggestion: "Use async requests or fetch API"

  # Code Quality Patterns
  unused_import:
    description: "Unused imports increase bundle size"
    severity: low
    pattern: "^import\\s+.*from|require\\s*\\(['\"].*['\"]\\)"
    suggestion: "Remove unused imports"

  missing_async_await:
    description: "Promise not awaited"
    severity: high
    pattern: "Promise\\s*\\.(then|catch)\\s*\\("
    suggestion: "Use async/await for better error handling"

  direct_mutation:
    description: "Direct state mutation in React/Redux"
    severity: critical
    pattern: "\\.(push|pop|shift|unshift|splice|sort|reverse)\\s*\\(|\\w+\\s*=\\s*\\w+\\["
    suggestion: "Use immutable patterns (spread, map, filter)"

  loose_equality:
    description: "Using == instead of === loses type safety"
    severity: medium
    pattern: "\\s==\\s"
    suggestion: "Use === for strict equality"

  typeof_undefined:
    description: "typeof undefined is unnecessary"
    severity: low
    pattern: "typeof\\s+\\w+\\s*===\\s*['\"]undefined['\"]"
    suggestion: "Use !== undefined or optional chaining"

  with_statement:
    description: "with statement is deprecated and error-prone"
    severity: high
    pattern: "\\bwith\\s*\\("
    suggestion: "Use explicit variable references"

# Deprecated patterns
deprecated_imports:
  "jquery": "Consider using vanilla JS or modern frameworks"
  "underscore": "Use native array methods or lodash-es"
  "moment": "Use date-fns or dayjs"

# Naming conventions
naming:
  generic_names:
    - data
    - result
    - temp
    - handler
    - callback
    - cb
    - fn
    - val
    - obj
    - arr
    - x
    - y
    - z

  conventions:
    functions: camelCase
    classes: PascalCase
    constants: UPPER_SNAKE_CASE
    variables: camelCase

# Quality thresholds
thresholds:
  complexity: 15
  function_length: 80
  nesting_depth: 4
  file_length: 400
  comment_ratio: 0.3
  class_ratio: 0.5

# File exclusions (autogenerated, vendor, coverage, hidden dirs)
exclusions:
  # Skip entire analysis (autogenerated, vendor, coverage, hidden dirs)
  skip_analysis:
    - "**/node_modules/**"
    - "**/.next/**"
    - "**/.nuxt/**"
    - "**/.cache/**"
    - "**/.git/**"
    - "**/coverage/**"
    - "**/dist/**"
    - "**/build/**"
    - "**/.dist/**"
    - "**/.build/**"
    - "**/.*/**"  # Hidden directories (e.g., .vscode, .idea)
    - "**/*.generated.js"
    - "**/*.generated.jsx"
    - "**/*.auto.js"
    - "**/*.auto.jsx"
    - "**/*.json"  # JSON files excluded from complexity checks
    - "**/vendor/**"
    - "**/vendors/**"
    - "**/third-party/**"
    - "**/third_party/**"

  # Skip file-level complexity check only (still analyze per-function)
  file_complexity:
    - "*.test.js"
    - "*.test.jsx"
    - "*.spec.js"
    - "*.spec.jsx"

# AI anti-patterns
anti_patterns:
  callback_hell:
    description: "Deeply nested callbacks"
    max_depth: 3

  copy_paste:
    description: "Duplicated code blocks"
    min_block_size: 5
