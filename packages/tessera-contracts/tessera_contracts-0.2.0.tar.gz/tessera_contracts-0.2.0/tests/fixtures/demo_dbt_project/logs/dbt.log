[0m11:22:05.471310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e67b10>]}


============================== 11:22:05.486393 | 91deab62-25c1-49da-b78f-670e37e81251 ==============================
[0m11:22:05.486393 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:22:05.486656 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir .', 'partial_parse': 'True', 'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '.', 'log_path': '/Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False'}
[0m11:22:05.626489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f4180>]}
[0m11:22:05.644805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63df0>]}
[0m11:22:05.646222 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:22:05.681573 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:22:05.681912 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:22:05.682054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecda50>]}
[0m11:22:06.151592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244a990>]}
[0m11:22:06.183332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/target/manifest.json
[0m11:22:06.184213 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/target/semantic_manifest.json
[0m11:22:06.269432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b7770>]}
[0m11:22:06.269674 [info ] [MainThread]: Found 4 models, 17 data tests, 2 seeds, 471 macros
[0m11:22:06.270769 [info ] [MainThread]: 
[0m11:22:06.270903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:06.271005 [info ] [MainThread]: 
[0m11:22:06.271259 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:22:06.273180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m11:22:06.303233 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m11:22:06.303452 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m11:22:06.303583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:06.313794 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:22:06.314436 [debug] [ThreadPool]: On list_demo: Close
[0m11:22:06.314724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m11:22:06.314895 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m11:22:06.317192 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m11:22:06.317323 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m11:22:06.317427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:06.318056 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:22:06.318534 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m11:22:06.318638 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m11:22:06.318788 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:06.318877 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m11:22:06.318964 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m11:22:06.319145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:06.319423 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m11:22:06.319530 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m11:22:06.319620 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m11:22:06.319749 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:06.319845 [debug] [ThreadPool]: On create_demo_main: Close
[0m11:22:06.320382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_main, now list_demo_main)
[0m11:22:06.322187 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m11:22:06.322301 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m11:22:06.322385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:06.322583 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:06.322673 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m11:22:06.322767 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m11:22:06.327471 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:22:06.328342 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m11:22:06.328837 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m11:22:06.328938 [debug] [ThreadPool]: On list_demo_main: Close
[0m11:22:06.329180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b7110>]}
[0m11:22:06.329416 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:06.329538 [debug] [MainThread]: On master: BEGIN
[0m11:22:06.329631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:06.329832 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:22:06.329934 [debug] [MainThread]: On master: COMMIT
[0m11:22:06.330038 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:06.330128 [debug] [MainThread]: On master: COMMIT
[0m11:22:06.330283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:22:06.330378 [debug] [MainThread]: On master: Close
[0m11:22:06.332801 [debug] [Thread-1 (]: Began running node seed.tessera_demo.raw_customers
[0m11:22:06.333073 [info ] [Thread-1 (]: 1 of 23 START seed file main.raw_customers ..................................... [RUN]
[0m11:22:06.333286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_main, now seed.tessera_demo.raw_customers)
[0m11:22:06.333418 [debug] [Thread-1 (]: Began compiling node seed.tessera_demo.raw_customers
[0m11:22:06.333544 [debug] [Thread-1 (]: Began executing node seed.tessera_demo.raw_customers
[0m11:22:06.343360 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_customers"
[0m11:22:06.343564 [debug] [Thread-1 (]: On seed.tessera_demo.raw_customers: BEGIN
[0m11:22:06.343692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.344001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.344124 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_customers"
[0m11:22:06.344245 [debug] [Thread-1 (]: On seed.tessera_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "seed.tessera_demo.raw_customers"} */

    create table "demo"."main"."raw_customers" ("customer_id" integer,"customer_name" text,"email" text,"created_at" date)
  
[0m11:22:06.344780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.348824 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_customers"
[0m11:22:06.348977 [debug] [Thread-1 (]: On seed.tessera_demo.raw_customers: 
          COPY "demo"."main"."raw_customers" FROM '/Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:22:06.354323 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:22:06.356356 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.tessera_demo.raw_customers"
[0m11:22:06.361111 [debug] [Thread-1 (]: On seed.tessera_demo.raw_customers: COMMIT
[0m11:22:06.361266 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_customers"
[0m11:22:06.361369 [debug] [Thread-1 (]: On seed.tessera_demo.raw_customers: COMMIT
[0m11:22:06.362053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.362703 [debug] [Thread-1 (]: On seed.tessera_demo.raw_customers: Close
[0m11:22:06.363626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11389b290>]}
[0m11:22:06.363833 [info ] [Thread-1 (]: 1 of 23 OK loaded seed file main.raw_customers ................................. [[32mINSERT 3[0m in 0.03s]
[0m11:22:06.364020 [debug] [Thread-1 (]: Finished running node seed.tessera_demo.raw_customers
[0m11:22:06.364165 [debug] [Thread-1 (]: Began running node seed.tessera_demo.raw_orders
[0m11:22:06.364331 [info ] [Thread-1 (]: 2 of 23 START seed file main.raw_orders ........................................ [RUN]
[0m11:22:06.364526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.tessera_demo.raw_customers, now seed.tessera_demo.raw_orders)
[0m11:22:06.364679 [debug] [Thread-1 (]: Began compiling node seed.tessera_demo.raw_orders
[0m11:22:06.364795 [debug] [Thread-1 (]: Began executing node seed.tessera_demo.raw_orders
[0m11:22:06.366168 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_orders"
[0m11:22:06.366293 [debug] [Thread-1 (]: On seed.tessera_demo.raw_orders: BEGIN
[0m11:22:06.366399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.366609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.366728 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_orders"
[0m11:22:06.366836 [debug] [Thread-1 (]: On seed.tessera_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "seed.tessera_demo.raw_orders"} */

    create table "demo"."main"."raw_orders" ("order_id" integer,"customer_id" integer,"order_date" date,"amount" float8,"status" text)
  
[0m11:22:06.367076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.367457 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_orders"
[0m11:22:06.367573 [debug] [Thread-1 (]: On seed.tessera_demo.raw_orders: 
          COPY "demo"."main"."raw_orders" FROM '/Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:22:06.368562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.368871 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.tessera_demo.raw_orders"
[0m11:22:06.369655 [debug] [Thread-1 (]: On seed.tessera_demo.raw_orders: COMMIT
[0m11:22:06.369800 [debug] [Thread-1 (]: Using duckdb connection "seed.tessera_demo.raw_orders"
[0m11:22:06.369918 [debug] [Thread-1 (]: On seed.tessera_demo.raw_orders: COMMIT
[0m11:22:06.370231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.370501 [debug] [Thread-1 (]: On seed.tessera_demo.raw_orders: Close
[0m11:22:06.370719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133764c0>]}
[0m11:22:06.370922 [info ] [Thread-1 (]: 2 of 23 OK loaded seed file main.raw_orders .................................... [[32mINSERT 5[0m in 0.01s]
[0m11:22:06.371124 [debug] [Thread-1 (]: Finished running node seed.tessera_demo.raw_orders
[0m11:22:06.371275 [debug] [Thread-1 (]: Began running node model.tessera_demo.stg_customers
[0m11:22:06.371463 [info ] [Thread-1 (]: 3 of 23 START sql view model main.stg_customers ................................ [RUN]
[0m11:22:06.371691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.tessera_demo.raw_orders, now model.tessera_demo.stg_customers)
[0m11:22:06.371910 [debug] [Thread-1 (]: Began compiling node model.tessera_demo.stg_customers
[0m11:22:06.374721 [debug] [Thread-1 (]: Writing injected SQL for node "model.tessera_demo.stg_customers"
[0m11:22:06.375230 [debug] [Thread-1 (]: Began executing node model.tessera_demo.stg_customers
[0m11:22:06.384900 [debug] [Thread-1 (]: Writing runtime sql for node "model.tessera_demo.stg_customers"
[0m11:22:06.385332 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_customers"
[0m11:22:06.385454 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: BEGIN
[0m11:22:06.385556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.385807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.385920 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_customers"
[0m11:22:06.386032 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.stg_customers"} */

  
  create view "demo"."main"."stg_customers__dbt_tmp" as (
    -- Staging layer: clean and type raw customers

select
    customer_id,
    customer_name,
    email,
    cast(created_at as date) as created_at
from "demo"."main"."raw_customers"
  );

[0m11:22:06.386275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.388159 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_customers"
[0m11:22:06.388292 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.stg_customers"} */
alter view "demo"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:22:06.388716 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.389166 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: COMMIT
[0m11:22:06.389269 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_customers"
[0m11:22:06.389361 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: COMMIT
[0m11:22:06.389802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.391475 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_customers"
[0m11:22:06.391606 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.stg_customers"} */

      drop view if exists "demo"."main"."stg_customers__dbt_backup" cascade
    
[0m11:22:06.391810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.392273 [debug] [Thread-1 (]: On model.tessera_demo.stg_customers: Close
[0m11:22:06.392464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b2030>]}
[0m11:22:06.392719 [info ] [Thread-1 (]: 3 of 23 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.02s]
[0m11:22:06.392910 [debug] [Thread-1 (]: Finished running node model.tessera_demo.stg_customers
[0m11:22:06.393028 [debug] [Thread-1 (]: Began running node model.tessera_demo.stg_orders
[0m11:22:06.393194 [info ] [Thread-1 (]: 4 of 23 START sql view model main.stg_orders ................................... [RUN]
[0m11:22:06.393380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tessera_demo.stg_customers, now model.tessera_demo.stg_orders)
[0m11:22:06.393515 [debug] [Thread-1 (]: Began compiling node model.tessera_demo.stg_orders
[0m11:22:06.394542 [debug] [Thread-1 (]: Writing injected SQL for node "model.tessera_demo.stg_orders"
[0m11:22:06.394833 [debug] [Thread-1 (]: Began executing node model.tessera_demo.stg_orders
[0m11:22:06.395688 [debug] [Thread-1 (]: Writing runtime sql for node "model.tessera_demo.stg_orders"
[0m11:22:06.395900 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_orders"
[0m11:22:06.395998 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: BEGIN
[0m11:22:06.396089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.396286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.396392 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_orders"
[0m11:22:06.396502 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.stg_orders"} */

  
  create view "demo"."main"."stg_orders__dbt_tmp" as (
    -- Staging layer: clean and type raw orders

select
    order_id,
    customer_id,
    cast(order_date as date) as order_date,
    cast(amount as decimal(10, 2)) as amount,
    status
from "demo"."main"."raw_orders"
  );

[0m11:22:06.396745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.397630 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_orders"
[0m11:22:06.397730 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.stg_orders"} */
alter view "demo"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:22:06.397896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.398310 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: COMMIT
[0m11:22:06.398410 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_orders"
[0m11:22:06.398499 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: COMMIT
[0m11:22:06.398702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.399273 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.stg_orders"
[0m11:22:06.399371 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.stg_orders"} */

      drop view if exists "demo"."main"."stg_orders__dbt_backup" cascade
    
[0m11:22:06.399522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.399898 [debug] [Thread-1 (]: On model.tessera_demo.stg_orders: Close
[0m11:22:06.400044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a64d0>]}
[0m11:22:06.400224 [info ] [Thread-1 (]: 4 of 23 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.01s]
[0m11:22:06.400383 [debug] [Thread-1 (]: Finished running node model.tessera_demo.stg_orders
[0m11:22:06.400494 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:22:06.400620 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m11:22:06.400811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tessera_demo.stg_orders, now test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m11:22:06.400988 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:22:06.405178 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:22:06.405561 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:22:06.410524 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:22:06.410828 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:22:06.410959 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m11:22:06.411075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.411346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.411460 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:22:06.411575 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "demo"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.412407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.413680 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m11:22:06.413925 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m11:22:06.414030 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m11:22:06.414212 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.01s]
[0m11:22:06.414382 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:22:06.414505 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_stg_customers_email.d7cf761533
[0m11:22:06.414623 [info ] [Thread-1 (]: 6 of 23 START test not_null_stg_customers_email ................................ [RUN]
[0m11:22:06.414781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.tessera_demo.not_null_stg_customers_email.d7cf761533)
[0m11:22:06.414897 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_stg_customers_email.d7cf761533
[0m11:22:06.416119 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_stg_customers_email.d7cf761533"
[0m11:22:06.416382 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_stg_customers_email.d7cf761533
[0m11:22:06.417199 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_stg_customers_email.d7cf761533"
[0m11:22:06.417408 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_customers_email.d7cf761533"
[0m11:22:06.417511 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_email.d7cf761533: BEGIN
[0m11:22:06.417607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.417787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.417891 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_customers_email.d7cf761533"
[0m11:22:06.418002 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "demo"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.418308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.418785 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m11:22:06.418983 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_stg_customers_email.d7cf761533'
[0m11:22:06.419081 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_customers_email.d7cf761533: Close
[0m11:22:06.419233 [info ] [Thread-1 (]: 6 of 23 PASS not_null_stg_customers_email ...................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.419388 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_stg_customers_email.d7cf761533
[0m11:22:06.419508 [debug] [Thread-1 (]: Began running node test.tessera_demo.unique_stg_customers_customer_id.c7614daada
[0m11:22:06.419641 [info ] [Thread-1 (]: 7 of 23 START test unique_stg_customers_customer_id ............................ [RUN]
[0m11:22:06.419766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_stg_customers_email.d7cf761533, now test.tessera_demo.unique_stg_customers_customer_id.c7614daada)
[0m11:22:06.419879 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.unique_stg_customers_customer_id.c7614daada
[0m11:22:06.421676 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.unique_stg_customers_customer_id.c7614daada"
[0m11:22:06.421902 [debug] [Thread-1 (]: Began executing node test.tessera_demo.unique_stg_customers_customer_id.c7614daada
[0m11:22:06.422660 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.unique_stg_customers_customer_id.c7614daada"
[0m11:22:06.422876 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_stg_customers_customer_id.c7614daada"
[0m11:22:06.422982 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m11:22:06.423074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.423249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.423353 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_stg_customers_customer_id.c7614daada"
[0m11:22:06.423466 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:22:06.425313 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:22:06.425792 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m11:22:06.426000 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.unique_stg_customers_customer_id.c7614daada'
[0m11:22:06.426102 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_customer_id.c7614daada: Close
[0m11:22:06.426270 [info ] [Thread-1 (]: 7 of 23 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.01s]
[0m11:22:06.426448 [debug] [Thread-1 (]: Finished running node test.tessera_demo.unique_stg_customers_customer_id.c7614daada
[0m11:22:06.426575 [debug] [Thread-1 (]: Began running node test.tessera_demo.unique_stg_customers_email.1ebcb2333e
[0m11:22:06.426719 [info ] [Thread-1 (]: 8 of 23 START test unique_stg_customers_email .................................. [RUN]
[0m11:22:06.426875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.unique_stg_customers_customer_id.c7614daada, now test.tessera_demo.unique_stg_customers_email.1ebcb2333e)
[0m11:22:06.426996 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.unique_stg_customers_email.1ebcb2333e
[0m11:22:06.428103 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.unique_stg_customers_email.1ebcb2333e"
[0m11:22:06.428357 [debug] [Thread-1 (]: Began executing node test.tessera_demo.unique_stg_customers_email.1ebcb2333e
[0m11:22:06.429006 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.unique_stg_customers_email.1ebcb2333e"
[0m11:22:06.429240 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_stg_customers_email.1ebcb2333e"
[0m11:22:06.429350 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m11:22:06.429453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.429656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.429761 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_stg_customers_email.1ebcb2333e"
[0m11:22:06.429876 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "demo"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:22:06.431493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.432022 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m11:22:06.432238 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.unique_stg_customers_email.1ebcb2333e'
[0m11:22:06.432336 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_customers_email.1ebcb2333e: Close
[0m11:22:06.432503 [info ] [Thread-1 (]: 8 of 23 PASS unique_stg_customers_email ........................................ [[32mPASS[0m in 0.01s]
[0m11:22:06.432663 [debug] [Thread-1 (]: Finished running node test.tessera_demo.unique_stg_customers_email.1ebcb2333e
[0m11:22:06.432790 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_stg_orders_amount.2546645448
[0m11:22:06.432926 [info ] [Thread-1 (]: 9 of 23 START test not_null_stg_orders_amount .................................. [RUN]
[0m11:22:06.433054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.unique_stg_customers_email.1ebcb2333e, now test.tessera_demo.not_null_stg_orders_amount.2546645448)
[0m11:22:06.433166 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_stg_orders_amount.2546645448
[0m11:22:06.434566 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_stg_orders_amount.2546645448"
[0m11:22:06.434783 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_stg_orders_amount.2546645448
[0m11:22:06.435354 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_stg_orders_amount.2546645448"
[0m11:22:06.435576 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_orders_amount.2546645448"
[0m11:22:06.435684 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_amount.2546645448: BEGIN
[0m11:22:06.435782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.435946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.436050 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_orders_amount.2546645448"
[0m11:22:06.436159 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.436842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.437333 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m11:22:06.437546 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_stg_orders_amount.2546645448'
[0m11:22:06.437654 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_amount.2546645448: Close
[0m11:22:06.437809 [info ] [Thread-1 (]: 9 of 23 PASS not_null_stg_orders_amount ........................................ [[32mPASS[0m in 0.00s]
[0m11:22:06.437965 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_stg_orders_amount.2546645448
[0m11:22:06.438074 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:22:06.438185 [info ] [Thread-1 (]: 10 of 23 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m11:22:06.438298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_stg_orders_amount.2546645448, now test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5)
[0m11:22:06.438395 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:22:06.439658 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:22:06.439867 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:22:06.440432 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:22:06.440626 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:22:06.440724 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m11:22:06.440816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.440972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.441077 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5"
[0m11:22:06.441188 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "demo"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.441467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.441909 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m11:22:06.442079 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5'
[0m11:22:06.442174 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m11:22:06.442320 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.00s]
[0m11:22:06.442470 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5
[0m11:22:06.442576 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:06.442676 [info ] [Thread-1 (]: 11 of 23 START test not_null_stg_orders_order_id ............................... [RUN]
[0m11:22:06.442813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_stg_orders_customer_id.af79d5e4b5, now test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:22:06.442923 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:06.444022 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:22:06.444206 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:06.444975 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:22:06.445165 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:22:06.445262 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:22:06.445350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.445500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.445605 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:22:06.445718 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.445983 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.446449 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:22:06.446628 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64'
[0m11:22:06.446729 [debug] [Thread-1 (]: On test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:22:06.446880 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.447035 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:06.447148 [debug] [Thread-1 (]: Began running node test.tessera_demo.unique_stg_orders_order_id.e3b841c71a
[0m11:22:06.447262 [info ] [Thread-1 (]: 12 of 23 START test unique_stg_orders_order_id ................................. [RUN]
[0m11:22:06.447386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_stg_orders_order_id.81cfe2fe64, now test.tessera_demo.unique_stg_orders_order_id.e3b841c71a)
[0m11:22:06.447496 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.unique_stg_orders_order_id.e3b841c71a
[0m11:22:06.448586 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.unique_stg_orders_order_id.e3b841c71a"
[0m11:22:06.448861 [debug] [Thread-1 (]: Began executing node test.tessera_demo.unique_stg_orders_order_id.e3b841c71a
[0m11:22:06.449688 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.unique_stg_orders_order_id.e3b841c71a"
[0m11:22:06.449924 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_stg_orders_order_id.e3b841c71a"
[0m11:22:06.450035 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m11:22:06.450136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.450352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.450455 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_stg_orders_order_id.e3b841c71a"
[0m11:22:06.450562 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:22:06.450975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.451454 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m11:22:06.451653 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.unique_stg_orders_order_id.e3b841c71a'
[0m11:22:06.451747 [debug] [Thread-1 (]: On test.tessera_demo.unique_stg_orders_order_id.e3b841c71a: Close
[0m11:22:06.451913 [info ] [Thread-1 (]: 12 of 23 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.452089 [debug] [Thread-1 (]: Finished running node test.tessera_demo.unique_stg_orders_order_id.e3b841c71a
[0m11:22:06.452447 [debug] [Thread-1 (]: Began running node model.tessera_demo.dim_customers
[0m11:22:06.452624 [info ] [Thread-1 (]: 13 of 23 START sql view model main.dim_customers ............................... [RUN]
[0m11:22:06.452765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.unique_stg_orders_order_id.e3b841c71a, now model.tessera_demo.dim_customers)
[0m11:22:06.452884 [debug] [Thread-1 (]: Began compiling node model.tessera_demo.dim_customers
[0m11:22:06.453805 [debug] [Thread-1 (]: Writing injected SQL for node "model.tessera_demo.dim_customers"
[0m11:22:06.454109 [debug] [Thread-1 (]: Began executing node model.tessera_demo.dim_customers
[0m11:22:06.454969 [debug] [Thread-1 (]: Writing runtime sql for node "model.tessera_demo.dim_customers"
[0m11:22:06.455211 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.dim_customers"
[0m11:22:06.455311 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: BEGIN
[0m11:22:06.455405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.455605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.455713 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.dim_customers"
[0m11:22:06.455830 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.dim_customers"} */

  
  create view "demo"."main"."dim_customers__dbt_tmp" as (
    -- Dimension table: customer summary

select
    c.customer_id,
    c.customer_name,
    c.email,
    c.created_at,
    count(o.order_id) as total_orders,
    coalesce(sum(case when o.status = 'completed' then o.amount else 0 end), 0) as lifetime_revenue
from "demo"."main"."stg_customers" c
left join "demo"."main"."stg_orders" o on c.customer_id = o.customer_id
group by c.customer_id, c.customer_name, c.email, c.created_at
  );

[0m11:22:06.456450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.457408 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.dim_customers"
[0m11:22:06.457508 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.dim_customers"} */
alter view "demo"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:22:06.457695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.458107 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: COMMIT
[0m11:22:06.458207 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.dim_customers"
[0m11:22:06.458298 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: COMMIT
[0m11:22:06.458522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.459132 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.dim_customers"
[0m11:22:06.459248 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.dim_customers"} */

      drop view if exists "demo"."main"."dim_customers__dbt_backup" cascade
    
[0m11:22:06.459414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.459805 [debug] [Thread-1 (]: On model.tessera_demo.dim_customers: Close
[0m11:22:06.459989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11345b000>]}
[0m11:22:06.460208 [info ] [Thread-1 (]: 13 of 23 OK created sql view model main.dim_customers .......................... [[32mOK[0m in 0.01s]
[0m11:22:06.460377 [debug] [Thread-1 (]: Finished running node model.tessera_demo.dim_customers
[0m11:22:06.460511 [debug] [Thread-1 (]: Began running node model.tessera_demo.fct_orders
[0m11:22:06.460663 [info ] [Thread-1 (]: 14 of 23 START sql view model main.fct_orders .................................. [RUN]
[0m11:22:06.460872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tessera_demo.dim_customers, now model.tessera_demo.fct_orders)
[0m11:22:06.460999 [debug] [Thread-1 (]: Began compiling node model.tessera_demo.fct_orders
[0m11:22:06.462094 [debug] [Thread-1 (]: Writing injected SQL for node "model.tessera_demo.fct_orders"
[0m11:22:06.462346 [debug] [Thread-1 (]: Began executing node model.tessera_demo.fct_orders
[0m11:22:06.463180 [debug] [Thread-1 (]: Writing runtime sql for node "model.tessera_demo.fct_orders"
[0m11:22:06.463399 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.fct_orders"
[0m11:22:06.463516 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: BEGIN
[0m11:22:06.463625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.463837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.463948 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.fct_orders"
[0m11:22:06.464067 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.fct_orders"} */

  
  create view "demo"."main"."fct_orders__dbt_tmp" as (
    -- Fact table: orders with customer info

select
    o.order_id,
    o.customer_id,
    c.customer_name,
    c.email as customer_email,
    o.order_date,
    o.amount,
    o.status,
    -- Derived fields
    case when o.status = 'completed' then o.amount else 0 end as revenue
from "demo"."main"."stg_orders" o
left join "demo"."main"."stg_customers" c on o.customer_id = c.customer_id
  );

[0m11:22:06.464368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.465144 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.fct_orders"
[0m11:22:06.465245 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.fct_orders"} */
alter view "demo"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:22:06.465410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.465812 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: COMMIT
[0m11:22:06.465913 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.fct_orders"
[0m11:22:06.466006 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: COMMIT
[0m11:22:06.466211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.468197 [debug] [Thread-1 (]: Using duckdb connection "model.tessera_demo.fct_orders"
[0m11:22:06.468309 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "model.tessera_demo.fct_orders"} */

      drop view if exists "demo"."main"."fct_orders__dbt_backup" cascade
    
[0m11:22:06.468478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.468859 [debug] [Thread-1 (]: On model.tessera_demo.fct_orders: Close
[0m11:22:06.469017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deab62-25c1-49da-b78f-670e37e81251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d5bfb0>]}
[0m11:22:06.469208 [info ] [Thread-1 (]: 14 of 23 OK created sql view model main.fct_orders ............................. [[32mOK[0m in 0.01s]
[0m11:22:06.469398 [debug] [Thread-1 (]: Finished running node model.tessera_demo.fct_orders
[0m11:22:06.469524 [debug] [Thread-1 (]: Began running node test.tessera_demo.assert_customers_have_valid_email
[0m11:22:06.469639 [info ] [Thread-1 (]: 15 of 23 START test assert_customers_have_valid_email .......................... [RUN]
[0m11:22:06.469849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tessera_demo.fct_orders, now test.tessera_demo.assert_customers_have_valid_email)
[0m11:22:06.469963 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.assert_customers_have_valid_email
[0m11:22:06.470753 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.assert_customers_have_valid_email"
[0m11:22:06.471108 [debug] [Thread-1 (]: Began executing node test.tessera_demo.assert_customers_have_valid_email
[0m11:22:06.472012 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.assert_customers_have_valid_email"
[0m11:22:06.472345 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.assert_customers_have_valid_email"
[0m11:22:06.472458 [debug] [Thread-1 (]: On test.tessera_demo.assert_customers_have_valid_email: BEGIN
[0m11:22:06.472566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.472785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.472889 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.assert_customers_have_valid_email"
[0m11:22:06.472997 [debug] [Thread-1 (]: On test.tessera_demo.assert_customers_have_valid_email: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.assert_customers_have_valid_email"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Singular test: ensure all customers have valid email format

select
    customer_id,
    email
from "demo"."main"."dim_customers"
where email not like '%@%.%'
  
  
      
    ) dbt_internal_test
[0m11:22:06.474623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.475216 [debug] [Thread-1 (]: On test.tessera_demo.assert_customers_have_valid_email: ROLLBACK
[0m11:22:06.475466 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.assert_customers_have_valid_email'
[0m11:22:06.475576 [debug] [Thread-1 (]: On test.tessera_demo.assert_customers_have_valid_email: Close
[0m11:22:06.475770 [info ] [Thread-1 (]: 15 of 23 PASS assert_customers_have_valid_email ................................ [[32mPASS[0m in 0.01s]
[0m11:22:06.475957 [debug] [Thread-1 (]: Finished running node test.tessera_demo.assert_customers_have_valid_email
[0m11:22:06.476088 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:22:06.476205 [info ] [Thread-1 (]: 16 of 23 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m11:22:06.476408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.assert_customers_have_valid_email, now test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m11:22:06.476562 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:22:06.477839 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:22:06.478133 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:22:06.478774 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:22:06.479029 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:22:06.479134 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m11:22:06.479228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.479421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.479532 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:22:06.479644 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "demo"."main"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.480202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.480705 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m11:22:06.480895 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m11:22:06.480993 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m11:22:06.481150 [info ] [Thread-1 (]: 16 of 23 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.00s]
[0m11:22:06.481310 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:22:06.481429 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105
[0m11:22:06.481548 [info ] [Thread-1 (]: 17 of 23 START test not_null_dim_customers_lifetime_revenue .................... [RUN]
[0m11:22:06.481700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_dim_customers_customer_id.dd91cd1c8d, now test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105)
[0m11:22:06.481812 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105
[0m11:22:06.483156 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105"
[0m11:22:06.483382 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105
[0m11:22:06.483951 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105"
[0m11:22:06.484132 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105"
[0m11:22:06.484229 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105: BEGIN
[0m11:22:06.484321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.484488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.484591 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105"
[0m11:22:06.484698 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_revenue
from "demo"."main"."dim_customers"
where lifetime_revenue is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.486432 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:22:06.486931 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105: ROLLBACK
[0m11:22:06.487129 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105'
[0m11:22:06.487229 [debug] [Thread-1 (]: On test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105: Close
[0m11:22:06.487387 [info ] [Thread-1 (]: 17 of 23 PASS not_null_dim_customers_lifetime_revenue .......................... [[32mPASS[0m in 0.01s]
[0m11:22:06.487544 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105
[0m11:22:06.487673 [debug] [Thread-1 (]: Began running node test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:22:06.487805 [info ] [Thread-1 (]: 18 of 23 START test unique_dim_customers_customer_id ........................... [RUN]
[0m11:22:06.487934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_dim_customers_lifetime_revenue.e461788105, now test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd)
[0m11:22:06.488048 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:22:06.489185 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:22:06.489388 [debug] [Thread-1 (]: Began executing node test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:22:06.490205 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:22:06.490397 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:22:06.490498 [debug] [Thread-1 (]: On test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m11:22:06.490590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.490758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.490865 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:22:06.490982 [debug] [Thread-1 (]: On test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "demo"."main"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:22:06.491880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.492394 [debug] [Thread-1 (]: On test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m11:22:06.492597 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd'
[0m11:22:06.492695 [debug] [Thread-1 (]: On test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m11:22:06.492854 [info ] [Thread-1 (]: 18 of 23 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.00s]
[0m11:22:06.493012 [debug] [Thread-1 (]: Finished running node test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:22:06.493121 [debug] [Thread-1 (]: Began running node test.tessera_demo.assert_positive_revenue
[0m11:22:06.493236 [info ] [Thread-1 (]: 19 of 23 START test assert_positive_revenue .................................... [RUN]
[0m11:22:06.493348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.unique_dim_customers_customer_id.15c9f1e2fd, now test.tessera_demo.assert_positive_revenue)
[0m11:22:06.493447 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.assert_positive_revenue
[0m11:22:06.494214 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.assert_positive_revenue"
[0m11:22:06.494470 [debug] [Thread-1 (]: Began executing node test.tessera_demo.assert_positive_revenue
[0m11:22:06.495222 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.assert_positive_revenue"
[0m11:22:06.495436 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.assert_positive_revenue"
[0m11:22:06.495533 [debug] [Thread-1 (]: On test.tessera_demo.assert_positive_revenue: BEGIN
[0m11:22:06.495624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.495799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.495903 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.assert_positive_revenue"
[0m11:22:06.496012 [debug] [Thread-1 (]: On test.tessera_demo.assert_positive_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.assert_positive_revenue"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Singular test: ensure all completed orders have positive revenue
-- This returns rows that FAIL the test

select
    order_id,
    revenue
from "demo"."main"."fct_orders"
where status = 'completed' and revenue <= 0
  
  
      
    ) dbt_internal_test
[0m11:22:06.496942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:22:06.497388 [debug] [Thread-1 (]: On test.tessera_demo.assert_positive_revenue: ROLLBACK
[0m11:22:06.497563 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.assert_positive_revenue'
[0m11:22:06.497654 [debug] [Thread-1 (]: On test.tessera_demo.assert_positive_revenue: Close
[0m11:22:06.497799 [info ] [Thread-1 (]: 19 of 23 PASS assert_positive_revenue .......................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.497951 [debug] [Thread-1 (]: Finished running node test.tessera_demo.assert_positive_revenue
[0m11:22:06.498059 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b
[0m11:22:06.498171 [info ] [Thread-1 (]: 20 of 23 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m11:22:06.498283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.assert_positive_revenue, now test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b)
[0m11:22:06.498382 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b
[0m11:22:06.499453 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b"
[0m11:22:06.499662 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b
[0m11:22:06.500228 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b"
[0m11:22:06.500419 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b"
[0m11:22:06.500515 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m11:22:06.500606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.500760 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.500864 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b"
[0m11:22:06.500973 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "demo"."main"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.501363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.501819 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m11:22:06.502022 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b'
[0m11:22:06.502135 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m11:22:06.502304 [info ] [Thread-1 (]: 20 of 23 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.00s]
[0m11:22:06.502466 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b
[0m11:22:06.502591 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0
[0m11:22:06.502719 [info ] [Thread-1 (]: 21 of 23 START test not_null_fct_orders_order_id ............................... [RUN]
[0m11:22:06.502847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_fct_orders_customer_id.16fe324f7b, now test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0)
[0m11:22:06.502958 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0
[0m11:22:06.504327 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0"
[0m11:22:06.504576 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0
[0m11:22:06.505219 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0"
[0m11:22:06.505448 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0"
[0m11:22:06.505548 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m11:22:06.505637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.505825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.505936 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0"
[0m11:22:06.506044 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.506477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.506938 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m11:22:06.507123 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0'
[0m11:22:06.507220 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0: Close
[0m11:22:06.507369 [info ] [Thread-1 (]: 21 of 23 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.507525 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0
[0m11:22:06.507643 [debug] [Thread-1 (]: Began running node test.tessera_demo.not_null_fct_orders_revenue.cd5321da23
[0m11:22:06.507769 [info ] [Thread-1 (]: 22 of 23 START test not_null_fct_orders_revenue ................................ [RUN]
[0m11:22:06.507899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_fct_orders_order_id.4e687af8d0, now test.tessera_demo.not_null_fct_orders_revenue.cd5321da23)
[0m11:22:06.508010 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.not_null_fct_orders_revenue.cd5321da23
[0m11:22:06.509249 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.not_null_fct_orders_revenue.cd5321da23"
[0m11:22:06.509442 [debug] [Thread-1 (]: Began executing node test.tessera_demo.not_null_fct_orders_revenue.cd5321da23
[0m11:22:06.509992 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.not_null_fct_orders_revenue.cd5321da23"
[0m11:22:06.510181 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_fct_orders_revenue.cd5321da23"
[0m11:22:06.510276 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_revenue.cd5321da23: BEGIN
[0m11:22:06.510364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.510551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.510659 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.not_null_fct_orders_revenue.cd5321da23"
[0m11:22:06.510773 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_revenue.cd5321da23: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.not_null_fct_orders_revenue.cd5321da23"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue
from "demo"."main"."fct_orders"
where revenue is null



  
  
      
    ) dbt_internal_test
[0m11:22:06.511214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.511724 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_revenue.cd5321da23: ROLLBACK
[0m11:22:06.511922 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.not_null_fct_orders_revenue.cd5321da23'
[0m11:22:06.512020 [debug] [Thread-1 (]: On test.tessera_demo.not_null_fct_orders_revenue.cd5321da23: Close
[0m11:22:06.512184 [info ] [Thread-1 (]: 22 of 23 PASS not_null_fct_orders_revenue ...................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.512348 [debug] [Thread-1 (]: Finished running node test.tessera_demo.not_null_fct_orders_revenue.cd5321da23
[0m11:22:06.512468 [debug] [Thread-1 (]: Began running node test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5
[0m11:22:06.512595 [info ] [Thread-1 (]: 23 of 23 START test unique_fct_orders_order_id ................................. [RUN]
[0m11:22:06.512725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tessera_demo.not_null_fct_orders_revenue.cd5321da23, now test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5)
[0m11:22:06.512837 [debug] [Thread-1 (]: Began compiling node test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5
[0m11:22:06.513988 [debug] [Thread-1 (]: Writing injected SQL for node "test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5"
[0m11:22:06.514281 [debug] [Thread-1 (]: Began executing node test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5
[0m11:22:06.515089 [debug] [Thread-1 (]: Writing runtime sql for node "test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5"
[0m11:22:06.515304 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5"
[0m11:22:06.515405 [debug] [Thread-1 (]: On test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m11:22:06.515501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:06.515687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.515791 [debug] [Thread-1 (]: Using duckdb connection "test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5"
[0m11:22:06.515900 [debug] [Thread-1 (]: On test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "tessera_demo", "target_name": "dev", "node_id": "test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:22:06.516493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:22:06.516952 [debug] [Thread-1 (]: On test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m11:22:06.517137 [debug] [Thread-1 (]: Failed to rollback 'test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5'
[0m11:22:06.517235 [debug] [Thread-1 (]: On test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5: Close
[0m11:22:06.517386 [info ] [Thread-1 (]: 23 of 23 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.00s]
[0m11:22:06.517543 [debug] [Thread-1 (]: Finished running node test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5
[0m11:22:06.518017 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:06.518133 [debug] [MainThread]: On master: BEGIN
[0m11:22:06.518226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:22:06.518376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:22:06.518473 [debug] [MainThread]: On master: COMMIT
[0m11:22:06.518567 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:06.518653 [debug] [MainThread]: On master: COMMIT
[0m11:22:06.518809 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:22:06.518928 [debug] [MainThread]: On master: Close
[0m11:22:06.519059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:06.519155 [debug] [MainThread]: Connection 'test.tessera_demo.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m11:22:06.519264 [info ] [MainThread]: 
[0m11:22:06.519365 [info ] [MainThread]: Finished running 2 seeds, 17 data tests, 4 view models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m11:22:06.520252 [debug] [MainThread]: Command end result
[0m11:22:06.528376 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/target/manifest.json
[0m11:22:06.529292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/target/semantic_manifest.json
[0m11:22:06.531541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/evanvolgas/Documents/gh/tessera/tests/fixtures/demo_dbt_project/target/run_results.json
[0m11:22:06.531649 [info ] [MainThread]: 
[0m11:22:06.531779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:06.531875 [info ] [MainThread]: 
[0m11:22:06.531975 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m11:22:06.532216 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0898342, "process_in_blocks": "0", "process_kernel_time": 0.346769, "process_mem_max_rss": "219332608", "process_out_blocks": "0", "process_user_time": 1.839192}
[0m11:22:06.532363 [debug] [MainThread]: Command `dbt build` succeeded at 11:22:06.532335 after 1.09 seconds
[0m11:22:06.532485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c66ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113056ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113467ef0>]}
[0m11:22:06.532600 [debug] [MainThread]: Flushing usage events
[0m11:22:06.988437 [debug] [MainThread]: An error was encountered while trying to flush usage events
