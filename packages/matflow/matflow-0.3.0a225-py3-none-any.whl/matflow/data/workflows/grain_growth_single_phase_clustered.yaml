doc:
  - >
    Generates a microstructure with a unimodal grain size distribution and simulates
    grain coarsening based on misorientation dependant GB energy and mobility

tasks:
    # rotated cube texture for the sub-grain matrix:
  - schema: sample_texture_from_model_ODF_mtex
    inputs:
      num_orientations: 2300
      crystal_symmetry: cubic
      specimen_symmetry: orthorhombic
      ODF_components:
        - type: unimodal
          component_fraction: 1.0
          modal_orientation_HKL: [0, 0, 1]
          modal_orientation_UVW: [1, 1, 0]
          halfwidth: 5

  - schema: visualise_orientations_pole_figure_mtex
    inputs:
      crystal_symmetry: cubic
      pole_figure_directions:
        - [0, 0, 1]
        - [1, 0, 1]
        - [1, 1, 1]
      use_contours: false

  - schema: generate_volume_element_from_statistics
    inputs:
      grid_size: [512, 512, 1]
      resolution: [1, 1, 1] # side length is 512
      periodic: false
      phase_statistics:
        - type: primary
          name: sub-grain-matrix
          crystal_structure: cubic
          volume_fraction: 1.0
          size_distribution:
            ESD_mean: 7.03431
            ESD_log_stddev: 0.04
            num_bins: 15

  - schema: visualise_VE_VTK

  - schema: cluster_orientations
    inputs:
      alpha_file_path: <<demo_data_file:clustering_quaternions>>/alpha.npy
      gamma_file_path: <<demo_data_file:clustering_quaternions>>/gamma.npy
      n_iterations: 60
      alpha_start_index: 150
      alpha_stop_index: 350
      gamma_start_index: 500
      gamma_stop_index: 700

  - schema: generate_phase_field_input_from_volume_element
    inputs:
      materials:
      - name: sub-grain-matrix
        properties:
          chemicalenergy: none
          molarvolume: 1e-5
          temperature0: 500.0
      interfaces:
      - materials: [sub-grain-matrix, sub-grain-matrix]
        properties:
          width: 6.0
          energy:
            e0: 1.0e+8
          mobility:
            m0: 3.333e-11
      components: [ti]
      outputs: [phaseid, matid, interfaceid, 0_phi]
      solution_parameters:
        abstol: 0.0001
        amrinterval: 25
        initblocksize: [1, 1]
        initcoarsen: 9
        initrefine: 9
        interpolation: cubic
        maxnrefine: 9
        minnrefine: 0
        outfile: out
        outputfreq: 100
        petscoptions: -ts_adapt_monitor -ts_rk_type 2a
        random_seed: 1579993586
        reltol: 0.0001
        time: 1000_000
      interface_binning: # specify one or both of energy_range/mobility_range:
        base_interface_name: sub-grain-matrix-sub-grain-matrix
        theta_max: 50
        bin_width: 1
        energy_range: [0.1e+8, 0.555e+8]
        mobility_range: [2.105e-11, 10.0e-11]
        n: 7 # mobility parameter
        B: 625 # mobility parameter

  - schema: simulate_grain_growth
    inputs:
      num_VTU_files: 22
      derive_outputs:
      - name: num_voxels_per_phase
      save_outputs:
      - name: phaseid
        time_interval: 5_000
      - name: matid
        number: 4
      - name: interfaceid
        number: 4
      - name: 0_phi
        number: 4
      - name: num_voxels_per_phase
        time_interval: 5_000
      delete_VTUs: true
