[dependencies]
anstream = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
xxhash-rust = { workspace = true }

# Optional dependencies
arrow = { optional = true, version = "53.0.0" }
avrotize = { optional = true, version = "0.1.1" }
crustrace = { features = ["debug"], optional = true, version = "0.1.9" }
crustrace-mermaid = { optional = true, version = "0.1.6" }
parquet = { optional = true, version = "53.0.0" }
tracing = { optional = true, version = "0.1.41" }
tracing-subscriber = { optional = true, version = "0.3.20" }

# Vendored from genson-rs
mimalloc.workspace = true
ordermap.workspace = true
rayon.workspace = true
regex.workspace = true
simd-json.workspace = true
sonic-rs = "0.5.6"

[features]
avro = ["avrotize"]
default = []
parquet = ["dep:arrow", "dep:parquet"]
trace = ["crustrace", "crustrace-mermaid", "tracing", "tracing-subscriber"]

[package]
authors.workspace = true
categories = ["data-structures", "encoding", "parsing"]
description = "Core library for JSON schema inference using genson-rs"
edition.workspace = true
homepage.workspace = true
keywords = ["core", "genson", "inference", "json", "schema"]
license.workspace = true
name = "genson-core"
readme = "README.md"
repository.workspace = true
version = "0.7.1"

[dev-dependencies]
criterion = { features = ["html_reports"], version = "0.8" }
predicates = "3.1.3"
tempfile = "3"

[package.metadata.cargo-machete]
ignored = ["crustrace", "sonic-rs", "tracing"]

[[bench]]
harness = false
name = "schema_inference"
