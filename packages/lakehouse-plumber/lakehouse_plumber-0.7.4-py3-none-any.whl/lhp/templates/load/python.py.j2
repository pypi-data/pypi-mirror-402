@dp.temporary_view()
def {{ target_view }}():
    """{{ description }}"""
    # Call the external Python function with spark and parameters
    parameters = {{ parameters | tojson }}
    df = {{ function_name }}(spark, parameters)
    {% if add_operational_metadata %}
    
    # Add operational metadata columns
    {% for col_name, expression in metadata_columns.items()|sort %}
    df = df.withColumn('{{ col_name }}', {{ expression }})
    {% endfor %}
    {% endif %}
    
    return df 