Metadata-Version: 2.4
Name: wally-dev
Version: 0.0.1
Summary: CLI para desenvolvimento local de casos de teste de acessibilidade da plataforma Wally
Author-email: Equallyze <contato@equallyze.com>
Maintainer-email: Equallyze <contato@equallyze.com>
License-Expression: LicenseRef-Proprietary
Project-URL: Homepage, https://acessibilidade.global
Project-URL: Documentation, https://docs.acessibilidade.global
Project-URL: Repository, https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev
Project-URL: Issues, https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev/-/issues
Project-URL: Changelog, https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev/-/blob/main/CHANGELOG.md
Keywords: accessibility,a11y,testing,cli,wally,equallyze,acessibilidade,nbr17225
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Console
Classifier: Intended Audience :: Developers
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Software Development :: Testing
Classifier: Topic :: Software Development :: Quality Assurance
Classifier: Topic :: Internet :: WWW/HTTP :: Site Management
Classifier: Typing :: Typed
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: requests<3.0.0,>=2.31.0
Requires-Dist: pydantic<3.0.0,>=2.5.0
Requires-Dist: pydantic-settings<3.0.0,>=2.1.0
Requires-Dist: python-dotenv<2.0.0,>=1.0.0
Requires-Dist: click<9.0.0,>=8.1.0
Requires-Dist: rich<14.0.0,>=13.0.0
Requires-Dist: beautifulsoup4<5.0.0,>=4.12.0
Provides-Extra: ai
Requires-Dist: openai<2.0.0,>=1.0.0; extra == "ai"
Provides-Extra: dev
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: pytest-cov>=4.1.0; extra == "dev"
Requires-Dist: pytest-mock>=3.12.0; extra == "dev"
Requires-Dist: responses>=0.24.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: mypy>=1.7.0; extra == "dev"
Requires-Dist: ruff>=0.1.0; extra == "dev"
Requires-Dist: types-requests>=2.31.0; extra == "dev"
Requires-Dist: types-beautifulsoup4>=4.12.0; extra == "dev"
Requires-Dist: pre-commit>=3.5.0; extra == "dev"
Requires-Dist: openai<2.0.0,>=1.0.0; extra == "dev"
Dynamic: license-file

# Wally Dev CLI

[![PyPI version](https://img.shields.io/pypi/v/wally-dev.svg)](https://pypi.org/project/wally-dev/)
[![Python versions](https://img.shields.io/pypi/pyversions/wally-dev.svg)](https://pypi.org/project/wally-dev/)
[![Pipeline](https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev/badges/main/pipeline.svg)](https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev/-/pipelines)

**Wally Dev** Ã© uma ferramenta de linha de comando (CLI) para desenvolvimento local de casos de teste de acessibilidade da plataforma [Wally](https://wally.equallyze.com).

## ğŸš€ InstalaÃ§Ã£o

### OpÃ§Ã£o 1: pipx (Recomendado)

```bash
# Instalar pipx (se necessÃ¡rio)
sudo apt install pipx
pipx ensurepath

# Instalar wally-dev
pipx install wally-dev
```

### OpÃ§Ã£o 2: pip com virtual environment

```bash
# Criar e ativar virtual environment
python3 -m venv ~/.venvs/wally-dev
source ~/.venvs/wally-dev/bin/activate

# Instalar
pip install wally-dev
```

### OpÃ§Ã£o 3: pip direto (sistemas sem proteÃ§Ã£o PEP 668)

```bash
pip install wally-dev
```

### Requisitos

- Python 3.9 ou superior
- Conta ativa na plataforma Wally

## ğŸ“‹ Comandos DisponÃ­veis

| Comando | DescriÃ§Ã£o |
|---------|-----------|
| `wally-dev login` | Autenticar na plataforma Wally |
| `wally-dev logout` | Remover credenciais e desbloquear normas |
| `wally-dev status` | Mostrar status do workspace local |
| `wally-dev norms list` | Listar normas disponÃ­veis |
| `wally-dev rules list` | Listar regras de uma norma |
| `wally-dev checkout` | Baixar casos de teste para desenvolvimento |
| `wally-dev run` | Executar casos de teste localmente |
| `wally-dev push` | Enviar alteraÃ§Ãµes para o servidor |

## ğŸ” AutenticaÃ§Ã£o

```bash
# Login interativo
wally-dev login

# Com parÃ¢metros
wally-dev login --username user@example.com --org-id <organization-id>
```

## ğŸ“¦ Workflow de Desenvolvimento

### 1. Listar normas disponÃ­veis

```bash
wally-dev norms list
```

SaÃ­da:
```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“‹ Normas (3) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚
â”‚ â”ƒ ID                       â”ƒ Nome              â”ƒ â”‚
â”‚ â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”© â”‚
â”‚ â”‚ 6954434ffdd23615c0e5d85d â”‚ NBR 17225         â”‚ â”‚
â”‚ â”‚ 695c46a91dd6a5bae0e4863b â”‚ Community         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

### 2. Fazer checkout de uma norma

```bash
wally-dev checkout --norm-id <norm-id>
```

Isso irÃ¡:
- Bloquear a norma no servidor (impede ediÃ§Ãµes simultÃ¢neas)
- Baixar todos os casos de teste e exemplos para `./workspace/`

### 3. Estrutura do Workspace

```
./workspace/
  <norm-id>/
    testCases/
      <testcase-id>/
        testcase.json     # Metadados do caso de teste
        code/
          finder.py       # FunÃ§Ã£o que encontra elementos
          validator.py    # FunÃ§Ã£o que valida elementos
        examples/
          compliant/
            example.html  # HTML que deve passar
          non-compliant/
            example.html  # HTML que deve falhar
```

### 4. Desenvolver o caso de teste

#### `finder.py`

```python
from bs4 import BeautifulSoup

def find(html_content: str):
    """
    Encontra elementos HTML para validaÃ§Ã£o.
    
    Args:
        html_content: String com o HTML a ser analisado
        
    Yields:
        Elementos encontrados para validaÃ§Ã£o
    """
    soup = BeautifulSoup(html_content, "html.parser")
    for img in soup.find_all("img"):
        yield img
```

#### `validator.py`

```python
def validate(element) -> bool:
    """
    Valida se um elemento estÃ¡ em conformidade.
    
    Args:
        element: Elemento HTML encontrado pelo finder
        
    Returns:
        True se o elemento estÃ¡ em conformidade, False caso contrÃ¡rio
    """
    alt = element.get("alt", "")
    return bool(alt and alt.strip())
```

### 5. Executar testes localmente

```bash
# Executar todos os exemplos de um caso de teste
wally-dev run --testcase <testcase-id>

# Executar um exemplo especÃ­fico
wally-dev run --testcase <testcase-id> --example compliant/example.html

# Modo debug (mostra elementos encontrados e validaÃ§Ãµes)
wally-dev run --testcase <testcase-id> --debug
```

SaÃ­da com `--debug`:
```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ” Debug Output â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ExecuÃ§Ã£o bem sucedida                                     â”‚
â”‚                                                           â”‚
â”‚ Elementos encontrados: 2                                  â”‚
â”‚ Tempo finder: 0.35ms                                      â”‚
â”‚ Tempo total: 0.40ms                                       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

ğŸ“‹ Elementos e ValidaÃ§Ãµes:
â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ # â”ƒ Linha â”ƒ Tag â”ƒ validate() â”ƒ Snippet                     â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚    10 â”‚ img â”‚   âœ“ True   â”‚ <img alt="" src="img.jpg"/> â”‚
â”‚ 1 â”‚    12 â”‚ img â”‚   âœ“ True   â”‚ <img aria-hidden="true"/>   â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. Enviar alteraÃ§Ãµes

```bash
wally-dev push --norm-id <norm-id>
```

## ğŸ§ª LÃ³gica de ValidaÃ§Ã£o

Os casos de teste seguem a convenÃ§Ã£o:

- **Exemplos `compliant/`**: Todos os elementos encontrados pelo `finder` devem retornar `True` no `validator`
- **Exemplos `non-compliant/`**: Pelo menos um elemento deve retornar `False` no `validator`

## âš™ï¸ ConfiguraÃ§Ã£o

A CLI armazena configuraÃ§Ãµes em `~/.config/wally-dev/.wally-dev.json`:

```json
{
  "access_token": "...",
  "refresh_token": "...",
  "user_email": "user@example.com",
  "organization_id": "...",
  "backend_url": "https://api.wally.equallyze.com/backend/services/v0.0.1"
}
```

### VariÃ¡veis de Ambiente

| VariÃ¡vel | DescriÃ§Ã£o | Default |
|----------|-----------|---------|
| `WALLY_DEV_BACKEND_URL` | URL da API backend | `https://api.wally.equallyze.com/...` |
| `WALLY_DEV_CONFIG_DIR` | DiretÃ³rio de configuraÃ§Ã£o | `~/.config/wally-dev` |

## ğŸ› ï¸ Desenvolvimento

### InstalaÃ§Ã£o para desenvolvimento

```bash
git clone https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev.git
cd wally-dev

# Criar virtual environment
python3 -m venv .venv
source .venv/bin/activate

# Instalar em modo editÃ¡vel com dependÃªncias de dev
pip install -e ".[dev]"
```

### Executar testes

```bash
pytest
pytest --cov=wally_dev --cov-report=html
```

### FormataÃ§Ã£o e linting

```bash
black wally_dev tests
isort wally_dev tests
ruff check wally_dev tests
mypy wally_dev
```

## ğŸ“„ LicenÃ§a

Este software Ã© propriedade da [Equallyze Tecnologia LTDA](https://equallyze.com). 
Todos os direitos reservados. Consulte o arquivo [LICENSE](LICENSE) para mais detalhes.

## ğŸ”— Links

- [Plataforma Wally](https://wally.equallyze.com)
- [DocumentaÃ§Ã£o](https://docs.wally.equallyze.com)
- [Equallyze](https://equallyze.com)
- [RepositÃ³rio](https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev)

## ğŸ¤ Suporte

Para suporte, abra uma issue no [GitLab](https://gitlab.com/AcessibilidadeParaTodos/wally/wally-dev/-/issues) ou entre em contato atravÃ©s de [contato@equallyze.com](mailto:contato@equallyze.com).
