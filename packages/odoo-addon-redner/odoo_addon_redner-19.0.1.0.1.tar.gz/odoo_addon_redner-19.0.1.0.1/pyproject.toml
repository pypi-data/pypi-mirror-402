[project]
name = "odoo-addon-redner"
description = "Odoo addon to use redner (producer of reports and emails)"
readme = "README.rst"
requires-python = ">=3.10"
license = "AGPL-3.0-or-later"
license-files = ["LICENSE"]
authors = [{ name = "XCG SAS" }]
keywords = ["odoo"]
classifiers = [
  "Development Status :: 5 - Production/Stable",
  "Framework :: Odoo",
  "Framework :: Odoo :: 19.0",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Programming Language :: Python :: 3.13",
]
dependencies = ["odoo==19.0.*", "odoo-addon-converter >=19.0.1.0.0,<19.0.2"]
dynamic = ["version"]

[project.urls]
changelog = "https://orus.io/xcg/odoo-modules/redner/-/blob/branch/19.0/NEWS.rst"
documentation = "https://xcg.pages.orus.io/odoo-modules/redner/en/"
homepage = "https://orbeet.io/services/generateur-documents-redner/"
repository = "https://orus.io/xcg/odoo-modules/redner"

[project.optional-dependencies]
doc = ["sphinx"]
test = []
unixsocket = ["requests_unixsocket"]

[build-system]
requires = ["hatch-vcs", "hatchling >=1.19", "setuptools-scm-branch-versions"]
build-backend = "hatchling.build"

[tool.hatch.build]
exclude = [
  "/biome.json",
  "/doc/",
  "/.editorconfig",
  "/eslint.config.cjs",
  "/.gitlab-ci.yml",
  "/.hgignore",
  "/.hgtags",
  "/prettier.config.cjs",
  "/.yamllint.yaml",
]

[tool.hatch.build.targets.wheel]
include = [
  "py.typed",
  "*.csv",
  "/i18n/",
  "/static/",
  "README.rst",
  "*.xml",
  "*.py",
  "*.svg",
  "*.png",
]

[tool.hatch.build.targets.wheel.sources]
# The key must be empty so disable tombi check just here
# tombi: lint.rules.key-empty.disabled = true
"" = "odoo/addons/redner"

[tool.hatch.version]
source = "vcs"

[tool.hatch.version.raw-options]
version_scheme = "branch-versions"

[tool.isort]
section-order = [
  "future",
  "standard-library",
  "third-party",
  "odoo",
  "odoo-addons",
  "first-party",
  "local-folder",
]

[tool.isort.sections]
"odoo" = ["odoo"]
"odoo-addons" = ["odoo.addons"]

[tool.mypy]
check_untyped_defs = true

[[tool.mypy.overrides]]
module = ["odoo.*"]
ignore_missing_imports = true

[tool.pylint.main]
load-plugins = ["pylint_odoo", "pylint.extensions.docparams"]
py-version = "3.10"
# only fail due to fail-on
fail-under = 0
disable = [
  "consider-using-f-string",
  "too-few-public-methods",
  # disabled because ruff is used directly
  "wrong-import-order",
  # disabled, almost never done in Odoo or OCA code
  "missing-module-docstring",
  # disabled, explicit is better than implicit
  "attribute-string-redundant",
]
# fail-on copied from OCAâ€™s .pylintrc-mandatory after removing attribute-string-redundant
fail-on = [
  "anomalous-backslash-in-string",
  "api-one-deprecated",
  "api-one-multi-together",
  "assignment-from-none",
  "attribute-deprecated",
  "class-camelcase",
  "dangerous-default-value",
  "dangerous-view-replace-wo-priority",
  "development-status-allowed",
  "duplicate-id-csv",
  "duplicate-key",
  "duplicate-xml-fields",
  "duplicate-xml-record-id",
  "eval-referenced",
  "eval-used",
  "incoherent-interpreter-exec-perm",
  "license-allowed",
  "manifest-author-string",
  "manifest-deprecated-key",
  "manifest-required-author",
  "manifest-required-key",
  "manifest-version-format",
  "method-compute",
  "method-inverse",
  "method-required-super",
  "method-search",
  "openerp-exception-warning",
  "pointless-statement",
  "pointless-string-statement",
  "print-used",
  "redundant-keyword-arg",
  "redundant-modulename-xml",
  "reimported",
  "relative-import",
  "return-in-init",
  "rst-syntax-error",
  "sql-injection",
  "too-few-format-args",
  "translation-field",
  "translation-required",
  "unreachable",
  "use-vim-comment",
  "wrong-tabs-instead-of-spaces",
  "xml-syntax-error",
  "character-not-valid-in-resource-link",
  "consider-merging-classes-inherited",
  "context-overridden",
  "create-user-wo-reset-password",
  "dangerous-filter-wo-user",
  "dangerous-qweb-replace-wo-priority",
  "deprecated-data-xml-node",
  "deprecated-openerp-xml-node",
  "duplicate-po-message-definition",
  "except-pass",
  "file-not-used",
  "invalid-commit",
  "manifest-maintainers-list",
  "missing-newline-extrafiles",
  "missing-readme",
  "missing-return",
  "odoo-addons-relative-import",
  "old-api7-method-defined",
  "po-msgstr-variables",
  "po-syntax-error",
  "renamed-field-parameter",
  "resource-not-exist",
  "str-format-used",
  "test-folder-imported",
  "translation-contains-variable",
  "translation-positional-used",
  "unnecessary-utf8-coding-comment",
  "website-manifest-key-not-valid-uri",
  "xml-attribute-translatable",
  "xml-deprecated-qweb-directive",
  "xml-deprecated-tree-attribute",
  "external-request-timeout",
  # not checked in OCA
  "differing-param-doc",
  "differing-type-doc",
  "invalid-commit",
  "broad-exception-caught",
  "translation-not-lazy",
  "unnecessary-pass",
  "super-init-not-called",
]

[tool.pylint.odoolint]
readme-template-url = "https://orus.io/xcg/templates/odoo_module/-/raw/branch/19.0/README.rst?ref_type=heads"
manifest-required-authors = "XCG SAS"
manifest-required-keys = ["license"]
manifest-deprecated-keys = ["description", "active"]
license-allowed = [
  "AGPL-3",
  "GPL-2",
  "GPL-2 or any later version",
  "GPL-3",
  "GPL-3 or any later version",
  "LGPL-3",
]
valid-odoo-versions = "19.0"

[tool.pylint.basic]
# Good variable names which should always be accepted, separated by a comma
# - added cr to the list, and also tearDownClass and maxDiff used in Odoo tests
good-names = ["i", "j", "k", "ex", "Run", "_", "cr", "tearDownClass", "maxDiff"]

[tool.pylint.typecheck]
# List of classes names for which member attributes should not be checked
# (useful for classes with attributes dynamically set).
# - added odoo models
ignored-classes = [
  "SQLObject",
  "optparse.Values",
  "thread._local",
  "_thread._local",
  "odoo.models.Model",
  "odoo.models.AbstractModel",
  "odoo.models.TransientModel",
]
# List of module names for which member attributes should not be checked
# (useful for modules/projects where namespaces are manipulated during runtime
# and thus existing member attributes cannot be deduced by static analysis). It
# supports qualified module names, as well as Unix pattern matching.
# - added icu to the list, otherwise there is some false positives
# - also added addons models module to avoid false positives on models
ignored-modules = ["icu", "odoo.addons.*.models.*"]

[tool.pylint.similarities]
# Imports are removed from the similarity computation
ignore-imports = true

[tool.ruff]
target-version = "py310"

[tool.ruff.lint]
extend-select = [
  "B",
  "C90",
  "E501",  # line too long (default 88)
  "I",  # isort
  "UP",  # pyupgrade
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = [
  "F401",
  "I001"
]  # ignore unused and unsorted imports in __init__.py
"__manifest__.py" = ["B018"]  # useless expression

[tool.ruff.lint.mccabe]
max-complexity = 16
